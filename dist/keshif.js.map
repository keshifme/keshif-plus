{"version":3,"file":"keshif.js","sources":["../src/Base.ts","../src/d3_select.ts","../src/i18n_EN.ts","../src/i18n.ts","../src/Filter.ts","../src/UI/Modal.ts","../src/Aggregate.ts","../src/Aggregate_NoValue.ts","../src/TimeSeriesData.ts","../src/AttribTemplate.ts","../src/Attrib.ts","../src/Config.ts","../src/Util.ts","../src/Aggregate_Interval.ts","../src/Filter_Interval.ts","../src/Record.ts","../src/Attrib_Interval.ts","../src/Block.ts","../src/Block_Interval.ts","../src/Block_Numeric.ts","../src/Attrib_Numeric.ts","../src/UI/AttribDropdown.ts","../src/UI/ConfigPanel.ts","../src/Filter_Geo.ts","../src/Attrib_RecordGeo.ts","../src/Attrib_Timeseries.ts","../src/Block_Categorical.ts","../src/Aggregate_Category.ts","../src/Aggregate_SetPair.ts","../src/Block_Set.ts","../src/Attrib_Set.ts","../src/Filter_Categorical.ts","../src/Attrib_Categorical.ts","../src/RecordView.ts","../src/RecordView_Timeseries.ts","../src/RecordView_Map.ts","../src/RecordView_Scatter.ts","../src/Block_Timestamp.ts","../src/Aggregate_Interval_Date.ts","../src/Attrib_Timestamp.ts","../src/RecordView_List.ts","../src/RecordDisplay.ts","../src/MapData.ts","../src/MapStandards.ts","../src/UI/Breadcrumb.ts","../src/UI/MenuOpts.ts","../src/UI/Panel.ts","../src/DataLoader/FetchURL.ts","../src/DataLoader/GoogleSheets.ts","../src/DataTable.ts","../src/Block_Content.ts","../src/Attrib_Content.ts","../src/UI/RecordDetailsPopup.ts","../src/Browser.ts"],"sourcesContent":["import \"tippy.js/animations/scale.css\";\nimport \"tippy.js/dist/svg-arrow.css\";\nimport \"tippy.js/dist/tippy.css\";\n\nimport \"./assets/font-awesome/css/all.min.css\";\n\nimport { CompareType, MeasureType, MetricFunc } from \"./Types\";\n\nimport \"./keshif.less\";\nimport { MapData } from \"./MapData\";\nimport { Browser } from \"./Browser\";\nimport { DataTable } from \"./DataTable\";\n\n\nclass kshfBase {\n  // active browser\n  browser: Browser = null;\n\n  // all browsers in window\n  browsers: { [key: string]: Browser } = {};\n\n  // update to support google api loading\n  gapi = {\n    gKey: null,\n    clientId: null,\n    scope: null,\n  };\n\n  // point to where geojson files are hosted\n  geoFileDir = \"\";\n  geoFileExt = \"topojson\";\n\n  // external service configuration parameters\n  helpscoutBeacon: \"\"; // to set helpscout beacon ID\n\n  // dt: any = [];\n  // dt_id: any = {};\n\n  // Number of maximum visible records (items)\n  maxVisibleItems_Default = 100;\n  // how many rows (records) to look at to auto-detect attributes\n  autoDetect_RowCount = 10;\n\n  // **************************************************************\n  // BASIC CONFIGURATIONS\n\n  timeKeyHeight = 35; //\n  recordRankWidth = 45; //\n\n  maxRecordPointSize = 30;\n  defaultRecordPointSize = 4.5;\n\n  // Categorical chart size settings\n  height_CatBottom = 36; //\n  defaultBarHeight = 32; //\n  width_CatLabelMin = 110; //\n\n  width_scatter_margin_left = 85;\n  height_scatter_margin_bottom = 95; //\n\n  // Interval chart size settings\n  width_HistBarGap = 2; // Width (pixels) between neighboring histogram bars\n  width_HistBinDefault = 45;\n  width_measureDescrLabel = 20; //\n  height_MaxRatioDefault = 0.3; //\n  height_HistMin = 40; //\n  height_HistBottomGap = 12; // Height (pixels) for histogram gap on top.\n  height_Percentile = 34; // Height (pixels) of percentile chart\n\n  // Other size settings\n  width_PanelGap = 8; //\n  width_ScrollBar = 19; // scroll bar width\n  width_AttribPanelDefault = 250; //\n\n  percentDecimal = true; // set to false to not use a decimal point when presenting % labels\n\n  defaultDOM = \"#kshfDashboard\";\n\n  Panel_List = [\"left\", \"right\", \"middle\", \"bottom\"];\n\n  defaultMetricFuncs: MetricFunc[] = [\"Sum\", \"Avg\"];\n\n  Compare_List: CompareType[] = [\n    \"Compare_A\",\n    \"Compare_B\",\n    \"Compare_C\",\n    \"Compare_D\",\n    \"Compare_E\",\n  ];\n\n  maps = new Map<string, MapData>();\n\n  tables = new Map<string, DataTable>();\n\n  get Active_Compare_List(): MeasureType[] {\n    let m: MeasureType[] = [\"Active\"];\n    return m.concat(this.Compare_List);\n  }\n\n  get Total_Active_Compare_List(): MeasureType[] {\n    let m: MeasureType[] = [\"Total\", \"Active\"];\n    return m.concat(this.Compare_List);\n  }\n\n  map = {\n    tileTemplate: \"\", // point to the tileserver\n    leafConfig: {\n      maxBoundsViscosity: 1,\n      worldCopyJump: false,\n      // zoom settings\n      zoomControl: false,\n      boxZoom: false,\n      doubleClickZoom: false,\n      touchZoom: false,\n      zoomSnap: 0.5,\n      zoomDelta: 0.5,\n      maxZoom: 18,\n      minZoom: 1,\n      //crs: L.CRS.EPSG3857\n      //crs: L.CRS.Simple\n    },\n    tileConfig: {\n      attribution:\n        '&copy; <a href=\"https://openstreetmap.org/about/\" target=\"_blank\">OpenStreetMap</a><br><a href=\"https://www.mapbox.com/about/maps/\" target=\"_blank\">Mapbox</a> &amp; <a href=\"https://keshif.me\" target=\"_blank\">Keshif</a>',\n      subdomains: \"abcd\",\n      id: \"mapbox.light\",\n      //noWrap: true\n    },\n    flyConfig: {\n      padding: [0, 0],\n      pan: { animate: true, duration: 1.2 },\n      zoom: { animate: true },\n    },\n\n    pinGlyphPath: `M-0.025 -18 C-4.106 -18 -7.427 -14.751 -7.427 -10.757 -7.427 -5.8 \n      -0.803 1.476 -0.521 1.784 -0.256 2.072 0.207 2.072 0.471 1.784 0.753 1.476 7.377 -5.8 \n      7.377 -10.757 7.377 -14.751 4.057 -18 -0.025 -18 Z M-0.025 -7.112 C-2.078 -7.112 -3.749 \n      -8.747 -3.749 -10.757 -3.749 -12.766 -2.078 -14.401 -0.025 -14.401 2.029 -14.401 3.699 \n      -12.766 3.699 -10.757 3.699 -8.747 2.029 -7.112 -0.025 -7.112 Z`,\n  };\n\n  DOM: any = {};\n  popupInstance: any; // temp\n\n  custom_icons = {\n    trails: `<svg class=\"custom_icon custom_icon_trails\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 600 500\" xml:space=\"preserve\">\n        <g>\n          <path d=\"M489.2,65.25c0-35.7-28.5-65.2-64.2-65.2s-64.2,29.6-64.2,65.2c0,28.1,17.7,52.3,42.6,61.4l-28.2,232.3\n            c-6.6,0.5-12.9,2-18.7,4.4l-97.1-99.6c1.6-5.8,2.5-11.8,2.5-18.1c0-35.7-28.5-65.2-64.2-65.2s-64.2,29.6-64.2,65.2\n            c0,15.6,5.4,29.9,14.5,41.2l-62.3,75.7c-6.7-2.4-14-3.8-21.5-3.8c-35.7,0-64.2,29.6-64.2,65.2c0,35.7,28.5,65.2,64.2,65.2\n            c36.7,0,64.2-29.6,64.2-65.2c0-13.3-4-25.8-10.9-36.2l64.8-78.8c4.9,1.2,10,1.9,15.3,1.9c14.5,0,27.8-4.9,38.5-13.1l89.4,91.8\n            c-6.2,10-9.7,21.8-9.7,34.4c0,35.7,28.5,65.2,64.2,65.2s64.2-29.6,64.2-65.2c0-23.1-12-43.6-30.1-55.2l29.5-241\n            C470.1,119.55,489.2,94.45,489.2,65.25z M425,40.85c12.2,0,23.4,11.2,23.4,24.5s-11.2,24.5-23.4,24.5s-23.4-11.2-23.4-24.5\n            S411.7,40.85,425,40.85z M64.2,448.45c-12.2,0-23.4-11.2-23.4-24.5c0-13.2,10.2-24.5,23.4-24.5s23.4,11.2,23.4,24.5\n            C87.7,437.25,76.4,448.45,64.2,448.45z M197.7,270.15c-12.2,0-23.4-11.2-23.4-24.5c0-13.2,10.2-24.5,23.4-24.5\n            s23.4,11.2,23.4,24.5C221.2,258.95,209.9,270.15,197.7,270.15z M380.1,448.45c-12.2,0-23.4-11.2-23.4-24.5\n            c0-13.2,10.2-24.5,23.4-24.5c13.2,0,23.4,11.2,23.4,24.5C403.6,437.25,392.4,448.45,380.1,448.45z\"/>\n        </g>\n      </svg>`,\n  };\n\n  reloadWithNewConfig(dashboard: Browser, newConfig) {\n    this.tables.delete(dashboard.primaryTableName);\n    return new Browser(newConfig);\n  };\n\n  WebFontConfig = {\n    google: {\n      families: [\n        \"Roboto:100,300,400,500,700:latin\",\n        \"Roboto+Slab:300,400,700\",\n        \"Roboto+Condensed:300,400\",\n      ],\n    },\n  };\n\n  loadResources = async function () {\n    if (this._resourcesLoaded === true) return;\n\n    // Load common fonts\n    window[\"WebFontConfig\"] = this.WebFontConfig;\n    await import(\n      \"https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js\"\n    );\n    //window.WebFont.load(this.WebFontConfig); // or, after loading the script\n\n    window.addEventListener(\n      \"resize\",\n      () => {\n        for (var id in this.browsers) {\n          this.browsers[id].setNoAnim(true);\n          this.browsers[id].updateLayout();\n        }\n        if (this._resizeTimeout) {\n          window.clearTimeout(this._resizeTimeout);\n        }\n        this._resizeTimeout = window.setTimeout(() => {\n          for (var id in this.browsers) this.browsers[id].setNoAnim(false);\n        }, 500);\n      },\n      false\n    );\n\n    this._resourcesLoaded = true;\n\n    return true;\n  };\n}\n\nexport var Base = new kshfBase();\n\nwindow[\"kshf\"] = Base;\n\n","import DOMPurify from \"dompurify/dist/purify.es\";\n\nimport tippy, { roundArrow} from \"tippy.js\";\n\nimport { select, pointer, selection } from \"d3-selection\";\n\n// We need to import transition module\n// It is used by other sections, but not explicitly initialized as d3.transition...\n// export * as transition from \"d3-transition\";\nimport { Base } from \"./Base\";\n\nDOMPurify.setConfig({\n  USE_PROFILES: { html: true, svg: true },\n  ALLOWED_ATTR: [\"target\"],\n  //'FORBID_ATTR': ['rel'],\n  //'ALLOW_DATA_ATTR': false\n});\n\n// Open links in new window\nDOMPurify.addHook(\"afterSanitizeAttributes\", function (node) {\n  if (\"target\" in node) {\n    node.setAttribute(\"target\", \"_blank\");\n  }\n});\n\nfunction isObject(item) {\n  return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nfunction mergeDeep(target, ...sources) {\n  if (!sources.length) return target;\n  const source = sources.shift();\n\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key]) && !(source[key] instanceof HTMLElement)) {\n        if (!target[key]) Object.assign(target, { [key]: {} });\n        mergeDeep(target[key], source[key]);\n      } else {\n        Object.assign(target, { [key]: source[key] });\n      }\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n\nselection.tippyDefaultConfig = {\n  allowHTML: true,\n  animation: \"scale\", //'fade', 'shift-away', 'scale',\n  animateFill: false,\n  theme: \"dark kshf-tooltip\",\n  arrow: roundArrow,\n  delay: [500, 50],\n  duration: [350, 250],\n  maxWidth: 350, // max-width of the tippy box\n  placement: \"auto\",\n  popperOptions: {\n    modifiers: [\n      {\n        name: \"flip\",\n        enabled: true,\n        options: {\n          padding: 10,\n        },\n      },\n    ],\n  },\n};\n\nselection.prototype.tooltip = function (param1, param2) {\n  var config = param2 ? param2 : typeof param1 === \"object\" ? param1 : null;\n  var title = param2 ? param1 : typeof param1 === \"object\" ? null : param1;\n\n  // this ensures that tooltips are visible if the dashboard is made full-screen\n  var appendTo = Base.browser ? Base.browser.DOM.root.node() : document.body;\n\n  var tippyConfig = Object.assign(\n    { appendTo: appendTo },\n    selection.tippyDefaultConfig\n  );\n  mergeDeep(tippyConfig, config);\n  tippyConfig.popperOptions.modifiers[0].options.boundariesElement =\n    tippyConfig.appendTo;\n\n  if (title) {\n    if (typeof title === \"string\") {\n      title = DOMPurify.sanitize(title);\n      //\n    } else if (typeof title === \"function\") {\n      tippyConfig.onShow = (instance) => {\n        instance.reference.tippy.setContent(\n          DOMPurify.sanitize(title(instance.reference.__data__))\n        );\n        return true;\n      };\n    }\n  }\n\n  this.each(function () {\n    if (this.tippy) {\n      this.tippy.destroy();\n    }\n    this.tippy = tippy(this, tippyConfig);\n    if (typeof title === \"string\") {\n      this.tippy.setContent(title);\n    }\n  });\n\n  return this;\n};\n\nfunction htmlRemove() {\n  this.innerHTML = \"\";\n}\nfunction htmlConstant(value) {\n  return function () {\n    this.innerHTML = DOMPurify.sanitize(value);\n  };\n}\nfunction htmlFunction(value) {\n  return function () {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : DOMPurify.sanitize(v);\n  };\n}\nselection.prototype.html = function (value) {\n  return arguments.length\n    ? this.each(\n        value == null\n          ? htmlRemove\n          : (typeof value === \"function\" ? htmlFunction : htmlConstant)(value)\n      )\n    : this.node().innerHTML;\n};\n\nexport { select, selection, pointer };\n","import { Attrib } from \"./Attrib\";\nimport { Base } from \"./Base\";\nimport { Browser } from \"./Browser\";\n\nexport class i18n_EN {\n  [x: string]: string | ((...args: any) => string) | any;\n\n  constructor() {\n    this.LANG_NAME = \"English\";\n\n    this.LoadingData = \"Loading data...\";\n    this.CreatingBrowser = \"Creating Dashboard...\";\n    this.Close = \"Close\";\n    this.Help = \"Help\";\n\n    this.RemoveFilter = \"Remove filter\";\n    this.RemoveHighlight = \"Remove highlight\";\n    this.RemoveAllFilters = \"Remove all filters\";\n    this.LockToCompare = \"Compare\";\n    this.Unlock = \"Remove comparison\";\n    this.CompareTopCategories = \"Compare top categories\";\n    this.Compare = \"Compare\";\n\n    (this.LockCrumbMode = (stacked: any) =>\n      `<b>${\n        stacked ? \"Stacked\" : \"Side-by-side\"\n      } charts</b><br> are used for comparison.<br><br>\n        Click to switch to ${stacked ? \"side-by-side\" : \"stacked\"} charts.`),\n      (this.SideBySide = \"Side-by-Side\");\n    this.Stacked = \"Stacked\";\n    this.GroupView = \"Group-View\";\n\n    this.CollapseSummary = \"Close\";\n    this.OpenSummary = \"Open\";\n    this.ExpandSummary = \"Maximize\";\n    this.RemoveSummary = \"Remove\";\n\n    this.Confirm = \"Confirm\";\n    this.Cancel = \"Cancel\";\n    this.OK = \"OK\";\n    this.Delete = \"Delete\";\n\n    this.NoAttribute = \"(None)\";\n\n    this[\"No [Record]\"] = \"No\";\n\n    this[\"Absolute (Breakdown)\"] = \"Absolute\";\n\n    this.SetPairTitle = (v: string) => `${v}->Relations`;\n\n    this.DialogSideBySideCharts =\n      \"<u class='learnIcon' data-helparticle='5e88ff692c7d3a7e9aea6475'>Stacked charts</u>\";\n    this.DialogStackedCharts =\n      \"<u class='learnIcon' data-helparticle='5e88ff692c7d3a7e9aea6475'>Stacked charts</u>\";\n    this.DialogComparisonSelection =\n      \"<u class='learnIcon' data-helparticle='5e8905262c7d3a7e9aea6483'>Compare-selection</u>\";\n    this.DialogRelativeBreakdown =\n      \"<u class='learnIcon' data-helparticle='5e8944932c7d3a7e9aea659c'>%-of-groups breakdown</u>\";\n    this.DialogDependentBreakdown =\n      \"<u class='learnIcon' data-helparticle='5e8944812c7d3a7e9aea659b'>%-of-compared breakdown</u>\";\n\n    (this.DialogEmptyResultSet =\n      \"Removing this category will create an empty result list.\"),\n      (this.DialogChangeCompare = (_to, _from) =>\n        `To compare by <i>${_to}</i>,<br> we need to remove the current comparison on <i>${_from}</i>.`);\n    this.DialogStackedMultiValue = (_name) =>\n      this.DialogStackedCharts +\n      ` cannot be enabled while comparing on<br> multi-valued categorical attribute:<br><i>${_name}</i>.`;\n    this.DialogSideBySideSingleValue = (_name) =>\n      this.DialogSideBySideCharts +\n      ` cannot be enabled while comparing on<br> single-valued categorical attribute:<br><i>${_name}</i><br>using ${this.DialogRelativeBreakdown}.`;\n    this.DialogCompareForRelative = `Apply ${this.DialogComparisonSelection} first before switching to ${this.DialogRelativeBreakdown}.`;\n    this.ComparedSelectionsLimit =\n      \"You cannot compare across more than five data groups.\";\n\n    this.ZoomLevelWarning =\n      \"\" +\n      \"Your current browser zoom level may not be optimal for charting.<br>\" +\n      \"For best results, \" +\n      \"<span class='link attemptToFix'><i class='fa fa-magic'></i>click here to fix and refresh</span>, or<br>\" +\n      \"if issue persists, manually reset your browser zoom and refresh the page.<br>\" +\n      \"<a class='link' style='font-weight: 300' href='https://help.keshif.me/article/49-resolving-chart-display-issues'>\" +\n      \"More info</a>\";\n\n    this.MeasureDescrLabel = (dashboard: Browser, summary: Attrib): string => {\n      const measureText_simple = dashboard.measureFunc_Count\n        ? \"\"\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName}`;\n\n      const comparedBy = dashboard.comparedAttrib?.printName ?? null;\n\n      const breakdown = dashboard.breakdownMode.get();\n\n      if (breakdown == \"absolute\") {\n        return (measureText_simple || dashboard.recordName) + (comparedBy ? ` by ${comparedBy}` : ``);\n      }\n\n      // PERCENTAGE-BASED BREAKDOWN\n\n      const measureText_all = measureText_simple || `${dashboard.isFiltered() ? \"filtered\" : \"all\"} ${dashboard.recordName}`;\n\n      if (!comparedBy) {\n        return `% of ${measureText_all}`;\n      }\n\n      switch(breakdown){\n        case \"dependent\": return `${summary.printName} % , out of ${comparedBy} ${measureText_simple}`;\n        case \"relative\": return `${comparedBy} % , out of ${summary.printName} ${measureText_simple}`;\n        case \"total\": return `Combined % , out of ${measureText_all}`;\n      }\n    };\n\n    this.measureText = (dashboard: Browser) => (dashboard.measureFunc_Count) \n        ? dashboard.recordName\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName}`;\n\n    this.measureText_2 = (dashboard: Browser) => (dashboard.measureFunc_Count)\n        ? \"\"\n        : `${dashboard.measureFunc} of ${dashboard.measureSummary.get().printName} of `;\n\n    this.ListButton = \"List\";\n    this.MapButton = \"Map\";\n    this.NodeButton = \"Node-Link\";\n    this.TimeSeriesButton = \"Time\";\n    this.ScatterButton = \"Scatter\";\n    this.RecordViewTypeTooltip = (v: string) =>\n      `View ${Base.browser.recordName} on <br><b>${v}</b> chart`;\n\n    this.Boost_NoSuggestions = \"No suggested changes. Explore on!\";\n\n    this.TooltipOne = (_v, dashboard: Browser) => `${dashboard.getValueLabel(\n      _v,\n      false,\n      1,\n      true\n    )} of\n        ${dashboard.isFiltered() ? dashboard.getFilteredSummaryText() : \"all\"}\n        ${dashboard.recordName}`;\n\n    this.Tooltip_OutOf = (_v, dashboard: Browser) => {\n      var str = \"\";\n      if (dashboard.absoluteBreakdown) return str;\n\n      str += \"<div class='percentageExplainer'>\";\n      if (dashboard.relativeBreakdown) {\n        str += \"% out of <i>\" + _v + \"</i>\";\n      } else if (dashboard.dependentBreakdown) {\n        str += \"% out of <i>\" + dashboard.comparedAttrib?.printName + \"</i>\";\n      } else {\n        str += \"% out of all\";\n      }\n      str += \"</div>\";\n      return str;\n    };\n\n    this.Size = \"Size\";\n    this.Larger = \"Larger\";\n    this.Smaller = \"Smaller\";\n    this.Pairs = \"Pairs\";\n\n    this.Color = \"Color\";\n    this.InvertColorTheme = \"Invert color theme\";\n    this.ChangeColorTheme = \"Change color theme\";\n\n    this.ReverseOrder = \"Reverse order\";\n    this.Reorder = \"Reorder\";\n    this.SwapAxis = \"Swap axis\";\n    this.Percentiles = \"Percentiles\";\n\n    this.OpenDataSource = \"Open Data Source\";\n    this.ShowInfoCredits = \"Info\";\n    this.ShowFullscreen = \"Fullscreen\";\n    this.PrintButton =\n      \"Click to activate print style<br><b>Shift+click</b> to print.\";\n\n    this.Search = \"Search\";\n    (this.TextSearchForRecords = `Type to search and highlight.<br><br>+\n        <b><u>Enter</u></b> to filter <i class=\"fa fa-filter\"></i>`),\n      (this.ClearTextSearch = \"Clear\");\n    this.Rows = \"Rows\";\n    this.More = \"More\";\n    this.ScrollToTop = \"Top\";\n    this.Percent = \"Percent\";\n    this.Absolute = \"Absolute\";\n    this.Relative = \"Relative\";\n    this.Dependent = \"Dependent\";\n    this.Breakdown = \"Breakdown\";\n    this.BreakdownBy = \"Breakdown by\";\n    this.Total = \"Prozentuale\";\n    this.SeeBreakdown = (v) =>\n      `See <b>${this[v.charAt(0).toUpperCase() + v.slice(1)]}</b> Breakdown`;\n    this.DragToFilter = \"Drag\";\n    this.And = \"And\";\n    this.Or = \"Or\";\n    this.Not = \"Not\";\n    this.NoData = \"Missing data\";\n    this.ValidData = \"Valid data\";\n    this.KeepNoData = \"Keep missing data\";\n    this.KeepValidData = \"Keep valid data\";\n\n    this.ZoomToFit = \"Zoom to fit\";\n    this.ZoomIn = \"Zoom In\";\n    this.ZoomOut = \"Zoom Out\";\n\n    this.MeasureScale = \"Scale\";\n    this.RowHeight = \"Bar Height\";\n    this.RowOrder = \"Order\";\n\n    this.Charts = \"Charts\";\n    this.Charts_Histogram = \"Histogram\";\n    this.Charts_Percentiles = \"Percentiles\";\n\n    this.BinScale = \"Value Axis Scale\";\n\n    this.BinWidth = \"Bin Width\";\n    this.BinWidth_Narrow = \"Narrow\";\n    this.BinWidth_Medium = \"Medium\";\n    this.BinWidth_Wide = \"Wide\";\n\n    this.BinHeight = \"Height\";\n    this.BinHeight_Compact = \"Compact\";\n    this.BinHeight_Short = \"Short\";\n    this.BinHeight_Medium = \"Medium\";\n    this.BinHeight_Tall = \"Tall\";\n\n    this.DashboardAnalyticsConfig = \"Dashboard Configuration\";\n    this.ViewAsMap = \"View as Map\";\n    this.ViewAsList = \"View as List\";\n    this.ViewSetMatrix = \"Show/Hide pair-wise relations\";\n\n    this.MissingLocations = \"Missing<br>Locations\";\n    this.Reset = \"Reset\";\n\n    this.measure_Sum = \"Sum\";\n    this.measure_Avg = \"Average\";\n    this.measure_Count = \"Count\";\n\n    this.Of_NumberRecord = \"of\";\n\n    this.AutoPlay = \"Autoplay\";\n    this.StopAutoPlay = \"Stop Autoplay\";\n\n    this.SaveSelection = \"Save selection\";\n    this.EditFormula = \"Edit formula\";\n\n    this.Attributes = \"Attributes\";\n    this.DatasetButton = \"Attributes\";\n    this.AdjustButton = \"Adjust\";\n\n    this.SaveShareButton = \"Save\";\n\n    this.CategoricalAttribute = \"Categorical\";\n    this.NumericAttribute = \"Numeric\";\n    this.TimestampAttribute = \"Timestamp\";\n    this.TimeseriesAttribute = \"Timeseries\";\n    this.LocationAttribute = \"Geographic\";\n    this.UnknownAttribute = \"Unknown\";\n    this.UniqueAttribute = \"Unique\";\n    this.MultiValuedAttribute = \"Multi-valued\";\n    this.FunctionAttribute = \"Uses Custom Function\";\n    this.ContentAttribute = \"Content\";\n\n    this.Configure = \"Configure\";\n    this.Derive = \"Derive\";\n\n    // Adjust\n    this.EditTitle = \"Rename\";\n    this.RemoveRecordPanel = \"Remove record panel\";\n\n    this.EmptyDashboardNotice = `To add data into the dashboard : <br><br>\n          <i class='far fa-angle-double-down'></i> switch to <span style='font-weight: bolder'>Author</span> mode,<br>and <br>\n          <i class='far fa-angle-double-left'></i> double-click, or\n          click+drag an attribute into this canvas.\n          <br> <img class='kshfLogo_K'>`;\n\n    this.LinearSequence =\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,2,3,4)</span>\";\n    this.Log2Sequence =\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,2,4,8)</span>\";\n    this.Log10Sequence =\n      \"<span style='font-size:0.8em; opacity: 0.75'>(1,10,100)</span>\";\n\n    this.Error_CannotFindMap = (mapName) => `<i class='fal fa-frown'></i> We could not find the map [${mapName}].`;\n    this.Error_CannotLoadMap = (mapName) => `<i class='fal fa-frown'></i> We could not load the map [${mapName}].`;\n    this.Error_CannotMatchMap = (mapName) => `<i class='fal fa-frown'></i> We could not match any location name with the map [${mapName}].`;\n\n    // Platform-specific\n    this.RemoveDataset = \"Remove Dataset\";\n    this.Bookmark = \"Bookmark<br><i>Shift+Click to delete</i>\";\n    // Keeping these because they are referenced from lang table to create derived summaries\n    this.Lookup_Months = {\n      0: \"January\",\n      1: \"February\",\n      2: \"March\",\n      3: \"April\",\n      4: \"May\",\n      5: \"June\",\n      6: \"July\",\n      7: \"August\",\n      8: \"September\",\n      9: \"October\",\n      10: \"November\",\n      11: \"December\",\n    };\n    this.Lookup_DaysOfWeek = {\n      0: \"Sunday\",\n      1: \"Monday\",\n      2: \"Tuesday\",\n      3: \"Wednesday\",\n      4: \"Thursday\",\n      5: \"Friday\",\n      6: \"Saturday\",\n    };\n  }\n}\n","import { i18n_EN } from \"./i18n_EN.js\";\n\ninterface i18nI {\n  //[index: string]: (string | (()=>string) );\n  [index: string]: any;\n}\n\nlet ActiveLanguage = null; // internal variable (singleton, always created);\n\nexport let LoadLanguage = function (langSpec) {\n  ActiveLanguage = new Proxy(langSpec, {\n    // returns the value in indexed position if it exists. Otherwise, returns the key.\n    get: function (obj, prop) {\n      return prop in obj ? obj[prop] : prop;\n    },\n  });\n};\n\n// Main object used to index translation keys.\n// Loads the default language (i18n_EN) if it's not defined yet.\nexport var i18n: i18nI = new Proxy(\n  {},\n  {\n    // using proxy feature to adjust return values...\n    get: function (obj, prop) {\n      // if not defined, load English\n      if (!ActiveLanguage) LoadLanguage(new i18n_EN());\n      return ActiveLanguage[prop];\n    },\n  }\n);\n","import { BreadCrumb } from \"./UI/Breadcrumb\";\nimport { Browser } from \"./Browser\";\nimport { Base } from \"./Base\";\nimport { Record } from \"./Record\";\nimport { Attrib } from \"./Attrib\";\nimport { i18n } from \"./i18n\";\n\n/** -- */\nexport abstract class Filter_Base {\n  protected readonly browser: Browser;\n  protected readonly filterID: number;\n\n  // Each filter has its own breadcrumb\n  public breadcrumb: BreadCrumb = null;\n\n  private _isFiltered: boolean = false;\n  get isFiltered() {\n    return this._isFiltered;\n  }\n\n  public how: \"All\" | \"LessResults\" | \"MoreResults\" = \"All\";\n\n  /** -- */\n  constructor(_browser: Browser) {\n    this.browser = _browser;\n    this.filterID = this.browser.filterCounter++;\n\n    // Initialize all records to true (Not filtered) for current filter ID\n    this.browser.records.forEach((record) =>\n      record.setFilterCache(this.filterID, true)\n    );\n\n    this.browser.filters.push(this);\n  }\n\n  abstract get title(): string;\n  abstract filterView_Detail(): string;\n  abstract onClear(forceUpdate: boolean): void;\n  abstract onFilter(): void;\n  abstract importFilter(config: any): void;\n  abstract exportFilter(): any;\n\n  /** -- */\n  setFiltered(update = true) {\n    if (this.browser.singleFiltering) {\n      // TODO check logic\n      return;\n    }\n\n    this._isFiltered = true;\n\n    if (!update) return;\n\n    this.browser.refresh_filterClearAll();\n\n    this.applyFilter();\n\n    var stateChanged = false;\n\n    var how = 0;\n    if (this.how === \"LessResults\") how = -1;\n    if (this.how === \"MoreResults\") how = 1;\n    this.browser.records.forEach((record) => {\n      if (how < 0 && record.filteredOut) return;\n      if (how > 0 && !record.filteredOut) return;\n      stateChanged = record.refreshFilterCache() || stateChanged;\n    });\n\n    if (stateChanged) {\n      this.browser.updateRecordCount_Active();\n      this.browser.updateAfterFilter();\n    }\n  }\n\n  /* -- */\n  applyFilter() {\n    if(!this.breadcrumb){\n      this.breadcrumb = this.browser.createNewCrumb();\n    }\n\n    this.onFilter();\n    \n    this.breadcrumb.showCrumb(\"Filter\", this);\n  }\n\n  /** -- */\n  getRichText() {\n    return `${this.title}: ${this.filterView_Detail()}`;\n  }\n  /** -- */\n  getRichText_flipped() {\n    return `${this.filterView_Detail()} [${this.title}]`;\n  }\n\n  /** -- */\n  clearFilter(forceUpdate = true) {\n    if (!this._isFiltered) return false; // TO-DO: Does this break anything?\n    this._isFiltered = false;\n\n    this.browser.records.forEach((rec) =>\n      rec.setFilterCache(this.filterID, true)\n    );\n\n    this.breadcrumb?.removeCrumb();\n    this.breadcrumb = null;\n\n    this.onClear(forceUpdate);\n\n    if (forceUpdate !== false) {\n      this.browser.records.forEach(\n        (rec) => rec.filteredOut && rec.refreshFilterCache()\n      );\n      this.browser.updateRecordCount_Active();\n      this.browser.updateAfterFilter(true);\n    }\n\n    if (!this.browser.isFiltered()) {\n      this.browser.filters_wrap_letItWrap = false;\n      this.browser.DOM.breadCrumbs_Filter.classed(\"collapsed\", false);\n    }\n\n    return true;\n  }\n}\n\n/** adds this attribute - these filters work on an individual attribute */\nexport abstract class Filter extends Filter_Base {\n  public abstract readonly attrib: Attrib;\n\n  public get noValueAggr(){\n    return this.attrib.noValueAggr;\n  }\n\n  /** -- */\n  constructor(_browser: Browser) {\n    super(_browser);\n  }\n\n  /** -- */\n  onFilter(): void {\n    this.attrib.block?.refreshUIFiltered(true);\n\n    // clear compare selections - these items cannot be within the filtered area\n    if (this.attrib.isComparedAttrib()) {\n      Base.Compare_List.forEach((cT) => {\n        if (this.browser.selectedAggrs[cT]) {\n          this.browser.clearSelect_Compare(cT, true, true);\n        }\n      });\n    }\n  }\n  /** -- */\n  onClear(forceUpdate = false) {\n    this.attrib.block?.refreshUIFiltered(false);\n    this.attrib.block?.onClearFilter(forceUpdate);\n  }\n}\n\n/**\n * @constructor\n */\nexport class Filter_Record extends Filter_Base {\n  private removedRecords: Record[];\n\n  /** -- */\n  constructor(browser: Browser) {\n    super(browser);\n    this.removedRecords = [];\n  }\n\n  /** -- */\n  removeRecord(_record: Record) {\n    _record.setFilterCache(this.filterID, false);\n    this.removedRecords.push(_record);\n    this.setFiltered();\n  }\n\n  /** -- */\n  get title(): string {\n    return `<i class='far fa-times-circle></i> ${i18n.Removed}`;\n  }\n  /** -- */\n  onClear() {\n    this.removedRecords = [];\n  }\n  /** -- */\n  filterView_Detail() {\n    return this.removedRecords.length + \" \" + this.browser.recordName;\n  }\n  /** -- */\n  onFilter(): void {}\n\n  /** -- */\n  exportFilter(): string[] {\n    return this.removedRecords.map((r) => r.id);\n  }\n\n  /** -- */\n  importFilter(_: string[]): void {\n    var recordIndex = Base.tables.get(this.browser.primaryTableName);\n    if (!recordIndex) return;\n\n    this.removedRecords = [];\n\n    _.forEach((recID) => {\n      var record = recordIndex[recID];\n      if (record) {\n        this.removedRecords.push(record);\n        record.setFilterCache(this.filterID, false);\n      }\n    });\n\n    if (this.removedRecords.length > 0) {\n      this.setFiltered(false);\n      this.applyFilter();\n    }\n  }\n}\n\n/** -- */\nexport class Filter_Text extends Filter_Base {\n  private multiMode: \"and\" | \"or\" = \"and\";\n  // This is the text query string, populated by user input\n  private _queryString: string = null;\n  // This is the parsed string (multiple components to match)\n  private filterQuery: string[];\n\n  /** -- */\n  constructor(browser: Browser) {\n    super(browser);\n    this._queryString = null;\n  }\n\n  /** -- */\n  get title(): string {\n    return this.browser.recordDisplay.textAttrib_Brief.attribName;\n  }\n  /** -- */\n  filterView_Detail() {\n    return this._queryString;\n  }\n\n  /** -- */\n  onClear() {\n    this.browser.recordDisplay.DOM.recordTextSearch.classed(\"showClear\", false);\n    this.browser.recordDisplay.DOM.recordTextSearch\n      .select(\"input\")\n      .node().value = \"\";\n  }\n\n  /** -- */\n  onFilter(): void {\n    this.browser.recordDisplay.DOM.recordTextSearch.classed(\"showClear\", true);\n\n    // go over all the records in the list, search each keyword separately\n    var _summary = this.browser.recordDisplay.textAttrib_Brief;\n    this.browser.records.forEach((record) => {\n      var v = _summary.getRecordValue(record);\n      var f = false;\n      if (v) {\n        let v2 = v.join(\" \").toLowerCase();\n        if (this.multiMode === \"or\") {\n          f = !this.filterQuery.every((v_i) => v2.indexOf(v_i) === -1);\n        } else if (this.multiMode === \"and\") {\n          f = this.filterQuery.every((v_i) => v2.indexOf(v_i) !== -1);\n        }\n      }\n      record.setFilterCache(this.filterID, f);\n    });\n  }\n\n  /** -- */\n  set queryString(v) {\n    this._queryString = v.toLowerCase();\n    // convert string to query pieces\n    this.filterQuery = [];\n    if (this._queryString !== \"\") {\n      // split the input by \" character\n      this._queryString.split('\"').forEach((block, i) => {\n        if (i % 2 === 0) {\n          block.split(/\\s+/).forEach((q) => this.filterQuery.push(q));\n        } else {\n          this.filterQuery.push(block);\n        }\n      });\n      // Remove the empty strings\n      this.filterQuery = this.filterQuery.filter((v) => v !== \"\");\n    }\n  }\n  get queryString(){\n    return this._queryString;\n  }\n\n  /** -- */\n  importFilter(_) {\n    if (typeof _ === \"string\") _ = { query: _ };\n    if (!_.query) return;\n    this.queryString = _.query;\n    if (_.multiMode) this.multiMode = _.multiMode;\n    if (this.isFiltered) {\n      this.browser.recordDisplay.DOM.recordTextSearch\n        .select(\".textSearchInput\")\n        .node().value = _.query;\n      this.applyFilter();\n    }\n  }\n\n  /** -- */\n  exportFilter() {\n    return {\n      query: this._queryString,\n      multiMode: this.multiMode,\n    };\n  }\n}\n","import * as Popper from \"@popperjs/core\";\nimport { select } from \"../d3_select\";\n\nimport { Base } from \"../Base\";\nimport { i18n } from \"../i18n\";\n\nconst d3 = { select };\n\ndeclare let window: any;\n\nexport class Modal {\n  /** -- */\n  static alert(message, header = \"\") {\n    return new Promise((resolve, reject) => {\n      var _wrapper;\n      if (Base.browser) {\n        _wrapper = Base.browser.DOM.overlay_wrapper;\n      } else {\n        Base.DOM.Modal = d3\n          .select(\"body\")\n          .append(\"div\")\n          .attr(\"class\", \"kshf kshf_Modal\");\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\n          \"class\",\n          \"overlay_wrapper\"\n        );\n      }\n      var _root = _wrapper\n        .append(\"div\")\n        .attr(\"class\", \"overlay_content overlay_modal\")\n        .html(`<div class='overlay_Header'>${header}<i class='fa fa-warning'></i></div>\n          <div class='overlay_Content'>${message}</div>\n          <div class='ModalButtons'>\n            <div class='modalButton confirmButton'>${i18n.OK}</div>\n          </div>`);\n\n      Modal.createHelpScoutLinks(_root, true);\n\n      _wrapper.attr(\"show\", \"modal\");\n\n      _root.select(\".confirmButton\").on(\"click\", (event) => {\n        Modal._removeModal(_wrapper);\n        if (resolve) resolve(true);\n      });\n    });\n  }\n\n  /** -- */\n  static confirm(message, okText, cancelText = null) {\n    return new Promise((resolve, reject) => {\n      var _wrapper;\n      if (Base.browser) {\n        _wrapper = Base.browser.DOM.overlay_wrapper;\n      } else {\n        // there's no keshif browser, attach to main body of the page.\n        Base.DOM.Modal = d3\n          .select(\"body\")\n          .append(\"div\")\n          .attr(\"class\", \"kshf kshf_Modal\");\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\n          \"class\",\n          \"overlay_wrapper\"\n        );\n      }\n\n      _wrapper.attr(\"show\", \"modal\");\n\n      var _root = _wrapper\n        .append(\"div\")\n        .attr(\"class\", \"overlay_content overlay_modal\")\n        .html(`<div class='overlay_Header'><i class='fa fa-question-circle'></i></div>\n          <div class='overlay_Content'>${message}</div>\n          <div class='ModalButtons'>\n            <div class='modalButton confirmButton'>${okText || i18n.OK}</div>\n            <div class='modalButton rejectButton'>${\n              cancelText || i18n.Cancel\n            }</div>\n          </div>\n          `);\n\n      _root.select(\".confirmButton\").on(\"click\", (event) => {\n        Modal._removeModal(_wrapper);\n        resolve(new MouseEvent(event.type, event));\n      });\n      _root.select(\".rejectButton\").on(\"click\", () => {\n        Modal._removeModal(_wrapper);\n        if (reject) reject(false);\n      });\n    });\n  }\n\n  /** -- */\n  static prompt(message: string, _default?: any) {\n    return window.prompt(message, _default);\n    // TO-DO: Make it a promise & modal dialogue box\n  }\n\n  /** -- */\n  static autoChanges(_changes) {\n    return new Promise(function (resolve, reject) {\n      var _wrapper;\n      if (Base.browser) {\n        _wrapper = Base.browser.DOM.overlay_wrapper;\n        _wrapper.selectAll(\".overlay_modal\").remove();\n      } else {\n        Base.DOM.Modal = d3\n          .select(\"body\")\n          .append(\"div\")\n          .attr(\"class\", \"kshf kshf_Modal\");\n        _wrapper = Base.DOM.Modal.append(\"div\").attr(\n          \"class\",\n          \"overlay_wrapper\"\n        );\n      }\n      var _root = _wrapper\n        .append(\"div\")\n        .attr(\"class\", \"overlay_content overlay_modal\").html(`\n          <div class='overlay_Header'>Review Changes <i class='fa fa-question-circle'></i></div>\n          <div class='overlay_Content'></div>\n          <div class='ModalButtons'>\n            <div class='modalButton confirmButton'>OK</div>\n            <div class='modalButton rejectButton'>Cancel</div>\n          </div>\n          `);\n\n      _wrapper.attr(\"show\", \"modal\");\n      var _ = _root.select(\".overlay_Content\");\n\n      _.html(\"\").style(\"text-align\", \"left\"); // clear content\n\n      _.append(\"div\").html(\"We identified the following potential changes: \");\n\n      var changeList = _.append(\"table\").attr(\"class\", \"changeList\");\n      var __ = changeList\n        .selectAll(\".changeRow\")\n        .data(_changes)\n        .enter()\n        .append(\"tr\")\n        .attr(\"class\", \"changeRow\");\n\n      __.append(\"td\")\n        .attr(\"class\", \"changeIcon\")\n        .html((d) => d.i);\n      __.append(\"td\")\n        .attr(\"class\", \"changeText\")\n        .html((d) => d.q);\n      var _t = __.append(\"td\").attr(\"class\", \"changeToggle\");\n      _t.append(\"input\")\n        .attr(\"class\", \"theToggleInput\")\n        .attr(\"type\", \"checkbox\")\n        .attr(\"checked\", (d) => {\n          return d.change ? true : null;\n        })\n        .attr(\"id\", (_, i) => {\n          return \"toggle_\" + i;\n        })\n        .on(\"change\", (event, d) => {\n          d.change = !d.change;\n        });\n      _t.append(\"label\")\n        .attr(\"class\", \"theToggleLabel\")\n        .attr(\"for\", (_, i) => {\n          return \"toggle_\" + i;\n        });\n\n      _root.select(\".confirmButton\").on(\"click\", () => {\n        _wrapper.attr(\"show\", \"none\");\n        _root.classed(\"modalAlert\", false);\n        if (Base.DOM.Modal) Base.DOM.Modal.remove();\n        if (resolve) resolve(_changes);\n      });\n      _root.select(\".rejectButton\").on(\"click\", () => {\n        _wrapper.attr(\"show\", \"none\");\n        _root.remove();\n        if (Base.DOM.Modal) Base.DOM.Modal.remove();\n        if (reject) reject(false);\n      });\n    });\n  }\n\n  /** -- */\n  static _removeModal(_wrapper) {\n    _wrapper.select(\".overlay_modal\").remove();\n    // Keshif-dashboard\n    if (_wrapper.selectAll(\".overlay_modal\").nodes().length === 0) {\n      _wrapper.attr(\"show\", \"none\");\n    }\n    // Non-Keshif modal window\n    Base.DOM.Modal?.remove();\n  }\n\n  /** -- */\n  static popupMenu(event, template, param, opts: {placement} = null) {\n    var dashRootDOM = Base.browser.DOM.root;\n\n    if (\n      Base.popupInstance &&\n      Base.popupInstance.state.elements.reference === event.target\n    ) {\n      return;\n    }\n\n    // remove existing popup menu\n    if (dashRootDOM.select(\".contextMenu\")) {\n      dashRootDOM.select(\".contextMenu\").remove();\n    }\n\n    var contextMenu = dashRootDOM.append(\"div\").attr(\"class\", \"contextMenu\");\n\n    var contextArrow = contextMenu.append(\"div\").attr(\"class\", \"popperArrow\");\n\n    var removePopper = () => {\n      contextMenu.remove();\n      if (Base.popupInstance) {\n        var t = Base.popupInstance.state.elements.reference;\n        while (t && t.classList) {\n          t.classList.remove(\"popupVisible\");\n          t = t.parentNode;\n        }\n      }\n      Base.popupInstance = null;\n    };\n\n    Base.popupInstance = Popper.createPopper(\n      event.currentTarget, // reference\n      contextMenu.node(), // popper\n      {\n        placement: opts?.placement ?? \"right-start\",\n        strategy: \"absolute\",\n        modifiers: [\n          {\n            name: \"flip\",\n            enabled: true,\n          },\n          {\n            name: \"offset\",\n            options: {\n              offset: [0, 8],\n            },\n          },\n          {\n            name: \"arrow\",\n            options: {\n              element: contextArrow.node(),\n              padding: 4,\n            },\n          },\n        ],\n      }\n    );\n\n    contextMenu\n      .append(\"div\")\n      .attr(\"class\", \"popupMenu_Close\")\n      .tooltip(i18n.Close)\n      .html(\"<i class='fa fa-window-close'></i>\")\n      .on(\"click\", () => removePopper());\n\n    contextMenu\n      .append(\"div\")\n      .attr(\"class\", \"contextMenu_Header\")\n      .html(i18n[template.name]);\n\n    var contextMenu_Items = contextMenu\n      .append(\"div\")\n      .attr(\"class\", \"contextMenu_Items\");\n\n    contextMenu_Items.selectAll(\".popupMenuItem\").remove();\n\n    var isWhen = (item) => !item.when || item.when(param);\n\n    var isApplicable = (item) => {\n      // we know it's not applicable\n      if (item.when && !item.when(param)) return false;\n\n      // no options, just check current item\n      if (!item.options) return isWhen(item);\n\n      // convert from function to proper list\n      var _options = item.options;\n      if (typeof item.options === \"function\") {\n        if (!isWhen(item)) return false;\n        _options = item.options(param);\n      }\n\n      return _options.some(isApplicable) && isWhen(item);\n    };\n\n    var addTitleText = (_) => {\n      _.filter((item) => item.iconClass)\n        .append(\"span\")\n        .attr(\"class\", \"popupMenuItem_Header_Icon\")\n        .append(\"span\")\n        .attr(\"class\", (item) => item.iconClass);\n\n      _.filter((item) => item.iconXML)\n        .append(\"span\")\n        .attr(\"class\", \"popupMenuItem_Header_Icon\")\n        .html((item) => item.iconXML);\n\n      _.append(\"span\")\n        .attr(\"class\", \"popupMenuItem_Header_Text\")\n        .call((header) => {\n          header\n            .append(\"div\")\n            .attr(\"class\", \"mainText\")\n            .html((item) => i18n[item.name]);\n          header\n            .filter((item) => item.sampleValue)\n            .append(\"div\")\n            .attr(\"class\", \"sampleValue\")\n            .html((item) => i18n[item.sampleValue]);\n        });\n\n      _.filter((item) => item.helparticle)\n        .append(\"span\")\n        .attr(\"class\", \"helparticle fal fa-question-circle\")\n        .attr(\"data-helparticle\", (item) => item.helparticle)\n        .tooltip(i18n[\"Learn more\"], { placement: \"bottom\" })\n        .on(\"click\", (event, item) => {\n          Modal.attachHelpScout().then(() =>\n            window.Beacon(\"article\", item.helparticle, { type: \"modal\" })\n          );\n          event.stopPropagation();\n          event.preventDefault();\n        });\n\n      _.filter((item) => item.options)\n        .append(\"i\")\n        .attr(\"class\", \"expandCollapseIcon fa fa-caret-down\");\n\n      _.each((item, i, nodes) => {\n        if (item.onName) item.onName(nodes[i]);\n      });\n    };\n\n    function insertChildItems(DOM, items, parentD = null) {\n      DOM.selectAll(\".popupMenuItem\")\n        .data(items.filter(isApplicable))\n        .enter()\n        .append(\"div\")\n        .attr(\"class\", \"popupMenuItem\")\n        .classed(\"expanded\", (item) => item.expanded)\n        .attr(\"data-itemID\", (item) => item.id || null)\n        .call((_) => {\n          _.append(\"div\")\n            .attr(\"class\", \"popupMenuItem_Header\")\n            .classed(\"active\", (item) => {\n              if (item.active) {\n                if (typeof item.active === \"function\") {\n                  return item.active(param);\n                } else {\n                  return !!item.active;\n                }\n              }\n            })\n            .each((d2) => {\n              d2.parentD = parentD;\n            })\n            .on(\"click\", processItem)\n            .call(addTitleText);\n          _.append(\"div\")\n            .attr(\"class\", \"popupMenuItem_Children\")\n            .each((item, i, nodes) => {\n              if (item.expanded) {\n                // do not over-write this.\n                // the options function, if there is, need to be dynamically evaluated every time.\n                var _options = item.options;\n                if (typeof item.options === \"function\" && isWhen(item))\n                  _options = item.options(param);\n\n                insertChildItems(d3.select(nodes[i]), _options, item);\n              }\n            });\n        });\n    }\n\n    function processItem(_event, item) {\n      var _path = [],\n        t;\n      for (t = item.parentD; t; t = t.parentD) {\n        _path = [t.name].concat(_path);\n      }\n\n      if (!item.options) {\n        // find the \"do\" function in hierarchy, and execute it\n        for (var curNode = item; curNode; curNode = curNode.parentD) {\n          if (curNode.do) {\n            curNode.do(param, item.value, _path);\n            break;\n          }\n        }\n        removePopper();\n        return;\n      }\n\n      // has options\n      _path.push(item.name);\n\n      // swap expanded setting\n      this.parentNode.classList.toggle(\"expanded\");\n\n      var _ = d3.select(this.parentNode);\n      if (_.classed(\"expanded\")) {\n        // close all items\n        //contextMenu_Items.selectAll(\".popupMenuItem\").classed(\"expanded\",false);\n        // but, enable current item\n        var children = d3.select(this.parentNode.childNodes[1]);\n        children.selectAll(\".popupMenuItem\").remove();\n\n        // do not over-write this.\n        // the options function, if there is, need to be dynamically evaluated every time.\n        var _options = item.options;\n        if (typeof item.options === \"function\" && isWhen(item))\n          _options = item.options(param);\n\n        insertChildItems(children, _options, item);\n      }\n\n      Base.popupInstance.update();\n    }\n\n    insertChildItems(contextMenu_Items, template.items);\n\n    Base.popupInstance.update();\n\n    setTimeout(() => contextMenu.classed(\"visible\", true), 10);\n  }\n\n  /** -- */\n  static helpUI() {\n    return Modal.attachHelpScout().then(() => window.Beacon(\"open\"));\n  }\n\n  /** -- */\n  static createHelpScoutLinks(dom, withTooltip = false) {\n    dom = dom.selectAll(\"[data-helparticle]\");\n\n    dom.on(\"click\", (event) => {\n      var articleID = event.currentTarget.dataset.helparticle;\n      if (!articleID) return;\n      Modal.attachHelpScout().then(() =>\n        window.Beacon(\"article\", articleID, { type: \"modal\" })\n      );\n    });\n\n    if (withTooltip) {\n      dom.tooltip(i18n[\"Learn more\"]);\n    }\n  }\n  /** -- */\n  static attachHelpScout() {\n    if (!window.Beacon) {\n      (window.Beacon = function (t, n, a) {\n        window.Beacon.readyQueue.push({ method: t, options: n, data: a });\n      }),\n        (window.Beacon.readyQueue = []);\n    }\n\n    return import(\"https://beacon-v2.helpscout.net/\")\n      .then(() => {\n        if (!window.Beacon.readyQueue) return;\n        window.Beacon(\"init\", Base.helpscoutBeacon);\n\n        if (window.firebase && window.firebase.auth) {\n          var user = window.firebase.auth().currentUser;\n          if (user) {\n            window.Beacon(\"identify\", {\n              name: user.displayName || user.email,\n              email: user.email,\n              avatar: user.photoURL,\n              uid: user.uid,\n              portal_name: \"TODO\",\n            });\n          }\n        }\n      })\n      .catch(() => {\n        Modal.alert(\n          \"Script blocking extensions (Adblock, NoScript, uBlock, ...)<br>\" +\n            \"may be blocking our embedded help system. \" +\n            \"<a href='https://docs.helpscout.net/article/911-beacon-ad-blockers' target='_blank'>Learn more</a>\",\n          \"<i class='fal fa-frown'></i> Cannot display the help.\"\n        );\n        throw new Error();\n      });\n  }\n}\n","import DOMPurify from \"dompurify/dist/purify.es\";\n\nimport { Record } from \"./Record\";\nimport { Base } from \"./Base\";\nimport { i18n } from \"./i18n\";\n\nimport { CompareType, MeasureType } from \"./Types\";\nimport { Attrib } from \"./Attrib\";\n\ntype AggrMeasure = {\n  recCnt: number;\n  measure: number;\n  // used for visualization\n  scale?: number;\n  offset?: number;\n};\n\n/** -- */\nexport class Aggregate {\n  // Records which are mapped to this aggregate\n  public records: Record[] = [];\n\n  // the attribute which this aggregate is attached to\n  // may not be attached to an attribute\n  public readonly attrib?: Attrib;\n\n  /** -- */\n  constructor(attrib: Attrib) {\n    this.attrib = attrib;\n    this.resetAggregateMeasures();\n  }\n\n  /** -- */\n  get label(): string {\n    return \"\";\n  }\n\n  // ********************************************************************\n  // Selection (comparison) status\n  // ********************************************************************\n\n  // comparison status of the aggregate (comparisons may not be locked (highlighted))\n  private _compared?: CompareType;\n  get compared() {\n    return this._compared;\n  }\n\n  // locked selection status: true if compared and locked (not highlighting)\n  protected _locked: boolean = false;\n  get locked(): boolean {\n    return this._locked;\n  }\n\n  private Active: AggrMeasure;\n  private Total: AggrMeasure;\n  private Compare_A: AggrMeasure;\n  private Compare_B: AggrMeasure;\n  private Compare_C: AggrMeasure;\n  private Compare_D: AggrMeasure;\n  private Compare_E: AggrMeasure;\n  private Other: AggrMeasure; // non-compared\n\n  // ********************************************************************\n  // Visual status\n  // ********************************************************************\n\n  public isVisible: boolean;\n  public isVisibleBefore: boolean;\n\n  // Set false to signal that this aggregate should not be rendered\n  public usedAggr: boolean = true;\n\n  // DOM elements\n  public DOM: {\n    aggrGlyph?: Element;\n  } = { aggrGlyph: undefined };\n\n  /** -- */\n  setAggrGlyph(v: Element) {\n    this.DOM.aggrGlyph = v;\n  }\n\n  // ********************************************************************\n  // Access to key data\n  // ********************************************************************\n\n  measure(m: MeasureType): number {\n    if (Base.browser.measureFunc.is(\"Avg\")) {\n      var r = this[m].recCnt;\n      return r === 0 ? 0 : this[m].measure / r; // avoids division by zero\n    }\n    return this[m].measure;\n  }\n  recCnt(m: MeasureType): number {\n    return this[m].recCnt;\n  }\n  scale(m: MeasureType): number {\n    return this[m].scale;\n  }\n  offset(m: MeasureType): number {\n    return this[m].offset;\n  }\n\n  ratioToActive(t: MeasureType) {\n    return this.Active.measure ? this[t].measure / this.Active.measure : 0;\n  }\n\n  sumOffsetScale(m: MeasureType): number {\n    return this[m].offset + this[m].scale;\n  }\n\n  setOffset(m: MeasureType, v: number): void {\n    this[m].offset = v;\n  }\n  setScale(m: MeasureType, v: number): void {\n    this[m].scale = v;\n  }\n\n  // ********************************************************************\n  // Add/remove records and update data\n  // ********************************************************************\n\n  /** Adds the given record to the aggregate */\n  addRecord(record) {\n    this.records.push(record);\n    record._aggrCache.push(this);\n    this._processRecord(record);\n  }\n\n  /** Internal method to update (insert) measure/record count caches with data from the given record */\n  private _processRecord(record: Record) {\n    if (record.measure_Self == null) return;\n    [\"Total\"]\n      .concat(\n        record.filteredOut\n          ? []\n          : [\"Active\"].concat(\n              Base.Compare_List.filter((cT) => record.isSelected(cT))\n            )\n      )\n      .forEach((cT) => {\n        this[cT].measure += record.measure_Self;\n        this[cT].recCnt++;\n      });\n  }\n\n  /** -- */\n  clearRecords() {\n    this.records.forEach((record) => {\n      record.removeAggrFromCache(this);\n    });\n    this.records = [];\n    this.resetAggregateMeasures();\n  }\n\n  /** -- */\n  removeRecord(record: Record) {\n    this.records.splice(this.records.indexOf(record), 1);\n    record.removeAggrFromCache(this);\n    if (record.measure_Self == null) return;\n    [\"Total\"]\n      .concat(record.filteredOut ? [] : [\"Active\"])\n      .concat(Base.Compare_List.filter((cT) => record.isSelected(cT)))\n      .forEach((cT) => {\n        this[cT].measure -= record.measure_Self;\n        this[cT].recCnt--;\n      });\n  }\n\n  /** -- */\n  resetMeasure(t: MeasureType) {\n    this[t] = { measure: 0, recCnt: 0 };\n  }\n  resetAggregateMeasures() {\n    Base.Total_Active_Compare_List.forEach((cT) => this.resetMeasure(cT));\n    this.records.forEach((record) => this._processRecord(record));\n  }\n\n  addToActive(measureToAdd: number, cntToAdd: number) {\n    this.Active.measure += measureToAdd;\n    this.Active.recCnt += cntToAdd;\n  }\n\n  // ********************************************************************\n  // Select / unselect\n  // ********************************************************************\n\n  /** -- */\n  unselectAggregate() {\n    if (this._locked) return;\n    this.DOM.aggrGlyph?.classList.remove(\"showLock\");\n  }\n\n  /** -- */\n  selectCompare(cT) {\n    this._compared = cT;\n\n    this.records.forEach((record) => record.setCompared(cT));\n\n    this.DOM.aggrGlyph?.classList.add(\"showLock\");\n    this.DOM.aggrGlyph?.classList.add(this._compared);\n  }\n\n  /** -- */\n  clearCompare(cT) {\n    this.DOM.aggrGlyph?.classList.remove(\"showLock\");\n    this.DOM.aggrGlyph?.classList.remove(this._compared);\n\n    if (this._locked) {\n      this.unlockSelection();\n    }\n    this._compared = null;\n    this.records.forEach((record) => record.unsetCompared(cT));\n  }\n\n  /** -- */\n  lockSelection() {\n    this._locked = true;\n    this.DOM.aggrGlyph?.classList.add(\"locked\");\n  }\n  /** -- */\n  unlockSelection() {\n    this._locked = false;\n    this.DOM.aggrGlyph?.classList.remove(\"locked\");\n  }\n\n  // no info by default\n  exportAggregateInfo() {\n    return null;\n  }\n\n  // ********************************************************************\n  // Tooltip\n  // ********************************************************************\n\n  /** -- */\n  get tooltipTitle(): string {\n    return \"\";\n  }\n  protected get tooltipSkip1(): boolean {\n    return false;\n  }\n\n  private printCompared(cT: CompareType | \"Other\", details: string) {\n    return (\n      `<tr>` +\n      `<td class='measureDetail'>${details}</td>` +\n      `<td><span class='colorBox bg_${cT}'></span></td> ` +\n      `<td class='measureValue'>${Base.browser.getMeasureFormattedValue(\n        this.measure(cT).toLocaleString()\n      )}</td>` +\n      (Base.browser.absoluteBreakdown\n        ? \"\"\n        : `<td class='percentValue'>(${Base.browser.getValueLabel(\n            Base.browser.getChartValue(this, cT)\n          )})</td>`) +\n      `</tr>`\n    );\n  }\n\n  /** Returns the html content of the tooltip as a string */\n  getTooltipHTML(): string {\n    var str = \"\";\n    var browser = Base.browser;\n\n    var newLine = true;\n\n    str += `<div class='tooltipSummaryName'>${this.tooltipTitle}</div>`;\n\n    if (this.label) {\n      str += `<span class='mapItemName ${\n        this._compared ? \"bg_\" + this._compared : \"\"\n      }'>${this.label}</span>`;\n    }\n\n    str += \"<div class='aggrTooltip'>\";\n\n    str += \"<div class='aggrRecordCount'>\";\n\n    if (browser.measureFunc.is(\"Sum\")) {\n      newLine = false;\n      str +=\n        browser.getValueLabel(\n          browser.getMeasureValue(this, \"Active\", \"absolute\"),\n          false,\n          1,\n          false\n        ) +\n        \" \" +\n        i18n.measureText(browser);\n      str += `<span class='percentBlock percentage_metricSumOutOf'> (${i18n.TooltipOne(\n        browser.getMeasureValue(this, \"Active\", \"dependent\"),\n        browser\n      )}) </span>`;\n      str += `<div style='font-size: 0.8em;' class='tooltipAmong'>among</div>`;\n    }\n\n    str += `<span class=\"recordNumberInfo\">${this.recCnt(\n      \"Active\"\n    ).toLocaleString()} ${browser.recordName}`;\n\n    // show the %-of value if there are active records inside\n    if (\n      this.recCnt(\"Active\") > 0 &&\n      (this.recCnt(\"Active\") != browser.allRecordsAggr.recCnt(\"Active\") ||\n        this.tooltipSkip1)\n    ) {\n      str += `${newLine ? \"<br>\" : \"\"}\n          <span class='percentBlock percentage_recordOutOf'> \n          (${i18n.TooltipOne(\n            (100 * this.recCnt(\"Active\")) /\n              browser.allRecordsAggr.recCnt(\"Active\"),\n            browser\n          )})\n        </span>`;\n    }\n\n    str += `</span>`; // recordNumberInfo\n\n    str += `</div>`; // aggrRecordCount\n\n    if (\n      browser.isCompared() &&\n      this.attrib &&\n      this.recCnt(\"Active\") > 0 &&\n      (!this.attrib.isComparedAttrib() ||\n        (this.attrib.isMultiValued && browser.activeComparisonsCount > 1))\n    ) {\n      str += `<div class='tooltipBreakdownHeader'> \n            <span class='BreakdownText'>${i18n.BreakdownBy}</span>\n            ${browser.comparedAttrib.attribNameHTML}\n          </div>`;\n\n      this.Other = {\n        measure: this.measure(\"Active\"),\n        recCnt: this.recCnt(\"Active\"),\n      };\n\n      browser.activeComparisons.forEach((cT) => {\n        this.Other.measure -= this.measure(cT);\n        this.Other.recCnt -= this.recCnt(cT);\n      });\n\n      str += \"<table class='tooltipBreakdownTable'>\";\n\n      // sort active comparisons from large to small measure value\n      var _ = browser.activeComparisons\n        .slice()\n        .sort((a, b) => this[b].measure - this[a].measure);\n\n      // render each compared label and its value\n      _.forEach((cT: CompareType) => {\n        var comparedLabel = browser.selectedAggrs[cT].label;\n        if (\n          this.attrib?.attribID === browser.comparedAttrib.attribID &&\n          comparedLabel === this.label\n        ) {\n          // same summary, and same category\n          return;\n        }\n        str += this.printCompared(cT, comparedLabel);\n      });\n\n      let c = browser.comparedAttrib;\n      if (\n        this.Other.measure &&\n        !c.isMultiValued &&\n        this.attrib.browser.breakdownMode.get() !== \"dependent\"\n      ) {\n        str += this.printCompared(\"Other\", `(${browser.otherNameInCompare})`);\n      }\n\n      str += \"</table>\";\n\n      str += i18n.Tooltip_OutOf(this.label, browser);\n    }\n\n    str += \"</div>\"; // aggrTooltip\n\n    return DOMPurify.sanitize(str);\n  }\n}\n","import { Aggregate } from \"./Aggregate\";\nimport { Attrib } from \"./Attrib\";\nimport { i18n } from \"./i18n\";\n\n// Filtering can be disabled (false), in, or out\ntype NoValueSelection = false | \"in\" | \"out\";\n\n/** -- */\nexport class Aggregate_NoValue extends Aggregate {\n  private filterSelection: NoValueSelection = false;\n\n  constructor(attrib: Attrib) {\n    super(attrib);\n  }\n\n  get label(): string {\n    return i18n.NoData;\n  }\n\n  get filtered(): NoValueSelection {\n    return this.filterSelection;\n  }\n\n  set filtered(v: NoValueSelection) {\n    this.filterSelection = v;\n\n    if(this.records.length===0) return;\n    \n    if (this.filterSelection === false) {\n      this.DOM.aggrGlyph?.classList.remove(\"filtered\");\n    } else {\n      this.DOM.aggrGlyph?.classList.add(\"filtered\");\n    }\n  }\n\n  exportAggregateInfo() {\n    return {};\n  }\n}\n","import { extent } from \"d3-array\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\n\nconst d3 = { extent };\n\nexport type TimeKey = {\n  _time: Date;\n  _time_src: string;\n  _histogram?: Attrib_Numeric;\n  _index?: number;\n};\n\nexport type TimeData = {\n  // Date representation of date\n  _time: Date;\n  // String representation of date\n  _time_src: string;\n  // Observed value in that time\n  _value: number;\n  // Ranking of the value within that time (dynamic)\n  _rank?: number;\n  // The graphical representation / Used by timeseries view (dot)\n  DOM?: Element;\n};\n\nexport class TimeSeriesData {\n  // timedata indexed by string representations of date\n  _keyIndex: { [index: string]: TimeData } = {};\n  // a (sorted) list of timedata\n  _timeseries_: TimeData[] = [];\n  // Range of date (cache)\n  extent_Time?: [Date, Date] = null;\n  // Range of values - may be adjusted to show different analytics\n  extent_Value?: [number, number] = null;\n  // Range of values - based on raw values, not dynamic\n  extent_Value_raw?: [number, number] = null;\n\n  addTimeData(t: TimeData) {\n    this._keyIndex[t._time_src] = t;\n    this._timeseries_.push(t);\n  }\n\n  isEmpty() {\n    return this._timeseries_.length === 0;\n  }\n\n  hasTimeData() {\n    return this._timeseries_.length > 0;\n  }\n\n  computeCaches() {\n    this.extent_Time = d3.extent(this._timeseries_, (k) => k._time);\n    this.extent_Value = d3.extent(this._timeseries_, (k) => k._value);\n    this.extent_Value_raw = [...this.extent_Value];\n  }\n\n  sortTimeseries() {\n    this._timeseries_.sort(\n      (a: TimeData, b: TimeData) => a._time.getTime() - b._time.getTime()\n    );\n  }\n}\n","import { BlockType } from \"./Types\";\nimport { Attrib } from \"./Attrib\";\nimport { TimeSeriesData } from \"./TimeSeriesData\";\nimport { Browser } from \"./Browser\";\n\ntype SpecialKey =\n  | \"Degree\"\n  | \"Year\"\n  | \"Month\"\n  | \"DayOfMonth\"\n  | \"WeekDay\"\n  | \"Hour\"\n  | \"TimeseriesChange-#\"\n  | \"TimeseriesChange-%\"\n  | \"TimePoint\";\n\n/**\n  ->Degree(), Year(), ....\n  ->[UPPERCASE(*.)]\n  ->[*.]\n  ->...->...\n  ->2010 (timekey)\n  ->Change(%)\n  ->Change(#)\n*/\nexport class AttribTemplate {\n  // the string representation of the template\n  str: string = null;\n  // used for easy serialization\n  toString() {\n    return this.str;\n  }\n\n  // the function to call to access values from records\n  func: Function = null;\n\n  // path of the access\n  path: string[] = [];\n  get pathStr() {\n    return this.path.join(\"->\");\n  }\n  // special access to last information\n  special: SpecialKey = null;\n  // parent attribute\n  parent: Attrib = null;\n  // type of the attribute\n  blockType: BlockType = null;\n  lastKey: string = null;\n  vFrom: string[];\n\n  constructor(input: string | Function, dashboard: Browser) {\n    if (typeof input === \"function\") {\n      this.func = input;\n      this.str = \"\" + this.func;\n      return;\n    }\n\n    this.str = input;\n\n    var path = input.split(\"->\");\n    this.lastKey = path[path.length - 1];\n    this.path = path.slice(0, -1);\n    this.parent = dashboard.attribWithName(this.path.join(\"->\")) || null;\n\n    if (this.path.length === 0) {\n      // direct index in the object\n      this.func = function () {\n        return this[input];\n      };\n    } else {\n      // closure variable - it is updated later depending on special type\n      var lastAccess = (v) => v[this.lastKey];\n\n      switch (this.lastKey) {\n        case \"Degree()\":\n          lastAccess = (v) => v.length;\n          this.special = \"Degree\";\n          this.blockType = \"numeric\";\n          break;\n\n        case \"Year()\":\n          lastAccess = (v) =>\n            v && !isNaN(v.getTime()) ? v.getUTCFullYear() : null;\n          this.special = \"Year\";\n          this.blockType = \"categorical\";\n          break;\n\n        case \"Month()\":\n          lastAccess = (v) =>\n            v && !isNaN(v.getTime()) ? v.getUTCMonth() : null;\n          this.special = \"Month\";\n          this.blockType = \"categorical\";\n          break;\n\n        case \"DayOfMonth()\":\n          lastAccess = (v) =>\n            v && !isNaN(v.getTime()) ? v.getUTCDate() : null;\n          this.special = \"DayOfMonth\";\n          this.blockType = \"numeric\";\n          break;\n\n        case \"WeekDay()\":\n          lastAccess = (v) => (v && !isNaN(v.getTime()) ? v.getUTCDay() : null);\n          this.special = \"WeekDay\";\n          this.blockType = \"categorical\";\n          break;\n\n        case \"Hour()\":\n          lastAccess = (v) =>\n            v && !isNaN(v.getTime()) ? v.getUTCHours() : null;\n          this.special = \"Hour\";\n          this.blockType = \"numeric\";\n          break;\n\n        case \"Change(#)\":\n          lastAccess = (v) => {\n            let _ts = new TimeSeriesData();\n\n            v._timeseries_.forEach((k, i) => {\n              if (i == 0) return;\n\n              var cur = v._timeseries_[i];\n              var prev = v._timeseries_[i - 1];\n              if (!cur || !prev) return;\n\n              _ts.addTimeData({\n                _time: k._time,\n                _time_src: k._time_src,\n                _value: cur._value - prev._value,\n              });\n            });\n            return _ts;\n          };\n          this.special = \"TimeseriesChange-#\";\n          this.blockType = \"timeseries\";\n          break;\n\n        case \"Change(%)\":\n          lastAccess = (v) => {\n            let _ts = new TimeSeriesData();\n\n            v._timeseries_.forEach((k, i) => {\n              if (i == 0) return;\n\n              var cur = v._timeseries_[i];\n              var prev = v._timeseries_[i - 1];\n              if (!cur || !prev) return;\n\n              _ts.addTimeData({\n                _time: k._time,\n                _time_src: k._time_src,\n                _value: (100 * (cur._value - prev._value)) / (prev._value || 1),\n              });\n            });\n            return _ts;\n          };\n          this.special = \"TimeseriesChange-%\";\n          this.blockType = \"timeseries\";\n          break;\n      }\n\n      // TimePoint of a TimeSeries variable\n      if (!this.special && this.parent?.type === \"timeseries\") {\n        this.special = \"TimePoint\";\n        this.blockType = \"numeric\";\n\n        if (\n          [\"TimeseriesChange-%\", \"TimeseriesChange-#\"].includes(\n            this.parent.template.special\n          )\n        ) {\n          // anonymous function, has access to this context in this scope.\n          this.func = (record) => {\n            var v = this.parent.getRecordValue(record);\n            if (!v || v.length != null || v.length === 0) return null;\n            if (v) v = lastAccess.call(this, v._keyIndex);\n            return v ? v._value : v;\n          };\n          return;\n        } else {\n          lastAccess = (v: TimeSeriesData) => v._keyIndex[this.lastKey]._value;\n        }\n      }\n\n      this.func = function () {\n        var v = this;\n        for (var i = 0; i < path.length - 1; i++) {\n          v = v[path[i]];\n          if (v == null) return null; // hit a null key in the object path. Abort! Abort!\n        }\n        return v ? lastAccess.call(this, v) : v;\n      };\n    }\n  }\n\n}\n","import DOMPurify from \"dompurify/dist/purify.es\";\nimport { scaleLinear, scaleLog } from \"d3-scale\";\nimport { min, max } from \"d3-array\";\n\nimport { Browser } from \"./Browser\";\nimport { i18n } from \"./i18n\";\nimport { Config } from \"./Config\";\n\nimport { Block } from \"./Block\";\nimport { Record } from \"./Record\";\nimport { Base } from \"./Base\";\nimport { Filter } from \"./Filter\";\n\nimport { Aggregate } from \"./Aggregate\";\nimport { Aggregate_NoValue } from \"./Aggregate_NoValue\";\n\nimport { AttribTemplate } from \"./AttribTemplate\";\n\nimport {\n  BlockSpec,\n  BlockType as AttribType,\n  CompareType,\n  LinearOrLog,\n  MeasurableConfig,\n  MeasureType,\n  MetricFunc,\n  RecordVisCoding,\n  SummaryConfig,\n  SummarySpec,\n} from \"./Types\";\n\nconst d3 = {\n  scaleLinear,\n  scaleLog,\n  min,\n  max,\n};\n\n/** -- */\nexport abstract class Attrib {\n  // ********************************************************************\n  // Basic\n  // ********************************************************************\n  public readonly browser: Browser;\n  public readonly type: AttribType;\n\n  // Each attribute is assigned a unique number.\n  // This number is not stable - any browser config change may change this.\n  public readonly attribID: number;\n\n  // The associated block (view) - null by default\n  protected _block: Block = null;\n  public get block(): Block {\n    return this._block;\n  }\n\n  // ********************************************************************\n  // Template system\n  // ********************************************************************\n\n  public template: AttribTemplate = null;\n  applyTemplateSpecial(): void {}\n\n  // ********************************************************************\n  // Aggregation\n  // ********************************************************************\n\n  public _aggrs: Aggregate[] = [];\n  public readonly noValueAggr: Aggregate_NoValue;\n  public aggr_initialized: boolean = false;\n\n  abstract initializeAggregates(): void;\n\n  isEmpty() {\n    return this._aggrs.length === 0;\n  }\n\n  // TODO: review/remove, as we should not check for a specific type here.\n  uniqueCategories() {\n    return (\n      this.type === \"categorical\" &&\n      !this.isEmpty() &&\n      this._aggrs.length === this.browser.records.length\n    );\n  }\n\n  // ********************************************************************\n  // Filtering\n  // ********************************************************************\n\n  // The filter used to filter records. May be null\n  public summaryFilter: Filter | null = null;\n  isFiltered(): boolean {\n    return this.summaryFilter?.isFiltered ?? false;\n  }\n  // cen be extended by sub-classes\n  createSummaryFilter(): void {}\n\n  // ********************************************************************\n  // Other attributes (parent/derivative/child)\n  // ********************************************************************\n\n  // may have multiple derivatives, indexed by string keys\n  public derivatives?: { [index: string]: Attrib } = {};\n\n  // may have a single parent attribute\n  protected _parent: Attrib = null;\n  get parent(): Attrib {\n    return this._parent || this.template?.parent;\n  }\n\n  // overwritten by numeric summary\n  hasTimeSeriesParent(): boolean {\n    return false;\n  }\n\n  createDerivedAttrib(_special: string, name: string = null) {\n    if (this.derivatives[_special]) return;\n    this.derivatives[_special] = this.browser.createAttrib(\n      name || `${this.attribName}->${_special.replace(\"()\", \"\")}`,\n      `${this.template}->${_special}`\n    );\n    this.browser.refreshAttribList();\n  }\n\n  // ********************************************************************\n  // Name (path, html formatted strings, etc.)\n  // ********************************************************************\n\n  // the string representation of the name. May include a path/group\n  private _attribName: string = null;\n  // aka blockName\n  get attribName(): string {\n    return this._attribName;\n  }\n  get printName(): string {\n    return this._attribName.split(\"->\").pop();\n  }\n  // name without last key item\n  get pathName(): string[] {\n    return this._attribName.split(\"->\").slice(0, -1); // removes last item\n  }\n  // specialized method to consider/change behavior if with timeseries parent\n  get groupPath() {\n    return this.pathName;\n  }\n  get attribNameHTML() {\n    return `<span class='blockName_Path ${\n      this.pathName.length ? \"visible\" : \"\"\n    }'>${this.pathName\n      .map(\n        (_) =>\n          `<span class='groupName'>${_}</span><span class='fa fa-caret-right'></span>`\n      )\n      .join(\"\")}</span><span class='blockName_Print'>${this.printName}</span>`;\n  }\n  set attribName(newName: string) {\n    let curName = this._attribName;\n\n    if (curName === newName) return;\n\n    if(this.browser.attribWithName(newName)) return;\n\n    this.browser.removeAttribFromGroupIndex(this); // remove it from previous newName index\n\n    this._attribName = newName;\n\n    this.browser.insertAttribIntoGroupIndex(this);\n\n    this.browser.refreshAttribList();\n\n    this.block?.refreshSummaryName_DOM();\n\n    if (this.summaryFilter?.breadcrumb?.DOM) {\n      this.addDOMBlockName(\n        this.summaryFilter.breadcrumb.DOM.select(\".crumbHeader\")\n      );\n    }\n  }\n\n  // ********************************************************************\n  // Description\n  // ********************************************************************\n\n  // The description of the variable or content block\n  private _description: string = \"\";\n  get description(): string {\n    if (!this._description && this._parent) return this._parent.description;\n    return this._description;\n  }\n  set description(v: string) {\n    this._description = DOMPurify.sanitize(v, {}) || null;\n    this.block?.updateDescription();\n  }\n\n  // ********************************************************************\n  // Configuration objects TODO review\n  // ********************************************************************\n\n  public configs: { [key: string]: Config<any> } = {};\n  refreshConfigs() {\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  public readonly isComparable: Config<boolean>;\n\n  /** -- */\n  isIDAttrib() {\n    return this.browser.idSummaryName === this.attribName;\n  }\n  isComparedAttrib() {\n    return this === this.browser.comparedAttrib;\n  }\n  autoCompare(): void {}\n\n  // TODO review\n  public _metricFuncs: MetricFunc[] = Base.defaultMetricFuncs;\n  get canHaveMetricFuncs() {\n    return false;\n  }\n  get supportedMetricFuncs() {\n    return []; // none supported by default\n  }\n\n  /** -- */\n  addSupportedMetricFunc(t: MetricFunc) {\n    if (this._metricFuncs.includes(t)) return;\n    this._metricFuncs.push(t);\n    this.browser.measureSummary.refresh();\n  }\n  /** -- */\n  removeSupportedMetricFunc(t: MetricFunc) {\n    if (!this._metricFuncs.includes(t)) return; // not included already\n    this._metricFuncs = this._metricFuncs.filter((_) => _ != t);\n    if (\n      this.attribID === this.measureSummary?.attribID &&\n      this.browser.measureFunc.is(t)\n    ) {\n      this.browser.measureFunc.set(\"Count\");\n      this.browser.measureFunc.refresh();\n    } else {\n      this.browser.measureSummary.refresh(); // drop-down options refresh\n    }\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  // used to add class name to UI\n  public readonly blockClassName: string;\n  public readonly nuggetClassName: string;\n\n  // Does not support record encoding by default, can be extended\n  supportsRecordEncoding(_coding: RecordVisCoding): boolean {\n    return false;\n  }\n\n  // ********************************************************************\n  // Record value access\n  // ********************************************************************\n\n  getRecordValue(record: Record) {\n    return record.getValue(this);\n  }\n  setRecordValueCacheToMissing(record) {\n    // TO-DO: Remove record from its existing aggregate for this summary\n    record.setValue(this, null);\n    this.noValueAggr.addRecord(record);\n  }\n\n  getFormattedValue(_v, _isSVG): string {\n    return \"\";\n  }\n  renderRecordValue(_v, _d3_selection): string{\n    return \"\";\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  constructor(\n    browser: Browser,\n    name: string,\n    template: AttribTemplate = null,\n    _type: AttribType,\n    blockClassName: string = \"\",\n    nuggetClassName: string = \"\"\n  ) {\n    this.browser = browser;\n    this._attribName = name;\n    this.type = _type;\n\n    this.attribID = this.browser.attribCounter++;\n    this.blockClassName = blockClassName;\n    this.nuggetClassName = nuggetClassName;\n\n    this.browser.attribs.push(this);\n\n    if (template instanceof AttribTemplate) {\n      this.template = template;\n    } else {\n      this.template = new AttribTemplate(name, this.browser);\n    }\n\n    this.noValueAggr = new Aggregate_NoValue(this);\n    this.browser.allAggregates.push(this.noValueAggr);\n\n    this.isComparable = new Config<boolean>({\n      parent: this,\n      cfgClass: \"isComparable\",\n      cfgTitle: \"Select-Compare\",\n      UI: { disabled: true },\n      default: true,\n      itemOptions: [\n        { name: \"Enabled\", value: true },\n        { name: \"Disabled\", value: false },\n      ],\n      onSet: (v) => {\n        if (!v) {\n          // if not comparable, cannot be used to sum/avg data\n          this._metricFuncs = [];\n        }\n        if (!v && this.isComparedAttrib()) {\n          this.browser.clearSelect_Compare(this.browser.activeComparisons);\n        }\n        this.block?.DOM.root?.classed(\"disableCompareLock\", !v);\n      },\n    });\n\n    this.measureScaleType = new Config<LinearOrLog>({\n      cfgClass: \"measureScaleType\",\n      cfgTitle: \"Axis Scale\",\n      parent: this,\n      UISeperator: {\n        title: \"Axis\",\n      },\n      default: \"linear\",\n      iconClass: \"fa fa-chart-line\",\n      helparticle: \"5e88d63f04286364bc97d40b\",\n      itemOptions: [\n        {\n          name: i18n.Linear + \" \" + i18n.LinearSequence,\n          value: \"linear\",\n        },\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\n      ],\n      forcedValue: () => {\n        if (this.stackedCompare) return \"linear\";\n        if (this.percentBreakdown) return \"linear\";\n        if (this.browser.measureSumWithNegativeValues()) return \"linear\";\n      },\n      onSet: (v) => {\n        this.refreshScale_Measure(v);\n        this.block?.refreshViz_All();\n      },\n    });\n\n    this.axisScaleType = new Config<\"fit\" | \"sync\" | \"full\">({\n      cfgClass: \"axisScaleType\",\n      cfgTitle: \"Axis Extent\",\n      default: \"fit\",\n      parent: this,\n      iconClass: \"fa fa-chart-line\",\n      helparticle: \"5e893b562c7d3a7e9aea656e\",\n      itemOptions: [\n        { name: \"Fit\", value: \"fit\" },\n        { name: \"Sync\", value: \"sync\" },\n        { name: \"Full\", value: \"full\" },\n      ],\n      forcedValue: () => {\n        if (this.percentBreakdown && !this.browser.isCompared()) {\n          return \"fit\";\n        }\n        if (\n          this.browser.measureFunc_Avg &&\n          this.axisScaleType._value === \"full\"\n        ) {\n          return \"fit\";\n        }\n      },\n      onSet: () => {\n        if (!this.aggr_initialized) return;\n        this.updateChartScale_Measure(true);\n        this.block?.refreshViz_All();\n      },\n    });\n  }\n\n  finishTemplateSpecial() {\n    if (this.template.special) {\n      // add to parent's derivatives automatically\n      if (this.template.parent) {\n        this.template.parent.derivatives[this.template.special] = this;\n      }\n      // customizations per attribute class.\n      this.applyTemplateSpecial();\n    }\n  }\n\n  destroy() {\n    this.browser.destroyAttrib(this);\n  }\n\n  /** Utility method to inject HTML into DOM */\n  addDOMBlockName(DOM) {\n    DOM.html(this.attribNameHTML);\n\n    DOM.select(\".blockName_Path\")\n      .tooltip(i18n[\"Show/Hide Path\"])\n      .on(\"click\", (event) => {\n        event.currentTarget.classList.toggle(\"visible\");\n        event.stopPropagation();\n      });\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  // Shorthand access\n  get records() {\n    return this.browser.records;\n  }\n  get breakdownMode() {\n    return this.browser.breakdownMode.get();\n  }\n  get relativeBreakdown() {\n    return this.browser.relativeBreakdown;\n  }\n  get absoluteBreakdown() {\n    return this.browser.absoluteBreakdown;\n  }\n  get dependentBreakdown() {\n    return this.browser.dependentBreakdown;\n  }\n  get totalBreakdown() {\n    return this.browser.totalBreakdown;\n  }\n  get percentBreakdown() {\n    return this.browser.percentBreakdown;\n  }\n  get stackedCompare() {\n    return this.browser.stackedCompare.is(true);\n  }\n  get stackedChart() {\n    return this.browser.stackedChart;\n  }\n  vizActive(key: CompareType) {\n    return this.browser.vizActive(key);\n  }\n  get measureFunc() {\n    return this.browser.measureFunc.get();\n  }\n  get activeComparisons() {\n    return this.browser.activeComparisons;\n  }\n  get activeComparisonsCount() {\n    return this.browser.activeComparisonsCount;\n  }\n  get measureSummary() {\n    return this.browser.measureSummary.get();\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  public readonly measureScaleType: Config<LinearOrLog>;\n\n  public chartScale_Measure_prev: any;\n  public chartScale_Measure: any;\n\n  abstract get measureRangeMax(): number;\n\n  /** -- */\n  get measureScale_Log() {\n    return this.measureScaleType.is(\"log\");\n  }\n  /** -- */\n  get measureScale_Linear() {\n    return this.measureScaleType.is(\"linear\");\n  }\n  /** -- */\n  get measureExtent_Self() {\n    var maxMeasureValue = this.getPeakAggr(d3.max);\n\n    var minMeasureValue = 0;\n    if (this.absoluteBreakdown && this.browser.measureSumWithNegativeValues()) {\n      minMeasureValue = Math.min(this.getPeakAggr(d3.min), 0); // just making sure it cannot be > 0\n    }\n\n    // if using log scale, minimum value cannot be zero or negative\n    if (this.measureScale_Log && minMeasureValue <= 0) {\n      minMeasureValue = Math.max(1, minMeasureValue);\n    }\n\n    // If min/max domain is set to zero, d3 puts zero-value in the middle of the range. prevent\n    if (maxMeasureValue === 0 && minMeasureValue === 0) {\n      maxMeasureValue = 0.001;\n    }\n\n    return [minMeasureValue, maxMeasureValue];\n  }\n\n  public readonly axisScaleType: Config<\"fit\" | \"sync\" | \"full\">;\n\n  /** -- */\n  get measureDomain_Final() {\n    if (!this.block?.panel) {\n      return this.measureExtent_Self;\n    }\n\n    if (this.axisScaleType.is(\"fit\")) {\n      return this.measureExtent_Self;\n    }\n\n    if (this.axisScaleType.is(\"full\")) {\n      if (this.absoluteBreakdown) {\n        return [0, this.browser.allRecordsAggr.measure(\"Active\")];\n      } else {\n        return [0, 100];\n      }\n    }\n\n    if (this.axisScaleType.is(\"sync\")) {\n      return this.block?.panel.syncedMeasureExtent;\n    }\n    // fallback, just in case\n    return this.measureExtent_Self;\n  }\n\n  public measureLogBase = 10;\n\n  refreshScale_Measure(v = null) {\n    v ??= this.measureScaleType.get();\n\n    this.chartScale_Measure_prev = this.chartScale_Measure\n      ? this.chartScale_Measure.copy().clamp(false)\n      : null;\n\n    this.measureLogBase = 10;\n    this.chartScale_Measure =\n      v === \"log\" ? d3.scaleLog().base(this.measureLogBase) : d3.scaleLinear();\n    this.chartScale_Measure.clamp(true);\n\n    if (this.chartScale_Measure_prev) {\n      var domain = this.chartScale_Measure_prev.domain();\n      var range = this.chartScale_Measure_prev.range();\n      if (this.measureScale_Log) {\n        if (domain[0] === 0) domain[0] = 1;\n      } else {\n        domain[0] = Math.min(0, domain[0]);\n      }\n      this.chartScale_Measure.domain(domain).range(range);\n    }\n  }\n\n  /** -- */\n  updateChartScale_Measure(skipRefreshViz = false): void {\n    if (!this.aggr_initialized || this.isEmpty()) {\n      return; // nothing to do\n    }\n\n    this.chartScale_Measure_prev = this.chartScale_Measure\n      ? this.chartScale_Measure.copy().clamp(false)\n      : null;\n\n    var newDomain = this.measureDomain_Final;\n\n    if (this.measureScale_Log && newDomain[0] === 0) {\n      newDomain[0] = 1;\n    }\n\n    var hideActive = false;\n    if (this.relativeBreakdown && this.browser.activeComparisonsCount > 0) {\n      hideActive = newDomain[1] !== 100;\n    }\n    this.block?.DOM.root?.classed(\"hideActive\", hideActive);\n\n    this.chartScale_Measure.domain(newDomain).range([0, this.measureRangeMax]);\n\n    if (!skipRefreshViz && this.chartScale_Measure_prev) {\n      var oldDomain = this.chartScale_Measure_prev.domain();\n      if (\n        newDomain[0] !== oldDomain[0] ||\n        newDomain[1] !== oldDomain[1] ||\n        this.measureRangeMax !== this.chartScale_Measure_prev.range()[1]\n      ) {\n        this.block?.refreshViz_All();\n      }\n    }\n  }\n\n  // returns the maximum active aggregate value per row in chart data\n  // peakFunc is d3.min or d3.max\n  getPeakAggr(peakFunc, sT: MeasureType = null) {\n    if (this.isEmpty()) return 0;\n\n    if (typeof sT === \"string\") {\n      return peakFunc(this._aggrs, (aggr: Aggregate) =>\n        aggr.usedAggr ? this.browser.getChartValue(aggr, sT) : null\n      );\n    }\n\n    // No comparisons. Max aggregate will be that of the active\n    if (this.activeComparisonsCount === 0) {\n      return this.getPeakAggr(peakFunc, \"Active\");\n    }\n\n    // Active will be max if visible & using count or positive-sum's\n    if (\n      (this.absoluteBreakdown || this.totalBreakdown) &&\n      this.browser.showWholeAggr.is(true) &&\n      this.browser.measureWithPositiveValues()\n    ) {\n      return this.getPeakAggr(peakFunc, \"Active\");\n    }\n\n    var activeComparisons = this.activeComparisons;\n    if (this.stackedChart) {\n      // cannot add up separate maximums per selection, it needs to be accumulated per aggregate\n      return peakFunc(this._aggrs, (aggr) =>\n        aggr.usedAggr\n          ? activeComparisons.reduce(\n              (accum, sT) => accum + this.browser.getChartValue(aggr, sT),\n              0\n            )\n          : null\n      );\n    } else {\n      // pick the peak of all comparisons\n      return peakFunc(\n        activeComparisons.map((sT) => this.getPeakAggr(peakFunc, sT))\n      );\n    }\n  }\n\n  // ********************************************************************\n  // Measurable configuration\n  // ********************************************************************\n\n  measurable: MeasurableConfig = null;\n\n  // only sets it if the attribute has/is \"measurable\"\n  set unitName(v: string) {\n    if (this.measurable) {\n      this.measurable.unitName = v;\n      this.browser.recordDisplay.View?.refreshAttribUnitName(this);\n    }\n  }\n  get unitName(): string {\n    return this.measurable?.unitName || \"\";\n  }\n  get valueDomain(): [number, number] {\n    return this.measurable?.valueDomain || null;\n  }\n  get metricFuncs(): MetricFunc[] {\n    return this.measurable?.metricFuncs || Base.defaultMetricFuncs;\n  }\n\n  // ....\n  get isMultiValued() {\n    return false;\n  }\n\n  // ********************************************************************\n  // Export & apply config\n  // ********************************************************************\n\n  /** -- */\n  async applyConfig(blockCfg: SummarySpec) {\n    if (blockCfg.noNugget) {\n      this.browser.removeAttribFromGroupIndex(this);\n    }\n\n    if (blockCfg.isComparable === false) {\n      await this.isComparable.set(false);\n    }\n\n    if (blockCfg.metricFuncs) {\n      this._metricFuncs = blockCfg.metricFuncs;\n    }\n\n    await this.axisScaleType.set(blockCfg.axisScaleType);\n\n    this.block?.setCollapsed(blockCfg.collapsed === true);\n    this.description = blockCfg.description;\n\n    this.initializeAggregates();\n  }\n\n  isExportable(): boolean {\n    return true;\n  }\n\n  /** -- */\n  exportConfig() {\n    var cfg1: BlockSpec = {\n      name: this._attribName,\n      panel: this.block?.panel?.name || \"none\",\n      description: this.description || undefined,\n      collapsed: this.block?.collapsed,\n      type: this.type,\n      // TODO: nonugget\n    };\n\n    var cfg2: SummaryConfig = {\n      value: this.template.str !== cfg1.name ? this.template.str : undefined,\n      axisScaleType: this.axisScaleType.exportValue(),\n      measureScaleType: this.measureScaleType.exportValue(),\n      isComparable: this.isComparable.exportValue(),\n      ...this.measurable,\n    };\n\n    return Object.assign({}, cfg1, cfg2);\n  }\n}\n","import noUiSlider from 'nouislider/dist/nouislider.mjs';\n\nimport { i18n } from \"./i18n\";\nimport { Modal } from \"./UI/Modal.js\";\nimport { Attrib } from \"./Attrib.js\";\n\nexport class ConfigS<T> {\n  cfgClass?: string;\n}\n\ntype ItemOption<T> = {\n  name?: string;\n  value?: T;\n  DOM?: any;\n  max?: number; // sometimes, numbers specy a maximum value for each UI-item\n  activeWhen?: () => boolean;\n  _type?: string;\n  minValue?: number;\n  maxValue?: number;\n};\n\n/** -- */\nexport class Config<T> {\n  // current value\n  _value: T;\n\n  private _prevValue: T;\n\n  // default value\n  readonly default: T;\n  // cfgClass / varible name\n  readonly cfgClass?: string;\n  // printed title in UI\n  cfgTitle?: string;\n\n  // forced value (depends on other app settings)\n  readonly forcedValue?: (Config) => T | null;\n  // adjustments on current value when reading the value\n  readonly onRead?: (T) => T;\n\n  readonly onSet?: (a: T, b: Config<T>) => void;\n\n  readonly preSet?: (T, Config) => Promise<T>;\n\n  readonly isActive?: (Config) => boolean;\n\n  readonly onRefreshDOM?: (Config) => void;\n\n  readonly itemOptions: ItemOption<T>[];\n\n  // disables export setting\n  readonly noExport: boolean = false;\n\n  // TODO: {configs[], finalized, .refreshConfigs}\n  readonly parent: any;\n\n  private lookup = new Map<T, string>();\n\n  // DOM /rendering\n\n  public DOM: {\n    root?: any;\n    configOptions?: any;\n    noUiSlider?: any;\n    mainSelect?: any;\n    timeKeys?: any;\n    keySelect?: any;\n  };\n\n  // TODO: extend with necessary UI options\n  readonly UI: {\n    disabled?: boolean;\n    range?: [number, number];\n    step?: number;\n  };\n  readonly helparticle?: string;\n  readonly iconClass?: string;\n  readonly iconXML?: string;\n  readonly tooltip?: string;\n\n  readonly UISeperator?: {\n    className?: string;\n    title?: string;\n  };\n\n  readonly onDOM?: (any) => void;\n\n  /** -- */\n  constructor(_cfg: Partial<Config<T>>) {\n    Object.assign(this, _cfg);\n\n    this.UI ??= { disabled: false };\n\n    this.isActive ??= ((d) => {\n      if (d._type === \"_range_\") {\n        return (this.get() as unknown as number) > 0;\n      }\n      return this.is(d.value);\n    });\n\n    this.itemOptions\n      ?.filter((option) => option.value !== null)\n      .forEach((option) => this.lookup.set(option.value, option.name));\n\n    if (this?.parent?.configs)\n      this.parent.configs[this.cfgClass] = this;\n\n    this._prevValue = _cfg.default;\n    this._value = _cfg.default;\n\n    // TODO: This function may be async, but we are in a constructor...\n    this.onSet?.(this.get(), this);\n  }\n\n  /** Current value to string */\n  public toString() {\n    var v = this.get();\n    return i18n[this.lookup.get(v) || (v as undefined as string)];\n  }\n\n  /** Value getter */\n  public get(): T {\n    // If we have a forcedValue function that returns a non-null value, that's our current value;\n    var forced = this.forcedValue?.(this);\n    if (forced != null) return forced;\n\n    // We may run an onRead function to customize the value, or directly return the value itself.\n    return this.onRead?.(this._value) ?? this._value;\n  }\n\n  public is(v: T): boolean {\n    return this.get() === v;\n  }\n\n  /** Value setter - onSet function may be async*/\n  public async set(v: T) {\n    if (v == null) return; // cannot set to null or undefined. (false is ok)\n\n    var forced = this.forcedValue?.(this);\n    if (forced !== null && forced === v) return; // trying to set to current forced value. No need.\n\n    if (this.preSet) {\n      try {\n        v = await this.preSet(v, this);\n      } catch (error) {\n        if (this.parent?.finalized) {\n          Modal.alert(error); // show alert only after dashboard loading\n        }\n        return;\n      }\n    }\n\n    if (v == null) return; // preSet can return null, preventing change and raising no error\n\n    if (this._value === v) return; // prevent setting it to current value - no change\n\n    this._prevValue = this._value;\n    this._value = v;\n\n    await this.onSet?.(this.get(), this);\n\n    if (this.parent?.refreshConfigs) {\n      this.parent.refreshConfigs();\n    } else {\n      this.refresh();\n    }\n  }\n\n  // sets the value to previous value\n  public async undoChange(){\n    await this.set(this._prevValue);\n  }\n\n  /** -- */\n  public async refresh() {\n    this.onRefreshDOM?.(this);\n\n    if (this.DOM) {\n      // we have custom forced value function\n      if (this.forcedValue) {\n        var v = this.forcedValue(this);\n        this.DOM.root.classed(\"forced\", v != null);\n        if (v != null) await this.onSet?.(v, this);\n      }\n\n      if (this.isActive) {\n        this.DOM.configOptions.classed(\"active\", this.isActive);\n      }\n\n      this.DOM.noUiSlider?.setHandle(0, this._value, false);\n\n      this.itemOptions\n        ?.filter((_) => _.DOM && _.activeWhen)\n        .forEach((_) => {\n          _.DOM.classList[!_.activeWhen() ? \"add\" : \"remove\"](\"disabled\");\n        });\n    }\n  }\n\n  /** Calls oNSet and refresh... */\n  public async reset() {\n    await this.onSet?.(this.get(), this);\n\n    if (this.parent?.refreshConfigs) {\n      this.parent.refreshConfigs(); // refresh all configs of the parent\n    } else {\n      await this.refresh();\n    }\n  }\n\n  private addUISeperator(DOM) {\n    if (!this.UISeperator) return;\n    DOM.append(\"tr\")\n      .attr(\"class\", \"configItemGroup \" + this.UISeperator.className ?? \"\")\n      .append(\"td\")\n      .attr(\"class\", \"groupName\")\n      .html(i18n[this.UISeperator.title]);\n  }\n\n  /** -- */\n  public insertControl(DOM) {\n    if (this.UI?.disabled) return;\n\n    this.addUISeperator(DOM);\n\n    this.DOM = {};\n    this.DOM.root = DOM.append(\"tr\")\n      .attr(\"class\", \"configItem configItem_\" + this.cfgClass);\n\n    this.DOM.root.append(\"td\")\n      .attr(\"class\", \"configItem_Header\")\n      .append(\"span\")\n      .html(i18n[this.cfgTitle]);\n\n    let icon = this.DOM.root.append(\"td\")\n      .attr(\"class\", \"configItem_Icon\")\n      .append(\"span\");\n\n    // We can use a css class, or iconXML.\n    if (this.iconClass) {\n      icon.attr(\"class\", \"icon \" + this.iconClass);\n    } else {\n      icon.attr(\"class\", \"icon\").append(\"span\").html(this.iconXML);\n    }\n\n    var _ = this.DOM.root\n      .append(\"td\")\n      .attr(\"class\", \"configItem_Options_td\")\n      .append(\"div\")\n      .attr(\"class\", \"configItem_Options\");\n\n    this.DOM.configOptions = _.selectAll(\".configOption\")\n      .data(this.itemOptions || [])\n      .enter()\n      .append(\"span\")\n      .attr(\n        \"class\",\n        (d: ItemOption<T>) => \"configOption pos_\" + (d._type || d.value || d.name)\n      )\n      .each((d: ItemOption<T>, i, nodes) => {\n        d.DOM = nodes[i];\n      });\n\n    this.DOM.configOptions\n      .filter((_: ItemOption<T>) => _.value !== undefined)\n      .html((d: ItemOption<T>) => i18n[d.name])\n      .on(\"click\", async (_event, d: ItemOption<T>) => await this.set(d.value) );\n\n    this.DOM.configOptions\n      .filter((_) => _._type === \"_range_\")\n      .append(\"span\")\n      .attr(\"class\", \"configOptionRange\")\n      .each((_, i, nodes) => {\n        this.DOM.noUiSlider = noUiSlider.create(nodes[i], {\n          connect: \"lower\",\n          step: 1,\n          behaviour: \"tap-drag\",\n          range: {\n            min: _.minValue,\n            max: _.maxValue,\n          },\n          start: this.default,\n        });\n        nodes[i].noUiSlider.on(\"set\", async (v) => await this.set(v));\n      });\n\n    this.DOM.root\n      .append(\"td\")\n      .attr(\"class\", \"configItem_Info\")\n      .append(\"span\")\n      .attr(\"class\", \"fal fa-question-circle\")\n      .attr(\"data-helparticle\", this.helparticle)\n      .tooltip((this.tooltip ? this.tooltip + \"<br><br>\" : \"\") + \"Learn more\", {\n        placement: \"bottom\",\n      });\n\n    Modal.createHelpScoutLinks(this.DOM.root);\n\n    this.onDOM?.(this.DOM);\n\n    this.refresh();\n  }\n\n  public exportValue() {\n    if (this.noExport) return undefined;\n    if (this._value === this.default) return undefined;\n    var v: any = this._value;\n    if (v instanceof Attrib) v = v.attribName;\n    if (v._time_src) v = v._time_src;\n    return v;\n  }\n\n  /** -- */\n  public exportConfigTo(_to) {\n    _to[this.cfgClass] = this.exportValue();\n  }\n}\n","import { utcParse } from \"d3-time-format\";\nimport { format } from \"d3-format\";\nimport { easeCubicOut } from \"d3-ease\";\nimport { scaleLog, scaleLinear } from \"d3-scale\";\nimport { arc, line, curveMonotoneX } from \"d3-shape\";\n\nimport { BlockType } from \"./Types\";\n\nconst d3 = {\n  utcParse,\n  format,\n  easeCubicOut,\n  scaleLog,\n  scaleLinear,\n  arc,\n  line,\n  curveMonotoneX,\n};\n\n/** A namespace for various independent functions */\nvar Util = {\n  // Does not modify _base or _extend configurations\n  mergeConfig(_base, _extend = {}) {\n    return Util._mergeLevel(\n      JSON.parse(JSON.stringify(_base)),\n      JSON.parse(JSON.stringify(_extend)),\n      _base,\n      _extend\n    );\n  },\n  // _target: is updated\n  // returns: _target\n  _mergeLevel(_target, _extend, _base_raw, _extend_raw) {\n    for (var _key in _extend_raw) {\n      var _value = _extend_raw[_key];\n\n      //if(_value==null) continue; // skip undefined values\n\n      if (_target[_key] == null) {\n        // key is new => Just assign the variable\n        _target[_key] = _value;\n        continue;\n      }\n\n      if (_value === null) {\n        delete _target[_key];\n        continue;\n      }\n\n      switch (typeof _value) {\n        case \"object\":\n          if (typeof _target[_key] === \"object\") {\n            // merge summaries section - custom logic\n            if (_key === \"summaries\") {\n              // both source and target has \"summaries\" section set\n              if (\n                !Array.isArray(_extend.summaries) ||\n                !Array.isArray(_target.summaries)\n              ) {\n                console.log(\"Merge error: summaries property is not array\");\n                continue;\n              }\n\n              var _finalSummaries = [];\n\n              _extend_raw.summaries.forEach((srcSummaryConfig) => {\n                if (!srcSummaryConfig.skipConfig)\n                  srcSummaryConfig.skipConfig = false;\n\n                var targetSummaryCfg = _base_raw.summaries.find(\n                  (s) => s.name === srcSummaryConfig.name\n                );\n                if (targetSummaryCfg) {\n                  srcSummaryConfig = Util._mergeLevel(\n                    JSON.parse(JSON.stringify(targetSummaryCfg)),\n                    JSON.parse(JSON.stringify(srcSummaryConfig)),\n                    targetSummaryCfg,\n                    srcSummaryConfig\n                  );\n                  if (!srcSummaryConfig.skipConfig)\n                    delete srcSummaryConfig.skipConfig;\n                }\n\n                // summary gets added to end of summaries list\n                _finalSummaries.push(srcSummaryConfig);\n              });\n              _base_raw.summaries.forEach((s) => {\n                if (!_finalSummaries.find((_s) => _s.name === s.name)) {\n                  _finalSummaries.push(s);\n                }\n              });\n              _target.summaries = _finalSummaries;\n            } else {\n              // recursion to merge new objects\n              Util._mergeLevel(\n                _target[_key],\n                _extend[_key],\n                _base_raw[_key],\n                _extend_raw[_key]\n              );\n            }\n            break;\n          }\n        // just assign the value to the key\n        default:\n          _target[_key] = _value;\n          break;\n      }\n    }\n\n    // there may be keys in raw target OR source that's not in _target\n    // Specically, function values (and dates) are skipped bc of JSON.stringify\n    for (var _key in _base_raw) {\n      if (_extend_raw[_key] === undefined) {\n        _target[_key] = _base_raw[_key];\n      }\n    }\n    for (var _key in _extend_raw) {\n      _target[_key] = _target[_key] || _extend_raw[_key];\n    }\n\n    return _target;\n  },\n\n  // ********************************************\n  // String methods\n  // ********************************************\n\n  // ***************\n  strCollate: new Intl.Collator(undefined, {\n    ignorePunctuation: true,\n    sensitivity: \"base\",\n    numeric: true,\n  }),\n  // ***************\n  sortFunc_List_String(a, b) {\n    return Util.strCollate.compare(\"\" + a, \"\" + b);\n  },\n  // ***************\n  sortFunc_List_Date(a, b) {\n    if (a == null || a === \"\") return 1;\n    if (b == null || b === \"\") return -1;\n    return b.getTime() - a.getTime(); // recent first\n  },\n  sortFunc_List_Number(a, b) {\n    return b - a;\n  },\n  /** -- */\n  toProperCase: function (str) {\n    return str.toLowerCase().replace(/\\b[a-z]/g, (f) => f.toUpperCase());\n  },\n\n  /** -- */\n  addUnitName: function (v, unitName, isSVG = false) {\n    if (!unitName) return (v + \"\").replace(\"G\", \"B\"); // replace abbrevation G with B;\n    var s = isSVG ? unitName : \"<span class='unitName'>\" + unitName + \"</span>\";\n    return ((Util.isCurrency(unitName) ? s + v : v + s) + \"\").replace(\"G\", \"B\"); // replace abbrevation G with B;\n  },\n\n  /** -- */\n  isCurrency(v) {\n    switch (v) {\n      case \"$\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\":\n      case \"\": // Costa rica colon\n      case \"\": // Cuba peso\n      case \"\": // Viet nam dong\n      case \"\": // Russian ruble\n      case \"\": // India rupee\n      case \"\": // Cambodia riel\n      case \"\":\n      case \"z\": // Poland Zloty\n      case \"Br\": // Belarus Ruble\n      case \"Lek\": // Albania Lek\n        return true;\n      default:\n        return false;\n    }\n  },\n\n  /** -- */\n  getTimeParseFunc(fmt) {\n    // Note: new EPOCH config is %s (d3 standard method). Keeping for backwards compatibility!\n    if (fmt === \"%EPOCH\") {\n      return (v) => new Date(Math.floor(v * 1000));\n    }\n\n    if (fmt !== \"%sn\" && fmt !== \"%SN\") {\n      return d3.utcParse(fmt);\n    }\n\n    // Parse (Google) Sheet Date\n    // Days are counted from December 31st 1899 and are incremented by 1\n    // Decimals are fractions of a day.\n    return function (v) {\n      if (v && v !== \"\") {\n        var utc_days = Math.floor(v - 25569);\n        var utc_base = utc_days * 86400;\n\n        var fractional_day = v - Math.floor(v);\n        if (fractional_day === 0) {\n          return new Date(utc_base * 1000);\n        }\n        var total_seconds = Math.floor(86400 * fractional_day);\n\n        return new Date(utc_base * 1000 + total_seconds * 1000);\n      }\n    };\n  },\n\n  baseMeasureFormat: d3.format(\".2s\"),\n\n  /** You should only display at most 3 digits + k/m/etc */\n  formatForItemCount(n, unitName = \"\") {\n    n = Math.round(n);\n    var str;\n    if (n < 1000 && n > -1000) {\n      str = n.toString();\n    } else {\n      str = Util.baseMeasureFormat(n);\n      if (str.replace(/\\D/g, \"\").length === 3) {\n        str = d3.format(\".3s\")(n);\n      }\n    }\n    return Util.addUnitName(str, unitName, false);\n  },\n\n  /** -- */\n  isStepTicks: function (ticks) {\n    // increasing or decreasing (+/- 1)\n    return (\n      ticks.length >= 2 &&\n      ticks.every((v, i) =>\n        i === 0 ? true : Math.abs(ticks[i] - ticks[i - 1]) === 1\n      )\n    );\n  },\n\n  /** -- */\n  insertMinorTicks: function (ticks, _scale, _out, numMinor = 4) {\n    // if ticks[0] is larger than ticks[last], reverse\n    if (ticks[0] > ticks[ticks.length - 1]) ticks = ticks.reverse();\n    for (var i = 1; i < ticks.length; i++) {\n      var _minR = ticks[i - 1];\n      var _maxR = ticks[i];\n      var _difR = (_maxR - _minR) / numMinor;\n      var _min = _scale(_minR);\n      var _max = _scale(_maxR);\n      for (var j = 1; j < numMinor; j++) {\n        if (numMinor === 4) {\n          // base 2\n          var x = (_min + _max) / 2;\n          var _midR = (_minR + _maxR) / 2;\n          _out.push({\n            tickValue: _scale.invert(x),\n            major: false,\n            tickUnique: _midR,\n          });\n          _min = x;\n          _minR = _midR;\n        } else {\n          // new way\n          x = ticks[i - 1] + j * _difR;\n          _out.push({ tickValue: x, major: false, tickUnique: x });\n        }\n      }\n    }\n  },\n\n  /** -- */\n  ignoreScrollEvents: false,\n  scrollToPos_do(scrollDom, targetPos) {\n    scrollDom = scrollDom.node();\n    Util.ignoreScrollEvents = true;\n    // scroll to top\n    var startTime = null;\n    var scrollInit = scrollDom.scrollTop;\n    var easeFunc = d3.easeCubicOut;\n    var scrollTime = 500;\n    var animateToTop = function (timestamp) {\n      var progress;\n      if (startTime == null) startTime = timestamp;\n      // complete animation in 500 ms\n      progress = (timestamp - startTime) / scrollTime;\n      var m = easeFunc(progress);\n      scrollDom.scrollTop = (1 - m) * scrollInit + m * targetPos;\n      if (\n        scrollDom.scrollTop >= targetPos ||\n        scrollDom.offsetHeight + scrollDom.scrollTop >= scrollDom.scrollHeight\n      ) {\n        Util.ignoreScrollEvents = false;\n      } else {\n        window.requestAnimationFrame(animateToTop);\n      }\n    };\n    window.requestAnimationFrame(animateToTop);\n  },\n\n  removeEmptyKeys: function(cfg){\n    Object.keys(cfg).forEach(\n      (key) => cfg[key] === undefined && delete cfg[key]\n    );\n  },\n\n  // http://stackoverflow.com/questions/13627308/add-st-nd-rd-and-th-ordinal-suffix-to-a-number\n  ordinal_suffix_of: function (i) {\n    var j = i % 10,\n      k = i % 100;\n    if (j == 1 && k != 11) return i + \"st\";\n    if (j == 2 && k != 12) return i + \"nd\";\n    if (j == 3 && k != 13) return i + \"rd\";\n    return i + \"th\";\n  },\n\n  /** -- Geo-helper */\n  addMarginToBounds: function (bounds) {\n    if (!bounds.isValid()) return bounds;\n    var _NW = bounds.getNorthWest();\n    var _SE = bounds.getSouthEast();\n    var dist = _NW.distanceTo(_SE);\n    return bounds.extend(_NW.toBounds(dist / 5)).extend(_SE.toBounds(dist / 5));\n  },\n\n  /** The order of data type sorting on the attribute panel */\n  getAttribTypeOrder: (t: BlockType) => {\n    switch (t) {\n      case \"categorical\":\n        return 1;\n      case \"numeric\":\n        return 2;\n      case \"timestamp\":\n        return 3;\n      case \"timeseries\":\n        return 4;\n      case \"recordGeo\":\n        return 5;\n      case \"content\":\n        return 6;\n      case \"recordGeo\":\n        return 7;\n      default:\n        return 20;\n    }\n  },\n\n  /* -- */\n  intersects(d3bound, leafletbound) {\n    if (d3bound[0][0] > leafletbound._northEast.lng) return false;\n    if (d3bound[0][1] > leafletbound._northEast.lat) return false;\n    if (d3bound[1][0] < leafletbound._southWest.lng) return false;\n    if (d3bound[1][1] < leafletbound._southWest.lat) return false;\n    return true;\n  },\n\n  /** -- */\n  intersectsDOMRect(R1, R2) {\n    if (!R1 || !R2) return false;\n    if (R1.left > R2.right) return false;\n    if (R1.right < R2.left) return false;\n    if (R1.top > R2.bottom) return false;\n    if (R1.bottom < R2.top) return false;\n    return true;\n  },\n\n  /** -- */\n  getD3Scale: function (useLog) {\n    return useLog ? d3.scaleLog().base(2) : d3.scaleLinear();\n  },\n\n  /** -- */\n  getLineGenerator(timeScale, valueScale) {\n    return d3\n      .line()\n      .curve(d3.curveMonotoneX)\n      .x((d) => timeScale(d._time))\n      .y((d) => valueScale(d._value))\n      .defined((d) => d._value != null);\n  },\n\n  /** -- */\n  // http://stackoverflow.com/questions/5737975/circle-drawing-with-svgs-arc-path\n  // http://stackoverflow.com/questions/15591614/svg-radial-wipe-animation-using-css3-js\n  // http://jsfiddle.net/Matt_Coughlin/j3Bhz/5/\n  getPieSVGPath(_start, _angle, _r, strokeOnly) {\n    var _end = Math.min(_start + _angle, 0.999999);\n    var startRadian = (Math.PI * (360 * _start - 90)) / 180;\n    var endRadian = (Math.PI * (360 * _end - 90)) / 180;\n    var largeArcFlag = _angle > 0.5 ? 1 : 0;\n\n    return (\n      \"M \" +\n      Math.cos(startRadian) * _r +\n      \",\" +\n      Math.sin(startRadian) * _r +\n      \" A \" +\n      _r +\n      \",\" +\n      _r +\n      \" \" +\n      largeArcFlag +\n      \" \" +\n      largeArcFlag +\n      \" 1 \" +\n      Math.cos(endRadian) * _r +\n      \",\" +\n      Math.sin(endRadian) * _r +\n      \" \" +\n      (!strokeOnly ? \"L0,0\" : \"\")\n    );\n  },\n\n  /** -- */\n  getCirclePath: function () {\n    return d3\n      .arc()\n      .innerRadius(0)\n      .outerRadius(0.001)\n      .startAngle(0)\n      .endAngle(2 * Math.PI)();\n  },\n};\n\nexport { Util };\n","import { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Aggregate } from \"./Aggregate\";\nimport { IntervalT } from \"./Types\";\n\n/** -- */\nexport abstract class Aggregate_Interval<T extends IntervalT> extends Aggregate {\n  readonly attrib: Attrib_Interval<T>;\n\n  public _minV: T = null;\n  get minV(){\n    return this._minV;\n  }\n\n  public _maxV: T = null;\n  get maxV(){\n    return this._maxV;\n  }\n\n  get tooltipTitle(): string {\n    return this.attrib.attribNameHTML;\n  }\n\n  validateMinMax() {\n    if (this.minV <= this.maxV) return;\n    let _temp = this.minV;\n    this._minV = this.maxV;\n    this._maxV = _temp;\n  }\n\n  isMinLarger(){\n    return this.minV > this.attrib.rangeOrg[0];\n  }\n  isMaxSmaller(){\n    return this.maxV < this.attrib.rangeOrg[1];\n  }\n\n  updateRecords(){\n    this.records = this.attrib.sortedRecords.filter((record) =>\n      this.isRecordWithin(record)\n    );\n  }\n\n  // true if the maximum value is included within the scale\n  isMaxIncluded: boolean = false;\n\n  // _spacer is needed to detect intersecting labels and prevent overlaps\n  // used by Block_Interval\n  public _spacer?: any;\n\n  constructor(attrib: Attrib_Interval<T>, minV: T, maxV: T) {\n    super(attrib);\n    this.setRange(minV, maxV);\n  }\n\n  setRange(_minV: T, _maxV: T) {\n    this._minV = _minV;\n    this._maxV = _maxV;\n  }\n\n  isRecordWithin(record) {\n    let v = this.attrib.getRecordValue(record);\n    if(v < this.minV ) return false;\n    if(v > this.maxV ) return false;\n    if( v=== this.maxV) return this.isMaxIncluded;\n    return true;\n  }\n\n  /** -- */\n  exportAggregateInfo() {\n    return {\n      min: this.minV,\n      max: this.maxV,\n    };\n  }\n}\n\nexport class Aggregate_Interval_Numeric extends Aggregate_Interval<number> {\n  hasFloat: boolean = true;\n\n  get label(): string {\n    if (this.minV == null || this.maxV == null) return \"-\";\n\n    if(this.maxV === this.minV + 1 && !this.hasFloat){\n      return this.attrib.getFormattedValue(this.minV, false);\n    }\n\n    var minStr = this.attrib.getFormattedValue(this.minV, false);\n    var maxStr = this.attrib.getFormattedValue(this.maxV, false);\n\n    if (this.isMinLarger() && this.isMaxSmaller()) {\n      if(this.isMaxIncluded){\n        return `${minStr} &mdash; ${maxStr}`;\n      } else {\n        return `${minStr} up to ${maxStr}`;\n      }\n    } else if (this.isMinLarger()) {\n      return `Min ${minStr}`;\n    } else {\n      if(this.isMaxIncluded){\n        return `Max ${maxStr}`;\n      } else {\n        return `Up to ${maxStr}`;\n      }\n    }\n  }\n\n  validateMinMax() {\n    super.validateMinMax();\n\n    // must be integers\n    if (!this.hasFloat) {\n      this._minV = Math.floor(this.minV);\n      this._maxV = Math.ceil(this.maxV);\n    }\n\n    this._minV = Math.max(this.minV, this.attrib.rangeOrg[0]);\n    this._maxV = Math.min(this.maxV, this.attrib.rangeOrg[1]);\n  }\n}\n","import { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Browser } from \"./Browser\";\nimport { Filter_Interval_Spec, IntervalT } from \"./Types\";\nimport { Filter } from \"./Filter\";\nimport { i18n } from \"./i18n\";\n\n/** Filtering based on intervals */\nexport class Filter_Interval<T extends IntervalT> extends Filter {\n  public readonly attrib: Attrib_Interval<T>;\n\n  public active: Aggregate_Interval<T>;\n\n  /** -- */\n  constructor(_browser: Browser, attrib: Attrib_Interval<T>) {\n    super(_browser);\n    this.attrib = attrib;\n  }\n\n  /** -- */\n  get title(): string {\n    return this.attrib.attribName;\n  }\n  /** -- */\n  exportFilter(): Filter_Interval_Spec<T> {\n    var _: Filter_Interval_Spec<T> = {};\n    if (this.noValueAggr.filtered) {\n      _.missing = this.noValueAggr.filtered;\n    } else if(this.active) {\n      _.min = this.active.minV;\n      _.max = this.active.maxV;\n    }\n    return _;\n  }\n  /** -- */\n  importFilter(_: Filter_Interval_Spec<T>) {\n    if (_.missing) {\n      this.noValueAggr.filtered = _.missing;\n    } else {\n      this.active = this.attrib.createAggregate(_.min, _.max);\n    }\n    this.setFiltered(false);\n    this.applyFilter();\n  }\n  /** -- */\n  onClear() {\n    super.onClear();\n\n    this.active = null;\n\n    this.browser.recordDisplay?.filterStatusUpdated(this.attrib);\n  }\n  /** -- */\n  onFilter(): void {\n    this.browser.recordDisplay?.filterStatusUpdated(this.attrib);\n\n    if (this.noValueAggr.filtered) {\n      var c =\n        this.noValueAggr.filtered === \"in\"\n          ? (record) => this.attrib.getRecordValue(record) === null\n          : (record) => this.attrib.getRecordValue(record) !== null;\n      this.attrib.records.forEach((record) => {\n        record.setFilterCache(this.filterID, c(record));\n      });\n      return;\n    }\n\n    var isFilteredCb;\n    if (this.active.isMinLarger() && this.active.isMaxSmaller()) {\n      if(this.active.isMaxIncluded){\n        isFilteredCb = (v) => v >= this.active.minV && v <= this.active.maxV;\n      } else {\n        isFilteredCb = (v) => v >= this.active.minV && v < this.active.maxV;\n      }\n      //\n    } else if (this.active.isMinLarger()) {\n      isFilteredCb = (v) => v >= this.active.minV;\n      //\n    } else {\n      if(this.active.isMaxIncluded){\n        isFilteredCb = (v) => v <= this.active.maxV;\n      } else {\n        isFilteredCb = (v) => v < this.active.maxV;\n      }\n    }\n\n    // TO-DO: Optimize: Check if the interval scale is extending/shrinking or completely updated...\n    this.attrib.records.forEach((record) => {\n      var v = this.attrib.getRecordValue(record);\n      record.setFilterCache(\n        this.filterID,\n        v !== null ? isFilteredCb(v) : false\n      );\n    });\n\n    this.attrib.block.DOM.zoomControl?.attr(\n      \"sign\",\n      this.attrib.block.zoomableStatus()\n    );\n\n    this.attrib.block.refreshIntervalSlider();\n\n    super.onFilter();\n  }\n\n  filterView_Detail() {\n    if (this.noValueAggr.filtered === \"in\") return `(${i18n.NoData})`;\n    if (this.noValueAggr.filtered === \"out\") return `(${i18n.ValidData})`;\n    return this.active.label;\n  }\n}\n\nexport class Filter_Numeric extends Filter_Interval<number> {}\n\nexport class Filter_Timestamp extends Filter_Interval<Date> {\n  /** -- */\n  importFilter(_: Filter_Interval_Spec<Date>) {\n    if (_.missing) {\n      this.noValueAggr.filtered = _.missing;\n    } else {\n      this.active = this.active = this.attrib.createAggregate(_.min, _.max);\n      // if (this.attrib.type === \"timestamp\") {\n      //   this.active.min = new Date(this.active.min);\n      //   this.active.max = new Date(this.active.max);\n      // }\n    }\n    this.setFiltered(false);\n    this.applyFilter();\n  }\n}\n","import { Aggregate } from \"./Aggregate\";\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { Attrib } from \"./Attrib\";\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\n\nimport { Base } from \"./Base\";\nimport { CompareType } from \"./Types\";\n\nexport class Record {\n  public readonly _id: string;\n\n  public readonly data: any;\n\n  // By default, each item is aggregated as 1\n  // You can modify this with a non-negative value\n  // Note that the aggregation currently works by summation only.\n  public measure_Self = 1;\n\n  public DOM: {\n    record: any;\n  };\n\n  /** -- */\n  constructor(d, idIndex) {\n    this.data = d;\n    this._id = d[idIndex];\n\n    this.DOM = { record: undefined };\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get label() {\n    return this._id;\n  }\n\n  // Aggregates which this record falls under\n  private _aggrCache: Aggregate[] = [];\n\n  // The data that's used for mapping this item, used as a cache.\n  // This is accessed by filterID, and used for getRecordValue\n  private _valueCache: any[] = []; // caching the values this item was mapped toggle\n\n  setValue(attrib: Attrib, v: any) {\n    this._valueCache[attrib.attribID] = v;\n  }\n  getValue(attrib: Attrib): any {\n    return this._valueCache[attrib.attribID];\n  }\n\n  // ********************************************************************\n  // Filtering state\n  // ********************************************************************\n\n  // Cached filter state, indexed by attribute ID\n  private _filterCache: boolean[] = [];\n\n  // Wanted item / not filtered out\n  private _filteredOut: boolean = false;\n  get filteredOut(): boolean {\n    return this._filteredOut;\n  }\n  get isIncluded(): boolean {\n    return !this._filteredOut;\n  }\n\n  // If true, filter/wanted state is dirty and needs to be updated.\n  private _filterCacheIsDirty = true;\n\n  /** -- */\n  setFilterCache(index: number, v: boolean): void {\n    if (this._filterCache[index] === v) return;\n    this._filterCache[index] = v;\n    this._filterCacheIsDirty = true;\n  }\n\n  /** Updates isIncluded state, and notifies all related aggregates of the change\n   *  Returns true iff the filtered stated is changed.\n   **/\n  refreshFilterCache(): boolean {\n    if (!this._filterCacheIsDirty) return false;\n\n    var prev = this.isIncluded;\n\n    this._filteredOut = this._filterCache.some((f) => !f); // set to true iff at least one is false\n    this._filterCacheIsDirty = false;\n\n    if (this.isIncluded === prev) return false;\n\n    if (this.measure_Self != null) {\n      // may be zero or negative...\n      var cntToAdd = this.isIncluded ? 1 : -1;\n      var measureToAdd = cntToAdd * this.measure_Self; // Add : Remove value\n      this._aggrCache.forEach((aggr) => {\n        aggr.addToActive(measureToAdd, cntToAdd);\n      });\n    }\n\n    this.DOM.record?.classList.toggle(\"isExcluded\");\n\n    return true;\n  }\n\n  // ********************************************************************\n  // Selected state\n  // ********************************************************************\n\n  private selected = {\n    Compare_A: false,\n    Compare_B: false,\n    Compare_C: false,\n    Compare_D: false,\n    Compare_E: false,\n  };\n\n  // if a specific compare type is given, looks that up. otherwise, checks if ANY is selected\n  isSelected(cT: CompareType = null): boolean {\n    if (cT) return this.selected[cT];\n    return Base.Compare_List.some((cT) => this.selected[cT]);\n  }\n  /** -- */\n  get activeComparisons() {\n    return Base.Compare_List.filter((cT) => this.selected[cT]);\n  }\n\n  // ********************************************************************\n  // Rank information (used externally)\n  // ********************************************************************\n\n  // Rank order of the record. Starts from zero\n  // Used by the list view only TODO: Review\n  public recordRank = 0;\n  // assigned on data load, each record has a unique order position\n  public recordOrder = 0;\n  // negative if filtered out, positive if filtered in\n  public recordRank_Unique = 0;\n\n  // ********************************************************************\n  // Used by other methods to track additional view-state\n  // ********************************************************************\n\n  /** -- */\n  assignDOM(dom) {\n    this.DOM.record = dom;\n    if (!dom) return;\n\n    this.DOM.record.classList[this.isIncluded ? \"remove\" : \"add\"](\"isExcluded\");\n    Base.Compare_List.forEach((cT) => {\n      this.DOM.record.classList[this.selected[cT] ? \"add\" : \"remove\"](\n        \"rec-selected-\" + cT\n      );\n    });\n  }\n\n  /** -- */\n  removeAggrFromCache(aggr: Aggregate) {\n    this._aggrCache.splice(this._aggrCache.indexOf(aggr), 1);\n  }\n\n  /** -- */\n  moveDOMtoTop() {\n    if (this.DOM.record && navigator.userAgent.indexOf(\"Edge\") <= 0) {\n      this.DOM.record.parentNode.appendChild(this.DOM.record);\n    }\n  }\n\n  /** -- */\n  highlightRecord() {\n    this.DOM.record?.classList.add(\"rec-selected-onRecord\");\n    // update visuals of aggregates that this record appears in\n    this._aggrCache.forEach((aggr) => {\n      aggr.DOM.aggrGlyph?.classList.add(\"withRecordHighlight\");\n      if (aggr instanceof Aggregate_Interval) {\n        aggr.attrib.block.showRecordValue(this);\n      }\n    });\n  }\n  /** -- */\n  unhighlightRecord() {\n    this.DOM.record?.classList.remove(\"rec-selected-onRecord\");\n    this._aggrCache.forEach((aggr) => {\n      aggr.DOM.aggrGlyph?.classList.remove(\"withRecordHighlight\");\n      if (aggr instanceof Aggregate_Interval) {\n        aggr.attrib.block.hideRecordValue?.();\n      }\n    });\n  }\n\n  /** -- */\n  flipSelected(f, cT) {\n    this.DOM.record?.classList[this.selected[cT] === f ? \"remove\" : \"add\"](\n      \"rec-selected-\" + cT\n    );\n  }\n\n  /** -- */\n  addToAggrMeasure(_type) {\n    if (this.filteredOut) return;\n\n    this._aggrCache.forEach((aggr) => {\n      if (this.measure_Self === 0) return;\n      aggr[_type].measure += this.measure_Self;\n      aggr[_type].recCnt++;\n    });\n  }\n  /** -- */\n  removeFromAggrMeasure(_type) {\n    if (this.filteredOut) return;\n\n    this._aggrCache.forEach((aggr) => {\n      if (this.measure_Self === 0) return;\n      aggr[_type].measure -= this.measure_Self;\n      aggr[_type].recCnt--;\n    });\n  }\n\n  /** -- */\n  setCompared(cT) {\n    if (this.selected[cT]) return;\n    this.selected[cT] = true;\n    if (this.DOM.record) {\n      this.DOM.record.classList.add(\"rec-selected-\" + cT);\n      // SVG geo area - move it to the bottom of parent so that border can be displayed nicely.\n      // TO-DO: improve the conditional check!\n      if (this.DOM.record.nodeName === \"path\")\n        this.DOM.record.parentNode.appendChild(this.DOM.record);\n    }\n    this.addToAggrMeasure(cT);\n  }\n\n  /** -- */\n  unsetCompared(cT) {\n    if (!this.selected[cT]) return;\n    this.selected[cT] = false;\n    this.DOM.record?.classList.remove(\"rec-selected-\" + cT);\n    this.removeFromAggrMeasure(cT);\n  }\n\n  /** -- */\n  getTimeKeys(): TimeKey[] {\n    // collect ALL time keys / all attributes\n    return (\n      this._valueCache\n        // only the timseries values\n        .filter((_) => _ instanceof TimeSeriesData)\n        // Keep TimeData only\n        .map((ts: TimeSeriesData) => Object.values(ts._keyIndex))\n        .flat()\n        // filter to unique values\n        .filter(\n          (key, index, self: TimeData[]) =>\n            self.findIndex(\n              (t: TimeData) => t._time.getTime() === key._time.getTime()\n            ) === index\n        )\n        // sort by _time (latest first)\n        .sort((a, b) => b._time.getTime() - a._time.getTime())\n    );\n  }\n\n  public _view: {\n    inCluster?: any;\n    _labelHidden?: any;\n    _labelOverlap?: any;\n    _labelPos?: any;\n    hideTextLabel?: any;\n    textBounds?: any;\n    isInScatterPlot?: any;\n    wasInScatterPlot?: any;\n    isInRange?: any;\n    viewBounds?: any;\n    x?: any,\n    y?: any,\n  } = {};\n}\n","import { extent } from \"d3-array\";\n\nimport { BlockType, CompareType, IntervalT, SummarySpec } from \"./Types\";\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { Block_Interval } from \"./Block_Interval\";\nimport { Filter_Interval } from \"./Filter_Interval\";\nimport { Attrib } from \"./Attrib\";\nimport { Browser } from \"./Browser\";\nimport { Record } from \"./Record\";\n\nconst d3 = { extent };\n\nexport abstract class Attrib_Interval<T extends IntervalT> extends Attrib {\n  public _aggrs: Aggregate_Interval<T>[] = [];\n\n  protected _block: Block_Interval<T>;\n  public get block(): Block_Interval<T> {\n    return this._block;\n  }\n\n  public sortedRecords: Record[] = [];\n\n  get attribName(): string {\n    return super.attribName;\n  }\n\n  set attribName(name: string) {\n    super.attribName = name;\n    // name wasn't updated\n    if (this.attribName === name) {\n      this.browser.recordDisplay.refreshAttribOptions(\"sort\");\n    }\n  }\n\n  // ********************************************************************\n  // Value scale and Ticks\n  // ********************************************************************\n\n  public intervalTicks: T[] = [];\n\n  binMatch(bin: [T, T, any], aggr: Aggregate_Interval<T>) {\n    return +bin[0] - +aggr.minV === 0 && +bin[1] - +aggr.maxV === 0;\n  }\n\n  // d3 scale object (linear / log / time\n  // depends on whether it is numeric or timestamp attibute\n  public valueScale: any = null;\n  public valueScale_prev: any = null;\n\n  // linear scale, log scale, time scale\n  abstract getValueScaleObj(): any;\n  // adjusts between linear and log (for numeric) - no-op for timestamp;\n  abstract refreshScaleType(): any;\n\n  // Printing\n  abstract updateTickPrintFunc();\n  // looks like a function, but created like a member in subclasses dynamically\n  intervalTickPrint: (T) => string = null;\n\n  // TODO: move to Block (View)\n  abstract getValuePosX(v: T): number;\n\n  // Resets the valueScale and intervalTicks based on \n  // active range (filtering/zoom), UI width, scale type\n  refreshValueScale() {\n    var nicing = this.block.getScaleNicing();\n\n    this.valueScale = this.getValueScaleObj()\n      .domain(this.rangeActive)\n      .range([0, this.block.width_histogram])\n      .nice(nicing);\n\n    this.intervalTicks = this.valueScale.ticks(nicing);\n\n    this.updateTickPrintFunc();\n  }\n\n  updateScaleAndBins(forceRenderUpdate = false) {\n    if (this.isEmpty()) return;\n    if (!this.aggr_initialized) return;\n\n    this.valueScale_prev = this.valueScale.copy();\n\n    // if the labels are updated (multiple rows), design needs update too.\n    var height_labels_prev = this.block.height_Ticklabels;\n\n    this.refreshValueScale();\n\n    var ticks = this.intervalTicks;\n\n    if (ticks.length === 0) return;\n\n    this.block.aggrWidth =\n      this.valueScale(ticks[1]) - this.valueScale(ticks[0]);\n\n    // [ From , To (excluding), assign aggregate ]\n    type Bin = [T, T, Aggregate_Interval<T>];\n\n    // converts ticks to bins\n    var bins: Bin[] = this.intervalTicks.reduce(\n      (result: Bin[], value: T, index: number, array) => {\n        if (index < array.length - 1) {\n          result.push([value, array[index + 1], null]);\n        }\n        return result;\n      },\n      []\n    );\n\n    // Identify aggregates that don't match to a bin, clear their records, remove them from all aggreegate index\n    this._aggrs = this._aggrs.filter((curAggr) => {\n      // aggregate that matches one of the bins exists already. Do not modify...\n      if (bins.some((bin) => this.binMatch(bin, curAggr))) {\n        return true;\n      }\n      curAggr.clearRecords();\n      this.browser.allAggregates.splice(\n        this.browser.allAggregates.indexOf(curAggr),\n        1\n      );\n      return false;\n    });\n\n    // keep only bins that do not have an existing aggregate\n    bins = bins.filter(\n      (bin: Bin) => !this._aggrs.some((curAggr) => this.binMatch(bin, curAggr))\n    );\n\n    // if there are new bins, create aggregates, and put records inside\n    if (bins.length > 0) {\n      // create new aggregate interval for each remaining bin\n      bins.forEach((bin: Bin, i) => {\n        let aggr = this.getAggregate(bin[0], bin[1]);\n        if (i === bins.length - 1) {\n          aggr.isMaxIncluded = true;\n        }\n        bin[2] = aggr; // indexing aggregate object for the bin\n      });\n\n      // sort aggregates by order of bin values, min to max\n      this._aggrs = this._aggrs.sort((a, b) => +b.minV - +a.minV);\n\n      // place records across bins\n      this.records.forEach((record) => {\n        var v = this.getRecordValue(record);\n        if (v == null) return;\n        // Add record into appropriate bin.\n        // This iterates only over new bins\n        bins.forEach((bin) => {\n          if (v < bin[0]) return;\n          var aggr = bin[2];\n          if (v < bin[1] || (v == bin[1] && aggr.isMaxIncluded)) {\n            aggr.addRecord(record);\n          }\n        });\n      });\n    }\n\n    // RENDER UPDATES\n    if (!this.block.DOM.inited) return;\n\n    this.block.refreshIntervalSlider();\n\n    if (bins.length > 0 || forceRenderUpdate) {\n      this.block.insertVizDOM();\n\n      if (height_labels_prev !== this.block.height_Ticklabels) {\n        this.block.setHeight(this.block.getHeight());\n      }\n\n      this.updateChartScale_Measure();\n\n      this.block.refreshViz_All(false); // no-axis\n    }\n  }\n\n  // ********************************************************************\n  // Step ticks\n  // ********************************************************************\n\n  private _stepTicks: boolean = false;\n  get stepTicks() {\n    return this._stepTicks;\n  }\n  setStepTicks(v) {\n    this._stepTicks = v;\n  }\n\n  // ********************************************************************\n  // Aggregates / bins\n  // ********************************************************************\n\n  abstract fillValueCache(): void;\n  abstract pofffff(): void;\n\n  initializeAggregates(): void {\n    if (this.aggr_initialized) return;\n\n    if (this.noValueAggr.records.length > 0) {\n      this.noValueAggr.records = [];\n      this.noValueAggr.resetAggregateMeasures();\n    }\n\n    this.fillValueCache();\n\n    // remove records that map to null / undefined\n    this.sortedRecords = this.records.filter(\n      (record) => this.getRecordValue(record) != null\n    );\n    // Sort the items by their attribute value\n    this.sortedRecords.sort((a: Record, b: Record) => {\n      // +Date converts the date to a number, and the template system continues by conversion\n      let a1 = +this.getRecordValue(a);\n      let a2 = +this.getRecordValue(b);\n      return a1 - a2;\n    });\n\n    this.updatedRangeOrg();\n\n    this.refreshValueScale();\n\n    this.pofffff();\n\n    this.aggr_initialized = true;\n  }\n\n  abstract createAggregate(minV: T, maxV: T): Aggregate_Interval<T>;\n\n  getAggregate(minV: T, maxV: T): Aggregate_Interval<T> {\n    var newAggr = this.createAggregate(minV, maxV);\n    this._aggrs.push(newAggr);\n    this.browser.allAggregates.push(newAggr);\n    return newAggr;\n  }\n\n  // ********************************************************************\n  // Filtering and Range\n  // ********************************************************************\n\n  public summaryFilter: Filter_Interval<T>;\n  createSummaryFilter() {\n    this.summaryFilter = new Filter_Interval(this.browser, this);\n  }\n\n  // original data scale\n  rangeOrg: [T, T];\n  updatedRangeOrg() {\n    this.rangeOrg = this.getRecordValueExtent();\n  }\n\n  // returns filtered range if filtered. Otherwise, original range\n  get rangeActive(): [T, T] {\n    return (this.summaryFilter.isFiltered && this.block.zoomed.is(true))\n      ? [this.summaryFilter.active.minV, this.summaryFilter.active.maxV]\n      : this.rangeOrg;\n  }\n\n  // in numbers, if time-series key, uses timeseries extent automatically\n  getRecordValueExtent(): [T, T] {\n    return d3.extent(this.sortedRecords, (record: Record) =>\n      this.getRecordValue(record)\n    );\n  }\n\n  // if time-series time key, returns timeserie's scale domain.\n  getVizDomain(): [T, T] {\n    this.initializeAggregates();\n    return this.valueScale.domain();\n  }\n\n  rangeFilterTimer: number = 0;\n\n  // creates new aggregate, and uses a timer to run the filtering\n  setRangeFilter_Custom(minV, maxV) {\n    var aggr = this.createAggregate(minV, maxV);\n    aggr.validateMinMax();\n    this.setRangeFilter(aggr, true);\n  }\n\n  setRangeFilter(aggr: Aggregate_Interval<T>, useTimer = false) {\n    aggr.validateMinMax();\n\n    this.summaryFilter.active = aggr;\n\n    this.summaryFilter.noValueAggr.filtered = false;\n\n    this.block.refreshIntervalSlider();\n\n    if (this.rangeFilterTimer) window.clearTimeout(this.rangeFilterTimer);\n    this.rangeFilterTimer = window.setTimeout(\n      () => {\n        this.summaryFilter.setFiltered();\n        this.rangeFilterTimer = 0;\n      },\n      useTimer ? 250 : 0\n    );\n  }\n\n  // ********************************************************************\n  // Sort labels (when attribute is used for sorting)\n  // ********************************************************************\n\n  _sortLabel: (Record) => string = null;\n\n  get sortLabel(): (Record) => string {\n    if (this._sortLabel) {\n      return (record) => this._sortLabel.call(record.data, record);\n    }\n    return (record) => {\n      var s = this.getRecordValue(record);\n      return s == null ? \"\" : this.getFormattedValue(s, false);\n    };\n  }\n\n  set sortLabel(v) {\n    this._sortLabel = v;\n  }\n\n  // ********************************************************************\n  // Record / printing / access\n  // ********************************************************************\n\n  getRecordValue(record: Record): T {\n    return record.getValue(this);\n  }\n\n  constructor(\n    browser: Browser,\n    name: string,\n    template: any,\n    _type: BlockType,\n    blockClassName,\n    nuggetClassName\n  ) {\n    super(\n      browser,\n      name,\n      template,\n      _type,\n      \"kshfSummary_Interval \" + blockClassName, // adds \"kshfSummary_Interval\" to given class name\n      nuggetClassName\n    );\n\n    this.createSummaryFilter();\n  }\n\n  updateChartScale_Measure(skipRefreshViz = false) {\n    if (!this.block.isVisible()) return;\n    super.updateChartScale_Measure(skipRefreshViz);\n\n    this.block.refreshViz_Bins();\n    this.block.refreshViz_All(false); // no-axis\n  }\n\n  get measureRangeMax(): number {\n    return this.block.height_hist;\n  }\n\n  // if range is invalid, returns the same value in both pairs\n  sanitizeRange(minV: T, maxV: T): [T, T] {\n    var activeRanges = this.activeComparisons\n      .filter((_: CompareType) => {\n        return (\n          this.browser.Compare_Highlight !== _ &&\n          (this.browser.selectedAggrs[_] as Aggregate_Interval<T>).minV != null\n        );\n      })\n      .map((_) => this.browser.selectedAggrs[_])\n      .map((_: Aggregate_Interval<T>) => ({ minV: _.minV, maxV: _.maxV }));\n\n    var r = activeRanges.reduce(\n      (accum, curRange) => {\n        // zero size range. no-op\n        if (accum.minV === accum.maxV) return accum;\n        // current range holds the input range. bad!\n        if (curRange.minV <= accum.minV && accum.maxV <= curRange.maxV) {\n          return { minV: minV, maxV: maxV }; // same value - signals invalid range\n        }\n        // input range holds the active range. bad!\n        if (accum.minV <= curRange.minV && curRange.maxV <= accum.maxV) {\n          return { minV: minV, maxV: maxV }; // same value - signals invalid range\n        }\n        // current range does not intersect with active range. Continue as-is\n        if (curRange.minV > accum.maxV || curRange.maxV < accum.minV) {\n          return accum;\n        }\n        // current range limits the active minimum value\n        if (curRange.maxV > accum.minV && curRange.minV < accum.minV) {\n          return { minV: curRange.maxV, maxV: accum.maxV };\n        }\n        // current range limits the active maximum value\n        if (curRange.minV < accum.maxV && curRange.minV > accum.maxV) {\n          return { minV: accum.minV, maxV: curRange.minV };\n        }\n        return accum;\n      },\n      { minV: minV, maxV: maxV }\n    );\n\n    return [r.minV, r.maxV];\n  }\n\n  renderRecordValue(v, d3_selection): string {\n    if (v instanceof Record) v = this.getRecordValue(v);\n\n    if (v == null) {\n      v = \"-\";\n    } else if (this.type !== \"timestamp\") {\n      v = v.toLocaleString();\n    }\n    let str = this.getFormattedValue(v, false);\n    if (d3_selection) {\n      d3_selection.html(str);\n    } else {\n      return str;\n    }\n  }\n\n  /** -- */\n  printAbbr(v: number, isSVG = false) {\n    if (v == null) return \"-\";\n    this.initializeAggregates();\n    return this.getFormattedValue(this.intervalTickPrint(v), isSVG);\n  }\n\n  isEmpty() {\n    return !this.aggr_initialized;\n  }\n\n  async applyConfig(blockCfg: SummarySpec) {\n    super.applyConfig(blockCfg);\n\n    await this.block.showHistogram.set(blockCfg.showHistogram);\n    await this.block.optimumBinWidth.set(blockCfg.optimumBinWidth);\n    await this.block.maxHeightRatio.set(blockCfg.maxHeightRatio);\n    await this.measureScaleType.set(blockCfg.measureScaleType);\n    await this.block.zoomed.set(blockCfg.zoomed);\n\n    if (blockCfg.filter) {\n      this.summaryFilter.importFilter(blockCfg.filter as any);\n    } else if (this.isFiltered()) {\n      this.summaryFilter.clearFilter();\n    }\n  }\n}\n","import { select, pointer } from \"./d3_select\";\n\nimport { Panel } from \"./UI/Panel\";\nimport { Attrib } from \"./Attrib\";\nimport { i18n } from \"./i18n\";\nimport { CompareType, d3Selection, MeasureType } from \"./Types\";\nimport { Util } from \"./Util\";\nimport { Base } from \"./Base\";\nimport { Modal } from \"./UI/Modal\";\nimport { Record } from \"./Record\";\nimport { Aggregate } from \"./Aggregate\";\n\nconst d3 = { select, pointer };\n\nexport abstract class Block {\n  // attribute of the block\n  public readonly attrib: Attrib;\n  // browser of the block (retrieved from attribute)\n  protected get browser() {\n    return this.attrib.browser;\n  }\n\n  // shorthand\n  get _aggrs(): Aggregate[] {\n    return this.attrib._aggrs;\n  }\n\n  public DOM: {\n    inited: boolean;\n    nugget?: d3Selection;\n    summaryIcons?: d3Selection;\n    root?: d3Selection;\n    headerGroup?: d3Selection;\n    summaryConfig?: d3Selection;\n    wrapper?: d3Selection;\n    summaryNameWrapper?: d3Selection;\n    blockName?: d3Selection;\n    summaryConfigControl?: d3Selection;\n\n    [index: string]: d3Selection; // general access...\n  } = { inited: false };\n\n  // The panel this block appears in (if placed in dashboard)\n  public panel: Panel = null;\n  public orderInPanel: number;\n\n  // Can be accessed by called .collapsed\n  private _collapsed: boolean = false;\n  get collapsed(): boolean {\n    return this._collapsed;\n  }\n\n  private _height_header: number = 0; // TODO\n  // Used by panel layouting to keep track of which blocks need to be layout\n  public dueForLayout: boolean; // TODO\n\n  constructor(attrib: Attrib) {\n    this.attrib = attrib;\n  }\n\n  get inDashboard() {\n    return this.panel !== null;\n  }\n  isVisible() {\n    return (\n      !this.attrib.isEmpty() &&\n      this.inDashboard &&\n      !this.collapsed &&\n      this.DOM.inited\n    );\n  }\n\n  abstract get height_Content(): number;\n  abstract get height_RangeMin(): number;\n  abstract get height_RangeMax(): number;\n  abstract setHeight(targetHeight: number): void;\n  abstract refreshWidth(): void;\n  abstract hasStaticHeight(): boolean;\n\n  abstract initDOM(beforeDOM): boolean;\n\n  onClearFilter(forceUpdate: boolean = false) {}\n\n  getWidth(): number {\n    return this.panel ? this.panel.width_Real - 2 : 0; // 1 pixel border on left & right\n  }\n  getHeight(): number {\n    return this.height_Header + this.height_Content;\n  }\n  get height_withMargin() {\n    return this.getHeight() + 8;\n  }\n\n  get height_Header() {\n    if (!this.DOM.inited) return 0;\n    if (!this._height_header) {\n      if (this.panel.isCollapsed()) return 0;\n      this._height_header = 29; // too much work to get the height/width right with panels collapsing\n      // 1 * this.DOM.headerGroup.node().offsetHeight;\n    }\n    return this._height_header;\n  }\n\n  refreshHeight() {\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\n    this.DOM.root.style(\"flex-basis\", this.getHeight() + \"px\");\n  }\n\n  insertRoot(beforeDOM: Element | null) {\n    this.DOM.root = this.panel.DOM.root.insert(\"div\", () => {\n      return beforeDOM;\n    });\n\n    this.DOM.root\n      .attr(\"class\", \"kshfSummary \" + this.attrib.blockClassName)\n      .attr(\"summary_id\", this.attrib.attribID) // can be used to customize a specific summary using CSS\n      .classed(\"disableCompareLock\", !this.attrib.isComparable.is(true))\n      .classed(\"filtered\", this.attrib.isFiltered())\n      .datum(this);\n\n    // can be extended by sub-classes\n    this.insertHeader();\n\n    // initialize config controls\n    Object.values(this.attrib.configs).forEach((cfg) =>\n      cfg.insertControl(this.DOM.summaryConfig)\n    );\n  }\n\n  updateDescription() {\n    this.DOM.nugget\n      ?.select(\".summaryDescription\")\n      .classed(\"active\", this.attrib.description ? true : null)\n      .node()\n      .tippy.setContent(this.attrib.description);\n    this.DOM.summaryIcons\n      ?.select(\".summaryDescription\")\n      .classed(\"active\", this.attrib.description ? true : null);\n  }\n\n  addToPanel(panel: Panel, index = null, _force = false) {\n    if (!panel) return;\n\n    if (index === null) {\n      index = panel.attribs.length; // add to end\n    }\n\n    var panelChanged = false;\n    if (this.panel === null) {\n      panelChanged = true;\n    } else if (this.panel && this.panel !== panel) {\n      this.panel.removeBlock(this);\n      panelChanged = true;\n    } else {\n      // re-inserting to current panel\n      if (this.orderInPanel === index) {\n        return; // inserting the summary to the same index as current one\n      }\n      // remove the dropzone above the moved summary\n      var dropZoneDOM = this.panel.DOM.root.selectAll(\".dropZone\").nodes()[\n        this.orderInPanel\n      ];\n      dropZoneDOM.parentNode.removeChild(dropZoneDOM);\n      if (this.orderInPanel < index) index--;\n    }\n\n    panel.addBlock(this, index);\n    this.DOM.nugget?.classed(\"inDashboard\", (_) => this.inDashboard);\n\n    if (panelChanged) {\n      this.refreshWidth();\n    }\n\n    this.browser.refreshIsEmpty();\n  }\n\n  removeFromPanel() {\n    if (!this.panel) return;\n    this.panel.removeBlock(this);\n\n    if (this.DOM.root) {\n      let dom = this.DOM.root.node();\n      dom.parentNode.removeChild(dom);\n    }\n\n    this.panel = null;\n\n    this.DOM.nugget?.classed(\"inDashboard\", (_) => this.inDashboard);\n\n    this.browser.refreshIsEmpty();\n  }\n\n  insertHeader() {\n    var me = this;\n\n    var _tempMoved = false;\n    this.DOM.headerGroup = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"headerGroup\")\n      .on(\"mousedown\", function (event) {\n        if (!me.browser.authorMode) {\n          event.preventDefault();\n          return;\n        }\n        var _this = this;\n        var moved = false;\n        _tempMoved = false;\n        d3.select(\"body\")\n          .style(\"cursor\", \"move\")\n          .on(\"keydown.layout\", function () {\n            if (event.keyCode === 27) {\n              // Escape key\n              _this.style.opacity = null;\n              me.browser.clearDropZones();\n            }\n          })\n          .on(\"mousemove.layout\", function (event2) {\n            _tempMoved = true;\n            if (!moved) {\n              if (_this.nextSibling) _this.nextSibling.style.display = \"none\";\n              if (_this.previousSibling)\n                _this.previousSibling.style.display = \"none\";\n              _this.parentNode.style.opacity = 0.5;\n              me.browser.prepareDropZones(me.attrib, \"browser\");\n              moved = true;\n            }\n            var mousePos = d3.pointer(event2, me.browser.DOM.root.node());\n            me.browser.DOM.attribDragBox.style(\n              \"transform\",\n              \"translate(\" +\n                (mousePos[0] - 20) +\n                \"px,\" +\n                (mousePos[1] + 5) +\n                \"px)\"\n            );\n            event2.stopPropagation();\n            event2.preventDefault();\n          })\n          .on(\"mouseup.layout\", function (event2) {\n            d3.select(\"body\").style(\"cursor\", null);\n            // Mouse up on the body\n            me.browser.clearDropZones();\n            if (me.panel !== undefined || true) {\n              _this.parentNode.style.opacity = null;\n              if (_this.nextSibling) _this.nextSibling.style.display = \"\";\n              if (_this.previousSibling)\n                _this.previousSibling.style.display = \"\";\n            }\n            event2.preventDefault();\n          });\n        event.preventDefault();\n      })\n      .on(\"mouseup\", () => {\n        if (_tempMoved) return;\n        d3.select(\"body\").style(\"cursor\", null);\n        this.browser.clearDropZones();\n        this.browser.unregisterBodyCallbacks();\n      });\n\n    this.DOM.headerGroup\n      .append(\"span\")\n      .attr(\"class\", \"header_display_control iconGroup\")\n      .on(\"mousedown\", (event) => event.stopPropagation())\n      .selectAll(\"span\")\n      .data([\n        [\n          \"Remove\",\n          \"far fa-times-circle\",\n          () => {\n            this.removeFromPanel();\n            this.browser.updateLayout();\n          },\n        ],\n        [\n          \"Collapse\",\n          \"far fa-compress-alt\",\n          () => this.setCollapsedAndLayout(true),\n        ],\n        [\"Open\", \"far fa-expand-alt\", () => this.setCollapsedAndLayout(false)],\n      ])\n      .enter()\n      .append(\"span\")\n      .attr(\"class\", (_) => \"buttonSummary\" + _[0] + \" \" + _[1])\n      .tooltip((_) => i18n[_[0] + \"Summary\"], { placement: \"bottom\" })\n      .on(\"click\", (_event, _) => _[2]());\n\n    this.DOM.summaryNameWrapper = this.DOM.headerGroup\n      .append(\"span\")\n      .attr(\"class\", \"summaryNameWrapper\");\n\n    this.DOM.blockName = this.DOM.summaryNameWrapper\n      .append(\"span\")\n      .attr(\"class\", \"blockName summaryName\")\n      .on(\"click\", () => {\n        if (this.collapsed) {\n          this.setCollapsedAndLayout(false); //un-collapse\n        }\n      });\n\n    this.attrib.addDOMBlockName(this.DOM.blockName);\n\n    this.DOM.summaryIcons = this.DOM.headerGroup\n      .append(\"span\")\n      .attr(\"class\", \"summaryIcons iconGroup\")\n      .on(\"mousedown\", (event) => event.stopPropagation());\n\n    this.DOM.summaryConfigControl = this.DOM.summaryIcons\n      .append(\"span\")\n      .attr(\"class\", \"summaryConfigControl fal fa-cog\")\n      .tooltip(i18n.Configure, { placement: \"bottom\" })\n      .on(\"click\", () => {\n        var open = !this.DOM.root.classed(\"showConfig\");\n        this.browser.closeConfigPanels();\n        if (open) {\n          this.browser.blockWithOpenConfig = this;\n        }\n        this.DOM.root.classed(\"showConfig\", open);\n      });\n\n    this.DOM.summaryIcons\n      .append(\"span\")\n      .attr(\"class\", \"summaryDescription fa fa-info\")\n      .tooltip(\"\", {\n        placement: \"bottom\",\n        onShow: (instance) => {\n          instance.reference.tippy.setContent(this.attrib.description);\n        },\n      });\n\n    this.DOM.headerGroup\n      .append(\"div\")\n      .attr(\"class\", \"configPanel summaryConfig\")\n      .on(\"mousedown\", (event) => event.stopPropagation())\n      .call((summaryConfig) => {\n        summaryConfig\n          .append(\"div\")\n          .attr(\"class\", \"configClose fa fa-window-close\")\n          .tooltip(i18n.Close)\n          .on(\"click\", () => {\n            this.browser.closeConfigPanels();\n            this.DOM.root.classed(\"showConfig\", false);\n          });\n        summaryConfig\n          .append(\"div\")\n          .attr(\"class\", \"compactSizeControl far fa-angle-double-up\")\n          .on(\"click\", (event) =>\n            event.target.parentNode.classList.toggle(\"compact\")\n          );\n        this.DOM.summaryConfig = summaryConfig\n          .append(\"table\")\n          .attr(\"class\", \"configTable\");\n      });\n\n    this.DOM.wrapper = this.DOM.root.append(\"div\").attr(\"class\", \"wrapper\");\n\n    this.refreshSummaryName_DOM();\n\n    this.insertDOM_EmptyAggr();\n\n    this.DOM.summaryNameWrapper\n      .insert(\"div\", \":first-child\")\n      .attr(\"class\", \"summaryHeaderButton clearFilterButton fa\")\n      .tooltip(i18n.RemoveFilter, { placement: \"bottom\" })\n      .on(\"mousedown\", (event) => event.stopPropagation())\n      .on(\"click\", (event) => {\n        this.attrib.summaryFilter?.clearFilter();\n        event.stopPropagation();\n      });\n\n    this.DOM.summaryNameWrapper\n      .append(\"div\")\n      .attr(\"class\", \"summaryHeaderButton summaryLockButton far fa-clone\")\n      .tooltip(\"\", {\n        onTrigger: (instance) => {\n          instance.reference.tippy.setContent(\n            i18n[\n              this.browser.comparedAttrib === this.attrib\n                ? \"Unlock\"\n                : \"CompareTopCategories\"\n            ]\n          );\n        },\n      })\n      .on(\"mousedown\", (event) => event.stopPropagation())\n      .on(\"click\", (event) => {\n        if (this.attrib.isComparedAttrib()) {\n          this.browser.clearSelect_Compare(\n            this.browser.activeComparisons,\n            true,\n            true\n          );\n        } else {\n          this.attrib.autoCompare();\n        }\n        event.stopPropagation();\n      });\n  }\n\n  refreshSummaryName_DOM() {\n    if (this.DOM.blockName) {\n      this.attrib.addDOMBlockName(this.DOM.blockName);\n    }\n    this.DOM.nugget?.select(\".summaryName\").html(this.attrib.printName);\n  }\n\n  get hasNugget(): boolean {\n    return !!this.DOM.nugget;\n  }\n\n  refreshNugget(_dom) {\n    var me = this;\n    let attribMoved;\n    this.DOM.nugget = _dom;\n    this.DOM.nugget\n      .on(\"dblclick\", (event, d) => {\n        if (event.which !== 1) return; // only respond to left-click\n        if (this.inDashboard) {\n          this.removeFromPanel();\n        } else {\n          this.browser.autoAddAttib(d.item);\n        }\n        this.browser.updateLayout();\n      })\n      .on(\"mousedown\", function (event) {\n        if (event.which !== 1) return; // only respond to left-click\n\n        var _this = this;\n        attribMoved = false;\n        d3.select(\"body\")\n          .on(\"keydown.layout\", (event2) => {\n            if (event2.keyCode === 27) {\n              // Escape key\n              _this.removeAttribute(\"moved\");\n              me.browser.clearDropZones();\n            }\n          })\n          .on(\"mousemove.layout\", (event2) => {\n            if (!attribMoved) {\n              _this.setAttribute(\"moved\", \"\");\n              me.browser.prepareDropZones(me.attrib, \"authoringPanel\");\n              attribMoved = true;\n            }\n            var mousePos = d3.pointer(event2, me.browser.DOM.root.node());\n            me.browser.DOM.attribDragBox.style(\n              \"transform\",\n              `translate(${mousePos[0] - 20}px,${mousePos[1] + 5}px)`\n            );\n            event2.stopPropagation();\n            event2.preventDefault();\n          })\n          .on(\"mouseup.layout\", (event2) => {\n            if (!attribMoved) return;\n            _this.removeAttribute(\"moved\");\n            me.browser.DOM.root.attr(\"drag_cursor\", null);\n            me.browser.clearDropZones();\n            event2.preventDefault();\n          });\n        event.preventDefault();\n      })\n      .on(\"mouseup\", () => {\n        if (!attribMoved) this.browser.unregisterBodyCallbacks();\n      });\n  }\n\n  setCollapsedAndLayout(collapsed) {\n    this.setCollapsed(collapsed);\n    this.browser.updateLayout_Height();\n\n    if (!this.DOM.root || this.collapsed || !this.DOM.inited) return;\n    this.refreshViz_All();\n    this.refreshMeasureLabelText(\"Active\");\n  }\n\n  setCollapsed(v: boolean): void {\n    this._collapsed = v;\n    this.panel?.refreshCollapsed();\n    var _ = this.height_Header; // computes header height if needed.\n    this.DOM.root\n      ?.classed(\"collapsed\", this.collapsed)\n      .classed(\"showConfig\", false);\n    this.onCollapse();\n  }\n\n  // Can be extended by sub-classes as needed\n  onCollapse(): void {\n    return;\n  }\n\n  abstract refreshViz_Active(): void;\n  abstract refreshViz_Compare(\n    cT: CompareType,\n    curGroup,\n    totalGroups,\n    prevCts\n  ): void;\n\n  // used by subclasses as well\n  get measureLineZero() {\n    return this.attrib.chartScale_Measure(0);\n  }\n\n  refreshViz_Cache(sT: MeasureType, _preCompare = null) {\n    if (!this.DOM.inited) return;\n    if (this.attrib.type === \"setpair\") return;\n\n    var baseline = this.measureLineZero;\n    var preCompare = this.browser.stackedChart\n      ? _preCompare || this.browser.activeComparisons\n      : [];\n\n    var _chartValue = (aggr, sT) =>\n      this.attrib.chartScale_Measure(this.browser.getChartValue(aggr, sT)) -\n      baseline;\n\n    this._aggrs.forEach((aggr) => {\n      aggr.setScale(sT, _chartValue(aggr, sT));\n      aggr.setOffset(\n        sT,\n        preCompare.reduce((accum, sT) => accum + _chartValue(aggr, sT), 0)\n      );\n    });\n\n    // flip 'active' selection\n    if (sT === \"Active\" && preCompare.length > 0 && this.browser.stackedChart) {\n      this._aggrs.forEach((aggr) => {\n        aggr.setScale(sT, aggr.scale(\"Active\") - aggr.offset(sT));\n      });\n    }\n  }\n\n  /** -- */\n  refreshViz_All(withAxisRefresh = true) {\n    if (!this.isVisible()) return;\n    if (!this.attrib.chartScale_Measure) return;\n    this.refreshViz_Active();\n    this.refreshViz_Compare_All();\n    this.refreshViz_NoValueAggr();\n    if (withAxisRefresh) this.refreshViz_Axis();\n  }\n  // -- TODO: incomplete / check references, not used much\n  refreshViz(sT) {\n    if (this.attrib.type === \"content\") return;\n    return sT === \"Active\"\n      ? this.refreshViz_Active()\n      : this.refreshViz_Compare(sT, 0, 0, null);\n  }\n  /** -- */\n  refreshViz_Compare_All() {\n    if (this.attrib.type === \"content\") return;\n    var compared = this.browser.activeComparisons;\n    var totalC = this.browser.activeComparisonsCount;\n\n    compared.forEach((cT, i) =>\n      this.refreshViz_Compare(cT, i, totalC, compared.slice(0, i))\n    );\n  }\n\n  // This can be set to true to prevent refreshViz_Axis from executing\n  noRefreshVizAxis: boolean = false;\n\n  abstract chartAxis_Measure_TickSkip(): number;\n\n  /** -- */\n  refreshViz_Axis() {\n    if (!this.isVisible()) return;\n    if (this.noRefreshVizAxis) return;\n\n    var axis_Scale = this.attrib.chartScale_Measure.copy().clamp(false);\n\n    // GET TICK VALUES ***********************************************************\n    // (no more than 10 tick values)\n    var tickValues = axis_Scale.ticks(\n      Math.min(10, this.chartAxis_Measure_TickSkip())\n    );\n\n    // Remove 0-tick if all domain values are non-negative\n    // if(axis_Scale.domain()[0]>=0) tickValues = tickValues.filter(d => d!==0 );\n\n    if (this.browser.hasIntOnlyMeasure())\n      tickValues = tickValues.filter((d) => Number.isInteger(d));\n\n    var ticks = tickValues.map((p) => ({ tickValue: p, major: true }));\n\n    if (this.attrib.measureScale_Log) {\n      if (this.attrib.measureLogBase === 2) {\n        Util.insertMinorTicks(\n          tickValues,\n          this.attrib.chartScale_Measure,\n          ticks\n        );\n      } else {\n        var maxDomainValue = axis_Scale.domain()[1];\n        if (maxDomainValue > this.attrib.measureLogBase) {\n          ticks = [];\n          tickValues = [];\n          var x = 1;\n          maxDomainValue *= this.attrib.measureLogBase; // adding one more major tick beyond the domain, so minors can be added.\n          while (x < maxDomainValue) {\n            ticks.push({ tickValue: x, major: true });\n            tickValues.push(x);\n            x *= this.attrib.measureLogBase;\n          }\n        }\n        Util.insertMinorTicks(\n          tickValues,\n          this.attrib.chartScale_Measure,\n          ticks,\n          this.attrib.measureLogBase - 1\n        );\n        maxDomainValue = axis_Scale.domain()[1];\n        ticks = ticks.filter((_) => _.tickValue < maxDomainValue);\n      }\n    }\n\n    var _transform =\n      this.attrib.type === \"categorical\"\n        ? (d, _scale) => `translateX(${_scale(d.tickValue) - 0.5}px)`\n        : (d, _scale) => `translateY(${-_scale(d.tickValue)}px)`;\n\n    var finalAnim = (t) =>\n      t\n        .style(\"transform\", (d) => _transform(d, axis_Scale))\n        .style(\"opacity\", 1);\n\n    var selection = this.DOM.chartAxis_Measure_TickGroup\n      .selectAll(\"span.tick\")\n      .data(ticks, (t) => t.tickValue);\n\n    selection\n      .enter()\n      .append(\"span\")\n      .attr(\"class\", \"tick\")\n      .call((ticks) => {\n        ticks.append(\"span\").attr(\"class\", \"line\");\n        ticks.append(\"span\").attr(\"class\", \"text measureAxis_1\");\n        ticks.append(\"span\").attr(\"class\", \"text measureAxis_2\");\n\n        if (\n          this.browser.chartsLoaded &&\n          this.attrib.chartScale_Measure_prev &&\n          !this.browser.preventAxisScaleTransition\n        ) {\n          // to transition position from previous scale, set position based on previous scale first\n          ticks\n            .style(\"opacity\", 0)\n            .classed(\"noAnim\", true)\n            .style(\"transform\", (tick) =>\n              _transform(tick, this.attrib.chartScale_Measure_prev)\n            )\n            .classed(\"noAnim\", false)\n            .call((ticks) =>\n              finalAnim(ticks.transition().duration(0).delay(10))\n            );\n        } else {\n          finalAnim(ticks);\n        }\n      })\n      .merge(selection)\n      .classed(\"major\", (tick) => tick.major)\n      .classed(\"minor\", (tick) => !tick.major)\n      .call((x) =>\n        x\n          .selectAll(\".text\")\n          .html((tick) => this.browser.getValueLabel(tick.tickValue, false))\n      );\n\n    finalAnim(selection);\n\n    selection.exit().call((exit) => {\n      if (\n        this.browser.chartsLoaded &&\n        this.attrib.chartScale_Measure_prev &&\n        !this.browser.preventAxisScaleTransition\n      ) {\n        exit = exit.style(\"transform\", (tick) => _transform(tick, axis_Scale));\n      }\n      return exit\n        .style(\"opacity\", 0)\n        .transition()\n        .duration(0)\n        .delay(500)\n        .remove();\n    });\n  }\n\n  refreshViz_NoValueAggr() {\n    if(this.attrib.noValueAggr.records.length===0) return;\n    this.DOM.noValueAggr?.classed(\n      \"visible\",\n      this.attrib.noValueAggr.recCnt(\"Active\") > 0\n    );\n  }\n\n  refreshMeasureLabelPos_All() {\n    this.refreshMeasureLabelPos(\"Active\");\n    this.browser.activeComparisons.forEach((cT, i) =>\n      this.refreshMeasureLabelPos(cT, i)\n    );\n  }\n  refreshMeasureLabelPos(sT = \"Active\", curGroup = 0) {\n    // No-op, can be extended\n  }\n\n  refreshMeasureLabelText(selectType: MeasureType) {\n    if (!this.isVisible()) return;\n    var _ = this.DOM[\"measureLabel_\" + selectType];\n    if (!_) return;\n\n    var offset =\n      this.browser.stackedChart && selectType === \"Active\"\n        ? this.browser.activeComparisons\n        : [];\n\n    var func = (aggr: Aggregate) => {\n      var _val = this.browser.getMeasureValue(aggr, selectType, null, offset);\n      var isSVG = aggr.DOM?.aggrGlyph?.nodeName === \"g\";\n      return this.browser.getValueLabel(\n        _val,\n        isSVG,\n        Base.percentDecimal ? 1 : 0\n      );\n    };\n\n    _.html(func);\n\n    if (\n      this.attrib.noValueAggr.records.length > 0 &&\n      selectType === \"Active\"\n    ) {\n      offset = [];\n      this.DOM.noValueAggr?.select(\".measureLabel_Active\").html(func);\n    }\n  }\n\n  insertDOM_EmptyAggr() {\n    this.DOM.noValueAggr = this.DOM.wrapper\n      .append(\"span\")\n      .attr(\"class\", \"noValueAggr aggrGlyph\")\n      .classed(\"filtered\", this.attrib.noValueAggr.filtered)\n      .datum(this.attrib.noValueAggr)\n      .tooltip((_) => this.attrib.noValueAggr.getTooltipHTML(), {\n        theme: \"dark kshf-tooltip kshf-record\",\n      })\n      .each((_, i, nodes) => {\n        this.attrib.noValueAggr.setAggrGlyph(nodes[i]);\n      })\n      .on(\"mouseover\", () => {\n        if (this.browser.adjustMode) return;\n        if (this.browser.mouseOverCompare.is(false)) return;\n        this.browser.setSelect_Compare(this.attrib.noValueAggr);\n      })\n      .on(\"mouseout\", () => {\n        this.browser.clearSelect_Compare();\n      })\n      .on(\"click\", (event) => {\n        if (event.shiftKey) {\n          this.browser.lockSelect_Compare();\n          return;\n        }\n\n        var noValAggr = this.attrib.noValueAggr;\n\n        var menuConfig = { name: \"Filter\", items: [] };\n\n        if (noValAggr.filtered) {\n          menuConfig.items.push({\n            id: \"filterOption_Remove\",\n            name: `<span class='filterContextOpt'>${i18n.Clear}</span>`,\n            do: () => {\n              noValAggr.filtered = false;\n              this.attrib.summaryFilter.how = \"All\";\n              this.attrib.summaryFilter.clearFilter();\n            },\n          });\n        }\n\n        if (noValAggr.filtered !== \"in\") {\n          menuConfig.items.push({\n            id: \"filterOption_Only\",\n            iconXML: \"\",\n            name: i18n.KeepNoData,\n            helparticle: \"5e88e95e04286364bc97d43f\",\n            do: () => {\n              this.attrib.summaryFilter.clearFilter();\n              noValAggr.filtered = \"in\";\n              this.attrib.summaryFilter.how = \"All\";\n              this.attrib.summaryFilter.setFiltered();\n            },\n          });\n        }\n        if (noValAggr.filtered !== \"out\") {\n          menuConfig.items.push({\n            id: \"filterOption_Not\",\n            iconXML: \"\",\n            name: i18n.KeepValidData,\n            helparticle: \"5e88e95e04286364bc97d43f\",\n            do: () => {\n              noValAggr.filtered = \"out\";\n              this.attrib.summaryFilter.setFiltered();\n            },\n          });\n        }\n        Modal.popupMenu(event, menuConfig, noValAggr);\n      });\n\n    this.DOM.noValueAggr.append(\"div\").attr(\"class\", \"noValueIcon\").text(\"\");\n    this.DOM.noValueAggr\n      .append(\"div\")\n      .attr(\"class\", \"measureLabel measureLabel_Active\");\n\n    this.refreshViz_NoValueAggr();\n  }\n\n  abstract updateAfterFilter(refreshViz: boolean): void;\n  refreshUIFiltered(v) {\n    this.DOM.root\n      ?.classed(\"filtered\", v)\n      .classed(\n        \"filtered_missing\",\n        v ? this.attrib.noValueAggr.filtered !== false : false\n      );\n  }\n\n  // -- Shared - Summary Base --\n  insertChartAxis_Measure(dom) {\n    this.DOM.chartAxis_Measure = dom\n      .append(\"div\")\n      .attr(\"class\", \"chartAxis_Measure\");\n\n    this.DOM.chartAxis_Measure.append(\"div\").attr(\"class\", \"measureDescrLabel\");\n    this.refreshMeasureDescrLabel();\n\n    this.DOM.chartAxis_Measure_TickGroup = this.DOM.chartAxis_Measure\n      .append(\"div\")\n      .attr(\"class\", \"tickGroup\");\n  }\n  refreshMeasureDescrLabel() {\n    this.DOM.root\n      ?.selectAll(\".measureDescrLabel\")\n      .html(i18n.MeasureDescrLabel(this.browser, this.attrib));\n  }\n\n  // Utility method for subclasses\n  insertAggrLockButton(dom, placement) {\n    var onClick = (aggr: Aggregate) => {\n      if (aggr.compared && aggr.locked) {\n        this.browser.clearSelect_Compare(aggr.compared, true, true);\n      } else {\n        if (\n          this.browser.setSelect_Compare(\n            aggr,\n            null,\n            false // no finalize analytics\n          )\n        ) {\n          this.browser.lockSelect_Compare();\n        }\n      }\n    };\n\n    dom\n      .append(\"span\")\n      .attr(\"class\", \"lockButton far fa-clone\")\n      .tooltip((_: Aggregate) => i18n[_.locked ? \"Unlock\" : \"LockToCompare\"], {\n        placement: placement,\n      })\n      .on(\"click\", (event, aggr) => {\n        if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib()) {\n          Modal.confirm(\n            i18n.DialogChangeCompare(\n              this.attrib.attribNameHTML,\n              this.browser.comparedAttrib.attribNameHTML\n            ),\n            i18n.Confirm\n          ).then(\n            () => {\n              this.browser.clearSelect_Compare(\n                this.browser.activeComparisons,\n                false,\n                true\n              ); // don't finalize yet\n              onClick(aggr);\n            },\n            () => {}\n          );\n        } else if (!this.browser.Compare_Highlight && !aggr.locked) {\n          Modal.alert(i18n.ComparedSelectionsLimit);\n        } else {\n          onClick(aggr);\n        }\n        event.preventDefault();\n        event.stopPropagation();\n      });\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  showRecordValue(record: Record): void {}\n  hideRecordValue(): void {}\n}\n","import { select, pointer } from \"./d3_select\";\nimport { min, max, extent } from \"d3-array\";\n\nimport { Block } from \"./Block\";\nimport { Base } from \"./Base\";\nimport { i18n } from \"./i18n\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { Config } from \"./Config\";\nimport { Record } from \"./Record\";\n\nimport { CompareType, IntervalT, MeasureType } from \"./Types\";\n\nconst d3 = {\n  select,\n  pointer,\n  min,\n  max,\n  extent,\n};\n\nexport type ZoomableStatus = \"plus\" | \"minus\" | \"\";\n\nexport abstract class Block_Interval<T extends IntervalT> extends Block {\n  // specific attribute type\n  public readonly attrib: Attrib_Interval<T>;\n\n  readonly zoomed: Config<boolean>;\n  readonly optimumBinWidth: Config<number>;\n  readonly maxHeightRatio: Config<number>;\n  readonly showHistogram: Config<boolean>;\n\n  abstract dragRange(initPos, curPos, initMin, initMax): void;\n  abstract showValuePicker(DOM, d: \"min\" | \"max\"): void;\n\n  // shorthand\n  get valueScale() {\n    return this.attrib.valueScale;\n  }\n\n  constructor(attrib: Attrib_Interval<T>) {\n    super(attrib);\n\n    this.zoomed = new Config<boolean>({\n      parent: this,\n      cfgClass: \"zoomed\",\n      cfgTitle: \"ValueAxisZoom\",\n      default: false,\n      UI: { disabled: true },\n      iconClass: \"far fa-search\",\n      helparticle: \"5e87ea002c7d3a7e9aea606c\",\n      itemOptions: [\n        { name: \"Zoomed\", value: true },\n        { name: \"Full\", value: false },\n      ],\n      forcedValue: () => {\n        if (!this.attrib.isFiltered()) return false;\n      },\n      onSet: async (v) => {\n        if (!this.attrib.aggr_initialized) return;\n\n        this.attrib.refreshValueScale();\n\n        if (this.DOM.inited) {\n          this.DOM.summaryInterval.classed(\"zoomed\", v);\n          this.DOM.zoomControl.attr(\"sign\", v ? \"minus\" : \"plus\");\n        }\n\n        this.noRefreshVizAxis = true;\n        var tempScale_prev = this.attrib.chartScale_Measure.copy().clamp(false);\n\n        if (this.attrib.type !== \"timestamp\") this.attrib.refreshScaleType(); // linear vs log\n        this.attrib.updateScaleAndBins();\n        this.refreshHeight();\n\n        this.noRefreshVizAxis = false;\n        this.attrib.chartScale_Measure_prev = tempScale_prev;\n        this.refreshViz_Axis();\n\n        await this.browser.recordDisplay?.refreshAttribScaleType(this);\n\n        this.attrib.updateScaleAndBins();\n      },\n    });\n\n    // ******************************************************\n    // Interval Bin width\n    this.optimumBinWidth = new Config<number>({\n      parent: this,\n      cfgClass: \"optimumBinWidth\",\n      cfgTitle: \"BinWidth\",\n      UISeperator: {\n        title: \"Binning\",\n      },\n      default: Base.width_HistBinDefault,\n      iconClass: \"fa fa-arrows-h\",\n      helparticle: \"5e87e8952c7d3a7e9aea6065\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { name: \"1x\", value: 45, max: 90 },\n        { name: \"2x\", value: 90, max: 135 },\n        { name: \"3x\", value: 135, max: 180 },\n        { name: \"4x\", value: 180, max: 100000 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      isActive: (d) =>\n        d.value <= this.optimumBinWidth.get() && d.max > this.optimumBinWidth.get(),\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 5;\n        } else if (v === -199) {\n          v = obj._value + 5;\n        }\n        return Math.max(45, Math.min(180, v));\n      },\n      onSet: () => this.attrib.updateScaleAndBins(),\n    });\n\n    // ******************************************************\n    // Interval Bin height (linear / log)\n    this.maxHeightRatio = new Config<number>({\n      parent: this,\n      cfgClass: \"maxHeightRatio\",\n      cfgTitle: \"BinHeight\",\n      default: Base.height_MaxRatioDefault,\n      UISeperator: {\n        title: \"Size\",\n      },\n      iconClass: \"fa fa-arrows-v\",\n      helparticle: \"5e87e7502c7d3a7e9aea6060\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { name: \"1x\", value: 0.15, max: 0.3 },\n        { name: \"2x\", value: 0.3, max: 0.6 },\n        { name: \"4x\", value: 0.6, max: 1.2 },\n        { name: \"8x\", value: 1.2, max: 1.5 },\n        { name: \"10x\", value: 1.5, max: 2.0 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      isActive: (d) => {\n        var v = this.maxHeightRatio.get();\n        if (this.attrib.type === \"timestamp\") v *= 3;\n        return d.value <= v && d.max > v;\n      },\n      // if timestamp, the returned value is divided by 3.\n      onRead: (v: number) => (this.attrib.type === \"timestamp\" ? v / 3 : v),\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 0.05;\n        } else if (v === -199) {\n          v = obj._value + 0.05;\n        }\n        return Math.max(0.08, Math.min(1.5, v));\n      },\n      onSet: () => {\n        if(!this.attrib.aggr_initialized) return;\n        this.browser.updateLayout_Height();\n      }\n    });\n\n    this.showHistogram = new Config<boolean>({\n      parent: this,\n      cfgClass: \"showHistogram\",\n      cfgTitle: \"Histogram\",\n      iconClass: \"fa fa-chart-bar\",\n      UISeperator: {\n        title: \"Charts\",\n      },\n      default: true,\n      itemOptions: [\n        { name: \"Show\", value: true },\n        { name: \"Hide\", value: false },\n      ],\n      onSet: (v) => {\n        if (!attrib.aggr_initialized) return; // not initialized yet\n        if (!v) this.height_hist = 0;\n        this.refreshChartsVisibleOption();\n        this.browser.updateLayout_Height();\n      },\n    });\n\n    this.attrib.configs.zoomed = this.zoomed;\n    this.attrib.configs.optimumBinWidth = this.optimumBinWidth;\n    this.attrib.configs.maxHeightRatio = this.maxHeightRatio;\n    this.attrib.configs.showHistogram = this.showHistogram;\n  }\n\n  get _aggrs(): Aggregate_Interval<T>[] {\n    return this.attrib._aggrs;\n  }\n\n  abstract zoomableStatus(): ZoomableStatus;\n\n  abstract getScaleNicing(): number;\n\n  // pixel width settings...\n  public height_hist = 1; // Initial height (will be updated later...)\n  public height_Ticklabels = 13; // can be double line\n  private width_measureAxisLabel = 35; // ..\n\n  protected highlightRangeLimits_Active = false;\n\n  // width for one aggregate - fixed width\n  public aggrWidth: number = 0;\n\n  refreshIntervalSlider(t: MeasureType[] = undefined) {\n    if (!this.DOM.intervalSlider) return;\n\n    (t || Base.Active_Compare_List).forEach((cT: CompareType | \"Active\") => {\n      var minPos: IntervalT, maxPos: IntervalT, visible;\n      switch (cT) {\n        case \"Active\":\n          // based on filtered range\n          visible = this.attrib.isFiltered();\n          minPos =\n            this.attrib.summaryFilter.active?.minV ?? this.attrib.rangeOrg[0];\n          maxPos =\n            this.attrib.summaryFilter.active?.maxV ?? this.attrib.rangeOrg[1];\n          break;\n        default:\n          visible =\n            this.browser.vizActive(cT) && this.attrib.isComparedAttrib();\n          var aggr = this.browser.selectedAggrs[cT] as Aggregate_Interval<T>;\n          if (visible) {\n            minPos = aggr.minV;\n            maxPos = aggr.maxV;\n          }\n          break;\n      }\n\n      minPos = Math.max(this.valueScale.range()[0], this.valueScale(minPos));\n      maxPos = Math.min(this.valueScale.range()[1], this.valueScale(maxPos));\n\n      this.DOM.intervalSlider\n        .select(\".base_\" + cT)\n        .classed(\"visible\", visible)\n        .style(\"left\", minPos + \"px\")\n        .style(\"width\", maxPos - minPos + \"px\");\n      if (cT === \"Active\") {\n        this.DOM.rangeHandle.style(\n          \"transform\",\n          (d) => `translateX(${d === \"min\" ? minPos : maxPos}px)`\n        );\n      }\n    });\n  }\n\n  // ********************************************************************\n  // Height & width\n  // ********************************************************************\n\n  get height_hist_max() {\n    return Math.max(\n      Base.height_HistMin,\n      this.width_histogram * this.maxHeightRatio.get()\n    ); // Maximim possible histogram height\n  }\n\n  get height_RangeMax() {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    return (\n      this.height_Header +\n      this.height_Extra_max +\n      (this.showHistogram.get() ? this.height_hist_max : 0)\n    );\n  }\n\n  get height_RangeMin() {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    return 0 + this.height_Header + this.height_Extra_max;\n  }\n\n  get height_slider() {\n    return 12;\n  }\n  get height_padding() {\n    return 7;\n  }\n\n  get height_Extra_base() {\n    return this.height_padding + this.height_slider + this.height_Ticklabels;\n  }\n\n  get height_Extra() {\n    return (\n      this.height_Extra_base +\n      (this.showHistogram.get() ? Base.height_HistBottomGap : 0) +\n      4\n    ); // 4 is some gap\n  }\n\n  get height_Extra_max() {\n    return this.height_Extra_base + Base.height_HistBottomGap;\n  }\n\n  get height_Content() {\n    return !this.isVisible()\n      ? 0\n      : (this.showHistogram.get() ? this.height_hist : 0) + this.height_Extra;\n  }\n\n  chartAxis_Measure_TickSkip(): number {\n    return this.height_hist / 30;\n  }\n\n  setHeight(targetHeight) {\n    if (!this._aggrs) return;\n    var c = Math.min(\n      this.height_hist_max,\n      targetHeight - this.height_Header - this.height_Extra\n    );\n    if (this.height_hist === c) return;\n    this.height_hist = c;\n    this.attrib.updateChartScale_Measure(true);\n  }\n\n  refreshHeight() {\n    super.refreshHeight();\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\n\n    var _h = this.showHistogram.get() ? this.height_hist + 23 : 10;\n\n    this.DOM.valueTickGroup.style(\"height\", this.height_Ticklabels + \"px\");\n    this.DOM.rangeHandle\n      .style(\"height\", _h + \"px\")\n      .style(\"top\", -_h + 10 + \"px\");\n    this.DOM.highlightRangeLimits.style(\"height\", this.height_hist + \"px\");\n    this.DOM.histogram.style(\"height\", this.height_hist + \"px\");\n\n    this.DOM.root\n      .select(\".chartAxis_Measure > .measureDescrLabel\")\n      .style(\"width\", this.height_hist + \"px\")\n      .style(\"left\", -this.height_hist / 2 + \"px\");\n\n    this.refreshViz_Bins();\n    this.updateValueTicks();\n\n    this.refreshViz_All();\n  }\n\n  get width_marginLeft() {\n    return this.width_measureAxisLabel + Base.width_measureDescrLabel;\n  }\n\n  get width_marginRight() {\n    return this.width_measureAxisLabel * (this.isWideChart() ? 1 : 0.5) + 8;\n  }\n\n  get width_histogram() {\n    if (!this.inDashboard) return 30;\n    return Math.max(\n      2,\n      this.getWidth() - this.width_marginLeft - this.width_marginRight\n    );\n  }\n\n  get width_Bin() {\n    return this.aggrWidth - Base.width_HistBarGap * 2;\n  }\n\n  isWideChart() {\n    return this.getWidth() > 500;\n  }\n\n  refreshWidth() {\n    this.attrib.updateScaleAndBins(true); // forces render update\n\n    if (this.DOM.inited === false) return;\n\n    this.DOM.wrapper.classed(\"showMeasureAxis_2\", this.isWideChart());\n    this.DOM.summaryInterval\n      .style(\"padding-left\", this.width_marginLeft + \"px\")\n      .style(\"padding-right\", this.width_marginRight + \"px\");\n\n    this.DOM.blockName.style(\n      \"max-width\",\n      this.collapsed ? null : this.getWidth() - 40 + \"px\"\n    );\n  }\n\n  // ********************************************************************\n  // Visualization\n  // ********************************************************************\n\n  insertVizDOM() {\n    this.refreshViz_Bins();\n    this.refreshViz_Axis();\n    this.refreshMeasureLabelText(\"Active\");\n    this.updateValueTicks();\n  }\n\n  refreshViz_Bins() {\n    if (!this.DOM.inited) return;\n    var me = this;\n\n    var baseline = this.measureLineZero;\n\n    var _width = (aggr: Aggregate_Interval<T>) =>\n      this.valueScale(aggr.maxV) -\n      this.valueScale(aggr.minV) -\n      Base.width_HistBarGap * 2;\n    var _transform = (aggr) =>\n      `translateX(${this.valueScale(aggr.minV) + Base.width_HistBarGap}px)`;\n\n    var updateVizBinWidth = (selection) => {\n      Base.Total_Active_Compare_List.forEach((t) => {\n        selection\n          .selectAll(\".measure_\" + t)\n          .style(\n            \"transform\",\n            (aggr) =>\n              `translateY(${this.height_hist - baseline}px) scale(${_width(\n                aggr\n              )},0)`\n          );\n      });\n    };\n\n    this.DOM.aggrGlyphs = this.DOM.histogram_bins\n      .selectAll(\".aggrGlyph\")\n      .data(this._aggrs, (aggr) => [aggr.maxV, aggr.minV])\n      .join(\n        (enter) =>\n          enter\n            .append(\"span\")\n            .attr(\"class\", \"aggrGlyph rangeGlyph\")\n            .tooltip((aggr: Aggregate_Interval<T>) => aggr.getTooltipHTML(), {\n              theme: \"dark kshf-tooltip kshf-record\",\n              placement: \"bottom\",\n              animation: \"fade\",\n              trigger: \"manual\",\n            })\n            .on(\"mouseenter\", function (_event, aggr) {\n              if (aggr.Active.recCnt === 0) return;\n              if (me.highlightRangeLimits_Active) return;\n\n              this.highlightTimeout = window.setTimeout(() => {\n                me.onAggrHighlight(aggr);\n                this.tippy.show();\n              }, me.browser.movingMouseDelay);\n            })\n            .on(\"mouseleave\", function (_event, aggr) {\n              this.tippy.hide();\n              if (aggr.Active.recCnt === 0) return;\n              if (me.highlightRangeLimits_Active) return;\n              if (this.highlightTimeout)\n                window.clearTimeout(this.highlightTimeout);\n              me.onAggrLeave(aggr);\n            })\n            .on(\"click\", (event, aggr) => this.onAggrClick(event, aggr))\n            .call((aggrGlyph) => {\n              aggrGlyph\n                .transition()\n                .duration(0)\n                .delay(10)\n                .style(\"opacity\", null)\n                .style(\"pointer-events\", null);\n\n              var measureGroup = aggrGlyph\n                .append(\"div\")\n                .attr(\"class\", \"measureGroup\");\n\n              Base.Total_Active_Compare_List.forEach((t) => {\n                this.DOM[\"measure_\" + t] = measureGroup\n                  .append(\"span\")\n                  .attr(\"class\", `measure_${t} bg_${t}`)\n                  .on(\"mouseenter\", (_event, aggr) => {\n                    aggr.DOM.aggrGlyph\n                      .querySelector(\".measureLabel_\" + t)\n                      .classList.add(\"forceShow\");\n                    if (Base.Compare_List.find((_) => _ === t)) {\n                      this.browser.refreshAllMeasureLabels(t);\n                    }\n                  })\n                  .on(\"mouseleave\", (_event, aggr) => {\n                    var labelDOM = aggr.DOM.aggrGlyph.querySelector(\n                      \".measureLabel_\" + t\n                    );\n                    if (labelDOM) labelDOM.classList.remove(\"forceShow\");\n                    if (Base.Compare_List.find((_) => _ === t)) {\n                      this.browser.refreshAllMeasureLabels(\"Active\");\n                    }\n                  });\n              });\n\n              updateVizBinWidth(aggrGlyph);\n\n              this.insertAggrLockButton(aggrGlyph, \"top\");\n\n              aggrGlyph\n                .append(\"span\")\n                .attr(\"class\", \"measureLabelGroup\")\n                .call((measureLabelGroup) => {\n                  Base.Active_Compare_List.forEach((t) => {\n                    measureLabelGroup\n                      .append(\"span\")\n                      .attr(\"class\", \"measureLabel measureLabel_\" + t);\n                  });\n                });\n            }),\n        (update) =>\n          update\n            .style(\n              \"width\",\n              (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\"\n            )\n            .style(\"transform\", _transform)\n            .call((update) => updateVizBinWidth(update)),\n        (exit) => {\n          if (this.noRefreshVizAxis && this.browser.finalized) {\n            exit\n              .style(\n                \"width\",\n                (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\"\n              )\n              .style(\"transform\", _transform)\n              .style(\"opacity\", 0)\n              .style(\"pointer-events\", \"none\")\n              .transition()\n              .duration(0)\n              .delay(700)\n              .remove();\n\n            updateVizBinWidth(exit);\n          } else {\n            exit.remove();\n          }\n          return exit;\n        }\n      )\n      .call((merged) => {\n        merged\n          .style(\"width\", (aggr: Aggregate_Interval<T>) => _width(aggr) + \"px\")\n          .style(\"transform\", _transform);\n\n        merged.each(function (aggr: Aggregate_Interval<T>) {\n          aggr.isVisible = true;\n          aggr.setAggrGlyph(this);\n        });\n\n        Base.Total_Active_Compare_List.forEach((t) => {\n          this.DOM[\"measure_\" + t] = merged.selectAll(\".measure_\" + t);\n        });\n        this.DOM.lockButton = merged.selectAll(\".lockButton\");\n        this.DOM.measureLabelGroup = merged.selectAll(\".measureLabelGroup\");\n        Base.Active_Compare_List.forEach((t) => {\n          this.DOM[\"measureLabel_\" + t] = merged.selectAll(\n            \".measureLabel_\" + t\n          );\n        });\n      });\n  }\n\n  refreshViz_Active(): void {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\n\n    var baseline = this.measureLineZero;\n\n    this.DOM.aggrGlyphs.classed(\n      \"NoActiveRecords\",\n      (aggr) => aggr.measure(\"Active\") === 0\n    );\n\n    this.refreshViz_Cache(\"Active\");\n\n    // Position the lock button\n    this.DOM.lockButton\n      .style(\n        \"transform\",\n        (aggr: Aggregate_Interval<T>) =>\n          `translateY(${\n            this.height_hist - baseline - aggr.sumOffsetScale(\"Active\") - 10\n          }px)`\n      )\n      .classed(\n        \"inside\",\n        (aggr: Aggregate_Interval<T>) =>\n          this.browser.relativeBreakdown ||\n          Math.abs(\n            this.height_hist - aggr.offset(\"Active\") - aggr.scale(\"Active\")\n          ) < 6\n      );\n\n    var maybePartial =\n      this.attrib.isFiltered() &&\n      !this.attrib.stepTicks &&\n      this.attrib.summaryFilter.active &&\n      this.attrib.type !== \"timestamp\";\n\n    // Used for partial rendering\n    let filter_min: T, filter_max: T, minPos: number, maxPos: number;\n    if (maybePartial) {\n      filter_min = this.attrib.summaryFilter.active.minV;\n      filter_max = this.attrib.summaryFilter.active.maxV;\n      minPos = this.valueScale(filter_min);\n      maxPos = this.valueScale(filter_max);\n    }\n\n    this.DOM.measure_Active.style(\"transform\", (aggr) => {\n      var translateX = 0;\n      var _w: number = this.width_Bin;\n\n      if (maybePartial) {\n        var aggr_min = aggr.minV;\n        var aggr_max = aggr.maxV;\n        // it is within the filtered range\n        if (aggr_max > filter_min && aggr_min < filter_max) {\n          if (aggr_min < filter_min) {\n            var lostWidth = minPos - this.valueScale(aggr_min);\n            translateX = lostWidth;\n            _w -= lostWidth;\n          }\n          if (aggr_max > filter_max) {\n            _w -=\n              this.valueScale(aggr_max) - maxPos - Base.width_HistBarGap * 2;\n          }\n        } else {\n          aggr.setScale(\"Active\", 0);\n        }\n      }\n\n      return `translate(${translateX}px, ${\n        this.height_hist - baseline - aggr.offset(\"Active\")\n      }px) scale(${_w},${aggr.scale(\"Active\")})`;\n    });\n\n    // doing position update after rendering the bar,\n    // bc the active scale can be set to zero if the bar is outside filtering.\n    this.refreshMeasureLabelText(\"Active\");\n    this.refreshMeasureLabelPos(\"Active\");\n  }\n\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\n\n    this.refreshViz_Cache(cT, prevCts);\n\n    this.refreshMeasureLabelText(cT);\n    this.refreshMeasureLabelPos(cT, curGroup);\n  }\n\n  refreshMeasureLabelPos(sT: MeasureType = \"Active\", curGroup = 0) {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs || !this.valueScale) return;\n    if (sT === \"Other\") return;\n\n    if (this.browser.stackedChart) {\n      this.DOM[\"measureLabel_\" + sT]\n        .classed(\n          \"hidden\",\n          (aggr: Aggregate_Interval<T>) =>\n            aggr.scale(sT) < 16 || this.browser.getMeasureValue(aggr, sT) == 0\n        )\n        .style(\"width\", \"100%\")\n        .style(\"transform\", (aggr: Aggregate_Interval<T>, i, nodes) => {\n          nodes[i].setAttribute(\"labelAlign\", \"middle\");\n          return `translate(0px, ${-aggr[sT].offset - aggr[sT].scale / 2}px)`;\n        });\n    } else {\n      if (\n        this.attrib.type === \"timestamp\" &&\n        (sT !== \"Active\" || this.browser.activeComparisonsCount > 0)\n      ) {\n        // Line chart\n\n        // _spacer is needed to detect intersecting labels and prevent overlaps\n        // cannot use LabelSpacer because this needs to maintain which selections are visible, etc.\n        this._aggrs.forEach((_: Aggregate_Interval<T>) => {\n          _._spacer = _._spacer || {};\n        });\n\n        var visibleStuff = [\"Active\"]\n          .concat(this.browser.activeComparisons)\n          .filter((_) => _ !== sT);\n\n        this.DOM[\"measureLabel_\" + sT].style(\n          \"transform\",\n          (aggr: Aggregate_Interval<T>, i, nodes) => {\n            var v = aggr.offset(sT) + aggr.scale(sT);\n            if (sT === \"Active\") {\n              v += 20; // 20 pixel up\n            }\n            // 5px: just extra offset to avoid intersecting with line\n            v = 5 - Math.min(v, this.height_hist);\n\n            aggr._spacer[sT] = { min: v - 5, max: v + 20 };\n            var intersects = visibleStuff.some((s) => {\n              var l = aggr._spacer[s];\n              return l ? l.min <= v && l.max >= v : false;\n            });\n\n            // the visibility (hidden class) of label depends on all other labels on the same aggregate\n            nodes[i].classList[intersects ? \"add\" : \"remove\"](\"hidden\");\n\n            return `translate(0px, ${v}px)`;\n          }\n        );\n      } else {\n        var totalGroups = this.browser.activeComparisonsCount;\n        var width = 100;\n        var tX = 0;\n        var hidden = false;\n        if (\n          (sT !== \"Active\" && sT !== \"Total\") &&\n          totalGroups > 1 &&\n          this.browser.vizActive(sT)\n        ) {\n          var realWidth = this.width_Bin / totalGroups;\n          tX = realWidth * curGroup;\n          width = 100 / totalGroups;\n          hidden = realWidth < this.panel.width_CatMeasureLabel;\n        }\n        this.DOM[\"measureLabel_\" + sT]\n          .classed(\"hidden\", this.attrib.type !== \"timestamp\" && hidden)\n          .style(\"transform\", `translate(${tX}px, 2px)`)\n          .style(\"width\", `${width}%`);\n      }\n    }\n  }\n\n  // ********************************************************************\n  // Show record value\n  // ********************************************************************\n\n  updateAfterFilter(): void {\n    if (!this.isVisible()) return;\n    this.attrib.updateChartScale_Measure();\n    this.refreshMeasureLabelText(\"Active\");\n    this.refreshViz_NoValueAggr();\n  }\n\n  showRecordValue(record: Record): void {\n    if (!this.inDashboard || !this.DOM.inited || !this.valueScale) return;\n    var v: T = this.attrib.getRecordValue(record);\n    if (v == null) return;\n    if (v < this.valueScale.domain()[0]) return;\n    if (v > this.valueScale.domain()[1]) return;\n\n    this.DOM.recordValue\n      .style(\"transform\", \"translateX(\" + this.attrib.getValuePosX(v) + \"px)\")\n      .style(\"display\", \"block\");\n    this.DOM.recordValueText.html(this.attrib.getFormattedValue(v, false));\n  }\n\n  hideRecordValue() {\n    if (!this.DOM.inited || !this.DOM.recordValue) return;\n    this.DOM.recordValue.style(\"display\", null);\n  }\n\n  // ********************************************************************\n  // DOM initializations\n  // ********************************************************************\n\n  _initPos: T = null;\n\n  initDOM(beforeDOM): boolean {\n    this.attrib.initializeAggregates();\n    if (this.attrib.isEmpty()) return false;\n    if (this.DOM.inited) return true;\n\n    this.insertRoot(beforeDOM);\n\n    this.DOM.summaryInterval = this.DOM.wrapper\n      .append(\"div\")\n      .attr(\"class\", \"summaryInterval\")\n      .on(\"mousedown\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      });\n\n    var _flexClear = (event) => {\n      this._initPos = undefined;\n      this.highlightRangeLimits_Active = false;\n      event.preventDefault();\n      event.stopPropagation();\n    };\n\n    this.DOM.histogram = this.DOM.summaryInterval\n      .append(\"div\")\n      .attr(\"class\", \"histogram\");\n    this.DOM.histogram_bins = this.DOM.histogram\n      .append(\"div\")\n      .attr(\"class\", \"aggrGroup\")\n      .on(\"mousemove\", (event) => {\n        if (!event.shiftKey) {\n          if (this.highlightRangeLimits_Active) {\n            this.browser.clearSelect_Compare();\n            _flexClear(event);\n          }\n          return;\n        }\n\n        // dynamically select... range by mouse-move\n        var pointerPosition = this.valueScale.invert(d3.pointer(event)[0]);\n        if (this._initPos == null) {\n          this._initPos = pointerPosition as T;\n        }\n\n        var [minV, maxV] = d3.extent([this._initPos, pointerPosition]);\n\n        [minV, maxV] = this.attrib.sanitizeRange(minV, maxV);\n        if (minV === maxV) return; // no selection!\n        this.highlightRangeLimits_Active = true;\n\n        if (this.browser.vizActive(this.browser.Compare_Highlight)) {\n          this.browser.clearSelect_Compare(\n            this.browser.Compare_Highlight,\n            false\n          );\n        }\n\n        var aggr = this.attrib.createAggregate(minV, maxV);\n        aggr.updateRecords();\n\n        this.browser.allRecordsAggr.clearCompare(\n          this.browser.Compare_Highlight\n        );\n        this.browser.setSelect_Compare(aggr);\n        event.preventDefault();\n        event.stopPropagation();\n      })\n      .on(\"click\", (event) => {\n        if (event.shiftKey && this.highlightRangeLimits_Active) {\n          this.browser.lockSelect_Compare();\n          _flexClear(event);\n        }\n      });\n\n    this.DOM.highlightRangeLimits = this.DOM.histogram_bins\n      .selectAll(\".highlightRangeLimits\")\n      .data([0, 1])\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", \"highlightRangeLimits\");\n\n    this.insertChartAxis_Measure(this.DOM.histogram);\n\n    this.initDOM_Slider();\n\n    this.insertVizDOM();\n\n    this.setCollapsed(this.collapsed);\n\n    this.DOM.inited = true;\n\n    this.refreshChartsVisibleOption();\n\n    return true;\n  }\n\n  initDOM_Slider() {\n    var me = this;\n\n    this.DOM.intervalSlider = this.DOM.summaryInterval\n      .append(\"div\")\n      .attr(\"class\", \"intervalSlider\");\n\n    this.DOM.zoomControl = this.DOM.intervalSlider\n      .append(\"span\")\n      .attr(\"class\", \"zoomControl far\")\n      .tooltip(\"\", {\n        onTrigger: (instance) => {\n          var zoomIn = instance.reference.getAttribute(\"sign\") === \"plus\";\n          instance.reference.tippy.setContent(\n            zoomIn ? \"Zoom into filtered range\" : \"Zoom out\"\n          );\n        },\n      })\n      .attr(\"sign\", this.zoomed.is(true) ? \"minus\" : \"plus\")\n      .on(\"click\", async (event) => {\n        await this.zoomed.set(event.currentTarget.getAttribute(\"sign\") === \"plus\");\n      });\n\n    var controlLine = this.DOM.intervalSlider\n      .append(\"div\")\n      .attr(\"class\", \"controlLine\")\n      .on(\"mousedown\", function (event) {\n        if (event.which !== 1) return; // only respond to left-click\n        me.browser.DOM.root\n          .classed(\"adjustingWidth\", true)\n          .classed(\"noPointerEvents\", true);\n        var e = this.parentNode;\n        var initPos: T = me.valueScale.invert(d3.pointer(event, e)[0]);\n        d3.select(\"body\")\n          .on(\"mousemove\", function (event2) {\n            var targetPos: T = me.valueScale.invert(d3.pointer(event2, e)[0]);\n            me.browser.preventAxisScaleTransition = true;\n            me.attrib.setRangeFilter_Custom(\n              d3.min([initPos, targetPos]),\n              d3.max([initPos, targetPos])\n            );\n          })\n          .on(\"mouseup\", function () {\n            me.browser.preventAxisScaleTransition = false;\n            me.browser.DOM.root\n              .classed(\"adjustingWidth\", false)\n              .classed(\"noPointerEvents\", false);\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n        event.preventDefault();\n      });\n\n    this.DOM.activeTotalRange = controlLine\n      .append(\"span\")\n      .attr(\"class\", \"base base_Total\");\n\n    controlLine\n      .append(\"span\")\n      .attr(\"class\", \"base base_Active\")\n      .tooltip(i18n.DragToFilter, { placement: \"bottom\" })\n      .on(\"mousedown\", function (event) {\n        if (event.which !== 1) return; // only respond to left-click\n        // time is not supported for now.\n        // if (me instanceof Summary_Timestamp) return;\n        if (me.attrib.type === \"timestamp\") return;\n\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\n\n        var e = this.parentNode;\n        var initMin = me.attrib.summaryFilter.active.minV;\n        var initMax = me.attrib.summaryFilter.active.maxV;\n        var initPos = d3.pointer(event, e)[0];\n\n        d3.select(\"body\")\n          .on(\"mousemove\", () => {\n            me.browser.preventAxisScaleTransition = true;\n            me.dragRange(initPos, d3.pointer(event, e)[0], initMin, initMax);\n          })\n          .on(\"mouseup\", () => {\n            me.browser.preventAxisScaleTransition = false;\n            me.browser.DOM.root.classed(\"noPointerEvents\", false);\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n        event.preventDefault();\n        event.stopPropagation();\n      });\n\n    Base.Compare_List.forEach((cT) => {\n      controlLine\n        .append(\"span\")\n        .attr(\"class\", \"base base_Compare bg_\" + cT)\n        .tooltip(i18n.DragToFilter, { placement: \"bottom\" });\n    });\n\n    this.DOM.rangeHandle = controlLine\n      .selectAll(\".rangeHandle\")\n      .data([\"min\", \"max\"])\n      .enter()\n      .append(\"span\")\n      .attr(\"class\", (d) => \"rangeHandle \" + d)\n      .tooltip(i18n.DragToFilter)\n      .on(\"mouseenter\", function () {\n        if (this.dragging) return;\n        this.tippy.show();\n        this.classList.add(\"dragging\");\n      })\n      .on(\"mouseleave\", function () {\n        if (this.dragging) return;\n        this.tippy.hide();\n        this.classList.remove(\"dragging\");\n      })\n      .on(\"dblclick\", function (_event, d: \"min\" | \"max\") {\n        me.showValuePicker(this, d);\n      })\n      .on(\"mousedown\", function (event, d: \"min\" | \"max\") {\n        if (event.which !== 1) return; // only respond to left-click\n\n        me.browser.DOM.root\n          .classed(\"adjustingWidth\", true)\n          .classed(\"noPointerEvents\", true);\n        this.classList.add(\"dragging\");\n\n        var mee = this;\n        mee.dragging = true;\n        var e = this.parentNode;\n        var org = {\n          min: me.attrib.summaryFilter.active.minV,\n          max: me.attrib.summaryFilter.active.maxV,\n        };\n        d3.select(\"body\")\n          .on(\"mousemove.range\", function (event2) {\n            var _v: T = me.valueScale.invert(d3.pointer(event2, e)[0]);\n            // TODO!\n            // me.attrib.setRangeFilter({ [d]: _v }, true);\n            // detect a flip :: TODO: Works only once, if there's a second flip, it doesn't detect correctly\n            if (d === \"min\" && _v >= org.max) d = \"max\";\n            if (d === \"max\" && _v <= org.min) d = \"min\";\n            me.browser.preventAxisScaleTransition = true;\n          })\n          .on(\"mouseup.range\", function () {\n            delete me.browser.preventAxisScaleTransition;\n            mee.dragging = false;\n            mee.classList.remove(\"dragging\");\n            me.browser.DOM.root\n              .classed(\"adjustingWidth\", null)\n              .classed(\"noPointerEvents\", false);\n            d3.select(\"body\")\n              .style(\"cursor\", \"auto\")\n              .on(\"mousemove.range\", null)\n              .on(\"mouseup.range\", null);\n          });\n        event.stopPropagation();\n      });\n\n    this.DOM.recordValue = controlLine\n      .append(\"div\")\n      .attr(\"class\", \"recordValue\");\n    this.DOM.recordValue.append(\"span\").attr(\"class\", \"valueScaleMark\");\n    this.DOM.recordValueText = this.DOM.recordValue\n      .append(\"span\")\n      .attr(\"class\", \"recordValueText\")\n      .append(\"span\")\n      .attr(\"class\", \"recordValueText-v\");\n\n    this.DOM.valueTickGroup = this.DOM.intervalSlider\n      .append(\"div\")\n      .attr(\"class\", \"valueTickGroup\");\n  }\n\n  onAggrHighlight(aggr: Aggregate_Interval<T>) {\n    if (this.browser.adjustMode) return;\n    if (this.browser.mouseOverCompare.is(false)) return;\n    if (!this.browser.can_setSelect_Compare(aggr)) return;\n    var [minV, maxV] = this.attrib.sanitizeRange(aggr.minV, aggr.maxV);\n\n    if (minV === maxV) return; // no selection!\n\n    if (!this.attrib.binMatch([minV, maxV, null], aggr)) {\n      aggr.updateRecords();\n    }\n    aggr.DOM.aggrGlyph?.setAttribute(\"selection\", \"selected\");\n    this.browser.setSelect_Compare(aggr);\n  }\n\n  onAggrLeave(aggr) {\n    if (this.browser.adjustMode) return;\n    aggr.unselectAggregate();\n    this.browser.clearSelect_Compare();\n  }\n\n  onAggrClick(event, aggr) {\n    if (this.highlightRangeLimits_Active) return;\n    if (event && event.shiftKey) {\n      this.browser.lockSelect_Compare();\n      return;\n    }\n    this.attrib.setRangeFilter(aggr);\n  }\n\n  refreshValueTickLabels() {\n    this.DOM.valueTickGroup\n      ?.selectAll(\".valueTick > .text\")\n      .html((tick) => this.attrib.printAbbr(tick.tickValue, false));\n  }\n\n  refreshChartsVisibleOption() {\n    if (!this.DOM.inited) return;\n    this.DOM.root.classed(\"chartVisibleHistogram\", this.showHistogram.is(true));\n  }\n\n  onClearFilter() {\n    this.attrib.noValueAggr.filtered = false;\n    this.attrib.summaryFilter.active = null;\n    this.zoomed.set(false);\n    this.refreshIntervalSlider();\n  }\n\n  // extended by Block_Numeric to add minor ticks when using log scale\n  insertMinorTicks(ticks) {}\n\n  updateValueTicks() {\n    var me = this;\n\n    // create ticks used in the value scale / interval range slider\n    var ticksOrg: T[] = this.attrib.intervalTicks.slice();\n\n    if (this.attrib.stepTicks) ticksOrg.pop(); // won't insert last tick here\n\n    type Tick = { tickValue: T; major: boolean };\n\n    let ticks: Tick[] = ticksOrg.map((p) => ({ tickValue: p, major: true }));\n\n    this.insertMinorTicks(ticks);\n\n    var finalPos = (d: Tick) => this.valueScale(d.tickValue) + \"px\";\n    var prevPos = (d: Tick) => this.attrib.valueScale_prev(d.tickValue) + \"px\";\n\n    if (!this.browser.chartsLoaded) prevPos = finalPos;\n\n    this.DOM.valueTickGroup\n      .selectAll(\".valueTick\")\n      .data(ticks, (t: Tick) => t.tickValue)\n      .join(\n        (enter) =>\n          enter\n            .append(\"span\")\n            .attr(\"class\", \"valueTick\")\n            .style(\"opacity\", 1)\n            .style(\"left\", finalPos)\n            .style(\"top\", \"20px\")\n            .call((valueTicks) => {\n              valueTicks.append(\"span\").attr(\"class\", \"line\");\n              valueTicks\n                .append(\"span\")\n                .attr(\"class\", \"text\")\n                .on(\"mouseover\", function () {\n                  if (this.bin) me.onAggrHighlight(this.bin);\n                })\n                .on(\"mouseleave\", function () {\n                  if (this.bin) me.onAggrLeave(this.bin);\n                })\n                .on(\"click\", function (event) {\n                  if (this.bin) me.onAggrClick(event, this.bin);\n                });\n            }),\n        // .call((valueTicks) => {\n        //   window.setTimeout(() => {\n        //     valueTicks\n        //       .style(\"pointer-events\", null)\n        //       .style(\"opacity\", 1)\n        //       .style(\"left\", finalPos);\n        //   }, 0);\n        // })\n        (update) => update,\n        (exit) => {\n          if (!this.browser.chartsLoaded) {\n            exit.remove();\n          } else {\n            exit\n              .style(\"left\", finalPos)\n              .style(\"opacity\", 0)\n              .transition()\n              .duration(0)\n              .delay(600)\n              .remove();\n          }\n        }\n      )\n      .classed(\"major\", (tick) => tick.major)\n      .style(\"left\", finalPos)\n      .call((valueTicks) => {\n        valueTicks.transition().duration(500).delay(5).style(\"top\", \"0px\");\n        //.style(\"left\", finalPos);\n        valueTicks.selectAll(\".text\").each(function (d) {\n          this.bin = null;\n          var v = +d.tickValue;\n          me._aggrs.some((bin) => {\n            if (+bin.minV - v) return false;\n            this.bin = bin;\n            return true;\n          });\n        });\n      });\n\n    this.refreshValueTickLabels();\n\n    this.DOM.valueTickGroup.style(\n      \"left\",\n      (this.attrib.stepTicks ? this.aggrWidth / 2 : 0) + \"px\"\n    );\n  }\n}\n","import { quantile } from \"d3-array\";\nimport { select } from \"./d3_select\";\n\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\nimport { Base } from \"./Base\";\nimport { Block_Interval, ZoomableStatus } from \"./Block_Interval\";\nimport { Config } from \"./Config\";\nimport { CompareType, MeasureType } from \"./Types\";\nimport { Util } from \"./Util\";\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { i18n } from \"./i18n\";\n\nconst d3 = { select, quantile };\n\nexport class Block_Numeric extends Block_Interval<number> {\n  // specific attribute type\n  public readonly attrib: Attrib_Numeric;\n\n  readonly showPercentiles: Config<boolean>;\n\n  constructor(attrib: Attrib_Numeric) {\n    super(attrib);\n\n    this.showPercentiles = new Config<boolean>({\n      cfgClass: \"showPercentiles\",\n      cfgTitle: \"Percentiles\",\n      iconClass: \"percentileBlocks\",\n      default: false,\n      parent: this,\n      itemOptions: [\n        { name: \"Show\", value: true },\n        { name: \"Hide\", value: false },\n      ],\n      onDOM: (DOM) => {\n        DOM.root\n          .select(\".percentileBlocks\")\n          .classed(\"percentileChart_Active\", true)\n          .selectAll(\".block\")\n          .data([1, 4, 4, 3, 2, 1])\n          .enter()\n          .append(\"i\")\n          .attr(\"class\", (_) => \"percentileBlock qG\" + _);\n      },\n      onSet: () => {\n        if (!this.DOM.inited) return;\n        var curHeight = this.getHeight();\n        this.refreshChartsVisibleOption();\n        this.updatePercentiles();\n        this.setHeight(curHeight);\n        this.browser.updateLayout_Height();\n      },\n    });\n\n    this.attrib.configs.showPercentiles = this.showPercentiles;\n  }\n\n  /** -- */\n  get height_Percentile() {\n    return this.showPercentiles.is(true) ? Base.height_Percentile : 0;\n  }\n  /** -- */\n  get height_Extra_base() {\n    return super.height_Extra_base + this.height_Percentile;\n  }\n\n  /** - */\n  refreshWidth() {\n    this.attrib.refreshScaleType();\n    super.refreshWidth();\n  }\n\n  getScaleNicing(): number {\n    if (!this.inDashboard) {\n      return this.width_histogram / 10;\n    }\n    var v = this.optimumBinWidth.get();\n    if (this.attrib.unitName) {\n      v += (v * (2 + this.attrib.unitName.length * 8)) / 45;\n    }\n    return this.width_histogram / v;\n  }\n\n  dragRange(initPos, curPos, initMin, initMax) {\n    var targetDif;\n    var r = {\n      min: undefined,\n      max: undefined,\n    };\n\n    if (this.attrib.isValueScale_Log) {\n      targetDif = curPos - initPos;\n      r.min = this.valueScale.invert(this.valueScale(initMin) + targetDif);\n      r.max = this.valueScale.invert(this.valueScale(initMax) + targetDif);\n      //\n    } else if (this.attrib.isValueScale_Linear) {\n      targetDif =\n        this.valueScale.invert(curPos) - this.valueScale.invert(initPos);\n      if (!this.attrib.hasFloat) targetDif = Math.round(targetDif);\n\n      r.min = initMin + targetDif;\n      r.max = initMax + targetDif;\n\n      var diff = initMax - initMin;\n      \n      var currentLimit = this.attrib.valueScale.domain();\n\n      // Limit the active filter to expand beyond the current min/max of the view.\n      if (r.min < currentLimit[0]) {\n        r.min = currentLimit[0];\n        r.max = currentLimit[0] + diff;\n      }\n      if (r.max > currentLimit[1]) {\n        r.max = currentLimit[1];\n        r.min = currentLimit[1] - diff;\n      }\n    }\n\n    this.attrib.setRangeFilter_Custom( r.min, r.max);\n  }\n\n  /** -- */\n  showValuePicker(DOM, d: \"min\" | \"max\") {\n    var pikanum = DOM.pikanum;\n    if (!pikanum) {\n      DOM.pikanum = pikanum = d3\n        .select(DOM)\n        .append(\"input\")\n        .attr(\"class\", \"rangeInput\")\n        .attr(\"type\", \"number\")\n        .attr(\"min\", this.attrib.rangeOrg[0])\n        .attr(\"max\", this.attrib.rangeOrg[1])\n        .on(\"blur\", function () {\n          pikanum.style(\"display\", \"none\");\n        })\n        .on(\"focusout\", function () {\n          pikanum.style(\"display\", \"none\");\n        })\n        .on(\"keydown\", function (event) {\n          if (event.keyCode === 27) {\n            // Escape key\n            pikanum.node().blur();\n          }\n        })\n        .on(\"change\", () => {\n          var v = 1 * pikanum.node().value;\n          var minV = this.attrib.summaryFilter.active.minV;\n          var maxV = this.attrib.summaryFilter.active.minV;\n          if(d===\"min\") minV = v;\n          if(d===\"max\") maxV = v;\n          this.attrib.setRangeFilter_Custom( minV, maxV);\n          pikanum.node().blur();\n        });\n    }\n    pikanum.attr(\"step\", 1).style(\"display\", \"block\");\n    pikanum.node().focus();\n    pikanum.node().value = this.attrib.summaryFilter.active[d];\n  }\n\n  zoomableStatus(): ZoomableStatus {\n    if (this.attrib.stepTicks) {\n      return this.zoomed.is(true) ? \"minus\" : \"\";\n    }\n    return \"plus\";\n  }\n  hasStaticHeight(): boolean {\n    return this.showHistogram.is(false);\n  }\n\n  /** -- */\n  initDOM(beforeDOM): boolean {\n    if (!super.initDOM(beforeDOM)) return false;\n    this.initDOM_Percentile();\n    return true;\n  }\n\n  refreshChartsVisibleOption() {\n    if (!this.DOM.inited) return;\n    super.refreshChartsVisibleOption();\n\n    this.DOM.root.classed(\"chartVisiblePercentile\", this.showPercentiles.is(true));\n  }\n  insertMinorTicks(ticks) {\n    if(this.attrib.isValueScale_Log){\n      Util.insertMinorTicks(this.attrib.intervalTicks, this.valueScale, ticks);\n    }\n  }\n\n  /** - */\n  updateAfterFilter(): void {\n    if (!this.isVisible()) return;\n    super.updateAfterFilter();\n    this.updatePercentiles();\n  }\n\n  refreshViz_Active(): void {\n    super.refreshViz_Active();\n\n    this.updatePercentiles(\"Active\");\n  }\n\n  /** - */\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\n    super.refreshViz_Compare(cT, curGroup, totalGroups, prevCts);\n\n    var baseline = this.measureLineZero;\n    \n    var maybePartial = this.attrib.isFiltered() && this.attrib.summaryFilter.active && !this.attrib.stepTicks;\n\n    // used in partial rendering\n    let filter_min: number, filter_max: number, minPos: number, maxPos: number;\n\n    if(maybePartial){\n      filter_min = this.attrib.summaryFilter.active.minV;\n      filter_max = this.attrib.summaryFilter.active.maxV;\n      minPos = this.valueScale(filter_min);\n      maxPos = this.valueScale(filter_max);\n    }\n\n    var _do = (withScale) => {\n      this.DOM[\"measure_\" + cT].style(\n        \"transform\",\n        (aggr: Aggregate_Interval<number>) => {\n          var _w = this.width_Bin;\n          var _translateX = 0;\n\n          if (maybePartial) {\n            var aggr_min = aggr.minV;\n            var aggr_max = aggr.maxV;\n            // it is within the filtered range\n            if (aggr_max > filter_min && aggr_min < filter_max) {\n              if (aggr_min < filter_min) {\n                var lostWidth = minPos - this.valueScale(aggr_min);\n                _translateX = lostWidth;\n                _w -= lostWidth;\n              }\n              if (aggr_max > filter_max) {\n                _w -=\n                  this.valueScale(aggr_max) -\n                  maxPos -\n                  Base.width_HistBarGap * 2;\n              }\n            } else {\n              aggr.setScale(cT, 0);\n            }\n          }\n\n          if (!this.browser.stackedCompare) {\n            _w = _w / totalGroups;\n            _translateX = _w * curGroup;\n          }\n\n          return `translate(${_translateX}px, ${\n            this.height_hist - baseline - aggr.offset(cT)\n          }px) scale(${_w}, ${withScale ? aggr.scale(cT) : 0})`;\n        }\n      );\n    };\n\n    if (curGroup === totalGroups - 1 && this.browser.addedCompare) {\n      _do(false);\n    }\n    _do(true);\n\n    this.updatePercentiles(cT);\n  }\n\n  // ********************************************************************\n  // Percentile chart\n  // ********************************************************************\n\n  // Percentile chart stuff\n  quantile_val: { [index: number]: number } = {};\n\n  /** -- */\n  private initDOM_Percentile() {\n    if (!this.DOM.summaryInterval || this.DOM.percentileGroup) return;\n\n    var me = this;\n    this.DOM.percentileGroup = this.DOM.summaryInterval\n      .append(\"div\")\n      .attr(\"class\", \"percentileGroup\");\n    this.DOM.percentileGroup\n      .append(\"span\")\n      .attr(\"class\", \"percentileTitle\")\n      .html(i18n.Percentiles);\n\n    (Base.Compare_List as MeasureType[])\n      .concat(\"Active\")\n      .forEach((sT: MeasureType) => {\n        var parent = me.DOM.percentileGroup\n          .append(\"div\")\n          .attr(\"class\", \"percentileChart_\" + sT);\n\n        parent\n          .selectAll(\".aggrGlyph\")\n          .data([\n            [10, 20, 1],\n            [20, 30, 2],\n            [30, 40, 3],\n            [40, 50, 4],\n            [50, 60, 4],\n            [60, 70, 3],\n            [70, 80, 2],\n            [80, 90, 1],\n          ])\n          .enter()\n          .append(\"span\")\n          .attr(\"class\", (qb) => \"quantile aggrGlyph q_range qG\" + qb[2])\n          .each(function () {\n            this.__data__.summary = me;\n          })\n          .tooltip(\n            (qb) =>\n              `<div><span style='font-weight:400'>${qb[0]}% - ${\n                qb[1]\n              }%</span> Percentile:</div><div style='font-weight: 500'>${me.attrib.printAbbr(\n                me.quantile_val[sT + qb[0]]\n              )} - ${me.attrib.printAbbr(me.quantile_val[sT + qb[1]])}</div>`,\n            { placement: \"top\" }\n          )\n          .on(\"mouseover\", (_event, qb) => {\n            if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib())\n              return;\n            if (this.browser.mouseOverCompare.is(false)) return;\n            this.highlightRangeLimits_Active = true;\n\n            var aggr = this.attrib.createAggregate(\n              this.quantile_val[sT + qb[0]],\n              this.quantile_val[sT + qb[1]]\n            );\n            aggr.updateRecords();\n\n            this.browser.allRecordsAggr.clearCompare(\n              this.browser.Compare_Highlight\n            );\n            this.browser.setSelect_Compare(aggr);\n          })\n          .on(\"mouseout\", () => {\n            if (this.browser.comparedAttrib && !this.attrib.isComparedAttrib())\n              return;\n            this.browser.clearSelect_Compare();\n            this.highlightRangeLimits_Active = false;\n          })\n          .on(\"click\", (event, qb) => {\n            if (event.shiftKey) {\n              this.browser.clearSelect_Compare(null, true, true);\n              this.highlightRangeLimits_Active = false;\n              return;\n            }\n\n            this.attrib.summaryFilter.active = this.attrib.createAggregate(\n              this.quantile_val[sT + qb[0]],\n              this.quantile_val[sT + qb[1]]\n            );\n            this.attrib.summaryFilter.setFiltered();\n          });\n\n        parent\n          .selectAll(\".q_pos\")\n          .data([50])\n          .enter()\n          .append(\"span\")\n          .attr(\"class\", (q) => \"quantile q_pos q_\" + q)\n          .tooltip(\n            (q) =>\n              `<u>Median</u><br><b>${me.attrib.getFormattedValue(\n                me.quantile_val[sT + q]\n              )}</b>`,\n            { placement: \"top\" }\n          );\n      });\n\n    this.refreshChartsVisibleOption();\n  }\n\n  /** - */\n  private refreshViz_Percentiles(distr) {\n    if (!this.DOM.percentileGroup) return;\n    if (!this.valueScale) return;\n    if (this.showPercentiles.is(false)) return;\n\n    var percentileChart = this.DOM.percentileGroup.select(\n      \".percentileChart_\" + distr\n    );\n\n    percentileChart\n      .style(\"margin-left\", \"0px\")\n      .style(\"opacity\", (q) =>\n        this.quantile_val[distr + \"10\"] == null ? 0 : 1\n      )\n      .style(\n        \"transform\",\n        this.attrib.stepTicks\n          ? \"translateX(\" + this.aggrWidth / 2 + \"px)\"\n          : null\n      );\n    percentileChart\n      .selectAll(\".q_pos\")\n      .style(\n        \"transform\",\n        (q) =>\n          \"translateX(\" + this.valueScale(this.quantile_val[distr + q]) + \"px)\"\n      );\n    percentileChart\n      .selectAll(\".quantile.aggrGlyph\")\n      .style(\"transform\", (qb) => {\n        var pos_1 = this.valueScale(this.quantile_val[distr + qb[0]]);\n        var pos_2 = this.valueScale(this.quantile_val[distr + qb[1]]);\n        return `translateX(${pos_1}px) scaleX(${pos_2 - pos_1})`;\n      });\n  }\n\n  private updatePercentiles(sT: MeasureType = null) {\n    if (sT === \"Other\") return;\n\n    if (this.showPercentiles.is(false)) return;\n\n    if (!sT) {\n      this.browser.activeComparisons.forEach((t) => this.updatePercentiles(t));\n      this.updatePercentiles(\"Active\");\n      return;\n    }\n\n    if (sT === \"Total\") return; // no total-vis for percentiles\n\n    if( sT !== \"Active\"){\n      if (!this.attrib.vizActive(sT)) return;\n    }\n\n    // the items are already sorted by their numeric value, it's just a linear pass.\n    var values = this.attrib.sortedRecords\n      .filter(\n        sT === \"Active\"\n          ? (record) => record.isIncluded\n          : (record) => record.isIncluded && record.isSelected(sT)\n      )\n      .map((record) => this.attrib.getRecordValue(record));\n\n    [10, 20, 30, 40, 50, 60, 70, 80, 90].forEach((q) => {\n      this.quantile_val[sT + q] = d3.quantile(values, q / 100);\n    });\n\n    this.refreshViz_Percentiles(sT);\n  }\n}\n","import { format } from \"d3-format\";\nimport { deviation } from \"d3-array\";\n\nimport { Aggregate_Interval_Numeric } from \"./Aggregate_Interval\";\n\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\nimport { TimeKey } from \"./TimeSeriesData\";\n\nimport { Block_Numeric } from \"./Block_Numeric\";\nimport { LinearOrLog, RecordVisCoding, SummarySpec } from \"./Types\";\nimport { Browser } from \"./Browser\";\nimport { Config } from \"./Config\";\nimport { i18n } from \"./i18n\";\nimport { Util } from \"./Util\";\nimport { Base } from \"./Base\";\n\nconst d3 = { format, deviation };\n\nexport class Attrib_Numeric extends Attrib_Interval<number> {\n  protected _block: Block_Numeric;\n  public get block(): Block_Numeric {\n    return this._block;\n  }\n\n  hasTimeSeriesParent(): boolean {\n    return this.parent?.type === \"timeseries\";\n  }\n\n  get timeseriesParent(): Attrib_Timeseries | null {\n    return this.parent?.type === \"timeseries\"\n      ? (this.parent as unknown as Attrib_Timeseries)\n      : null;\n  }\n\n  // specialized method to consider/change behavior if with timeseries parent\n  get groupPath() {\n    return this.timeseriesParent?.attribName.split(\"->\") || this.pathName;\n  }\n  \n  readonly valueScaleType: Config<LinearOrLog | \"auto\">;\n\n  // has floating numbers as data points\n\n  private tickPrecision = 3;\n\n  autoScaleType: LinearOrLog | null = null;\n\n  constructor(browser: Browser, name: string, template: any) {\n    super(\n      browser,\n      name,\n      template,\n      \"numeric\",\n      \"kshfSummary_Numeric\",\n      \"far fa-hashtag\"\n    );\n\n    this._block = new Block_Numeric(this);\n\n    this.measurable = {\n      metricFuncs: Base.defaultMetricFuncs,\n    };\n\n    this.valueScaleType = new Config<LinearOrLog | \"auto\">({\n      cfgClass: \"valueScaleType\",\n      cfgTitle: \"BinScale\",\n      iconClass: \"fa fa-arrows-h\",\n      parent: this,\n      default: \"auto\",\n      helparticle: \"5e87eabc04286364bc97d0cf\",\n      itemOptions: [\n        { name: \"Auto\", value: \"auto\" },\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\n        { name: i18n.Log + \" \" + i18n.Log2Sequence, value: \"log\" },\n      ],\n      forcedValue: () => {\n        if (this.timeseriesParent) return this.timeseriesParent.valueScaleType.get();\n        if (this.stepTicks) return \"linear\";\n        if (!this.supportsLogScale()) return \"linear\";\n        if (this.valueScaleType._value === \"auto\") return this.autoScaleType;\n      },\n      onSet: async () => {\n        if(!this.aggr_initialized) return;\n        this.block.noRefreshVizAxis = true;\n        await this.applyScaleType();\n        this.block.noRefreshVizAxis = false;\n\n        await this.browser.recordDisplay?.refreshAttribScaleType(this);\n      },\n    });\n\n    this.finishTemplateSpecial();\n\n    // TODO: maintain good order for UI, delete showHistogram index and add it at appropriate position\n  }\n\n  createAggregate(minV: number, maxV: number){\n    return new Aggregate_Interval_Numeric(this, minV, maxV);\n  }\n\n  // ********************************************************************\n  // Range and Scale...\n  // ********************************************************************\n\n  get isValueScale_Log() {\n    return this.valueScaleType.is(\"log\");\n  }\n  get isValueScale_Linear() {\n    return this.valueScaleType.is(\"linear\");\n  }\n\n  supportsLogScale(): boolean {\n    return !this.hasNegativeValues();\n  }\n\n  sanitizeRange(minV: number, maxV: number): [number, number] {\n    if (!this.hasFloat) {\n      maxV = Math.round(maxV);\n      minV = Math.round(minV);\n    }\n    return super.sanitizeRange(minV, maxV);\n  }\n\n  getRecordValueExtent(): [number, number] {\n    if (this.valueDomain) {\n      return [...this.valueDomain];\n    }\n    if (this.timeseriesParent?.valueDomain) {\n      return [...this.timeseriesParent.valueDomain];\n    }\n    return super.getRecordValueExtent();\n  }\n\n  // ********************************************************************\n  // Data & initialization\n  // ********************************************************************\n\n  private _hasFloat: boolean;\n  get hasFloat(): boolean {\n    return this._hasFloat;\n  }\n\n  /** -- */\n  fillValueCache() {\n    this._hasFloat = false;\n\n    this.records.forEach((record) => {\n      var v = this.template.func.call(record.data, record);\n      if (v === undefined) v = null;\n      if (isNaN(v)) v = null;\n      if (v === 0 && this.skipZero) v = null;\n      if (v !== null) {\n        if (typeof v !== \"number\") {\n          v = null;\n        } else {\n          this._hasFloat = this._hasFloat || v % 1 !== 0;\n        }\n      }\n      record.setValue(this, v);\n      if (v == null) {\n        this.noValueAggr.addRecord(record);\n      }\n    });\n  }\n\n  /** -- */\n  pofffff() {\n    this.refreshScaleType();\n  }\n\n  // Also a method of Timeseries\n  hasNegativeValues() {\n    if (!this.aggr_initialized) return true; // unknown, assume it can have negative\n    return this.rangeOrg[0] < 0;\n  }\n\n  /** -- */\n  supportsRecordEncoding(_type: RecordVisCoding) {\n    if (this.isEmpty()) return false;\n    if ([\"text\", \"textBrief\"].includes(_type)) return true;\n    this.initializeAggregates();\n    if (!this.isComparable.get()) return false;\n    if ([\"sort\", \"scatterX\", \"scatterY\", \"color\"].includes(_type)) return true;\n    if (_type === \"size\") {\n      return !this.hasNegativeValues();\n    }\n    return false;\n  }\n\n  /** -- */\n  get canHaveMetricFuncs() {\n    if (this.isIDAttrib()) return false;\n    if (!this.aggr_initialized) return false;\n    return true;\n  }\n  /** -- */\n  get supportedMetricFuncs() {\n    return this.canHaveMetricFuncs ? this._metricFuncs : [];\n  }\n\n  /** -- */\n  private getTickPrecision() {\n    return this.timeseriesParent?.tickPrecision ?? this.tickPrecision;\n  }\n\n  updateTickPrintFunc(){\n    var t = d3.format(\".\" + this.getTickPrecision() + \"~s\");\n    if (this.getTickPrecision() === 0) {\n      t = d3.format(\"~s\");\n    }\n\n    this.intervalTickPrint = (v: number) => {\n      if (!this.hasFloat) v = Math.round(v);\n      var r = t(v);\n      var _r = v.toLocaleString();\n      // if value is 1021 and summary doesn't have float, formatted value returns \"1,021k\" - Stupid!\n      if (_r.length <= r.length) return _r;\n      if (r.substr(-1) === \"m\") {\n        r = parseFloat(r) / 1000;\n        r = Math.round((r + 0.000001) * 1000) / 1000;\n      }\n      return r;\n    };\n\n    if (this.stepTicks) {\n      this.intervalTickPrint = d3.format(\"d\");\n    }\n  }\n\n  refreshValueScale(){\n    super.refreshValueScale();\n\n    if (!this.hasFloat) {\n      this.intervalTicks = this.intervalTicks.filter((tick) => tick % 1 === 0);\n    }\n  }\n\n  // if parent is timeseries, timeKey shows which time we are about...\n  timeKey: TimeKey = null;\n\n  /** -- */\n  isPercentageUnit() {\n    if (this.unitName !== \"%\") return false;\n    if (this.hasNegativeValues()) return false;\n    if (this.rangeOrg[1] > 100) return false;\n    return true;\n  }\n\n  /** -- */\n  refreshScaleType() {\n    if (this.isEmpty()) return;\n\n    this.setStepTicks(false);\n\n    if (this.timeseriesParent) {\n      this.timeseriesParent.initializeAggregates();\n      return;\n    }\n\n    var domain = this.valueScale.domain();\n\n    // decide scale type based on the filtered records\n    var deviation = d3.deviation(this.sortedRecords, (record) => {\n      var v = this.getRecordValue(record);\n      if(v==null) return undefined;\n      if(v >= domain[0] && v <= domain[1]) return v;\n    });\n\n    var range = this.valueScale.domain();\n    var activeRange = range[1] - range[0];\n\n    var optTicks = this.block.getScaleNicing();\n\n    if (!this.hasFloat && optTicks >= activeRange) {\n      // Apply step domain before you check for log - it has higher precedence\n      this.setStepTicks(true);\n    } else if (\n      deviation / activeRange < 0.12 &&\n      this.rangeOrg[0] > 0\n    ) {\n      // Log scale\n      this.autoScaleType = \"log\";\n      return;\n    } else if (!this.hasFloat && optTicks >= activeRange) {\n      // The scale can be linear or step after this stage\n      this.setStepTicks(true);\n    }\n    this.autoScaleType = \"linear\";\n  }\n\n  getFormattedValue(v: any, isSVG: any = false): string {\n    if (v == null) {\n      v = \"-\";\n    } else if (typeof v === \"number\") {\n      if (!this.intervalTickPrint) this.refreshValueScale();\n      v = this.intervalTickPrint(v);\n    }\n    return Util.addUnitName(v, this.unitName, isSVG);\n  }\n\n  /** -- */\n  private keepOnlyPositiveRecords() {\n    this.sortedRecords = this.records.filter((record) => {\n      var isPositive = this.getRecordValue(record) > 0;\n      if (!isPositive) {\n        this.setRecordValueCacheToMissing(record);\n      }\n      return isPositive;\n    });\n\n    this.updatedRangeOrg();\n  }\n\n  /** -- */\n  async applyScaleType() {\n    if (!this.sortedRecords) return;\n\n    this.initializeAggregates();\n\n    // remove records with value:0 (because log(0) is invalid)\n    if (this.isValueScale_Log && this.rangeOrg[0] <= 0) {\n      this.keepOnlyPositiveRecords();\n    }\n\n    this.updateScaleAndBins();\n    await this.browser.recordDisplay?.refreshAttribScaleType(this);\n  }\n\n  getValueScaleObj() {\n    return Util.getD3Scale(this.isValueScale_Log);\n  }\n  getValuePosX(v: number) {\n    return this.valueScale(v) + (this.stepTicks ? this.block.aggrWidth / 2 : 0);\n  }\n\n  getVizDomain(): [number, number] {\n    if (this.timeseriesParent) {\n      this.timeseriesParent.initializeAggregates();\n      return this.timeseriesParent.timeSeriesScale_Value.domain();\n    }\n    return super.getVizDomain();\n  }\n\n  applyTemplateSpecial(): void {\n    if (this.template.special === \"TimePoint\" && this.template.parent) {\n      this.timeseriesParent.setTimepointAttrib(this.template.lastKey, this);\n    } else if (this.template.special === \"Hour\") {\n      this.unitName = \":00\";\n    }\n  }\n\n  skipZero: boolean = false;\n\n  /** -- */\n  setSkipZero() {\n    if (!this.aggr_initialized) return;\n    if (this.rangeOrg[0] > 0) return;\n    if (this.skipZero) return;\n\n    this.skipZero = true;\n\n    this.keepOnlyPositiveRecords();\n\n    this.refreshScaleType();\n  }\n\n  // ********************************************************************\n  // Unit name access  & updates\n  // ********************************************************************\n\n  /** -- */\n  get unitName(): string {\n    return this.timeseriesParent?.unitName ?? this.measurable?.unitName ?? \"\";\n  }\n\n  /** -- */\n  set unitName(v: string) {\n    if (!v) v = \"\";\n    if (this.unitName === v) return;\n    if (this.timeseriesParent) {\n      this.timeseriesParent.unitName = v;\n      return;\n    }\n\n    super.unitName = v;\n\n    this.block.refreshValueTickLabels();\n\n    this.browser.recordDisplay.View?.refreshAttribUnitName(this);\n\n    if (this.measureSummary === this) {\n      this.browser.blocks.forEach((block) =>\n        block.refreshMeasureLabelText(\"Active\")\n      );\n      this.browser.DOM.activeRecordMeasure.html(\n        this.browser.getGlobalActiveMeasure()\n      );\n    }\n  }\n\n  // ********************************************************************\n  // Import / Export\n  // ********************************************************************\n\n  /** -- */\n  async applyConfig(blockCfg: SummarySpec) {\n    super.applyConfig(blockCfg);\n\n    this.measurable.valueDomain = blockCfg.valueDomain;\n\n    await this.block.showPercentiles.set(blockCfg.showPercentiles);\n    await this.valueScaleType.set(blockCfg.valueScaleType);\n\n    if (blockCfg.unitName) {\n      this.unitName = blockCfg.unitName;\n    }\n\n    if (blockCfg.skipZero) {\n      this.setSkipZero();\n    }\n  }\n\n  // not exportable if this is just a timekey - it inherits properties from its parent\n  isExportable(): boolean {\n    return this.timeseriesParent === null;\n  }\n\n  /** -- */\n  exportConfig() {\n    var config = super.exportConfig();\n\n    var c = {\n      unitName: this.unitName,\n      skipZero: this.skipZero,\n      filter: this.summaryFilter.exportFilter()\n    };\n\n    return Object.assign(config, c);\n  }\n}\n","import * as d3 from \"../d3_select\";\nimport * as Popper from \"@popperjs/core\";\n\nimport { RecordDisplay } from \"../RecordDisplay\";\nimport { RecordVisCoding } from \"../Types\";\nimport { Attrib } from \"../Attrib\";\nimport { i18n } from \"../i18n\";\nimport { Attrib_Numeric } from \"../Attrib_Numeric\";\n\ntype DropdownOption = {\n  item: Attrib | string | null, // if null, it means no value\n  measureType?: \"Sum\" | \"Count\", // special grouping option\n  name: string,\n  sub: {[index: string]: DropdownOption},\n  parents?: string[], // if not defined, means no parent\n}\n\ntype DropdownSpec = {[index:string]: DropdownOption};\n\n// group attribList by pathName\nfunction groupSummaries(attribList: Attrib[]): DropdownSpec {\n  var grouped: DropdownSpec = {};\n\n  for (const attrib of attribList) {\n    if (attrib == null) {\n      grouped[\"\"] = { item: null, name: i18n[\"(None)\"], sub: {} };\n      continue;\n    }\n\n    var target = grouped;\n\n    attrib.pathName.forEach((_key: string) => {\n      target[_key] =  target[_key] || {\n        item: _key,\n        name: _key,\n        sub: {}, // creates one with empty sub\n      };\n      target = target[_key].sub;\n    });\n\n    target[attrib.printName] = target[attrib.printName] || {\n      name: attrib.printName,\n      item: attrib,\n      sub: {},\n    };\n\n    // overwriting it here, since the existing one might be set before as a simple group (item as key)\n    target[attrib.printName].item = attrib;\n  }\n  return grouped;\n}\n\nexport class AttribDropdown {\n  private readonly _type: RecordVisCoding;\n  private readonly recordDisplay: RecordDisplay;\n  private _element: any; // d3 select\n  private _button: any; // d3 select\n  private _popup: any; // d3 select\n  private _popper: any; // d3 select\n\n  /** -- */\n  constructor(_type: RecordVisCoding, recDisp: RecordDisplay) {\n    this.recordDisplay = recDisp;\n    this._type = _type;\n\n    this._element = this.recordDisplay.DOM[_type + \"ControlGroup\"]\n      .append(\"span\")\n      .attr(\"class\", \"summaryGroup\");\n\n    this._button = this._element\n      .append(\"div\")\n      .attr(\"class\", \"selectButton\")\n      .on(\"click\", () => this.toggle());\n\n    this._button.append(\"div\").attr(\"class\", \"text\");\n    this._button.append(\"div\").attr(\"class\", \"caret far fa-angle-down\");\n\n    this._popup = this._element.append(\"div\").attr(\"class\", \"selectOptions\");\n\n    this._element\n      .append(\"span\")\n      .attr(\"class\", \"summaryDescription fa fa-info\")\n      .tooltip(\"\");\n\n    this._popper = null;\n  }\n\n  /** -- */\n  get browser() {\n    return this.recordDisplay.browser;\n  }\n\n  /** Returns main timeseries if selected one is a timeKey */\n  get activeAttrib() {\n    var attrib = this.recordDisplay.codeBy[this._type];\n    if (attrib instanceof Attrib_Numeric && attrib.hasTimeSeriesParent()) {\n      return attrib.timeseriesParent;\n    }\n    return attrib;\n  }\n\n  /** -- */\n  refresh() {\n    var attrib = this.activeAttrib;\n    var text: string;\n\n    if (attrib == null) {\n      text = i18n.NoAttribute;\n    } else if (attrib === \"_measure_\") {\n      text = (this.browser.measureFunc.is(\"Count\"))\n        ? this.browser.recordName \n        : this.browser.measureSummary.get().printName;\n    } else {\n      text = attrib.printName;\n    }\n\n    this._button.select(\".text\").html(text);\n    this._button.classed(\"none\", attrib == null);\n\n    // Update description tooltip\n    var descSummary =\n      attrib === \"_measure_\" ? this.browser.measureSummary : attrib;\n    if (descSummary instanceof Attrib) {\n      var description = descSummary ? descSummary.description : null;\n      this._element\n        .select(\".summaryDescription\")\n        .style(\"display\", description ? null : \"none\")\n        .tooltip(description, { placement: \"bottom\" });\n    }\n  }\n\n  /** -- */\n  toggle() {\n    if (this._popper) {\n      this.hide();\n    } else {\n      this.show();\n    }\n  }\n\n  /** -- */\n  show() {\n    if (this._popper) return;\n\n    var measuring = (this._type===\"size\" || this._type===\"color\") && this.recordDisplay.hasAggregates();\n\n    var dropdownOptions: DropdownSpec;\n\n    if (measuring) {\n      dropdownOptions = {};\n      dropdownOptions[\"\"] = {\n        item: null,\n        name: i18n.NoAttribute,\n        sub: {},\n      };\n      dropdownOptions[\"Count\"] = {\n        item: null,\n        measureType: \"Count\",\n        name: `${i18n.measure_Count}: ${this.browser.recordName}`,\n        sub: {},\n      };\n      dropdownOptions[\"Sum\"] = {\n        item: null,\n        name: \"Sum\",\n        measureType: \"Sum\",\n        sub: groupSummaries(this.browser.getMeasurableSummaries(\"Sum\")),\n      };\n      // \n    } else {\n      dropdownOptions = groupSummaries(\n        this.recordDisplay.getAttribOptions_UI(this._type)\n      );\n    }\n\n    this._popup.selectAll(\"div\").remove();\n\n    // recursiv method to add list of options\n    var addList = (DOM, def: DropdownSpec, level = 0) => {\n      var list: DropdownOption[] = Object.values(def);\n\n      // sort list so that items without group appear on top\n      list = list.sort((a: DropdownOption, b: DropdownOption) => {\n        if (a.item === null) return 1;\n        if (b.item === null) return -1;\n        return (\n          Object.entries(b.sub).length - Object.entries(a.sub).length ||\n          a.name.localeCompare(b.name)\n        );\n      });\n\n      var listItems = DOM.selectAll(\"div\")\n        .data(list)\n        .enter()\n        .append(\"div\")\n        .attr(\"class\", \"option\")\n        .classed(\n          \"active\",\n          (_: DropdownOption) => {\n            if(measuring){\n              if(_.measureType===\"Count\"){\n                return this.activeAttrib===\"_measure_\";\n              }\n              if(_.measureType===\"Sum\"){\n                return this.activeAttrib===\"_measure_\";\n              }\n            }\n            if( _.item == this.activeAttrib ) return true;\n            return (_.item === \"Count\" && this.activeAttrib === \"_measure_\" && this.browser.measureFunc.is(\"Count\"))\n          }\n        )\n        .classed(\"collapsed\", true)\n        .attr(\"data-id\", (_: DropdownOption) => {\n          if (_.item === null) return \"none\";\n          if (typeof _.item === \"string\") return \"_measure_\";// Count or Sum\n          return _.item.attribID;\n        })\n        .classed(\"isSelectable\", (_: DropdownOption) => _.item instanceof Attrib)\n        .classed(\"hasSubItems\", (_: DropdownOption) => Object.entries(_.sub).length > 0);\n\n      listItems\n        .append(\"div\")\n        .attr(\"class\", \"optionItem\")\n        .call((optionItem) => {\n          optionItem\n            .append(\"div\")\n            .attr(\"class\", \"groupControl\")\n            .tooltip(i18n[\"Open/Close\"])\n            .on(\"click\", (event) => {\n              event.stopPropagation();\n              event.preventDefault();\n              event.currentTarget.parentNode.parentNode.classList.toggle(\"collapsed\");\n            })\n            .append(\"div\")\n            .attr(\"class\", \"fa fa-caret-down\");\n          optionItem\n            .append(\"div\")\n            .attr(\"class\", \"optionName\")\n            .html((_) => _.name);\n        })\n        .on(\"click\", async (event, _: DropdownOption) => {\n          if(measuring){\n            if (_.measureType) {\n              await this.browser.measureFunc.set(_.measureType);\n              this.recordDisplay.setAttrib(this._type, \"_measure_\", true);\n            } else{\n              this.recordDisplay.setAttrib(this._type, null, true);\n            }\n            this.hide();\n            return;\n          }\n\n          if (typeof _.item === \"string\") {\n            // grouping only. open/close group\n            event.currentTarget.parentNode.classList.toggle(\"collapsed\");\n            return;\n          }\n\n          // Attrib selection\n          this.recordDisplay.setAttrib(this._type, _.item, true);\n          this.hide();\n        });\n\n      listItems\n        .append(\"div\")\n        .attr(\"class\", \"subItems\")\n        .each((d, i, nodes) => {\n          addList(d3.select(nodes[i]), d.sub, level + 1);\n        });\n    };\n\n    addList(this._popup, dropdownOptions, 0);\n\n    this._popup.style(\"min-width\", this._button.node().offsetWidth + \"px\");\n\n    this._popper = Popper.createPopper(\n      this._button.node(),\n      this._popup.node(),\n      {\n        placement:\n          this._type == \"timeSeries\" || this._type == \"scatterY\"\n            ? \"right-start\"\n            : \"bottom-start\",\n        strategy: \"absolute\",\n        modifiers: [\n          {\n            name: \"flip\",\n            enabled: true,\n            boundary: this.browser.DOM.root.node(),\n            //fallbackPlacements: ['top', 'right', 'bottom', 'left'],\n          },\n        ],\n      }\n    );\n\n    setTimeout(() => this._element.classed(\"dropdownOpen\", true), 10);\n  }\n\n  /** -- */\n  hide() {\n    this._element.classed(\"dropdownOpen\", false);\n    setTimeout(() => {\n      if (!this._popper) return;\n      this._popper.destroy();\n      this._popper = null;\n    }, 350);\n  }\n}\n","import { select, pointer } from \"../d3_select\";\n\nimport { i18n } from \"../i18n\";\nimport { Browser } from \"../Browser\";\nimport { Base } from \"../Base\";\nimport { Config } from \"../Config\";\n\nconst d3 = { select, pointer };\n\nexport class ConfigPanel {\n  private readonly browser: Browser;\n  private readonly DOM: { root: any; configTable: any };\n  private readonly controlButton: any;\n\n  /** -- */\n  constructor(\n    rootDOM,\n    headerName,\n    className,\n    configs: Config<any>[],\n    browser: Browser,\n    controlButton\n  ) {\n    this.browser = browser;\n\n    this.DOM = {\n      root: rootDOM\n        .append(\"div\")\n        .attr(\"class\", \"configPanel \" + className)\n        .classed(\"active\", false),\n      configTable: null,\n    };\n\n    this.controlButton = controlButton;\n\n    this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"configClose fa fa-window-close\")\n      .tooltip(i18n.Close)\n      .on(\"click\", () => this.hide());\n\n    this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"popupPanel_Header\")\n      .html(i18n[headerName])\n\n      // Dragging support while keeping it within window\n      .on(\"mousedown\", (event) => {\n        browser.DOM.root\n          .classed(\"noPointerEvents\", true)\n          .attr(\"drag_cursor\", \"grabbing\");\n\n        var bodyDOM = d3.select(\"body\").node();\n\n        var initPos = d3.pointer(event, bodyDOM);\n        var DOM = this.DOM.root.node();\n        var initX = parseInt(DOM.offsetLeft);\n        var initY = parseInt(DOM.offsetTop);\n\n        d3.select(\"body\")\n          .on(\"mousemove\", (event2) => {\n            var newPos = d3.pointer(event2, bodyDOM);\n            this.checkPositionSanity(\n              initX - initPos[0] + newPos[0],\n              initY - initPos[1] + newPos[1]\n            );\n          })\n          .on(\"mouseup\", () => {\n            browser.DOM.root\n              .classed(\"noPointerEvents\", false)\n              .attr(\"drag_cursor\", null);\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n\n        event.preventDefault();\n      });\n\n    this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"compactSizeControl far fa-angle-double-up\")\n      .on(\"click\", () => this.DOM.root.node().classList.toggle(\"compact\"));\n\n    this.DOM.configTable = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"popupPanel_Content\")\n      .append(\"table\")\n      .attr(\"class\", \"configTable\");\n\n    configs.forEach((cfg) => this.insertConfigUI(cfg));\n  }\n\n  insertConfigUI(cfg){\n    cfg.insertControl(this.DOM.configTable);\n  }\n\n  /** -- */\n  showAtPos(left, top) {\n    if (this.DOM.root.classed(\"active\")) {\n      this.hide();\n      return;\n    }\n    this.browser.closeConfigPanels();\n    this.DOM.root.classed(\"active\", true);\n    this.controlButton.classed(\"fa-spin\", true);\n    this.checkPositionSanity(left, top);\n  }\n\n  /** -- */\n  hide() {\n    this.DOM.root.classed(\"active\", false);\n    this.controlButton.classed(\"fa-spin\", false);\n  }\n\n  /** -- */\n  private checkPositionSanity(curLeft = null, curTop = null) {\n    if (!Base.browser) return;\n    var space = 8; // just to add some space around...\n    var dom = this.DOM.root.node();\n    var panelWidth = dom.offsetWidth + space;\n    var panelHeight = dom.offsetHeight + space;\n    if (curLeft == null) curLeft = parseFloat(dom.style.left);\n    if (curTop == null) curTop = parseFloat(dom.style.top);\n    var maxWidth = dom.offsetParent.getBoundingClientRect().width;\n    var maxHeight = dom.offsetParent.getBoundingClientRect().height;\n    dom.style.left =\n      Math.max(space, Math.min(maxWidth - panelWidth, curLeft)) + \"px\";\n    dom.style.top =\n      Math.max(space, Math.min(maxHeight - panelHeight, curTop)) + \"px\";\n  }\n}\n","import { Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\nimport { Browser } from \"./Browser\";\nimport { Filter } from \"./Filter\";\nimport { i18n } from \"./i18n\";\nimport { Util } from \"./Util\";\n\nexport class Filter_Spatial extends Filter {\n  public readonly attrib: Attrib_RecordGeo;\n\n  bounds: any; // TODO\n\n  constructor(_browser: Browser, attrib: Attrib_RecordGeo) {\n    super(_browser);\n    this.bounds = null;\n  }\n  get title() {\n    return i18n[\"Spatial\"];\n  }\n  exportFilter() {\n    return {\n      bounds: this.bounds,\n    };\n  }\n  importFilter(_) {\n    this.bounds = _;\n    this.setFiltered(false); // no update...\n    this.applyFilter();\n  }\n  onClear() {\n    this.browser.recordDisplay.DOM.recordBase_Map\n      .select(\".spatialQueryBox_Filter\")\n      .classed(\"active\", null);\n  }\n  filterView_Detail() {\n    return \"<i class='fa fa-square-o'></i> (Area)\";\n  }\n  onFilter(): void {\n    this.browser.recordDisplay.DOM.recordBase_Map\n      .select(\".spatialQueryBox_Filter\")\n      .classed(\"active\", true);\n\n    this.browser.records.forEach((record) => {\n      var rBounds = this.attrib.getRecordValue(record)._bounds;\n      record.setFilterCache(\n        this.filterID,\n        rBounds ? Util.intersects(rBounds, this.bounds) : false\n      );\n    }, this);\n  }\n}\n\n","import { geoBounds } from \"d3-geo\";\n\nimport { Aggregate } from \"./Aggregate.js\";\nimport { Attrib } from \"./Attrib.js\";\nimport { AttribTemplate } from \"./AttribTemplate.js\";\nimport { Base } from \"./Base.js\";\nimport { Browser } from \"./Browser.js\";\nimport {\n  BlockSpec,\n  RecordVisCoding,\n  SummaryConfig,\n  SummarySpec,\n} from \"./Types.js\";\nimport { Filter_Spatial as Filter_Geo } from \"./Filter_Geo.js\";\nimport { i18n } from \"./i18n.js\";\nimport { MapData } from \"./MapData.js\";\nimport { Record } from \"./Record.js\";\n\nconst d3 = { geoBounds };\n\ndeclare let Supercluster: any;\ndeclare let L: any;\n\n/** -- */\nexport class Aggregate_PointCluster extends Aggregate {\n  // cluster structure is returned by Supercluster library\n  cluster: any;\n\n  _glyphOrder: any; // TODO\n\n  /** -- */\n  constructor(attrib: Attrib_RecordGeo, _cluster) {\n    super(attrib);\n    this.cluster = _cluster;\n  }\n  get tooltipTitle() {\n    return i18n[\"Cluster\"];\n  }\n  get label(): string {\n    return \"\";\n  }\n}\n\nexport type RecordGeoData = {\n  geoFeat: any;\n  _bounds: any;\n};\n\n/** Can be a point object, or polygon objects */\nexport class Attrib_RecordGeo extends Attrib {\n  public _aggrs: Aggregate_PointCluster[] = [];\n\n  recordGeoMap: MapData;\n\n  geoType:\n    | \"Point\"\n    | \"MultiPoint\"\n    | \"LineString\"\n    | \"MultiLineString\"\n    | \"Polygon\"\n    | \"MultiPolygon\"\n    | \"GeometryCollection\"\n    | \"Feature\"\n    | \"FeatureCollection\";\n\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\n    super(browser, name, template, \"recordGeo\", \"\", \"far fa-map-marker\");\n\n    this.createSummaryFilter();\n  }\n\n  getRecordValue(record: Record): RecordGeoData {\n    return record.getValue(this);\n  }\n\n  /** Only supports \"geo\" encoding */\n  supportsRecordEncoding(coding: RecordVisCoding) {\n    return coding === \"geo\";\n  }\n\n  get measureRangeMax(): number {\n    return this.geoType === \"Point\" ? this._pointClusterRadius : 1;\n  }\n\n  // ********************************************************************\n  // Filtering\n  // ********************************************************************\n\n  public summaryFilter: Filter_Geo | null = null;\n\n  createSummaryFilter() {\n    this.summaryFilter = new Filter_Geo(this.browser, this);\n  }\n\n  // ********************************************************************\n  // Aggregates / geo-cache\n  // ********************************************************************\n\n  async loadGeo() {\n    if (this.recordGeoMap) {\n      await this.recordGeoMap.loadGeo();\n    }\n\n    this.browser.records.forEach((record) => {\n      var feature = this.template.func.call(record.data, record);\n      if (typeof feature === \"string\" && this.recordGeoMap) {\n        feature = this.recordGeoMap.getFeature(feature.toUpperCase());\n      }\n      if (feature) {\n        var g: RecordGeoData = {\n          geoFeat: feature,\n          _bounds: d3.geoBounds(feature),\n        };\n        this.geoType = feature.type;\n        record.setValue(this, g);\n      } else {\n        record.setValue(this, null);\n        this.noValueAggr.addRecord(record);\n      }\n    });\n  }\n\n  initializeAggregates(): void {\n    if (this.aggr_initialized) return;\n\n    this.aggr_initialized = true;\n  }\n\n  async applyConfig(blockCfg: SummarySpec) {\n    super.applyConfig(blockCfg);\n\n    if (blockCfg.recordGeo) {\n      this.recordGeoMap = Base.maps.get(blockCfg.recordGeo);\n      if (!this.recordGeoMap) {\n        this.recordGeoMap = null;\n      }\n    }\n  }\n\n  /** -- */\n  getRecordBounds(onlyIncluded) {\n    var bs = [];\n    this.browser.records.forEach((record) => {\n      if (onlyIncluded && record.filteredOut) return;\n      var v = this.getRecordValue(record);\n      if (!v) return;\n      if (!v._bounds) return;\n      var b = v._bounds;\n      if (isNaN(b[0][0])) return;\n      var p1 = L.latLng(b[0][1], b[0][0]);\n      var p2 = L.latLng(b[1][1], b[1][0]);\n      bs.push(p1);\n      bs.push(p2);\n    });\n    return new L.latLngBounds(bs);\n  }\n\n  // ********************************************************************\n  // Point cluster management\n  // ********************************************************************\n\n  readonly maxNodeRecordSize = 1000;\n\n  public PointCluster: any; // Supercluster library\n\n  async prepPointCluster(leafletMap) {\n    if (this.pointClusterRadius === 0) {\n      return;\n    }\n\n    if (!Supercluster) {\n      Supercluster = await import(\"supercluster\");\n    }\n\n    this.PointCluster = new Supercluster({\n      radius: this.pointClusterRadius, // in pixels\n      maxZoom: leafletMap.getMaxZoom() - 1,\n      minZoom: leafletMap.getMinZoom(),\n      //map: (props) => ({data: props.data}),\n    });\n\n    var points = [];\n    this.records.forEach((record) => {\n      points.push({\n        type: \"Feature\",\n        properties: record,\n        geometry: this.getRecordValue(record).geoFeat,\n      });\n    });\n\n    this.PointCluster.load(points);\n  }\n\n  updateClusters(_bounds, zoom) {\n    this.deletePointClusters();\n\n    var _clusters = this.PointCluster.getClusters(\n      [\n        _bounds.getWest(),\n        _bounds.getSouth(),\n        _bounds.getEast(),\n        _bounds.getNorth(),\n      ],\n      Math.floor(zoom)\n    );\n\n    _clusters.forEach((cluster) => {\n      if (!cluster.id) {\n        // single record\n        let record: Record = cluster.properties;\n        record._view.inCluster = false;\n        //\n      } else {\n        var clusterMembers = this.PointCluster.getLeaves(\n          cluster.id,\n          this.maxNodeRecordSize\n        );\n\n        var clusterAggr = new Aggregate_PointCluster(this, cluster);\n\n        clusterMembers.forEach((member) => {\n          let record: Record = member.properties;\n          record._view.inCluster = true;\n          if (record.isIncluded) {\n            clusterAggr.addRecord(record);\n          }\n        });\n\n        if (clusterAggr.records.length === 0) return;\n\n        if (clusterAggr.records.length === 1) {\n          // remove individual record from cluster\n          let record: Record = clusterAggr.records[0];\n          record._view.inCluster = false;\n          clusterAggr.clearRecords();\n          return;\n        }\n\n        this._aggrs.push(clusterAggr);\n        this.browser.allAggregates.push(clusterAggr);\n      }\n    });\n\n    // sort aggregates by active measure size\n    this._aggrs.sort((c1, c2) => c2.measure(\"Active\") - c1.measure(\"Active\"));\n  }\n\n  /** -- */\n  private deletePointClusters() {\n    // delete all clusters\n    this._aggrs.forEach((clusterAggr: Aggregate_PointCluster) => {\n      clusterAggr.clearRecords(); // removes cluster aggregate from record's aggregate index\n      clusterAggr.DOM.aggrGlyph.remove(); // removes the DOM item\n      this.browser.allAggregates.splice(\n        this.browser.allAggregates.indexOf(clusterAggr),\n        1\n      );\n    });\n    this.records.forEach((record: Record) => {\n      record._view.inCluster = false;\n    });\n    this._aggrs = [];\n  }\n\n  // ********************************************************************\n  // Cluster radius management\n  // ********************************************************************\n\n  private _pointClusterRadius: number = 50;\n  public get pointClusterRadius() {\n    return this._pointClusterRadius;\n  }\n\n  async setPointClusterRadius(_v, leafletRecordMap) {\n    // must be positive integer\n    this._pointClusterRadius = Math.round(Math.max(0, _v));\n    if (this.pointClusterRadius === 0) {\n      this.deletePointClusters();\n      return;\n    }\n    return await this.prepPointCluster(leafletRecordMap);\n  }\n\n  // ********************************************************************\n  // Export / import config\n  // ********************************************************************\n\n  exportConfig(): BlockSpec & SummaryConfig {\n    return {\n      pointClusterRadius: this._pointClusterRadius,\n    } as any;\n  }\n}\n","import { scaleTime, scaleLinear } from \"d3-scale\";\nimport { min, max, extent, deviation } from \"d3-array\";\nimport { format } from \"d3-format\";\nimport { easePolyInOut } from \"d3-ease\";\n\nimport { Config } from \"./Config\";\nimport { i18n } from \"./i18n\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { Attrib } from \"./Attrib\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\nimport { LinearOrLog, RecordVisCoding } from \"./Types\";\nimport { AttribTemplate } from \"./AttribTemplate\";\nimport { Base } from \"./Base\";\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\n\nconst d3 = {\n  scaleTime,\n  scaleLinear,\n  min,\n  max,\n  extent,\n  format,\n  deviation,\n  easePolyInOut,\n};\n\nvar _tempClipPathCounter;\n\n/** -- */\nexport class Attrib_Timeseries extends Attrib {\n  get measureRangeMax(): number {\n    throw new Error(\"Not applicable.\");\n  }\n\n  // hared with Attribute_Numeric\n  // accessed by RecordView_Timeseries\n  public hasFloat: boolean;\n\n  public tickPrecision = 3;\n\n  public timeKeys: TimeKey[] = [];\n\n  public timeKeyAttribs: Attrib_Numeric[] = [];\n\n  valueScaleType: Config<LinearOrLog>;\n\n  public timeSeriesScale_Time: any;\n  public timeSeriesScale_Value: any;\n\n  // given a number, returns the formatted string\n  numberFormat: (number) => string;\n\n  constructor(browser, name: string, template: AttribTemplate) {\n    super(browser, name, template, \"timeseries\", \"\", \"far fa-chart-line\");\n\n    this.measurable = {\n      metricFuncs: Base.defaultMetricFuncs\n    };\n\n    this.valueScaleType = new Config<LinearOrLog>({\n      cfgClass: \"valueScaleType\",\n      cfgTitle: \"BinScale\",\n      iconClass: \"fa fa-arrows-h\",\n      parent: this,\n      default: \"linear\",\n      helparticle: \"5e87eabc04286364bc97d0cf\",\n      itemOptions: [\n        { name: `${i18n.Linear} ${i18n.LinearSequence}`, value: \"linear\" },\n        { name: `${i18n.Log} ${i18n.Log2Sequence}`, value: \"log\" },\n      ],\n      forcedValue: () => {\n        if (!this.supportsLogScale()) return \"linear\";\n      },\n      preSet: async (v) => {\n        if (v !== \"log\" && v !== \"linear\") return;\n        // don't set to log if it's not applicable\n        return v;\n      },\n      onSet: async (v) => {\n        if (!this.timeSeriesScale_Value) return;\n\n        for (var c in this.timeKeyAttribs) {\n          var s = this.timeKeyAttribs[c];\n          if (s.timeKey) await s.applyScaleType();\n        }\n\n        this.timeSeriesScale_Value = Util.getD3Scale(v === \"log\").domain(\n          this.getExtent_Value()\n        );\n\n        await this.browser.recordDisplay.refreshAttribScaleType(this);\n      },\n    });\n\n    this.numberFormat = (x) => {\n      if (this.hasFloat && x < 1000) {\n        return d3.format(\",.3~f\")(x);\n      }\n      var m = d3.format(\".3~s\")(x); // if input is 9, it returns 9.0 . ARGH!\n      return m.replace(\".0\", \"\");\n    };\n\n    this.finishTemplateSpecial();\n  }\n\n  getRecordValue(record: Record): TimeSeriesData {\n    return record.getValue(this);\n  }\n\n  /** -- */\n  supportsRecordEncoding(coding: RecordVisCoding): boolean {\n    if (this.isEmpty()) return false;\n    this.initializeAggregates();\n    if (this.isComparable.is(false)) return false;\n    if (coding === \"timeSeries\") return true;\n    if (coding === \"sort\") return true;\n    if (coding === \"scatterX\") return true;\n    if (coding === \"scatterY\") return true;\n    if (coding === \"color\") return true;\n    if (coding === \"size\") {\n      return !this.hasNegativeValues();\n    }\n    return false;\n  }\n  /** -- */\n  isEmpty() {\n    return !this.timeKeys || this.timeKeys.length === 0;\n  }\n  /** -- */\n  get canHaveMetricFuncs() {\n    return true;\n  }\n  /** -- */\n  get supportedMetricFuncs() {\n    return this._metricFuncs;\n  }\n  /** -- */\n  supportsLogScale(): boolean {\n    if (!this.timeSeriesScale_Value) {\n      return true; // assume it supports by default\n    }\n    return (\n      this.timeSeriesScale_Value &&\n      this.timeSeriesScale_Value.domain().every((_) => _ > 0)\n    );\n    // Do not filter by unitName!==\"%\" - in some cases it may make sense\n  }\n  /** -- */\n  hasNonNegativeValueDomain() {\n    return this.timeSeriesScale_Value.domain().every((_) => _ >= 0);\n  }\n\n  get attribName(): string {\n    return super.attribName;\n  }\n  set attribName(name: string) {\n    super.attribName = name;\n\n    // name wasn't updated\n    if (this.attribName !== name) return;\n\n    for (var timeKey in this.timeKeyAttribs) {\n      var attrib = this.timeKeyAttribs[timeKey];\n      attrib.attribName = `${this.attribName} <i class=\"far fa-calendar-day\"></i> ${attrib.timeKey._time_src}`;\n    }\n\n    // Refresh other places which is linked to this timeseries variable\n    if (this.browser.recordChartType.is(\"timeseries\")) {\n      this.browser.recordDisplay.refreshAttribOptions(\"timeSeries\");\n    }\n\n    this.browser.recordDisplay.refreshAttribOptions(\"sort\");\n  }\n\n  /** -- */\n  updateChartScale_Measure(): void {\n    // no-op\n  }\n\n  applyTemplateSpecial(): void {\n    if (this.template.special === \"TimeseriesChange-%\") {\n      this.unitName = \"%\";\n    }\n  }\n\n  /** -- */\n  initializeAggregates(): void {\n    if (this.aggr_initialized) return;\n\n    var timeIndex: { [index: number]: string } = {};\n    var extent_Time: [Date, Date][] = [];\n    var extent_Value: [number, number][] = [];\n    var allRecordValues: number[] = [];\n\n    this.browser.records.forEach((record: Record) => {\n      var _ = this.template.func.call(record.data, record);\n      if (_ == null) {\n        record.setValue(this, null);\n        return;\n      }\n\n      var ts = _ as TimeSeriesData;\n\n      record.setValue(this, ts);\n\n      ts.sortTimeseries();\n\n      ts.computeCaches();\n\n      // per whole attribute\n      ts._timeseries_.forEach((k: TimeData) => {\n        timeIndex[k._time.getTime()] = k._time_src;\n        allRecordValues.push(k._value);\n      });\n      extent_Time.push(ts.extent_Time);\n      extent_Value.push(ts.extent_Value);\n    });\n\n    if (extent_Time.length === 0) {\n      this.aggr_initialized = true;\n      return;\n    }\n\n    // min of the min's, max of the max's\n    var valueDomain: [number, number] = this.valueDomain || [\n      d3.min(extent_Value, (_) => _[0]),\n      d3.max(extent_Value, (_) => _[1]),\n    ];\n    var timeDomain: [Date, Date] = [\n      d3.min(extent_Time, (_) => _[0]),\n      d3.max(extent_Time, (_) => _[1]),\n    ];\n\n    // Figure out if the values are floating points or full integers\n    this.hasFloat = allRecordValues.some((v) => v % 1 !== 0);\n\n    if (!this.hasFloat) {\n      this.tickPrecision = valueDomain[1].toLocaleString().length > 5 ? 3 : 0;\n    }\n\n    // Set scale\n    var deviation = d3.deviation(allRecordValues);\n    var activeRange = valueDomain[1] - valueDomain[0];\n    this.valueScaleType.set(\n      (deviation / activeRange < 0.12 && valueDomain[0] > 0) ? \"log\" : \"linear\"\n    );\n\n    // Currently static settings once a timeseries is selected\n    this.timeSeriesScale_Time = d3.scaleTime().domain(timeDomain);\n    this.timeSeriesScale_Value = Util.getD3Scale(this.isValueScale_Log);\n    this.timeSeriesScale_Value.domain(valueDomain);\n\n    for (var _ in timeIndex) {\n      this.timeKeys.push({\n        _time: new Date(Number(_)), // convert string to number\n        _time_src: timeIndex[_],\n      });\n    }\n    this.timeKeys.sort((a, b) => a._time.getTime() - b._time.getTime());\n    this.timeKeys.forEach((timeKey, i) => {\n      timeKey._index = i;\n    });\n\n    // Some records may be missing some values on some time-keys.\n    // Here, we need to insert new time keys and set them to undefined\n    // Charting will take care whether to interpolate the missing values or not.\n    this.browser.records.forEach((record) => {\n      var _ts: TimeSeriesData | null = this.getRecordValue(record);\n      if (!_ts) return;\n\n      var newTimeKeyAdded = false;\n\n      this.timeKeys.forEach((_key: TimeKey) => {\n        if (!_ts._keyIndex[_key._time_src]) {\n          _ts.addTimeData({\n            _time: _key._time,\n            _time_src: _key._time_src,\n            _value: undefined,\n          });\n          newTimeKeyAdded = true;\n        }\n      });\n\n      if (newTimeKeyAdded) {\n        _ts.sortTimeseries();\n      }\n    });\n\n    this.aggr_initialized = true;\n  }\n\n  /** -- */\n  getExtent_Value(onlyUnfiltered = false, timeDomain: [Date, Date] = null) {\n    if (!onlyUnfiltered && this.valueDomain) {\n      return this.valueDomain;\n    }\n\n    var inTimeDomain = (_d: TimeData) => true;\n    if (timeDomain) {\n      inTimeDomain = (d: TimeData) =>\n        d._time >= timeDomain[0] && d._time <= timeDomain[1];\n    }\n\n    var extent_Value: [number, number][] = [];\n\n    var valFunc = (k: TimeData): number => (inTimeDomain(k) ? k._value : null);\n    if (this.isValueScale_Log) {\n      valFunc = (k: TimeData): number => (inTimeDomain(k) && k._value > 0 ? k._value : null);\n    }\n\n    this.browser.records.forEach((record) => {\n      if (onlyUnfiltered && record.filteredOut) return;\n      var _ts = this.getRecordValue(record);\n      if (!_ts) return;\n\n      _ts.extent_Value = d3.extent(_ts._timeseries_, valFunc);\n      if (typeof _ts.extent_Value[0] === \"number\") {\n        extent_Value.push(_ts.extent_Value);\n      }\n    });\n\n    return [\n      d3.min(extent_Value, (_) => _[0]),\n      d3.max(extent_Value, (_) => _[1]),\n    ];\n  }\n\n  /** -- */\n  hasNegativeValues() {\n    return d3.min(this.timeSeriesScale_Value.domain()) < 0;\n  }\n  /** -- */\n  hasFlippedDomain() {\n    var tsDomain = this.timeSeriesScale_Value.domain();\n    return tsDomain[0] > tsDomain[1];\n  }\n\n  /** -- */\n  computeRecordRanks() {\n    this.timeKeys.forEach((timeKey: TimeKey) => {\n      // sort records in place\n      var compFunc = this.hasFlippedDomain()\n        ? (vA: TimeData, vB: TimeData) => vA._value - vB._value\n        : (vA: TimeData, vB: TimeData) => vB._value - vA._value;\n\n      var getValueAtTime = (record: Record, key: string): TimeData => {\n        var v = this.getRecordValue(record);\n        if (!v || v.isEmpty()) return null;\n        let v2 = v._keyIndex[key];\n        if (v2 == null) return null;\n        return v2;\n      };\n\n      // sorts a copied record list, and assigns _rank.\n      Array.from(this.browser.records)\n        .sort((a: Record, b: Record) => {\n          if (a.filteredOut) return 1;\n          if (b.filteredOut) return -1;\n\n          var vA = getValueAtTime(a, timeKey._time_src);\n          if (vA == null) return 1;\n\n          var vB = getValueAtTime(b, timeKey._time_src);\n          if (vB == null) return -1;\n\n          return compFunc(vA, vB);\n        })\n        .forEach((record: Record, i) => {\n          var v: TimeData = getValueAtTime(record, timeKey._time_src);\n          if (v != null) v._rank = i + 1;\n        });\n    });\n  }\n\n  /** -- */\n  get isValueScale_Log() {\n    return this.valueScaleType.is(\"log\");\n  }\n  get isValueScale_Linear() {\n    return this.valueScaleType.is(\"linear\");\n  }\n\n  // No-ops\n  createSummaryFilter() {}\n  refreshViz_Compare() {}\n\n  // ********************************************************************\n  // Accessing specific timepoint attributes\n  // ********************************************************************\n\n  /** -- */\n  setTimepointAttrib(timePoint, summary: Attrib_Numeric) {\n    if (typeof timePoint === \"string\" || !timePoint._time) {\n      timePoint = this.timeKeys.filter((key) => key._time_src === timePoint)[0];\n      if (!timePoint) return; // nope\n    }\n    summary.timeKey = timePoint;\n    this.timeKeyAttribs[timePoint._time_src] = summary;\n  }\n\n  /** -- */\n  getTimepointSummary_Next(curSummary, shift = 1) {\n    this.initializeAggregates(); // make sure the summary is ready\n    if (this.isEmpty()) return null;\n    var timeKey = curSummary.timeKey._time_src;\n    if (!timeKey) return null;\n\n    // Return null if end of keys\n    var curIndex = -1;\n    this.timeKeys.some((key, i) => {\n      if (key._time_src === timeKey) {\n        curIndex = i;\n        return true;\n      }\n    });\n\n    // check if new value is in range\n    if (shift > 0 && curIndex === this.timeKeys.length - 1) {\n      return null;\n    }\n    if (shift < 0 && curIndex === 0) {\n      return null;\n    }\n    var target = Math.min(\n      this.timeKeys.length - 1,\n      Math.max(0, curIndex + shift)\n    );\n    return this.getTimepointSummary(this.timeKeys[target]);\n  }\n\n  /** - */\n  getTimepointSummary(timePoint): Attrib_Numeric {\n    this.initializeAggregates(); // make sure the summary is ready\n    var attrib = this.timeKeyAttribs[timePoint._time_src];\n    if (!attrib) {\n      attrib = this.browser.createAttrib(\n        `${this.attribName} <i class=\"far fa-calendar-day\"></i> ${timePoint._time_src}`,\n        `${this.template}->${timePoint._time_src}`,\n        \"numeric\"\n      ) as Attrib_Numeric;\n      this.setTimepointAttrib(timePoint, attrib);\n      attrib.initializeAggregates();\n    }\n    return attrib;\n  }\n\n  /** -- */\n  printAbbr(v: TimeData, isSVG = false) {\n    // uses print from a timeKey summary\n    return this.getTimepointSummary(this.timeKeys[0]).printAbbr(v._value, isSVG);\n  }\n  /** -- */\n  getFormattedValue(v, isSVG = false) {\n    var formatted = this.numberFormat(v);\n    return v == null ? \"-\" : Util.addUnitName(formatted, this.unitName, isSVG);\n  }\n  /** -- */\n  async applyConfig(blockCfg) {\n    super.applyConfig(blockCfg);\n\n    this.measurable.valueDomain = blockCfg.valueDomain;\n\n    if (blockCfg.valueScaleType) {\n      await this.valueScaleType.set(blockCfg.valueScaleType);\n    }\n    if (blockCfg.unitName) {\n      this.unitName = blockCfg.unitName;\n    }\n  }\n  /** -- */\n  exportConfig() {\n    return Object.assign(\n      super.exportConfig(), \n      {\n        unitName: this.unitName,\n        valueScaleType: this.valueScaleType.get(),\n      });\n  }\n  /** -- */\n  renderRecordValue(v, d3_selection, timeKeys = null): string {\n    if (v instanceof Record) v = this.getRecordValue(v);\n\n    if (!d3_selection || !v) return;\n\n    if(!(v instanceof TimeSeriesData)) return\n\n    this.initializeAggregates();\n\n    var timeseriesWidth = this.browser.recordDisplay.config.timeseriesWidth;\n\n    var timeScale = d3\n      .scaleTime()\n      .domain(d3.extent(timeKeys, (f) => f._time))\n      .rangeRound([5, timeseriesWidth - 5]);\n\n    let timeData: TimeData[] = v._timeseries_;\n\n    var [value_min, value_max] = d3.extent(timeData, (d) => d._value);\n    var steadyValue = false;\n    if (value_min === value_max) {\n      steadyValue = value_max;\n      value_min -= 0.00001;\n      value_max += 0.00001;\n    } else if (this.hasFlippedDomain()) {\n      // if the timeseries value-axis is flipped\n      [value_min, value_max] = [value_max, value_min];\n    }\n\n    var valueScale = d3\n      .scaleLinear()\n      .domain([value_min, value_max])\n      .rangeRound([40, 0]);\n\n    _tempClipPathCounter++;\n\n    var colorOut = this.browser.colorTheme.getContinuous();\n    var mapp = this.timeSeriesScale_Value.copy().range([0, 1]);\n\n    var _timeSeriesSvg = d3_selection\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .attr(\"class\", \"recordDetailTimeseries\")\n      .style(\"width\", timeseriesWidth + \"px\");\n\n    var defs = _timeSeriesSvg.append(\"defs\");\n    defs\n      .append(\"clipPath\")\n      .attr(\"id\", \"RecordTimeseriesClip_\" + _tempClipPathCounter)\n      .append(\"rect\")\n      .attr(\"class\", \"recordTimeseriesClipPath\")\n      .attr(\"x\", 0)\n      .attr(\"y\", -10)\n      .attr(\"height\", 70)\n      .attr(\"width\", 1)\n      .transition()\n      .duration(1500)\n      .delay(0)\n      .ease(d3.easePolyInOut)\n      .attr(\"width\", timeseriesWidth + 10);\n\n    var _ = defs\n      .append(\"linearGradient\")\n      .attr(\"id\", \"GradientPath_\" + _tempClipPathCounter)\n      .attr(\"x1\", \"0\")\n      .attr(\"x2\", \"0\")\n      .attr(\"y1\", \"0\")\n      .attr(\"y2\", \"1\");\n    _.append(\"stop\")\n      .attr(\"stop-color\", colorOut(mapp(value_max)))\n      .attr(\"offset\", \"0%\");\n    _.append(\"stop\")\n      .attr(\"stop-color\", colorOut(mapp(value_min)))\n      .attr(\"offset\", \"100%\");\n\n    _timeSeriesSvg\n      .selectAll(\".extentValueGroup\")\n      .data(steadyValue !== false ? [steadyValue] : [value_min, value_max])\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"extentValueGroup\")\n      .attr(\"transform\", (d) => `translate(0,${valueScale(d)})`)\n      .call((_) => {\n        _.append(\"text\")\n          .attr(\"class\", \"extentText\")\n          .html((timeData) => this.printAbbr(timeData, true))\n          .attr(\"x\", timeseriesWidth + 6);\n        _.append(\"line\")\n          .attr(\"class\", \"extentLine\")\n          .attr(\"x1\", 0)\n          .attr(\"x2\", timeseriesWidth)\n          .attr(\"y1\", 0)\n          .attr(\"y2\", 0);\n      });\n\n    var maxChar = timeKeys.reduce(\n      (accum, key) => Math.max(accum, key._time_src.length),\n      0\n    );\n    var tickGapWidth = maxChar * 7;\n\n    var lastTickPos = 30000;\n    _timeSeriesSvg\n      .append(\"g\")\n      .attr(\"class\", \"extentYearGroup\")\n      .selectAll(\".extentYear\")\n      .data(timeKeys)\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"extentYear\")\n      .attr(\"y\", 53)\n      .attr(\"x\", (tick) => timeScale(tick._time))\n      .html((tick) => tick._time_src)\n      .style(\"opacity\", (tick) => {\n        var newTickPos = timeScale(tick._time);\n        if (lastTickPos - newTickPos < tickGapWidth) return 0;\n        lastTickPos = newTickPos;\n        return 0.8;\n      });\n\n    _timeSeriesSvg\n      .append(\"g\")\n      .attr(\n        \"clip-path\",\n        'url(\"#RecordTimeseriesClip_' + _tempClipPathCounter + '\")'\n      )\n      .call((_g) => {\n        _g.append(\"path\")\n          .attr(\"class\", \"recordTimeseriesLine\")\n          .datum(timeData)\n          .attr(\"d\", Util.getLineGenerator(timeScale, valueScale))\n          .attr(\n            \"stroke\",\n            steadyValue !== false\n              ? colorOut(mapp(value_max))\n              : \"url(#GradientPath_\" + _tempClipPathCounter + \")\"\n          );\n\n        _g.selectAll(\".recordTimeseriesDot\")\n          .data(timeData.filter((_: TimeData) => !!_._value)) // only use the entries which have a _value set\n          .enter()\n          .append(\"circle\")\n          .attr(\"class\", \"recordTimeseriesDot\")\n          .attr(\"r\", 3)\n          .attr(\"cx\", (d) => timeScale(d._time))\n          .attr(\"cy\", (d) => valueScale(d._value))\n          .attr(\"fill\", (d) => colorOut(mapp(d._value)))\n          .tooltip(\n            (d) =>\n              \"<div class='recordColorInfo'>\" +\n              \"<span class='mapTooltipLabel'>\" +\n              \"<i class='far fa-calendar'></i> \" +\n              d._time_src +\n              \"</span><br> \" +\n              \"<b><span class='mapTooltipValue'>\" +\n              this.getFormattedValue(d._value) +\n              \"</span></b>\" +\n              \"</div>\",\n            {\n              theme: \"dark timeseriesRecordDot\",\n              placement: \"top\",\n            }\n          )\n          .on(\"click\", (_event, d) => this.browser.recordDetailsPopup.updateFocusedTimeKey(d));\n      });\n  }\n}\n","import { select, pointer } from \"./d3_select\";\nimport { scaleQuantize } from \"d3-scale\";\nimport { max } from \"d3-array\";\nimport { format } from \"d3-format\";\nimport { hsl } from \"d3-color\";\nimport { geoBounds, geoPath, geoTransform } from \"d3-geo\";\n\nimport DOMPurify from \"dompurify/dist/purify.es\";\n\nimport { Aggregate_Category } from \"./Aggregate_Category\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Attrib_Set } from \"./Attrib_Set\";\nimport { Modal } from \"./UI/Modal\";\nimport { Block } from \"./Block\";\nimport { Base } from \"./Base\";\nimport { i18n } from \"./i18n\";\nimport { Util } from \"./Util\";\n\nimport {\n  CompareType,\n  DropdownType,\n  MeasureType,\n  SummaryCatView,\n} from \"./Types\";\n\ndeclare let L: any;\n\nconst d3 = {\n  select,\n  pointer,\n  max,\n  format,\n  hsl,\n  geoBounds,\n  geoPath,\n  geoTransform,\n  scaleQuantize,\n};\n\nexport class Block_Categorical extends Block {\n  // specific attribute type\n  public readonly attrib: Attrib_Categorical;\n  constructor(attrib: Attrib_Categorical) {\n    super(attrib);\n  }\n\n  get _aggrs(): Aggregate_Category[] {\n    return this.attrib._aggrs;\n  }\n\n  get setAttrib(): Attrib_Set | null {\n    return this.attrib.setAttrib;\n  }\n\n  // ********************************************************************\n  // Collapse / add / remove pansl\n  // ********************************************************************\n\n  setCollapsed(v: boolean): void {\n    super.setCollapsed(v);\n    if (this.leafletAttrMap && !this.collapsed) {\n      setTimeout(() => {\n        this.leafletAttrMap.invalidateSize();\n        this.catMap_zoomToActive();\n      }, 500);\n    }\n    if (this.collapsed && this.setAttrib) {\n      this.showSetMatrix(false);\n    }\n  }\n\n  onCollapse() {\n    if (!this.collapsed && this.DOM.root && this.isView_List) {\n      if (this.attrib.dirtySort) {\n        this.updateCatSorting_now();\n        this.refreshViz_All();\n      }\n      this.refreshLabelWidth();\n      this.catList_cullCategories();\n    }\n  }\n\n  addToPanel(panel, index, force = false) {\n    var _do = () => {\n      super.addToPanel(panel, index);\n\n      if (this.setAttrib) {\n        if (this.panel.name === \"left\" || this.panel.name === \"right\") {\n          this.setAttrib.block.refreshPopupSide();\n        } else {\n          this.hideSetMatrix();\n        }\n      }\n\n      this.browser.updateLayout();\n    };\n\n    if (\n      this._aggrs.length > 500 &&\n      this.attrib.minAggrSize.get() === 1 &&\n      !force\n    ) {\n      Modal.confirm(\n        \"<div style='text-align:center'>There are many (\" +\n          this._aggrs.length.toLocaleString() +\n          \") \" +\n          \"categories in \" +\n          this.attrib.attribName +\n          \".<br>\" +\n          \"Adding all can make your dashboard slower.<br><br>\" +\n          \"Would you like to hide categories with 5 or less records?</div>\",\n        \"Hide small categories\",\n        \"Show all categories\"\n      )\n        .then(async () => await this.attrib.minAggrSize.set(5))\n        .finally(() => _do());\n    } else {\n      _do();\n    }\n  }\n\n  // ********************************************************************\n  // View type control\n  // ********************************************************************\n\n  public viewType: SummaryCatView = \"list\";\n\n  get isView_Dropdown() {\n    return this.viewType === \"dropdown\";\n  }\n  get isView_List() {\n    return this.viewType === \"list\";\n  }\n  get isView_Map() {\n    return this.viewType === \"map\";\n  }\n\n  async catViewAs(_type) {\n    if (_type === \"map\") {\n      try {\n        if (!this.attrib.catGeo) throw new Error(\"No mapping specified\");\n\n        if (!(window as any).L) {\n          await import(\"leaflet\");\n        }\n\n        await this.attrib.loadMap();\n\n        this.mapIsReady = false;\n      } catch (error) {\n        console.log(error);\n        Modal.alert(error.message);\n        this.catViewAs(\"list\");\n        return;\n      }\n    }\n\n    this.viewType = _type;\n\n    this.noRefreshVizAxis = this.isView_Dropdown;\n\n    if (!this.DOM.inited) return;\n    this.DOM.root.attr(\"viewType\", this.viewType);\n    this.DOM.root.selectAll(\".summaryViewAs\").classed(\"active\", false);\n    this.DOM.root\n      .selectAll(\".summaryViewAs_\" + this.viewType)\n      .classed(\"active\", true);\n\n    if (this.viewType === \"list\") {\n      this.list_prepView();\n    } else if (this.viewType === \"map\") {\n      this.catMap_prepView();\n    } else if (this.viewType === \"dropdown\") {\n      this.dropdown_prepView();\n    }\n  }\n\n  // ********************************************************************\n  // Height\n  // ********************************************************************\n\n  private _height_Categories = 0;\n\n  public heightRow_category_dirty = false;\n\n  get height_Categories(): number {\n    return this._height_Categories;\n  }\n  get height_Content(): number {\n    if (!this.isVisible()) return 0;\n    if (this.isView_Dropdown) return this.height_Dropdown;\n    return (\n      this._height_Categories + this.height_Config + this.height_Bottom + 1\n    );\n  }\n  get height_RangeMin(): number {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    if (this.isView_Dropdown) return this.height_Dropdown;\n    if (this.isView_Map) return this.getWidth() * 0.2;\n    return this.height_ListWithoutCats + 1.5 * this.heightCat;\n  }\n  get height_RangeMax(): number {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    if (this.isView_Dropdown) return this.height_Dropdown;\n    if (this.isView_Map) return this.getWidth() * 1.5;\n    return this.height_ListWithoutCats + this._aggrs.length * this.heightCat;\n  }\n  get heightCat(): number {\n    return this.attrib.barHeight.get();\n  }\n  get height_Dropdown(): number {\n    return 42;\n  }\n  get height_ListWithoutCats(): number {\n    return this.height_Header + this.height_Config + this.height_Bottom;\n  }\n  get height_VisibleAttrib(): number {\n    return this.catCount_Active * this.heightCat;\n  }\n  get height_Config(): number {\n    return 18 * (this.hasTextSearch() ? 1 : 0);\n  }\n  get height_bar_topGap(): number {\n    return this.heightCat > 20 ? 4 : 2;\n  }\n  get barHeight_Full(): number {\n    return this.heightCat - 2 * this.height_bar_topGap;\n  }\n  get height_Bottom(): number {\n    if (\n      !this.areAllCatsInDisplay() ||\n      !this.panel.hiddenCatBars() ||\n      this._aggrs.length > 4\n    ) {\n      this.DOM.summaryCategorical?.classed(\"nobottoms\", false);\n      return Base.height_CatBottom;\n    }\n    this.DOM.summaryCategorical?.classed(\"nobottoms\", true);\n    return 0;\n  }\n  /** -- */\n  get catLabelFontSize() {\n    var fontSize = this.heightCat - 2;\n    if (this.heightCat > 15) fontSize = 13;\n    if (this.heightCat > 25) fontSize = 15;\n    if (this.heightCat > 30) fontSize = 17;\n    if (this.heightCat > 35) fontSize = 19;\n    return fontSize;\n  }\n\n  hasStaticHeight(): boolean {\n    return this.isView_Dropdown;\n  }\n\n  setHeight(targetHeight: number): void {\n    if (this.attrib.isEmpty()) return;\n    // take into consideration the other components in the summary\n    targetHeight -=\n      this.height_Header + this.height_Config + this.height_Bottom;\n\n    if (this.isView_Map) {\n      this._height_Categories = targetHeight;\n      setTimeout(() => {\n        if (this.leafletAttrMap) this.leafletAttrMap.invalidateSize();\n      }, 700);\n      return;\n    }\n\n    this._height_Categories = Math.min(\n      targetHeight,\n      this.heightCat * this.catCount_Active - 1\n    );\n  }\n  refreshHeight_Category() {\n    if (!this.DOM.inited) return;\n    if (!this.isView_List) return;\n\n    this.heightRow_category_dirty = false;\n\n    this.browser.updateLayout();\n\n    this.DOM.aggrGlyphs.style(\"transform\", (_cat) => _cat.transformPos);\n\n    this.refreshHeight_Category_do();\n  }\n  /** -- */\n  refreshHeight_Category_do() {\n    this.DOM.aggrGlyphs.style(\"height\", this.heightCat + \"px\");\n\n    this.DOM.root\n      .selectAll(\".catLabel\")\n      .style(\"font-size\", this.catLabelFontSize + \"px\");\n\n    this.DOM.chartBackground.style(\"height\", this.height_VisibleAttrib + \"px\");\n\n    this.DOM.catChart.classed(\n      \"multiLine\",\n      this.heightCat >= 56 && // 4x\n        this.DOM.root.node().style.webkitLineClamp !== undefined\n    );\n\n    this.refreshViz_All();\n  }\n\n  refreshHeight() {\n    super.refreshHeight();\n    if (this.attrib.isEmpty() || !this.inDashboard || !this.DOM.inited) return;\n    if (this.isView_Dropdown) return;\n\n    // It can be collapsed! - don't use \"isVisible\" fucntion here\n    if (this.collapsed) {\n      if (this.isView_Map) this.DOM.catMap_Base.style(\"height\", \"0px\");\n      return;\n    }\n\n    // update catCount_InDisplay\n    var c = Math.floor(this._height_Categories / this.heightCat);\n    if (c < 0) c = 1;\n    if (c > this.catCount_Active) c = this.catCount_Active;\n    if (this.catCount_Active <= 2) {\n      c = this.catCount_Active;\n    } else {\n      c = Math.max(c, 2);\n    }\n    this.catCount_InDisplay = c + 1;\n    this.catCount_InDisplay = Math.min(\n      this.catCount_InDisplay,\n      this.catCount_Active\n    );\n\n    this.refreshScrollDisplayMore(\n      this.firstCatIndexInView + this.catCount_InDisplay\n    );\n\n    this.updateCats_IsVisible();\n    this.catList_cullCategories();\n\n    this.DOM.headerGroup.attr(\"allCatsInDisplay\", this.areAllCatsInDisplay());\n\n    if (this.isView_Map) {\n      this.DOM.catMap_Base.style(\"height\", null);\n      if (this.leafletAttrMap) this.leafletAttrMap.invalidateSize();\n    }\n  }\n\n  catList_cullCategories() {\n    if (!this.isView_List) return;\n    if (!this.DOM.aggrGlyphs) return;\n    this.DOM.aggrGlyphs\n      .style(\"display\", (_cat) => (_cat.isVisible ? null : \"none\"))\n      .style(\"opacity\", (_cat) => (_cat.isVisible ? 1 : 0))\n      .style(\"transform\", (_cat) =>\n        _cat.isVisible ? `translate(0px,${_cat.posY}px)` : null\n      );\n\n    if (this.setAttrib && !this.setAttrib.block.pausePanning) {\n      this.setAttrib.block.refreshSVGViewBox();\n    }\n  }\n\n  refreshConfigRowCount() {\n    this.DOM.summaryControls?.style(\n      \"display\",\n      this.hasTextSearch() ? \"block\" : null\n    );\n    this.DOM.wrapper?.classed(\"showMeasureAxis_2\", this.hasTextSearch());\n    this.DOM.catTextSearch?.classed(\"active\", this.hasTextSearch());\n  }\n\n  // ********************************************************************\n  // Width\n  // ********************************************************************\n\n  get width_CatLabel() {\n    return this.isVisible() ? this.panel.width_CatLabel : 0;\n  }\n  get width_CatMeasureLabel() {\n    return this.isVisible() ? this.panel.width_CatMeasureLabel : 0;\n  }\n  get width_CatText() {\n    return this.isVisible() ? this.panel.width_CatText : 0;\n  }\n  get width_CatChart() {\n    return this.isVisible() ? this.panel.width_CatBars : 1;\n  }\n  refreshWidth(): void {\n    if (!this.DOM.summaryCategorical) return;\n    this.attrib.updateChartScale_Measure(); // refreshes viz axis if needed\n    if (this.isView_List) {\n      this.DOM.chartAxis_Measure.style(\"width\", this.width_CatChart + 5 + \"px\");\n    }\n    if (this.isView_Map && this.mapIsReady) {\n      this.leafletAttrMap.invalidateSize();\n    }\n  }\n\n  // ********************************************************************\n  // Text search\n  // ********************************************************************\n\n  skipTextSearchClear: boolean = false;\n\n  hasTextSearch(): boolean {\n    return this._aggrs.length >= 15;\n  }\n\n  initDOM_CatTextSearch() {\n    var me = this;\n    this.DOM.catTextSearch = this.DOM.summaryControls\n      .append(\"div\")\n      .attr(\"class\", \"textSearchBox catTextSearch hasLabelWidth\");\n\n    this.DOM.catTextSearch.append(\"span\").attr(\"class\", \"far fa-search\");\n    this.DOM.catTextSearch\n      .append(\"span\")\n      .attr(\"class\", \"fa fa-times-circle\")\n      .tooltip(i18n.ClearTextSearch)\n      .on(\"click\", () => this.attrib.summaryFilter.clearFilter());\n    this.DOM.catTextSearchInput = this.DOM.catTextSearch\n      .append(\"input\")\n      .attr(\"class\", \"textSearchInput\")\n      .attr(\"type\", \"text\")\n      .attr(\"placeholder\", \"...\")\n      .tooltip(i18n.Search)\n      .on(\"keydown\", (event) => event.stopPropagation())\n      .on(\"keypress\", (event) => event.stopPropagation())\n      .on(\"keyup\", (event) => event.stopPropagation())\n      .on(\"input\", function () {\n        this.tippy.hide();\n        if (this.timer) clearTimeout(this.timer);\n        var x = this;\n        this.timer = setTimeout(function () {\n          me.attrib.unselectAllCategories();\n          var query = [];\n\n          // split the query by \" character\n          var processed = x.value.toLowerCase().split('\"');\n          processed.forEach((block, i) => {\n            if (i % 2 === 0) {\n              block.split(/\\s+/).forEach((q) => query.push(q));\n            } else {\n              query.push(block);\n            }\n          });\n\n          // Remove the empty strings\n          query = query.filter((v) => v !== \"\");\n\n          if (query.length > 0) {\n            me.DOM.catTextSearch.classed(\"showClear\", true);\n            me._aggrs.forEach((_cat) => {\n              var catLabel = _cat.label.toString().toLowerCase();\n              var f = query.every((query_str) => {\n                if (catLabel.indexOf(query_str) !== -1) {\n                  return true;\n                }\n                return false;\n              });\n              if (f) {\n                _cat.set_OR(me.attrib.summaryFilter.selected_OR);\n              } else {\n                _cat.set_NONE();\n              }\n            });\n\n            // All categories are process, and the filtering state is set. Now, process the summary as a whole\n            if (me.attrib.summaryFilter.selectedCount_Total() === 0) {\n              me.skipTextSearchClear = true;\n              me.attrib.summaryFilter.clearFilter();\n              me.skipTextSearchClear = false;\n            } else {\n              me.attrib.summaryFilter.how = \"All\";\n              me.attrib.noValueAggr.filtered = false;\n              me.attrib.summaryFilter.setFiltered();\n            }\n          } else {\n            me.attrib.summaryFilter.clearFilter();\n          }\n        }, 750);\n      });\n  }\n\n  clearCatTextSearch() {\n    if (!this.hasTextSearch()) return;\n    if (this.skipTextSearchClear) return;\n    if (!this.DOM.catTextSearch) return;\n    this.DOM.catTextSearch.classed(\"showClear\", false);\n    this.DOM.catTextSearchInput.node().value = \"\";\n  }\n\n  // ********************************************************************\n  // Managing in-display / visible categories\n  // ********************************************************************\n\n  isCatActive(_cat: Aggregate_Category) {\n    if (!_cat.usedAggr) return false;\n    if (_cat.isFiltered()) return true;\n    if (_cat.recCnt('Active') !== 0) return true;\n    if (!this.attrib.isFiltered()) return _cat.recCnt('Active') !== 0;\n    if (this.viewType === \"map\") return _cat.recCnt('Active') !== 0;\n    // Hide if multiple options are selected and selection is and\n    //        if(this.summaryFilter.selecttype===\"SelectAnd\") return false;\n    // TO-DO: Figuring out non-selected, zero-active-item attribs under \"SelectOr\" is tricky!\n    return true;\n  }\n\n  public catCount_InDisplay = 0;\n  public catCount_Active: number;\n  private firstCatIndexInView = 0;\n\n  areAllCatsInDisplay() {\n    return this.catCount_Active === this.catCount_InDisplay;\n  }\n  updateCats_IsActive() {\n    this.catCount_Active = 0;\n    this._aggrs.forEach((_cat) => {\n      _cat.isActiveBefore = _cat.isActive;\n      _cat.isActive = this.isCatActive(_cat);\n      if (_cat.isActive) this.catCount_Active++;\n    });\n    if (this.attrib.catOrder_Fixed) {\n      // if fixed, categories do not roll up on each other, the total count is still original count\n      this.catCount_Active = this._aggrs.length;\n    }\n  }\n  updateCats_IsVisible() {\n    var maxVisibleNumCats = Math.ceil(\n      (this.scrollTop_cache + this._height_Categories) / this.heightCat\n    );\n    this._aggrs.forEach((_cat) => {\n      _cat.isVisibleBefore = _cat.isVisible;\n      _cat.isVisible =\n        this.viewType === \"map\"\n          ? true\n          : _cat.isActive &&\n            _cat.orderIndex >= this.firstCatIndexInView &&\n            _cat.orderIndex < maxVisibleNumCats;\n    });\n  }\n\n  // ********************************************************************\n  // Active / Compare visualizations\n  // ********************************************************************\n\n  vizSideBySide() {\n    if (this.browser.stackedChart) return false;\n    if (this.browser.activeComparisonsCount < 2) return false;\n    if (!this.attrib.isComparedAttrib()) return true;\n    return this.attrib.isMultiValued && this.splitOnSelfCompare;\n  }\n\n  refreshViz_Active() {\n    if (!this.isVisible()) return;\n\n    if (this.isView_Dropdown) return;\n    if (!this.attrib.chartScale_Measure) return;\n\n    if (this.isView_Map && this.mapIsReady) {\n      this.catMap_refreshVis(\"Active\");\n      return;\n    }\n\n    if (this.isView_List) {\n      var baseline = this.measureLineZero;\n\n      this.refreshViz_Cache(\"Active\", null);\n\n      this.DOM.aggrGlyphs.classed(\n        \"NoActiveRecords\",\n        (aggr) => aggr.Active.measure === 0\n      );\n\n      this.DOM.measure_Active.style(\n        \"transform\",\n        (aggr) =>\n          `translate(${baseline + aggr.offset(\"Active\")}px, ${\n            this.height_bar_topGap\n          }px) ` + `scale(${aggr.scale(\"Active\")}, ${this.barHeight_Full})`\n      );\n\n      this.refreshMeasureLabelText(\"Active\");\n      this.refreshMeasureLabelPos(\"Active\", -1);\n    }\n  }\n\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\n    if (!this.isVisible()) return;\n\n    if (this.isView_Dropdown) {\n      this.dropdown_refreshCategories(); // might change the assigned colors\n      return;\n    }\n\n    this.refreshMeasureLabelText(cT);\n\n    if (cT === \"Compare_A\") {\n      this.refreshViz_NoValueAggr();\n    }\n\n    if (this.isView_List) {\n      var baseline = this.measureLineZero;\n      var _translateY = this.height_bar_topGap;\n      var barHeight = this.barHeight_Full;\n\n      // adjust position if sidebyside\n      if (this.vizSideBySide()) {\n        barHeight = barHeight / totalGroups;\n        _translateY += barHeight * curGroup;\n      }\n\n      this.refreshViz_Cache(cT, prevCts);\n      this.refreshMeasureLabelPos(cT, curGroup);\n\n      var onlySelectedNoSplit =\n        true &&\n        !this.browser.stackedChart &&\n        this.attrib.isComparedAttrib() &&\n        this.attrib.isMultiValued &&\n        !this.splitOnSelfCompare;\n\n      var _do = (scaleX) => {\n        this.DOM[\"measure_\" + cT].style(\n          \"transform\",\n          (aggr: Aggregate_Category) => {\n            if (onlySelectedNoSplit) scaleX = aggr.compared === cT;\n\n            return `translate(${\n              baseline + aggr.offset(cT)\n            }px, ${_translateY}px) scale(${\n              scaleX ? aggr.scale(cT) : 0\n            }, ${barHeight})`;\n          }\n        );\n      };\n\n      if (curGroup === totalGroups - 1 && this.browser.addedCompare) {\n        _do(false); // sets scaleX to zero, - I believe this was for animation purposes\n      }\n      _do(true);\n    }\n\n    if (this.isView_Map && this.mapIsReady && this.attrib.vizActive(cT)) {\n      if (this.attrib.isComparedAttrib() && !this.attrib.isMultiValued) return;\n      this.catMap_refreshVis(cT);\n    }\n  }\n\n  // Overwrites base class\n  chartAxis_Measure_TickSkip(): number {\n    var width = this.width_CatChart;\n    var widthPerTick = 35;\n\n    if (this.attrib.getPeakAggr(d3.max, \"Active\") > 100000) {\n      widthPerTick += 12; // k,m etc\n    }\n\n    if (this.browser.percentBreakdown) {\n      widthPerTick += 11; // %\n    } else if (this.browser.measureFunc.get() !== \"Count\") {\n      var unitName = this.browser.measureSummary.get()?.unitName;\n      if (unitName) widthPerTick += 2 + unitName.length * 9;\n    }\n\n    return width / widthPerTick;\n  }\n\n  // ********************************************************************\n  // Set matrix - multi valuied control\n  // ********************************************************************\n\n  private show_set_matrix = false;\n  public splitOnSelfCompare = true;\n\n  showSetMatrix(v: boolean) {\n    if (!this.isView_List && v === true) {\n      return;\n    }\n    this.show_set_matrix = v;\n    this.refreshShowSetMatrix();\n  }\n  hideSetMatrix() {\n    this.showSetMatrix(false);\n  }\n\n  refreshShowSetMatrix() {\n    this.DOM.root?.classed(\"show_set_matrix\", this.show_set_matrix);\n\n    if (this.show_set_matrix) {\n      this.attrib.showSetSummary();\n    } else if (this.setAttrib) {\n      this.attrib.setSortingOption(\"Active\"); // back to dynamic order\n      this.updateCatSorting(0); // no delay, animated\n    }\n  }\n\n  initDOM(beforeDOM): boolean {\n    this.attrib.initializeAggregates();\n    if (this.attrib.isEmpty()) return false;\n    if (this.DOM.inited) return true;\n\n    this.insertRoot(beforeDOM);\n\n    this.DOM.root\n      .attr(\"viewType\", this.viewType)\n      .classed(\"hasMultiAnd\", this.attrib.summaryFilter.selected_AND.length > 1)\n      .classed(\"isMultiValued\", this.attrib.isMultiValued)\n      .classed(\"supportsSetMatrix\", this.attrib.supportsSetMatrix)\n      .attr(\"hasMap\", this.attrib.catGeo !== null);\n\n    this.DOM.summaryCategorical = this.DOM.wrapper\n      .append(\"div\")\n      .attr(\"class\", \"summaryCategorical\");\n\n    if (!this.isView_Dropdown) {\n      this.init_DOM_Cat();\n    }\n\n    this.setCollapsed(this.collapsed);\n\n    this.DOM.inited = true;\n    this.catViewAs(this.viewType);\n\n    this.refreshShowSetMatrix();\n\n    return true;\n  }\n\n  // ********************************************************************\n  // Main block setup (header / root)\n  // ********************************************************************\n\n  insertHeader() {\n    super.insertHeader();\n    [\n      [\n        \"summaryViewAs setMatrixButton\",\n        \"ViewSetMatrix\",\n        \"far fa-tags\",\n        () => this.showSetMatrix(!this.show_set_matrix),\n      ],\n      [\n        \"summaryViewAs summaryViewAs_list\",\n        \"ViewAsList\",\n        \"far fa-list-ul\",\n        () => this.catViewAs(\"list\"),\n      ],\n      [\n        \"summaryViewAs summaryViewAs_map\",\n        \"ViewAsMap\",\n        \"fal fa-globe\",\n        () => this.catViewAs(\"map\"),\n      ],\n    ].forEach((button: any[], i, arr) => {\n      this.DOM.summaryIcons\n        .append(\"span\")\n        .attr(\"class\", button[0])\n        .tooltip(i18n[button[1]], { placement: \"bottom\" })\n        .on(\"click\", button[3])\n        .append(\"div\")\n        .attr(\"class\", button[2]);\n    });\n  }\n\n  // ********************************************************************\n  // Filtering\n  // ********************************************************************\n\n  onClearFilter(forceUpdate) {\n    this.attrib.noValueAggr.filtered = false;\n    this.attrib.unselectAllCategories();\n    this.clearCatTextSearch();\n    if (forceUpdate !== false && this.isView_Dropdown) {\n      this.dropdown_refreshCategories();\n    }\n    this.DOM.root?.classed(\"hasMultiAnd\", false);\n  }\n\n  updateAfterFilter(refreshViz = true): void {\n    if (!this.isVisible()) {\n      this.attrib.dirtySort = true;\n      return;\n    }\n\n    if (this.isView_Dropdown) {\n      if (!this.attrib.dirtySort) this.updateCatSorting_now();\n      this.dropdown_refreshCategories();\n      return;\n    }\n\n    this.refreshViz_NoValueAggr();\n    this.refreshMeasureLabelText(\"Active\");\n\n    if (this.isView_Map) {\n      this.attrib.updateChartScale_Measure(true); // skep refresh viz\n      this.updateCats_IsActive();\n      this.refreshViz_Active(); // maps can only visualize \"active\" selection.\n      return;\n    }\n\n    if (this.show_set_matrix) this.attrib.dirtySort = true;\n\n    if (!this.attrib.dirtySort) this.updateCatSorting();\n\n    if (refreshViz) {\n      this.attrib.updateChartScale_Measure(true); // skep refresh viz\n      this.refreshViz_All();\n    }\n  }\n\n  refreshLabelWidth() {\n    if (!this.isVisible()) return;\n    if (!this.DOM.summaryCategorical) return;\n    if (!this.isView_List) return;\n\n    this.DOM.chartCatLabelResize.style(\"left\", `${this.width_CatLabel}px`);\n\n    this.DOM.summaryCategorical\n      .selectAll(\".hasLabelWidth\")\n      .style(\"width\", `${this.width_CatLabel}px`);\n\n    this.DOM.measureLabelGroup.style(\n      \"width\",\n      `${this.width_CatMeasureLabel}px`\n    );\n\n    this.DOM.chartAxis_Measure.style(\n      \"transform\",\n      `translateX(${this.width_CatText}px)`\n    );\n  }\n\n  refreshScrollDisplayMore(bottomItem) {\n    if (!this.isView_List) {\n      return;\n    }\n    this.DOM.catSortButton.style(\n      \"display\",\n      this._aggrs.length === 1 ? \"none\" : null\n    );\n    if (this.catCount_Active <= 4) {\n      this.DOM.scroll_display_more.style(\"display\", \"none\");\n      return;\n    }\n    var below = this.catCount_Active - bottomItem;\n    var moreTxt = `<span class='rowCount ${below ? \" hasMore\" : \"\"}'>${\n      this.catCount_Active\n    } ${i18n.Rows}</span>`;\n    if (below > 0)\n      moreTxt += ` <span class='belowCount'>${below} ${i18n.More} <span class='far fa-angle-double-down'></span></span>`;\n    this.DOM.scroll_display_more.html(moreTxt);\n  }\n\n  // ********************************************************************\n  // Mapping\n  // ********************************************************************\n\n  private leafletAttrMap: any = null;\n  private mapIsReady: any;\n  public invertedColorTheme: any;\n  private mapColorScale: any;\n  private mapBounds_Active: any;\n  private geoPath: any;\n  private mapConfig: any; // todo\n\n  removeCatGeo() {\n    if (this.viewType === \"map\") {\n      this.catViewAs(\"list\");\n    }\n    this.DOM.root?.attr(\"hasMap\", false);\n    this.leafletAttrMap?.remove();\n    this.leafletAttrMap = null;\n  }\n\n  catMap_projectCategories() {\n    if (!this.panel) return;\n    // the following is temporary\n    var missingRegions = [];\n    this.DOM.measure_Active.attr(\"d\", (aggr, i, nodes) => {\n      if (!aggr._geo_) {\n        missingRegions.push(aggr.label);\n        nodes[i].parentNode.style.display = \"none\";\n        return;\n      }\n      return this.geoPath(aggr._geo_);\n    });\n\n    this.DOM.root\n      .select(\".mapView-UnmatchedData\")\n      .classed(\"active\", missingRegions.length > 0);\n\n    this.DOM.measureLabel\n      .attr(\"transform\", (_cat) => {\n        var centroid = this.geoPath.centroid(_cat._geo_);\n        return `translate(${centroid[0]},${centroid[1]})`;\n      })\n      .style(\"display\", (_cat) => {\n        var bounds = this.geoPath.bounds(_cat._geo_);\n        var width = Math.abs(bounds[0][0] - bounds[1][0]);\n        return width < this.width_CatMeasureLabel ? \"none\" : \"block\";\n      });\n  }\n\n  catMap_refreshBounds_Active() {\n    this.mapBounds_Active = this.catMap_getBounds(true);\n  }\n\n  catMap_zoomToActive(fly = false) {\n    if (this.attrib.mapInitView) {\n      this.leafletAttrMap.setView(\n        L.latLng(this.attrib.mapInitView[0], this.attrib.mapInitView[1]),\n        this.attrib.mapInitView[2]\n      );\n      this.attrib.mapInitView = null;\n      return;\n    }\n\n    if (fly) {\n      this.leafletAttrMap.flyToBounds(\n        this.mapBounds_Active,\n        this.mapConfig.flyConfig\n      );\n    } else {\n      this.leafletAttrMap.fitBounds(this.mapBounds_Active);\n      // there's a bug that makes the map not set the bounds correctly first time\n      //window.setTimeout(() => this.leafletAttrMap.fitBounds(this.mapBounds_Active), 100);\n    }\n  }\n\n  catMap_setMaxBounds() {\n    this.leafletAttrMap.setMaxBounds(this.catMap_getBounds());\n  }\n\n  catMap_getBounds(onlyActive = false) {\n    var bs = [];\n    // Insert the bounds for each record path into the bs\n    this._aggrs.forEach((_cat) => {\n      if (!_cat._geo_) return;\n      if (onlyActive && !_cat.isActive) return;\n      // get bounding box, cached in _geo_ property\n      var b = _cat._geo_._bounds;\n      if (b === undefined) {\n        b = d3.geoBounds(_cat._geo_);\n        if (isNaN(b[0][0])) {\n          b = null;\n        }\n        _cat._geo_._bounds = b;\n      }\n      if (b === null) return;\n      var p1 = L.latLng(b[0][1], b[0][0]);\n      var p2 = L.latLng(b[1][1], b[1][0]);\n      bs.push(p1);\n      bs.push(p2);\n    });\n    if (bs.length === 0) {\n      return this.catMap_getBounds(false); // not only active.\n    }\n    return Util.addMarginToBounds(new L.latLngBounds(bs));\n  }\n\n  catMap_invertColorTheme(v = null) {\n    if (v === null) v = !this.invertedColorTheme; // invert\n    this.invertedColorTheme = v;\n    if (this.mapColorScale) {\n      this.mapColorScale.range(this.invertedColorTheme ? [9, 0] : [0, 9]);\n      this.catMap_refreshColorScale();\n      this.refreshViz_All();\n      this.DOM.root\n        .select(\".editColorTheme.fa-adjust\")\n        .classed(\"rotatedY\", this.invertedColorTheme);\n    }\n  }\n\n  catMap_refreshColorScale() {\n    if (!this.DOM.mapColorBlocks) return;\n    var colorTheme = this.browser.colorTheme.getDiscrete(9);\n    if (this.invertedColorTheme) {\n      colorTheme = colorTheme.reverse();\n    }\n\n    this.DOM.mapColorBlocks\n      .style(\"background-color\", (d) => colorTheme[d])\n      .style(\"transform\", (d) => {\n        var left = (100 * d) / 9;\n        var right = (100 * (d + 1)) / 9;\n        return (\n          \"translateX(\" +\n          left +\n          \"%) scaleX(\" +\n          Math.abs(right - left) / 100 +\n          \")\"\n        );\n      });\n  }\n\n  catMap_prepView() {\n    if (this.setAttrib) this.showSetMatrix(false);\n\n    if (this.leafletAttrMap) {\n      // The map view was already initialized\n\n      this.leafletAttrMap.invalidateSize();\n\n      this.DOM.aggrGroup = this.DOM.summaryCategorical.select(\n        \".catMap_SVG > .aggrGroup\"\n      );\n      this.refreshDOMcats();\n\n      this.mapIsReady = true;\n\n      //  No longer resetting the zoom after switching back to an already existing map.\n      //  this.catMap_refreshBounds_Active();\n      //  this.catMap_zoomToActive();\n\n      this.catMap_projectCategories();\n      this.refreshViz_Active();\n      this.refreshViz_All();\n      return;\n    }\n\n    this.mapConfig = Util.mergeConfig(Base.map, this.attrib.mapConfig || {});\n\n    var me = this;\n    this.leafletAttrMap = L.map(\n      this.DOM.catMap_Base.node(),\n      this.mapConfig.leafConfig\n    )\n      .addLayer(\n        new L.TileLayer(this.mapConfig.tileTemplate, this.mapConfig.tileConfig)\n      )\n      .on(\"viewreset\", () => this.catMap_projectCategories())\n      .on(\"movestart\", function () {\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\n        this._zoomInit_ = this.getZoom();\n        me.DOM.catMap_SVG.style(\"opacity\", 0.3);\n      })\n      .on(\"moveend\", function () {\n        me.browser.DOM.root.classed(\"noPointerEvents\", false);\n        me.DOM.catMap_SVG.style(\"opacity\", null);\n        if (this._zoomInit_ !== this.getZoom()) me.catMap_projectCategories();\n      });\n\n    this.leafletAttrMap.attributionControl.setPosition(\"topright\");\n\n    this.geoPath = d3.geoPath().projection(\n      d3.geoTransform({\n        // Use Leaflet latLngToLayerPoint to implement a D3 geometric transformation.\n        point: function (x, y) {\n          var point = me.leafletAttrMap.latLngToLayerPoint(L.latLng(y, x));\n          this.stream.point(point.x, point.y);\n        },\n      })\n    );\n\n    this.DOM.catMap_SVG = d3\n      .select(this.leafletAttrMap.getPanes().overlayPane)\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .attr(\"class\", \"catMap_SVG\");\n\n    // The fill pattern definition in SVG, used to denote geo-objects with no data.\n    // http://stackoverflow.com/questions/17776641/fill-rect-with-pattern\n    this.DOM.catMap_SVG\n      .append(\"defs\")\n      .append(\"pattern\")\n      .attr(\"id\", \"diagonalHatch\")\n      .attr(\"patternUnits\", \"userSpaceOnUse\")\n      .attr(\"width\", 4)\n      .attr(\"height\", 4)\n      .append(\"path\")\n      .attr(\"d\", \"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2\")\n      .attr(\"stroke\", \"gray\")\n      .attr(\"stroke-width\", 1);\n\n    // Add custom controls\n\n    var X;\n    X = this.DOM.summaryCategorical\n      .append(\"div\")\n      .attr(\"class\", \"visViewControl ViewControlGroup\");\n\n    X.append(\"div\")\n      .attr(\"class\", \"visViewControlButton far fa-plus\")\n      .tooltip(i18n.ZoomIn)\n      .on(\"click\", () => this.leafletAttrMap.zoomIn());\n    X.append(\"div\")\n      .attr(\"class\", \"visViewControlButton far fa-minus\")\n      .tooltip(i18n.ZoomOut)\n      .on(\"click\", () => this.leafletAttrMap.zoomOut());\n    X.append(\"div\")\n      .attr(\"class\", \"visViewControlButton viewFit far fa-expand-arrows-alt\")\n      .tooltip(i18n.ZoomToFit)\n      .on(\"click\", (event) => {\n        this.catMap_refreshBounds_Active();\n        this.catMap_zoomToActive(true);\n        event.preventDefault();\n        event.stopPropagation();\n      });\n\n    X.append(\"div\")\n      .attr(\n        \"class\",\n        \"visViewControlButton mapView-UnmatchedData fa fa-exclamation\"\n      )\n      .tooltip(i18n.MissingLocations)\n      .on(\"click\", () => {\n        var missingRegions = [];\n        this._aggrs.forEach((_cat) => {\n          if (_cat._geo_ === undefined)\n            missingRegions.push(\n              _cat.label +\n                ` <span style='color: gray; font-weight:300; font-size: 0.9em;'>[${_cat.recCnt(\n                  \"Total\"\n                )} ${this.browser.recordName}\"]</span>`\n            );\n        });\n        Modal.alert(\n          \"The following regions do not appear on the map.<br><br>\" +\n            missingRegions.join(\", \") +\n            \"<br><br>\" +\n            \"<span style='font-size: 0.9em; color: gray; font-weight: 300'>\" +\n            \"Please see the list of standard region names \" +\n            \"<a style='color: gray; text-decoration: underline;' href='https://docs.google.com/spreadsheets/d/1DKNXwsJy6_Mdy3ofwbBIZeBGrxSItYOJXNZgLyu0IM4' target='_blank'>here</a>.<br>\" +\n            \"If the place names above are misspelled, please update your data source.<span>\"\n        ).then(() => {\n          this.DOM.root\n            .select(\".mapView-UnmatchedData\")\n            .classed(\"active\", false);\n        });\n      });\n\n    X = this.DOM.summaryCategorical\n      .append(\"div\")\n      .attr(\"class\", \"mapGlyphColorSetting\");\n\n    var XX = X.append(\"div\")\n      .attr(\"class\", \"colorOptions\")\n      .classed(\"active\", true);\n\n    this.DOM.aggrGroup = this.DOM.catMap_SVG\n      .append(\"g\")\n      .attr(\"class\", \"leaflet-zoom-hide aggrGroup\");\n\n    // This will insert map svg component\n    this.insertCategoryGlyphs();\n\n    this.DOM.mapColorScaleGroup = XX.append(\"div\").attr(\n      \"class\",\n      \"mapColorScaleGroup\"\n    );\n\n    this.DOM.mapColorHighlightedValue = this.DOM.mapColorScaleGroup\n      .append(\"span\")\n      .attr(\"class\", \"mapColorHighlightedValue fa fa-caret-down\");\n\n    this.DOM.mapColorBlocks = this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"mapColorScaleBins\")\n      .selectAll(\".mapColorThemeBin\")\n      .data([0, 1, 2, 3, 4, 5, 6, 7, 8])\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", \"mapColorThemeBin\")\n      .tooltip(\"\", { placement: \"bottom\" })\n      .on(\"mouseenter\", (event, d) => {\n        var _minValue = Math.round(this.mapColorScale.invert(d));\n        var _maxValue = Math.round(this.mapColorScale.invert(d + 1));\n        event.currentTarget.tippy.setContent(\n          Math.round(_minValue) + \" &mdash; \" + Math.round(_maxValue)\n        );\n      });\n\n    this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"mapColorScaleLabels\")\n      .call((mapColorScaleLabels) => {\n        mapColorScaleLabels\n          .selectAll(\".asdsd\")\n          .data([0, 3, 6, 9])\n          .enter()\n          .append(\"div\")\n          .attr(\"class\", \"mapColorScaleLabel\")\n          .style(\"left\", (i) => (100 * i) / 9 + \"%\")\n          .call((ticks) => {\n            ticks.append(\"div\").attr(\"class\", \"tickLine\");\n            ticks.append(\"div\").attr(\"class\", \"tickLabel\");\n          });\n      });\n\n    this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"measureDescrLabel\");\n    this.refreshMeasureDescrLabel();\n\n    XX.append(\"div\")\n      .attr(\"class\", \"colorThemeOptions\")\n      .append(\"div\")\n      .attr(\"class\", \"editColorTheme far fa-adjust\")\n      .tooltip(i18n[\"InvertColorTheme\"])\n      .on(\"click\", () => this.catMap_invertColorTheme());\n\n    this.mapIsReady = true;\n\n    this.leafletAttrMap.invalidateSize();\n\n    this.catMap_refreshBounds_Active();\n    this.catMap_zoomToActive();\n    this.catMap_setMaxBounds();\n    this.catMap_projectCategories();\n    this.refreshMeasureLabelText(\"Active\");\n    this.refreshMapColorScaleBounds();\n    this.refreshViz_Active();\n    this.catMap_refreshColorScale();\n    this.refreshHeight();\n  }\n\n  refreshMapColorScaleBounds(_type = \"Active\") {\n    this.mapColorScale = this.attrib.chartScale_Measure\n      .copy()\n      .range(this.invertedColorTheme ? [9, 0] : [0, 9]);\n\n    this.DOM.mapColorScaleGroup\n      .selectAll(\".mapColorScaleLabels > .mapColorScaleLabel > .tickLabel\")\n      .html((d, i) =>\n        this.browser.getValueLabel(\n          this.mapColorScale.invert((this.invertedColorTheme ? 3 - i : i) * 3)\n        )\n      );\n  }\n\n  catMap_refreshVis(sT) {\n    this.DOM.root.select(\".editColorTheme\").attr(\"data-color\", sT);\n\n    this.refreshMapColorScaleBounds(sT);\n\n    var mapColorQuantize = d3\n      .scaleQuantize()\n      .domain([0, 9])\n      .range(this.browser.colorTheme.getDiscrete(9));\n\n    this.DOM.measure_Active.each((aggr, i, nodes) => {\n      var _visV = this.browser.getChartValue(aggr, sT);\n      if (aggr[sT].recCnt === 0) _visV = null;\n      var DOM = nodes[i];\n      var _fill = \"url(#diagonalHatch)\";\n      var _stroke = \"#111111\";\n      if (_visV != null) {\n        _fill = mapColorQuantize(this.mapColorScale(_visV));\n        _stroke = d3.hsl(_fill).l > 0.5 ? \"#111111\" : \"#EEEEEE\";\n      }\n      DOM.style.fill = _fill;\n      DOM.style.stroke = _stroke;\n      DOM.classList[_visV == null ? \"add\" : \"remove\"](\"noData\");\n    });\n  }\n\n  // ********************************************************************\n  // List\n  // ********************************************************************\n\n  list_prepView() {\n    this.DOM.aggrGroup = this.DOM.aggrGroup_list;\n    this.insertCategoryGlyphs();\n    if (this.heightRow_category_dirty) this.refreshHeight_Category();\n    this.updateCats_IsActive();\n    this.updateCatSorting_now();\n    this.refreshLabelWidth();\n    this.refreshViz_All();\n    this.refreshHeight();\n    this.refreshLabelWidth();\n    this.DOM.measureLabel.style(\"display\", null); // default is visible\n  }\n\n  init_DOM_Cat() {\n    this.DOM.summaryControls = this.DOM.summaryCategorical\n      .append(\"div\")\n      .attr(\"class\", \"summaryControls\");\n    this.initDOM_CatTextSearch();\n\n    this.refreshConfigRowCount();\n\n    this.DOM.catChart = this.DOM.summaryCategorical\n      .append(\"div\")\n      .attr(\"class\", \"catChart\");\n\n    this.DOM.aggrGroup = this.DOM.catChart\n      .append(\"div\")\n      .attr(\"class\", \"aggrGroup\")\n      .on(\"mousedown\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      })\n      .on(\"scroll\", () => {\n        if (Util.ignoreScrollEvents === true) return;\n        this.scrollTop_cache = this.DOM.aggrGroup.node().scrollTop;\n\n        this.DOM.chartCatLabelResize.style(\"top\", \"0px\");\n        this.firstCatIndexInView = Math.floor(\n          this.scrollTop_cache / this.heightCat\n        );\n        this.refreshScrollDisplayMore(\n          this.firstCatIndexInView + this.catCount_InDisplay\n        );\n        this.updateCats_IsVisible();\n        this.catList_cullCategories();\n        this.refreshMeasureLabelText(\"Active\");\n      });\n    this.DOM.aggrGroup_list = this.DOM.aggrGroup;\n\n    this.DOM.catMap_Base = this.DOM.catChart\n      .append(\"div\")\n      .attr(\"class\", \"catMap_Base\");\n\n    // This makes sure that the (scrollable) div height is correctly set to visible number of categories\n    this.DOM.chartBackground = this.DOM.aggrGroup\n      .append(\"span\")\n      .attr(\"class\", \"chartBackground\");\n\n    this.DOM.chartCatLabelResize = this.DOM.catChart\n      .append(\"span\")\n      .attr(\"class\", \"chartCatLabelResize dragWidthHandle\")\n      .tooltip(i18n[\"Adjust Label Width\"])\n      .on(\"mousedown\", (event) => {\n        var initWidth =\n          this.width_CatLabel - d3.pointer(event, d3.select(\"body\").node())[0];\n\n        this.browser.activateWidthDrag(\n          this.panel.DOM.root.node(),\n          event,\n          (event2) => {\n            this.panel.width_CatText =\n              initWidth +\n              d3.pointer(event2, d3.select(\"body\").node())[0] +\n              this.width_CatMeasureLabel;\n          }\n        );\n      });\n\n    this.insertChartAxis_Measure(this.DOM.catChart);\n\n    this.DOM.belowCatChart = this.DOM.summaryCategorical\n      .append(\"div\")\n      .attr(\"class\", \"belowCatChart catSummary_ListOnly hasLabelWidth\")\n      .style(\"height\", Base.height_CatBottom - 1 + \"px\"); // for some reason, chrome needs 1 more pixel for categories\n\n    this.initDOM_CatSortButton();\n\n    this.DOM.scroll_display_more = this.DOM.belowCatChart\n      .append(\"div\")\n      .attr(\"class\", \"scroll_display_more\")\n      .on(\"click\", () =>\n        Util.scrollToPos_do(\n          this.DOM.aggrGroup,\n          this.DOM.aggrGroup.node().scrollTop + this.heightCat\n        )\n      );\n\n    this.DOM.belowCatChart.append(\"div\").attr(\"class\", \"gap\");\n\n    // move noValueAggr under belowChart\n    // TODO: Fix. If it's map view or dropdown view, it shouldn't be moved under this dom element\n    this.DOM.belowCatChart.node().appendChild(this.DOM.noValueAggr.node());\n  }\n\n  initDOM_CatSortButton() {\n    this.DOM.catSortButton = this.DOM.belowCatChart\n      .append(\"span\")\n      .attr(\"class\", \"catSortButton fa fa-sort catSummary_ListOnly\") // alt icon: fa-bars\n      .tooltip(i18n[\"Sorting\"])\n      .on(\"click\", (event) =>\n        Modal.popupMenu(event, this.attrib.getSortMenuOpts(), this, {\n          placement: \"top-start\",\n        })\n      );\n  }\n\n  insertCategoryGlyphs() {\n    var me = this;\n    if (this.isView_Dropdown) {\n      this.dropdown_refreshCategories();\n      return;\n    }\n\n    if (!this.DOM.aggrGroup) return;\n\n    var aggrGlyphSelection = this.DOM.aggrGroup\n      .selectAll(\".aggrGlyph\")\n      .data(this._aggrs, (aggr) => aggr.id);\n\n    var DOM_cats_new = aggrGlyphSelection\n      .enter()\n      .append(this.viewType == \"list\" ? \"span\" : \"g\")\n      .attr(\n        \"class\",\n        \"aggrGlyph \" + (this.viewType == \"list\" ? \"cat\" : \"map\") + \"Glyph\"\n      ) // mapGlyph, catGlyph\n      .tooltip((aggr: Aggregate_Category) => aggr.getTooltipHTML(), {\n        theme: \"dark kshf-tooltip kshf-record\",\n        placement: \"right\",\n        animation: \"fade\",\n        followCursor: this.isView_Map,\n        offset: [0, this.isView_Map ? 15 : 0],\n        trigger: \"manual\",\n        // don't show the tooltip if the categorical chart is made up of unique categories.\n        onShow: () => !this.attrib.uniqueCategories(),\n      })\n      .on(\"mouseenter\", function (_event, aggr) {\n        if (me.browser.adjustMode) return;\n        this.highlightTimeout = window.setTimeout(() => {\n          this.highlightTimeout = null;\n          this.classList.add(\"catMouseOver\");\n          me.attrib.onAggrHighlight(aggr);\n          // Do not change.\n          // If trigger is automated (not manual), mouse-over automatically shows the tooltip\n          //  but, the highliht/compare setting may be old (invalid) because of the delay to apply it.\n          // So, we need to keep this manual\n          this.tippy.show();\n        }, me.browser.movingMouseDelay);\n      })\n      .on(\"mouseleave\", function (_event, aggr) {\n        if (this.tippy) {\n          this.tippy.hide();\n        }\n        if (me.browser.adjustMode) return;\n        this.classList.remove(\"catMouseOver\");\n        if (this.highlightTimeout) window.clearTimeout(this.highlightTimeout);\n        me.attrib.onAggrLeave(aggr);\n      })\n      .on(\"click\", (event, aggr) => {\n        if (this.browser.adjustMode) return;\n        this.attrib.onAggrClick(event, aggr);\n      });\n\n    this.updateCats_IsVisible();\n\n    if (this.isView_List) {\n      DOM_cats_new.style(\"height\", this.heightCat + \"px\").style(\n        \"transform\",\n        \"translateY(0px)\"\n      );\n\n      DOM_cats_new.append(\"span\").attr(\n        \"class\",\n        \"catLabelGroup_BG hasLabelWidth\"\n      );\n\n      var domAttrLabel = DOM_cats_new.append(\"span\").attr(\n        \"class\",\n        \"catLabelGroup hasLabelWidth\"\n      );\n\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"filterButton far fa-filter\")\n        .tooltip(i18n.Filter)\n        .on(\"click\", (event, _cat: Aggregate_Category) => {\n          var menuConfig = { name: \"Filter\", items: [] };\n          var _only = true,\n            _and = !_cat.filtered_AND(),\n            _or = !_cat.filtered_OR(),\n            _not = !_cat.filtered_NOT(),\n            _remove = _cat.isFiltered();\n          var _Or_And =\n            this.attrib.summaryFilter.selected_OR.length > 0 ||\n            this.attrib.summaryFilter.selected_AND.length > 0;\n\n          if (!this.attrib.isMultiValued) {\n            _only = !_cat.filtered_AND();\n            _and = false;\n            _or = _or && _Or_And && !_cat.filtered_AND();\n            _not = _not && (!_Or_And || _cat.filtered_AND());\n          } else {\n            _only = true;\n            _and = _and && _Or_And;\n            _or = _or && _Or_And;\n          }\n\n          var _label = `<span class='filterContextLabel'>${_cat.label}</span>`;\n\n          if (_remove) {\n            menuConfig.items.push({\n              id: \"filterOption_Remove\",\n              name: \"<span class='filterContextOpt'>\" + i18n.Clear + \"</span>\",\n              helparticle: \"5e88e80a2c7d3a7e9aea63ed\",\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"NONE\"),\n            });\n          }\n\n          if (_only) {\n            menuConfig.items.push({\n              id: \"filterOption_Only\",\n              name: `<span class='filterContextOpt'>${i18n.Only}</span> ${_label}`,\n              helparticle: \"5e88e7bc2c7d3a7e9aea63e9\",\n              do: (_cat: Aggregate_Category) => {\n                this.attrib.noValueAggr.filtered = null;\n                this.attrib.summaryFilter\n                  .selected_AndOrNot()\n                  .forEach((_) => _.set_NONE());\n                this.attrib.filterCategory(_cat, \"AND\", \"All\");\n              },\n            });\n          }\n          if (_and) {\n            menuConfig.items.push({\n              id: \"filterOption_And\",\n              name:\n                `<span class='filterContextOpt'>${i18n.And}</span> ${_label}`+\n                ` <span class='filterContextMultiple'>[${i18n.Multiple}]</span>`,\n              helparticle: \"5e88e81a2c7d3a7e9aea63ee\",\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"AND\"),\n            });\n          }\n          if (_or) {\n            menuConfig.items.push({\n              id: \"filterOption_Or\",\n              name:\n              `<span class='filterContextOpt'>${i18n.Or}</span> ${_label}`+\n              ` <span class='filterContextMultiple'>[${i18n.Multiple}]</span>`,\n              helparticle: \"5e88e7e22c7d3a7e9aea63ec\",\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"OR\"),\n            });\n          }\n          if (_not) {\n            menuConfig.items.push({\n              id: \"filterOption_Not\",\n              name:\n                \"<span class='filterContextOpt'>\" +\n                i18n.Not +\n                \"</span> \" +\n                _label,\n              helparticle: \"5e88e7cf2c7d3a7e9aea63ea\",\n              do: (_cat: Aggregate_Category) => this.attrib.filterCategory(_cat, \"NOT\"),\n            });\n          }\n          Modal.popupMenu(event, menuConfig, _cat, {\n            placement: \"bottom-start\",\n          });\n          event.stopPropagation();\n          event.preventDefault();\n        });\n\n      this.insertAggrLockButton(domAttrLabel, \"bottom\");\n\n      domAttrLabel.append(\"span\").attr(\"class\", \"catLabelGap\");\n\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"AndOrNot AndOrNot_And\")\n        .text(i18n.And);\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"AndOrNot AndOrNot_Or\")\n        .text(i18n.Or);\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"AndOrNot AndOrNot_Not\")\n        .text(i18n.Not);\n\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"catLabelOrder fa fa-bars\")\n        .tooltip(i18n[\"Reorder\"])\n        .on(\"mousedown\", (event, aggr: Aggregate_Category) => {\n          var catNode = event.currentTarget.parentNode.parentNode;\n          var catGroupNode =\n            event.currentTarget.parentNode.parentNode.parentNode;\n          me.browser.DOM.root.classed(\"noPointerEvents\", true);\n          var srcIndex = aggr.orderIndex;\n\n          d3.select(\"body\")\n            .on(\"mousemove.reordercat\", function (event2) {\n              catNode.classList.add(\"draggedCategory\");\n\n              var targetPos = Math.min(\n                Math.max(d3.pointer(event2, catGroupNode)[1], 0),\n                me.heightCat * (me.catCount_Active - 1)\n              );\n              var targetIndex = Math.min(\n                Math.max(Math.round(targetPos / me.heightCat), 0),\n                me.catCount_Active - 1\n              );\n              var skip = { from: srcIndex, to: targetIndex };\n\n              me.updateCatSorting(0, true, skip); // zero-delay, animated\n\n              catNode.style.transform = `translate(0px, ${targetPos}px)`; // transition the moved cat directly\n            })\n            .on(\"mouseup.reordercat\", function (event3) {\n              catNode.classList.remove(\"draggedCategory\");\n\n              var targetPos = Math.min(\n                Math.max(d3.pointer(event3, catGroupNode)[1], 0),\n                me.heightCat * (me.catCount_Active - 1)\n              );\n              var targetIndex = Math.min(\n                Math.max(Math.round(targetPos / me.heightCat), 0),\n                me.catCount_Active - 1\n              );\n              var skip = { from: srcIndex, to: targetIndex, mult: undefined };\n\n              if (skip.from > skip.to) {\n                var _ = skip.to;\n                skip.to = skip.from;\n                skip.from = _;\n                skip.mult = 1;\n              } else {\n                // from smaller than to\n                skip.mult = -1;\n              }\n\n              // update orderIndex!\n              aggr.orderIndex = targetIndex;\n              me.DOM.aggrGlyphs\n                .filter((_cat: Aggregate_Category) => _cat.label !== aggr.label) // all but the moved one\n                .each((_cat: Aggregate_Category) => {\n                  if (\n                    _cat.orderIndex >= skip.from &&\n                    _cat.orderIndex <= skip.to\n                  )\n                    _cat.orderIndex += skip.mult;\n                });\n\n              me.attrib.pleaseSort = true;\n              // Save the ordering\n              me.attrib.setFixedCatOrder();\n\n              me.browser.DOM.root.classed(\"noPointerEvents\", false);\n              d3.select(\"body\")\n                .on(\"mousemove.reordercat\", null)\n                .on(\"mouseup.reordercat\", null);\n            });\n        });\n\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"catLabelEdit fa fa-pencil\")\n        .tooltip(\"\")\n        .on(\"mouseenter\", (event, d: Aggregate_Category) => {\n          var info = \"\";\n          if (me.attrib.catLabel_attr[d.id]) {\n            // Show original value\n            info = ` <span>(${d.id})</span>`;\n            if (event.shiftKey) {\n              event.currentTarget.tippy.setContent(\n                \"+Shift : \" + i18n.Reset + info\n              );\n              return;\n            }\n          }\n          event.currentTarget.tippy.setContent(i18n.EditTitle + info);\n        })\n        .on(\"click\", function (event, d: Aggregate_Category) {\n          this.tippy.hide();\n          if (event.shiftKey) {\n            delete me.attrib.catLabel_attr[d.id];\n            this.nextSibling.innerHTML = DOMPurify.sanitize(d.id);\n            return;\n          }\n          this.style.display = \"none\";\n          this.previousSibling.style.display = \"none\";\n          this.nextSibling.setAttribute(\"contenteditable\", true);\n          this.nextSibling.focus();\n        });\n\n      domAttrLabel\n        .append(\"span\")\n        .attr(\"class\", \"catLabel\")\n        .html((aggr: Aggregate_Category) => aggr.label)\n        .on(\"focus\", function () {\n          this._initValue = DOMPurify.sanitize(this.innerHTML);\n          document.execCommand(\"selectAll\", false, null);\n        })\n        .on(\"blur\", function () {\n          this.removeAttribute(\"contenteditable\");\n          this.blur();\n          this.previousSibling.style.display = \"\";\n          this.previousSibling.previousSibling.style.display = \"\";\n        })\n        .on(\"keydown\", function (event, d: Aggregate_Category) {\n          if (event.keyCode === 27) {\n            // Escape key\n            // Do not apply the new label\n            this.blur();\n            this.innerHTML = DOMPurify.sanitize(this._initValue);\n            return;\n          }\n          if (event.key === \"Enter\") {\n            event.stopPropagation();\n            event.preventDefault();\n            var newLabel = DOMPurify.sanitize(this.innerHTML);\n            if (newLabel === \"\") {\n              this.innerHTML = DOMPurify.sanitize(this._initValue);\n              this.blur();\n              return;\n            }\n            d.label = newLabel;\n            me.attrib.catLabel_attr[d.id] = newLabel;\n            this.blur();\n          }\n        });\n\n      var labelGroup = DOM_cats_new.append(\"div\").attr(\n        \"class\",\n        \"measureLabelGroup\"\n      );\n      Base.Active_Compare_List.forEach((m) => {\n        labelGroup\n          .append(\"span\")\n          .attr(\"class\", \"measureLabel measureLabel_\" + m);\n      });\n\n      var measureGroup = DOM_cats_new.append(\"div\").attr(\n        \"class\",\n        \"measureGroup\"\n      );\n\n      Base.Total_Active_Compare_List.forEach((t) => {\n        measureGroup\n          .append(\"span\")\n          .attr(\"class\", `measure_${t} bg_${t}`)\n          .on(\"mouseenter\", (event, aggr: Aggregate_Category) => {\n            aggr.DOM.aggrGlyph\n              .querySelector(\".measureLabel_\" + t)\n              .classList.add(\"forceShow\");\n\n            if (Base.Compare_List.find((_) => _ === t)) {\n              this.browser.refreshAllMeasureLabels(t);\n            }\n            event.preventDefault();\n            event.stopPropagation();\n          })\n          .on(\"mouseleave\", (_event, aggr: Aggregate_Category) => {\n            var labelDOM = aggr.DOM.aggrGlyph.querySelector(\n              \".measureLabel_\" + t\n            );\n            if (labelDOM) labelDOM.classList.remove(\"forceShow\");\n            if (Base.Compare_List.find((_) => _ === t)) {\n              this.browser.refreshAllMeasureLabels(\"Active\");\n            }\n          });\n      });\n      measureGroup.append(\"div\").attr(\"class\", \"setMatrixLine\");\n    } else if (this.isView_Map) {\n      DOM_cats_new.append(\"g\")\n        .attr(\"class\", \"measureGroup\")\n        .append(\"path\")\n        .attr(\"class\", \"measure_Active\");\n      // only \"active\" measure group right now\n\n      // label on top of (after) all the rest (removed for now)\n    }\n    this.refreshDOMcats();\n  }\n\n  refreshMeasureLabelPos(sT: MeasureType = \"Active\", curGroup = 0) {\n    if (!this.isVisible()) return;\n    if (!this.isView_List) return;\n    if (sT === \"Other\") return;\n\n    var _top = this.height_bar_topGap;\n    var barHeight = this.barHeight_Full;\n\n    if (this.browser.stackedCompare.get() && !this.panel.hiddenCatBars()) {\n      var baseline = this.measureLineZero;\n      var maxWidth = this.width_CatChart;\n\n      var endOfBar = !this.browser.isCompared();\n\n      this.DOM[\"measureLabel_\" + sT].each(\n        (aggr: Aggregate_Category, i, nodes) => {\n          var _width = aggr.scale(sT);\n          var _left = baseline + aggr.offset(sT);\n          var _right = _left + _width;\n\n          var _hidden = this.browser.getMeasureValue(aggr, sT) == 0;\n\n          if (!_hidden && this.browser.isCompared()) {\n            _hidden = aggr.scale(sT) < this.width_CatMeasureLabel - 4;\n          }\n\n          // label alignment\n          var _labelAlign =\n            Math.abs(_left - baseline) < 2\n              ? \"left\"\n              : Math.abs(_right - maxWidth) < 2 &&\n                this.browser.relativeBreakdown\n              ? \"right\"\n              : \"middle\";\n\n          if (endOfBar) {\n            _width = this.width_CatMeasureLabel;\n            _left = Math.min(\n              baseline + aggr.sumOffsetScale(sT),\n              maxWidth - _width\n            );\n            _right = _left + _width;\n            _labelAlign = _right + 10 < maxWidth ? \"left\" : \"right\";\n            _hidden = aggr.recCnt(sT) === 0;\n          }\n\n          nodes[i].classList[_hidden ? \"add\" : \"remove\"](\"hidden\");\n\n          nodes[i].setAttribute(\"labelAlign\", _labelAlign);\n\n          nodes[i].style.width = _width + \"px\";\n          nodes[i].style.transform = `translate(${_left}px, ${_top}px)`;\n        }\n      );\n    } else {\n      if (this.vizSideBySide()) {\n        barHeight = barHeight / this.browser.activeComparisonsCount;\n        _top += barHeight * curGroup;\n      }\n\n      var onlySelectedNoSplit =\n        true &&\n        !this.browser.stackedChart &&\n        this.attrib.isComparedAttrib() &&\n        this.attrib.isMultiValued &&\n        !this.splitOnSelfCompare;\n\n      this.DOM[\"measureLabel_\" + sT]\n        .attr(\"labelAlign\", null)\n        .classed(\"hidden\", (aggr) => {\n          if (onlySelectedNoSplit) return aggr.compared !== sT;\n          return (\n            barHeight < 12 ||\n            (this.attrib.isComparedAttrib() &&\n              !this.attrib.isMultiValued &&\n              (sT !== aggr.compared || this.browser.relativeBreakdown))\n          );\n        })\n        .style(\"transform\", `translateY(${_top}px)`)\n        .style(\"width\", null);\n    }\n\n    this.DOM[\"measureLabel_\" + sT].style(\"line-height\", barHeight + \"px\");\n  }\n\n  refreshDOMcats() {\n    this.DOM.aggrGlyphs = this.DOM.aggrGroup\n      .selectAll(\".aggrGlyph\")\n      .each((aggr: Aggregate_Category, i, nodes) => {\n        aggr.setAggrGlyph(nodes[i]);\n      });\n\n    this.DOM.measureLabelGroup =\n      this.DOM.aggrGlyphs.selectAll(\".measureLabelGroup\");\n    this.DOM.measureLabel = this.DOM.aggrGlyphs.selectAll(\".measureLabel\");\n\n    Base.Active_Compare_List.forEach((t) => {\n      this.DOM[\"measureLabel_\" + t] = this.DOM.aggrGlyphs.selectAll(\n        \".measureLabel_\" + t\n      );\n    });\n\n    Base.Total_Active_Compare_List.forEach((t) => {\n      this.DOM[\"measure_\" + t] = this.DOM.aggrGlyphs.selectAll(\".measure_\" + t);\n    });\n\n    if (this.isView_List) {\n      this.DOM.catLabel = this.DOM.aggrGlyphs.selectAll(\".catLabel\");\n      this.DOM.lockButton = this.DOM.aggrGlyphs.selectAll(\".lockButton\");\n      this.refreshHeight_Category_do();\n    }\n  }\n\n  // ********************************************************************\n  // List - Sorting\n  // ********************************************************************\n\n  public scrollTop_cache = 0;\n\n  updateCatSorting_now() {\n    this.updateCatSorting(0, false); // no delay, not animated\n  }\n\n  updateCatSorting(sortDelay = 1000, animate = true, skip: any = false) {\n    if (this._aggrs.length === 0) return; // no aggregates to sort\n    if (this.attrib.uniqueCategories() && !this.panel) return; // Nothing to sort...\n\n    if (!this.browser.finalized) animate = false;\n\n    this.updateCats_IsActive();\n\n    if (\n      !skip &&\n      (sortDelay === 0 || !this.attrib.catOrder_Fixed || this.attrib.pleaseSort)\n    ) {\n      this.attrib._sortCategories();\n      // ************************************************\n      // update orderIndex\n      var lastRank = 0;\n      this._aggrs.forEach((_cat) => {\n        _cat.orderIndex = _cat.isActive ? lastRank++ : -lastRank - 1;\n      });\n    }\n\n    this.updateCats_IsVisible();\n\n    // No need to update UI if checks below fail\n    if (!this.panel) return;\n    if (!this.DOM.aggrGlyphs) return;\n    if (!this.isView_List) return;\n\n    // The rest deals with updating UI\n\n    this.DOM.catChart.classed(\"catOrder_Fixed\", this.attrib.catOrder_Fixed);\n\n    if (!skip && this.setAttrib) {\n      // need to handle some setAttrib updates when the categories are re-ordered\n      var setAttrib = this.setAttrib;\n      setAttrib.block.refreshRow();\n      setAttrib.block.DOM.setPairGroup.attr(\"animate_position\", false);\n      setAttrib.block.refreshSetPair_Position();\n      setTimeout(\n        () => setAttrib.block.DOM.setPairGroup.attr(\"animate_position\", true),\n        1000\n      );\n    }\n\n    // Categories outside the view are set \"invisible\"\n    // Her, we expand the background box. This makes the scroll bar visible.\n    this.DOM.chartBackground.style(\"height\", this.height_VisibleAttrib + \"px\");\n\n    // scroll to top when re-sorted\n    if (this.scrollTop_cache !== 0) Util.scrollToPos_do(this.DOM.aggrGroup, 0);\n\n    this.refreshScrollDisplayMore(\n      this.firstCatIndexInView + this.catCount_InDisplay\n    );\n\n    if (!animate) {\n      this.DOM.aggrGlyphs\n        .each((_cat) => {\n          _cat.posX = 0;\n        })\n        .style(\"opacity\", 1)\n        .style(\"transform\", (_cat) => _cat.transformPos);\n      this.catList_cullCategories();\n      return;\n    }\n\n    // Exectued only when categories are reordered through GUI\n    if (skip) {\n      var selfOrder = skip.from;\n      // from is less than to (like, from 2 to 5 ): make 2,3,4 skip\n      if (skip.from > skip.to) {\n        var _ = skip.to;\n        skip.to = skip.from;\n        skip.from = _;\n        skip.mult = 1;\n      } else {\n        skip.mult = -1;\n      }\n      this.DOM.aggrGlyphs\n        .filter((_cat) => _cat.orderIndex !== selfOrder)\n        .transition()\n        .duration(sortDelay)\n        .style(\"transform\", (_cat) => {\n          var offset =\n            _cat.orderIndex >= skip.from && _cat.orderIndex <= skip.to\n              ? this.heightCat * skip.mult\n              : 0;\n          return `translate(${_cat.posX}px, ${_cat.posY + offset}px)`;\n        });\n\n      return;\n    }\n\n    var cats_NotActiveBeforeAndNow = this.DOM.aggrGlyphs.filter(\n      (_cat) => !_cat.isActiveBefore && !_cat.isActive\n    );\n    var cats_Disappearing = this.DOM.aggrGlyphs.filter(\n      (_cat) => _cat.isActiveBefore && !_cat.isActive\n    );\n    var cats_Appearing = this.DOM.aggrGlyphs.filter(\n      (_cat) => !_cat.isActiveBefore && _cat.isActive\n    );\n    var cats_Active = this.DOM.aggrGlyphs.filter((_cat) => _cat.isActive);\n\n    cats_NotActiveBeforeAndNow.style(\"display\", \"none\");\n\n    var xRemoveOffset = -100;\n\n    // Disappear animation\n    cats_Disappearing\n      .transition()\n      .duration(sortDelay)\n      .on(\"end\", function (aggr) {\n        this.style.opacity = 0;\n        aggr.posX = xRemoveOffset;\n        this.style.transform = aggr.transformPos;\n      })\n      .transition()\n      .duration(1000)\n      .on(\"end\", function () {\n        this.style.display = \"none\";\n      });\n\n    // Appear animation (initial position)\n    cats_Appearing\n      .transition()\n      .duration(sortDelay)\n      .on(\"end\", (aggr, i, nodes) => {\n        var node = nodes[i];\n        node.style.opacity = 0;\n        node.style.display = null;\n        aggr.posX = xRemoveOffset;\n        node.style.transform = aggr.transformPos;\n      });\n\n    // Sort animation\n    var perCatDelay = 30;\n    cats_Active\n      .style(\"display\", null)\n      .transition()\n      .duration((_cat) => {\n        if (_cat.isVisibleBefore && !_cat.isVisible) return sortDelay;\n        var x = _cat.isActiveBefore\n          ? 0\n          : (this.catCount_InDisplay - 5) * perCatDelay; // appear animation is further delayed\n        return (\n          100 +\n          sortDelay +\n          x +\n          Math.min(_cat.orderIndex, this.catCount_InDisplay + 2) * perCatDelay\n        );\n      })\n      .on(\"end\", (aggr, i, nodes) => {\n        aggr.posX = 0;\n        nodes[i].style.opacity = 1;\n        nodes[i].style.transform = aggr.transformPos;\n      })\n      .transition()\n      .duration(250)\n      .on(\"end\", (aggr, i, nodes) => {\n        if (!(aggr.isVisible || aggr.isVisibleBefore)) {\n          nodes[i].style.display = \"none\";\n        }\n      });\n  }\n\n  // ********************************************************************\n  // Dropdown\n  // ********************************************************************\n\n  public dropdown_type: DropdownType = \"SingleSelect\";\n\n  private choicesUI: any;\n\n  dropdown_prepView() {\n    this.insertCategoryGlyphs();\n  }\n\n  dropdown_refreshCategories() {\n    if (!this.DOM) return;\n    if (!this.DOM.summaryCategorical) return;\n    if (!this.inDashboard) return;\n    if (!this.isVisible()) return;\n\n    import(\"choices.js\").then((Choices) => {\n      var me = this; // callbacks set their own this context for choices library\n\n      var cfg = {\n        searchEnabled: this._aggrs.length > 15,\n        searchResultLimit: 20,\n        searchPlaceholderValue: i18n.Search,\n        shouldSort: false,\n        shouldSortItems: false,\n        duplicateItemsAllowed: false,\n        paste: false,\n\n        removeItemButton: this.dropdown_type === \"MultiSelect\" ? true : false,\n        placeholder: this.dropdown_type === \"MultiSelect\" ? true : \"\",\n        placeholderValue: i18n.All,\n\n        callbackOnCreateTemplates: () => ({\n          choice(classes, obj) {\n            const el = Choices.defaults.templates.choice.call(\n              this,\n              classes,\n              obj\n            );\n            var aggr = me.attrib.catTable_id[obj.label];\n            if (aggr && aggr.compared) {\n              el.classList.add(aggr.compared);\n            }\n            return el;\n          },\n          item(classes, obj) {\n            const el = Choices.defaults.templates.item.call(\n              this,\n              classes,\n              obj,\n              me.dropdown_type === \"MultiSelect\"\n            );\n            var aggr = me.attrib.catTable_id[obj.label];\n            if (aggr && aggr.compared) {\n              el.classList.add(\"bg_\" + aggr.compared);\n            }\n            return el;\n          },\n        }),\n      };\n\n      if (this.choicesUI) {\n        this.choicesUI.destroy();\n        this.DOM.ChoicesSelectDOM.remove();\n      }\n\n      this.DOM.ChoicesSelectDOM = this.DOM.summaryCategorical\n        .append(\"select\")\n        .attr(\"multiple\", this.dropdown_type === \"MultiSelect\" ? true : null);\n\n      this.DOM.ChoicesSelectDOM.node().addEventListener(\n        \"removeItem\",\n        (event) => {\n          if (this.dropdown_type !== \"MultiSelect\") return;\n          var _cat = event.detail.customProperties;\n          if (!_cat) {\n            // choices js: Update/remove after version update of library, feature just added.\n            _cat = this.attrib.catTable_id[event.detail.label];\n          }\n          if (_cat) this.attrib.onAggrClick(event, _cat);\n        }\n      );\n\n      this.DOM.ChoicesSelectDOM.node().addEventListener(\"choice\", (_event) => {\n        var selectedCat = this.attrib.summaryFilter.selected_AND[0];\n        var _cat = _event.detail.choice.customProperties as Aggregate_Category;\n        // selecting filtered category again\n        if (_cat && selectedCat && selectedCat.label === _cat.label) return;\n        if (_cat && _cat.recCnt(\"Active\") === 0 && !this.attrib.isFiltered()) {\n          Modal.alert(\n            i18n[\n              \"Cannot select an option with no data in current filtered dashboard.\"\n            ]\n          );\n          return;\n        }\n        window.setTimeout(() => {\n          if (this.dropdown_type === \"MultiSelect\") {\n            if (_cat) {\n              if (this.attrib.isFiltered()) {\n                this.attrib.filterCategory(\n                  _cat,\n                  this.attrib.isMultiValued ? \"AND\" : \"OR\",\n                  \"All\"\n                );\n              } else {\n                this.attrib.filterCategory(_cat, \"AND\", \"All\");\n              }\n            } else {\n              this.attrib.summaryFilter.clearFilter(_cat ? false : true);\n            }\n            return;\n          }\n          this.attrib.summaryFilter.clearFilter(_cat ? false : true);\n          if (_cat) {\n            this.attrib.filterCategory(_cat, \"AND\", \"All\");\n          }\n        }, 10);\n      });\n\n      this.choicesUI = new Choices(this.DOM.ChoicesSelectDOM.node(), cfg);\n      this.choicesUI.setChoices(\n        [\n          // \"All\" option\n          {\n            value: \"-\",\n            label: i18n.All,\n            selected: this.attrib.isFiltered() ? null : true,\n          },\n        ].concat(\n          this._aggrs.map((aggr) => ({\n            value: aggr.label,\n            label: aggr.label,\n            selected: !aggr.isFiltered() ? null : true,\n            disabled:\n              aggr.recCnt(\"Active\") === 0 && !this.attrib.isFiltered()\n                ? true\n                : null,\n            customProperties: aggr,\n          }))\n        ),\n        \"value\",\n        \"label\",\n        true\n      );\n    });\n  }\n}\n","import { Aggregate } from \"./Aggregate\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\n\nexport type CatFilterType = \"AND\" | \"OR\" | \"NOT\";\n\n/** -- */\nexport class Aggregate_Category extends Aggregate {\n  readonly attrib: Attrib_Categorical;\n\n  // DOM elements\n  public DOM: {\n    aggrGlyph?: Element;\n    matrixRow?: Element;\n  } = {};\n\n  private readonly _id: string;\n\n  private _label: string = null;\n\n  // additional active status is needed for some UI / animations\n  isActive?: boolean;\n  isActiveBefore?: boolean;\n\n  constructor(attrib: Attrib_Categorical, id: string) {\n    super(attrib);\n    this._id = id;\n  }\n\n  get id(): string {\n    return this._id;\n  }\n  set label(v: string) {\n    this._label = v;\n  }\n  /** If a separate label has not been assigned, the id of the category. */\n  get label(): string {\n    return this._label || this._id;\n  }\n\n  get tooltipTitle(): string {\n    return this.attrib.attribNameHTML;\n  }\n  protected get tooltipSkip1(): boolean {\n    return !this.filtered_AND();\n  }\n\n  /** Overwrite */\n  setAggrGlyph(v: Element) {\n    super.setAggrGlyph(v);\n    this.refreshCatDOMSelected();\n  }\n\n  // ********************************************************************\n  // Filtering\n  // ********************************************************************\n\n  private catFiltering: CatFilterType = null;\n\n  isFiltered(): boolean {\n    return this.catFiltering !== null;\n  }\n  filtered_NOT(): boolean {\n    return this.catFiltering === \"NOT\";\n  }\n  filtered_AND(): boolean {\n    return this.catFiltering === \"AND\";\n  }\n  filtered_OR(): boolean {\n    return this.catFiltering === \"OR\";\n  }\n\n  set_NONE(): void {\n    if (this.inList) this.inList.splice(this.inList.indexOf(this), 1);\n    this.catFiltering = null;\n    this.refreshCatDOMSelected();\n  }\n  set_NOT(l: Aggregate_Category[]): void {\n    if (this.filtered_NOT()) return;\n    this.catFiltering = \"NOT\";\n    this.insertToList(l);\n  }\n  set_AND(l: Aggregate_Category[]): void {\n    if (this.filtered_AND()) return;\n    this.catFiltering = \"AND\";\n    this.insertToList(l);\n  }\n  set_OR(l: Aggregate_Category[]): void {\n    if (this.filtered_OR()) return;\n    this.catFiltering = \"OR\";\n    this.insertToList(l);\n  }\n\n  /** -- */\n  unselectAggregate(): void {\n    super.unselectAggregate();\n    if (this.locked) return;\n    this.DOM.matrixRow?.removeAttribute(\"selection\");\n  }\n\n  // ********************************************************************\n  // Export\n  // ********************************************************************\n\n  exportAggregateInfo() {\n    return {\n      id: this.id,\n    };\n  }\n\n  // ********************************************************************\n  // Visualization parameters\n  // ********************************************************************\n\n  // Order index of the category among other categories in the attrib\n  public orderIndex: number = 0;\n\n  /** -- Visual variable */\n  public posX: number = 0;\n  get posY(): number {\n    return this.orderIndex * this.attrib.barHeight.get();\n  }\n  get transformPos() {\n    return `translate(${this.posX}px, ${this.posY}px)`;\n  }\n\n  // ********************************************************************\n  // Set (multi-value) cache\n  // ********************************************************************\n\n  // the list of setpairs this category appears in (is one of the sets)\n  setPairs?: Aggregate_SetPair[];\n  // for computing MST tree (perceptual ordering)\n  MST?: {\n    tree: {}; // Some unqiue identifier, to check if two nodes are in the same tree.\n    childNodes: Aggregate_Category[];\n    parentNode: Aggregate_Category | null;\n    treeSize?: number; // computed recursively from the node networks\n    order?: number;\n  };\n\n  // ********************************************************************\n  // Geographic data cache\n  // ********************************************************************\n\n  public _geo_: any = null;\n\n  // ********************************************************************\n  // Private helpers\n  // ********************************************************************\n\n  private inList: Aggregate_Category[];\n\n  /** -- */\n  private insertToList(l: Aggregate_Category[]) {\n    if (this.inList) this.inList.splice(this.inList.indexOf(this), 1);\n    this.inList = l;\n    l.push(this);\n    this.refreshCatDOMSelected();\n  }\n\n  /** -- */\n  private refreshCatDOMSelected() {\n    if (!this.catFiltering) {\n      this.DOM.aggrGlyph?.removeAttribute(\"catFiltered\");\n    } else {\n      this.DOM.aggrGlyph?.setAttribute(\"catFiltered\", this.catFiltering);\n    }\n  }\n}\n","import { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Aggregate_Category } from \"./Aggregate_Category\";\nimport { Aggregate } from \"./Aggregate\";\n\n/** -- */\nexport class Aggregate_SetPair extends Aggregate {\n  readonly attrib: Attrib_Categorical;\n\n  // Composed of two sets (categories)\n  readonly set_1: Aggregate_Category;\n  readonly set_2: Aggregate_Category;\n\n  constructor(\n    attrib: Attrib_Categorical,\n    set_1: Aggregate_Category,\n    set_2: Aggregate_Category\n  ) {\n    super(attrib);\n    this.set_1 = set_1;\n    this.set_2 = set_2;\n  }\n\n  mst_distance: number = 0;\n\n  similarityScore() {\n    var size_and = this.measure(\"Active\");\n    if (size_and === 0) return 0;\n\n    var size_A = this.set_1.measure(\"Active\");\n    var size_B = this.set_2.measure(\"Active\");\n    return size_and / Math.min(size_A, size_B);\n  }\n\n  get label() {\n    return `${this.set_1.label}<br> &amp; ${this.set_2.label}`;\n  }\n\n  exportAggregateInfo() {\n    return {};\n  }\n}\n","import { select, pointer } from \"./d3_select\";\nimport { max } from \"d3-array\";\nimport { format } from \"d3-format\";\nimport { easeLinear } from \"d3-ease\";\nimport { interpolate, interpolateHsl } from \"d3-interpolate\";\nimport { rgb } from \"d3-color\";\n\nimport { Attrib_Set } from \"./Attrib_Set\";\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\nimport { Block } from \"./Block\";\nimport { i18n } from \"./i18n\";\nimport { Base } from \"./Base\";\nimport { CompareType } from \"./Types\";\nimport { Aggregate_Category } from \"./Aggregate_Category\";\nimport { Util } from \"./Util\";\n\nconst d3 = {\n  select,\n  pointer,\n  max,\n  format,\n  easeLinear,\n  interpolate,\n  interpolateHsl,\n  rgb,\n};\n\nexport class Block_Set extends Block {\n  // specific attribute type\n  public readonly attrib: Attrib_Set;\n\n  constructor(attrib: Attrib_Set) {\n    super(attrib);\n\n    this.panel = attrib.setListAttrib.block.panel;\n  }\n\n  // ********************************************************************\n  // Shorthand\n  // ********************************************************************\n\n  get setPairs(): Aggregate_SetPair[] {\n    return this.attrib.setPairs;\n  }\n  get setListSummary() {\n    return this.attrib.parent;\n  }\n  get rowHeight(): number {\n    return this.setListSummary.barHeight.get();\n  }\n\n  /** -- */\n  get setPairCount_Total() {\n    return (this.attrib.sets.length * (this.attrib.sets.length - 1)) / 2;\n  }\n\n  get popupSide() {\n    return this.setListSummary.block.panel.name === \"left\" ? \"right\" : \"left\";\n  }\n\n  // ********************************************************************\n  // Radius / diameter\n  // ********************************************************************\n\n  private setPairDiameter = 0;\n\n  updateSetPairDiameter() {\n    this.setPairDiameter = this.rowHeight - 2;\n  }\n\n  /** Shorthand - half of diameter */\n  get setPairRadius() {\n    return this.setPairDiameter / 2;\n  }\n\n  // ********************************************************************\n  // Maximum active values\n  // ********************************************************************\n\n  private _maxSetPairAggr_Active = 0;\n\n  /** -- */\n  updateMaxAggr_Active() {\n    this._maxSetPairAggr_Active = d3.max(\n      this.setPairs,\n      (aggr: Aggregate_SetPair) => aggr.measure(\"Active\")\n    );\n  }\n\n  /** -- */\n  private getCliqueSizeRatio(setPair) {\n    return this._maxSetPairAggr_Active === 0\n      ? 0\n      : Math.sqrt(setPair.measure(\"Active\") / this._maxSetPairAggr_Active);\n  }\n\n  /** -- */\n  private usingFullSizeGlyph() {\n    return this.browser.relativeBreakdown || this.browser.dependentBreakdown;\n  }\n\n  /** -- */\n  setCollapsed(v: boolean): void {\n    this.setListSummary.block.showSetMatrix(v !== true);\n  }\n\n  private gridPan_x = 0;\n  public pausePanning = false;\n\n  // ********************************************************************\n  // Height and width management\n  // ********************************************************************\n\n  /** always has static height */\n  hasStaticHeight(): boolean {\n    return true;\n  }\n  get height_Content(): number {\n    return this.setListSummary.block.height_Content;\n  }\n  get height_RangeMin(): number {\n    return this.setListSummary.block.height_RangeMin;\n  }\n  get height_RangeMax(): number {\n    return this.setListSummary.block.height_RangeMax;\n  }\n  getHeight(): number {\n    return this.setListSummary.block.height_Categories;\n  }\n  setHeight(targetHeight: number): void {\n    this.setListSummary.block.setHeight(targetHeight);\n  }\n\n  refreshHeight() {\n    if (!this.isVisible()) return;\n\n    this.updateSetPairDiameter();\n\n    this.DOM.chartRoot.attr(\"show_gridlines\", this.rowHeight > 15);\n\n    this.DOM.setPairGroup.attr(\"animate_position\", false);\n    this.refreshRow();\n\n    this.refreshSetPair_Background();\n    this.refreshSetPair_Position();\n    this.refreshViz_All();\n    this.refreshSetPair_Strength();\n    setTimeout(\n      () => this.DOM.setPairGroup.attr(\"animate_position\", true),\n      1000\n    );\n  }\n\n  /** -- */\n  getWidth(): number {\n    return this.browser.panels.middle.width_Real + Base.width_PanelGap;\n  }\n  /** -- */\n  refreshWidth(): void {\n    this.refreshWindowSize();\n    if (this.popupSide === \"left\") {\n      this.refreshRow_LineWidths();\n      this.refreshSetPair_Position();\n    }\n  }\n\n  initDOM(beforeDOM = null): boolean {\n    // Inserts the DOM root under the setListSummary so that the matrix view is attached...\n    this.DOM.root = this.setListSummary.block.DOM.root\n      .insert(\"div\", \":first-child\")\n      .attr(\"class\", \"kshfSummary setPairSummary\")\n      .attr(\"data-popupSide\", this.popupSide);\n\n    // Use keshif's standard header\n    this.insertHeader();\n\n    this.DOM.chartRoot = this.DOM.wrapper\n      .append(\"span\")\n      .attr(\"class\", \"Summary_Set\")\n      .attr(\"show_gridlines\", true);\n\n    this.insertSummaryControls();\n\n    this.DOM.setMatrixSVG = this.DOM.chartRoot\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .attr(\"class\", \"setMatrix\");\n\n    /** BELOW THE MATRIX **/\n    this.DOM.belowMatrix = this.DOM.chartRoot\n      .append(\"div\")\n      .attr(\"class\", \"belowMatrix\");\n\n    this.DOM.pairCount = this.DOM.belowMatrix\n      .append(\"span\")\n      .attr(\"class\", \"pairCount matrixInfo\");\n    this.DOM.pairCount_Text = this.DOM.pairCount\n      .append(\"span\")\n      .attr(\"class\", \"pairCount_Text\")\n      .html(`<i class='fa fa-circle' style='color: #b1bdc5;'></i> \n      ${this.setPairs.length} ${i18n.Pairs} (${Math.round(\n      (100 * this.setPairs.length) / this.setPairCount_Total\n    )}%)`);\n\n    this.DOM.subsetCount = this.DOM.belowMatrix\n      .append(\"span\")\n      .attr(\"class\", \"subsetCount matrixInfo\");\n    this.DOM.subsetCount.append(\"span\").attr(\"class\", \"circleeee borrderr\");\n    this.DOM.subsetCount_Text = this.DOM.subsetCount\n      .append(\"span\")\n      .attr(\"class\", \"subsetCount_Text\");\n\n    this.DOM.strengthControl = this.DOM.belowMatrix\n      .append(\"span\")\n      .attr(\"class\", \"strengthControl matrixInfo\")\n      .tooltip(\n        \"Cell color shows strength (ratio of shared elements) between categories.\"\n      );\n\n    // ******************* STRENGTH CONFIG\n    this.DOM.strengthControl\n      .append(\"span\")\n      .attr(\"class\", \"strengthLabel\")\n      .text(i18n.Weak);\n    this.DOM.strengthControl\n      .append(\"span\")\n      .attr(\"class\", \"strengthText\")\n      .text(i18n.Strength);\n    this.DOM.strengthControl\n      .append(\"span\")\n      .attr(\"class\", \"strengthLabel\")\n      .text(i18n.Strong);\n\n    // invisible background - Used for panning\n    this.DOM.setMatrixBackground = this.DOM.setMatrixSVG\n      .append(\"rect\")\n      .attr(\"class\", \"setMatrixBackground\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .style(\"fill-opacity\", \"0\")\n      .on(\"mousedown\", (event) => {\n        this.browser.DOM.pointerBlock.attr(\"active\", \"\");\n        this.browser.DOM.root.attr(\"pointerEvents\", false);\n\n        var mouseInitPos = d3.pointer(event, this.browser.DOM.root.node());\n\n        var gridPan_x_init = this.gridPan_x;\n\n        // scroll the setlist summary too...\n        var scrollDom = this.setListSummary.block.DOM.aggrGroup.node();\n        var initScrollPos = scrollDom.scrollTop;\n        var w = this.getWidth();\n        var h = this.getHeight();\n        var initT = this.setListSummary.block.scrollTop_cache;\n        var initR = Math.min(-initT - this.gridPan_x, 0);\n\n        this.pausePanning = true;\n\n        d3.select(\"body\")\n          .on(\"mousemove\", (event2) => {\n            var mouseMovePos = d3.pointer(event2, this.browser.DOM.root.node());\n            var difX = mouseMovePos[0] - mouseInitPos[0];\n            var difY = mouseMovePos[1] - mouseInitPos[1];\n\n            if (this.popupSide === \"right\") difX *= -1;\n\n            this.gridPan_x = gridPan_x_init + difX + difY;\n            //this.gridPan_x = Math.min(this.getWidth(),gridPan_x_init+difX+difY);\n\n            this.refreshSVGViewBox();\n\n            scrollDom.scrollTop = Math.max(0, initScrollPos - difY);\n\n            event2.preventDefault();\n            event2.stopPropagation();\n          })\n          .on(\"mouseup\", (event3) => {\n            this.pausePanning = false;\n            this.browser.DOM.root.attr(\"pointerEvents\", null);\n            this.browser.DOM.pointerBlock.attr(\"active\", null);\n            this.refreshLabel_Vert_Show();\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n            event3.preventDefault();\n            event3.stopPropagation();\n          });\n        event.preventDefault();\n        event.stopPropagation();\n      });\n\n    this.DOM.setMatrixSVG\n      .append(\"g\")\n      .attr(\"class\", \"rows\")\n      .style(\"transform\", \"translateY(0.5px)\"); // adjusting to match to list-view on the side on retina displays.\n    this.DOM.setPairGroup = this.DOM.setMatrixSVG\n      .append(\"g\")\n      .attr(\"class\", \"aggrGroup setPairGroup\")\n      .attr(\"animate_position\", true);\n\n    this.insertRows();\n    this.insertSetPairs();\n\n    this.updateSetPairDiameter();\n\n    this.refreshRow();\n\n    this.refreshSetPair_Background();\n    this.refreshSetPair_Position();\n    this.refreshSetPair_Containment();\n\n    this.refreshViz_Axis();\n    this.refreshViz_Active();\n    this.refreshViz_Compare_All();\n\n    this.DOM.inited = true;\n\n    return true;\n  }\n\n  /** -- */\n  insertSummaryControls() {\n    this.DOM.summaryControls = this.DOM.chartRoot\n      .append(\"div\")\n      .attr(\"class\", \"summaryControls\")\n      .style(\"height\", this.setListSummary.block.height_Config + 1 + \"px\");\n\n    this.DOM.scaleLegend_SVG = this.DOM.summaryControls\n      .append(\"svg\")\n      .attr(\"class\", \"sizeLegend\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\");\n\n    this.DOM.legendHeader = this.DOM.scaleLegend_SVG\n      .append(\"text\")\n      .attr(\"class\", \"legendHeader\")\n      .text(\"#\");\n    this.DOM.legend_Group = this.DOM.scaleLegend_SVG.append(\"g\");\n  }\n\n  /** -- */\n  insertRows() {\n    var newRows = this.DOM.setMatrixSVG\n      .select(\"g.rows\")\n      .selectAll(\"g.row\")\n      .data(this.attrib.sets, (aggr) => aggr.id)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"row\")\n      .each((aggr: Aggregate_Category, i, nodes) => {\n        aggr.DOM.matrixRow = nodes[i];\n      })\n      .on(\"mouseenter\", (_event, aggr: Aggregate_Category) =>\n        this.setListSummary.onAggrHighlight(aggr)\n      )\n      .on(\"mouseleave\", (_event, aggr: Aggregate_Category) =>\n        this.setListSummary.onAggrLeave(aggr)\n      );\n\n    // tmp is used to parse html text\n    var tmp = document.createElement(\"div\");\n\n    newRows\n      .append(\"line\")\n      .attr(\"class\", \"line line_vert\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", 0)\n      .attr(\"y1\", 0)\n      .attr(\"y2\", 0);\n    newRows\n      .append(\"text\")\n      .attr(\"class\", \"catLabel label_horz\")\n      .style(\"font-size\", this.setListSummary.block.catLabelFontSize + \"px\")\n      .text((aggr: Aggregate_Category) => {\n        tmp.innerHTML = aggr.label;\n        return tmp.textContent || tmp.innerText || \"\";\n      })\n      .on(\"click\", (_event, aggr: Aggregate_Category) => {\n        this.setListSummary.filterCategory(aggr, \"AND\");\n      });\n\n    newRows\n      .append(\"line\")\n      .attr(\"class\", \"line line_horz\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", 0)\n      .attr(\"y2\", 0);\n    newRows\n      .append(\"text\")\n      .attr(\"class\", \"catLabel label_vert\")\n      .style(\"font-size\", this.setListSummary.block.catLabelFontSize + \"px\")\n      .text((aggr: Aggregate_Category) => {\n        tmp.innerHTML = aggr.label;\n        return tmp.textContent || tmp.innerText || \"\";\n      })\n      .attr(\"y\", -4);\n\n    tmp.remove();\n\n    this.DOM.setRows = this.DOM.setMatrixSVG.selectAll(\"g.rows > g.row\");\n    this.DOM.line_vert = this.DOM.setMatrixSVG.selectAll(\n      \"g.rows > g.row > line.line_vert\"\n    );\n    this.DOM.line_horz = this.DOM.setMatrixSVG.selectAll(\n      \"g.rows > g.row > line.line_horz\"\n    );\n    this.DOM.line_horz_label = this.DOM.setMatrixSVG.selectAll(\n      \"g.rows > g.row > text.label_horz\"\n    );\n    this.DOM.line_vert_label = this.DOM.setMatrixSVG.selectAll(\n      \"g.rows > g.row > text.label_vert\"\n    );\n  }\n\n  /** -- */\n  refreshViz_Active() {\n    this.DOM.aggrGlyphs.attr(\"activesize\", (aggr) => aggr.measure(\"Active\"));\n    this.DOM.measure_Active\n      .transition()\n      .ease(d3.easeLinear)\n      .duration(500)\n      .attr(\n        \"r\",\n        this.usingFullSizeGlyph()\n          ? (setPair) => this.setPairRadius + (setPair.subt ? -1 : 0)\n          : (setPair) => this.getCliqueSizeRatio(setPair) * this.setPairRadius\n      );\n  }\n\n  /** -- */\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts) {\n    var strokeWidth = (aggr) => 0;\n    var aggrValue = (aggr, sT) => aggr.ratioToActive(sT);\n    var usingFullSizeGlyph = this.usingFullSizeGlyph();\n    if (!this.browser.stackedCompare) {\n      strokeWidth = (aggr) =>\n        (this.setPairRadius / totalGroups) *\n        (usingFullSizeGlyph ? 1 : this.getCliqueSizeRatio(aggr));\n      prevCts = [];\n    }\n\n    if (this.browser.dependentBreakdown) {\n      aggrValue = (aggr, sT) =>\n        aggr[sT].measure /\n        (this.browser.allRecordsAggr[cT].measure || 10000000000000);\n    }\n\n    this.DOM[\"measure_\" + cT]\n      .style(\"stroke-width\", strokeWidth)\n      .transition()\n      .ease(d3.easeLinear)\n      .duration(\n        curGroup === totalGroups - 1 && this.browser.addedCompare ? 500 : 0\n      )\n      .attrTween(\"d\", (aggr, i, nodes) => {\n        var DOM = nodes[i];\n        var offset = prevCts.reduce(\n          (accum, sT) => accum + aggrValue(aggr, sT),\n          0\n        );\n        var angleInterp = d3.interpolate(\n          DOM._currentPreviewAngle,\n          aggrValue(aggr, cT)\n        );\n        var r =\n          this.setPairRadius *\n            (usingFullSizeGlyph ? 1 : this.getCliqueSizeRatio(aggr)) -\n          (this.browser.stackedCompare\n            ? 0\n            : (curGroup + 0.5) * strokeWidth(aggr)); // side-by-side radius adjust\n        return (t) => {\n          var newAngle = angleInterp(t);\n          DOM._currentPreviewAngle = newAngle;\n          return Util.getPieSVGPath(\n            offset,\n            newAngle,\n            r,\n            !this.browser.stackedCompare\n          );\n        };\n      });\n  }\n\n  chartAxis_Measure_TickSkip(): number {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  /** -- */\n  updateAfterFilter(refreshViz: boolean): void {\n    if (!this.isVisible()) return;\n    this.updateMaxAggr_Active();\n    this.refreshViz_All();\n    this.refreshViz_NoValueAggr();\n\n    this.DOM.setRows.style(\"opacity\", (row) =>\n      row.Active.measure > 0 ? 1 : 0.3\n    );\n\n    this.refreshSetPair_Containment();\n  }\n\n  /** Does not work with Avg pair */\n  private refreshSetPair_Containment() {\n    var numOfSubsets = 0;\n    this.DOM.aggrGlyphs\n      .each((setPair) => {\n        var setPair_itemCount = setPair.Active.measure;\n        var set_1_itemCount = setPair.set_1.Active.measure;\n        var set_2_itemCount = setPair.set_2.Active.measure;\n        if (\n          setPair_itemCount === set_1_itemCount ||\n          setPair_itemCount === set_2_itemCount\n        ) {\n          numOfSubsets++;\n          setPair.subset =\n            set_1_itemCount === set_2_itemCount ? \"equal\" : \"proper\";\n        } else {\n          setPair.subset = \"\";\n        }\n      })\n      .classed(\"isSubset\", (setPair) => setPair.subset !== \"\");\n\n    this.DOM.subsetCount.style(\"display\", numOfSubsets === 0 ? \"none\" : null);\n    this.DOM.subsetCount_Text.text(numOfSubsets);\n\n    this.refreshSetPair_Strength();\n  }\n\n  /** -- */\n  onSetPairEnter(aggr: Aggregate_SetPair) {\n    aggr.set_1.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\n    aggr.set_2.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\n    this.browser.setSelect_Compare(aggr);\n  }\n\n  /** -- */\n  onSetPairLeave(aggr: Aggregate_SetPair) {\n    aggr.set_1.DOM.matrixRow?.removeAttribute(\"selection\");\n    aggr.set_2.DOM.matrixRow?.removeAttribute(\"selection\");\n    this.browser.clearSelect_Compare();\n    this.browser.refreshAllMeasureLabels(\"Active\");\n  }\n\n  /** -- */\n  private refreshSetPair_Strength() {\n    var strengthColor = d3.interpolateHsl(\n      d3.rgb(169, 181, 190),\n      d3.rgb(232, 235, 238)\n    );\n\n    let _maxSimilarity = d3.max(this.setPairs, (aggr: Aggregate_SetPair) =>\n      aggr.similarityScore()\n    );\n\n    this.DOM.setPairBackground\n      .style(\"fill\", (setPair: Aggregate_SetPair) =>\n        strengthColor(setPair.similarityScore() / _maxSimilarity)\n      )\n      .each((setPair, i, nodes) => {\n        var _DOM = nodes[i];\n        // border\n        if (setPair.subset === \"\") return;\n        if (setPair.subset === \"equal\") {\n          _DOM.style.strokeDasharray = \"\";\n          _DOM.style.strokeDashoffset = \"\";\n          return;\n        }\n        var halfCircle = (this.setPairRadius - 1) * Math.PI;\n        _DOM.style.strokeDasharray = halfCircle + \"px\";\n        // rotate halfway\n        var i1 = setPair.set_1.orderIndex;\n        var i2 = setPair.set_2.orderIndex;\n        var c1 = setPair.set_1.Active.measure;\n        var c2 = setPair.set_2.Active.measure;\n        if ((i1 < i2 && c1 < c2) || (i1 > i2 && c1 > c2))\n          halfCircle = halfCircle / 2;\n        _DOM.style.strokeDashoffset = halfCircle + \"px\";\n      });\n  }\n\n  /** -- */\n  insertSetPairs() {\n    var me = this;\n    var newCliques = this.DOM.setMatrixSVG\n      .select(\"g.setPairGroup\")\n      .selectAll(\"g.setPairGlyph\")\n      .data(this.setPairs, (_, i) => i)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"aggrGlyph setPairGlyph\")\n      .each((d: Aggregate_SetPair, i, nodes) => {\n        d.setAggrGlyph(nodes[i]);\n      })\n      .tooltip((aggr: Aggregate_SetPair) => aggr.getTooltipHTML(), {\n        theme: \"dark kshf-tooltip kshf-record\",\n        placement: \"right\",\n        animation: \"fade\",\n        boundary: \"window\",\n        trigger: \"manual\",\n      })\n      .on(\"mouseenter\", (event, aggr: Aggregate_SetPair) => {\n        if (me.browser.adjustMode) return;\n        var DOM = event.currentTarget;\n        if (DOM.highlightTimeout) window.clearTimeout(DOM.highlightTimeout);\n        DOM.highlightTimeout = window.setTimeout(() => {\n          DOM.tippy.show();\n          this.onSetPairEnter(aggr);\n        }, me.browser.movingMouseDelay);\n      })\n      .on(\"mouseleave\", (event, aggr: Aggregate_SetPair) => {\n        var DOM = event.currentTarget;\n        if (DOM.highlightTimeout) window.clearTimeout(DOM.highlightTimeout);\n        DOM.tippy.hide();\n        this.onSetPairLeave(aggr);\n      })\n      .on(\"click\", (_event, aggr: Aggregate_SetPair) => {\n        this.setListSummary.filterCategory(aggr.set_1, \"AND\");\n        this.setListSummary.filterCategory(aggr.set_2, \"AND\");\n      });\n\n    newCliques\n      .append(\"rect\")\n      .attr(\"class\", \"setPairBackground\")\n      .attr(\"rx\", 3)\n      .attr(\"ry\", 3);\n    var measureGroup = newCliques.append(\"g\").attr(\"class\", \"measureGroup\");\n    measureGroup\n      .append(\"circle\")\n      .attr(\"class\", \"measure_Active\")\n      .attr(\"cx\", 0)\n      .attr(\"cy\", 0)\n      .attr(\"r\", 0);\n    Base.Compare_List.forEach((cT) => {\n      this.DOM[\"measure_\" + cT] = measureGroup\n        .append(\"path\")\n        .attr(\"class\", \"measure_\" + cT)\n        .each((_d, i, nodes) => {\n          nodes[i]._currentPreviewAngle = 0;\n        });\n    });\n\n    this.DOM.aggrGlyphs = this.DOM.setPairGroup.selectAll(\".setPairGlyph\");\n    this.DOM.setPairBackground =\n      this.DOM.aggrGlyphs.selectAll(\".setPairBackground\");\n    [\"Active\"].concat(Base.Compare_List).forEach((t) => {\n      this.DOM[\"measure_\" + t] = this.DOM.aggrGlyphs.selectAll(\".measure_\" + t);\n    });\n  }\n\n  /** Axis is shown as a separate legend for set summaries */\n  refreshViz_Axis() {\n    this.refreshSetPair_Strength();\n\n    if (this.usingFullSizeGlyph()) {\n      this.DOM.scaleLegend_SVG.style(\"dislay\", \"none\");\n      return;\n    }\n    this.DOM.scaleLegend_SVG.style(\"display\", \"block\");\n\n    this.DOM.scaleLegend_SVG\n      .attr(\"width\", this.setPairDiameter + 50)\n      .attr(\"height\", this.setPairDiameter + 10)\n      .attr(\n        \"viewBox\",\n        \"0 0 \" + (this.setPairDiameter + 35) + \" \" + (this.setPairDiameter + 10)\n      );\n\n    this.DOM.legend_Group.attr(\n      \"transform\",\n      `translate(${this.setPairRadius},${this.setPairRadius + 18})`\n    );\n    this.DOM.legendHeader.attr(\n      \"transform\",\n      `translate(${this.setPairDiameter + 3},6)`\n    );\n\n    var maxVal = this._maxSetPairAggr_Active;\n\n    var tickValues = [maxVal];\n    if (this.setPairRadius > 8) tickValues.push(Math.round(maxVal / 4));\n\n    this.DOM.legend_Group.selectAll(\"g.legendMark\").remove();\n\n    var tickDoms = this.DOM.legend_Group\n      .selectAll(\"g.legendMark\")\n      .data(tickValues, (i) => i);\n\n    this.DOM.legendCircleMarks = tickDoms\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"legendMark\");\n\n    this.DOM.legendCircleMarks\n      .append(\"circle\")\n      .attr(\"class\", \"legendCircle\")\n      .attr(\"cx\", 0)\n      .attr(\"cy\", 0)\n      .attr(\"r\", (d) => this.setPairRadius * Math.sqrt(d / maxVal));\n    this.DOM.legendCircleMarks\n      .append(\"line\")\n      .attr(\"class\", \"legendLine\")\n      .each((d, i, nodes) => {\n        var rx = this.setPairRadius + 3;\n        var ry = this.setPairRadius * Math.sqrt(d / maxVal);\n        var x2, y1;\n        switch (i % 4) {\n          case 0:\n            x2 = rx;\n            y1 = -ry;\n            break;\n          case 1:\n            x2 = rx; // -rx;\n            y1 = ry; // -ry;\n            break;\n          case 2:\n            x2 = rx;\n            y1 = ry;\n            break;\n          case 3:\n            x2 = -rx;\n            y1 = ry;\n            break;\n        }\n        nodes[i].setAttribute(\"x1\", 0);\n        nodes[i].setAttribute(\"x2\", x2);\n        nodes[i].setAttribute(\"y1\", y1);\n        nodes[i].setAttribute(\"y2\", y1);\n      });\n    this.DOM.legendText = this.DOM.legendCircleMarks\n      .append(\"text\")\n      .attr(\"class\", \"legendLabel\");\n\n    this.DOM.legendText.each((d, i, nodes) => {\n      var rx = this.setPairRadius + 3;\n      var ry = this.setPairRadius * Math.sqrt(d / maxVal);\n      var x2, y1;\n      switch (i % 4) {\n        case 0:\n          x2 = rx;\n          y1 = -ry;\n          break;\n        case 1:\n          x2 = rx; // -rx;\n          y1 = ry; // -ry;\n          break;\n        case 2:\n          x2 = rx;\n          y1 = ry;\n          break;\n        case 3:\n          x2 = -rx;\n          y1 = ry;\n          break;\n      }\n      nodes[i].setAttribute(\"transform\", `translate(${x2},${y1})`);\n      nodes[i].style.textAnchor = i % 2 === 0 || true ? \"start\" : \"end\";\n    });\n\n    this.DOM.legendText.text((d) => {\n      return d3.format(\"0.1s\")(d);\n    });\n  }\n\n  /** -- */\n  refreshWindowSize() {\n    var w = this.getWidth();\n    var h = this.getHeight();\n    this.DOM.wrapper.style(\n      \"height\",\n      this.setListSummary.block.getHeight() -\n        this.setListSummary.block.height_Header +\n        \"px\"\n    );\n    this.DOM.setMatrixBackground\n      .attr(\"x\", -w * 24)\n      .attr(\"y\", -h * 24)\n      .attr(\"width\", w * 50)\n      .attr(\"height\", h * 50);\n    this.DOM.root\n      .style(this.popupSide, -w + \"px\")\n      .style(\"width\", w + \"px\")\n      .style(this.popupSide === \"left\" ? \"right\" : \"left\", \"initial\");\n\n    if (!this.pausePanning) {\n      this.refreshSVGViewBox();\n    }\n  }\n\n  /** -- */\n  public refreshPopupSide() {\n    this.DOM.root.attr(\"data-popupSide\", this.popupSide);\n    this.refreshRow();\n    this.refreshSetPair_Position();\n    this.refreshSVGViewBox();\n  }\n\n  /** -- */\n  public refreshSVGViewBox() {\n    var w = this.getWidth();\n    var h = this.getHeight();\n    var t = this.setListSummary.block.scrollTop_cache;\n    var r =\n      Math.max(t + this.gridPan_x, 0) * (this.popupSide === \"left\" ? -1 : 1);\n    this.DOM.setMatrixSVG\n      .attr(\"width\", w)\n      .attr(\"height\", h)\n      .attr(\"viewBox\", r + \" \" + t + \" \" + w + \" \" + h);\n    this.refreshLabel_Vert_Show();\n  }\n\n  /** -- */\n  private refreshSetPair_Background() {\n    this.DOM.setPairBackground\n      .attr(\"x\", -this.setPairRadius)\n      .attr(\"y\", -this.setPairRadius)\n      .attr(\"width\", this.setPairDiameter)\n      .attr(\"height\", this.setPairDiameter);\n  }\n\n  /** -- */\n  refreshLabel_Vert_Show() {\n    var totalWidth = this.getWidth();\n    var totalHeight = this.getHeight();\n    var t = this.setListSummary.block.scrollTop_cache;\n    this.DOM.line_vert_label // points up/right\n      .attr(\"show\", (d) => !d.isVisible)\n      .attr(\"transform\", (d) => {\n        var i = d.orderIndex;\n\n        var x = totalWidth - (i + 0.5) * this.rowHeight - 2;\n        if (this.popupSide === \"right\") x = totalWidth - x - 4;\n\n        var y =\n          (this.setListSummary.block.catCount_Active - i - 1) * this.rowHeight -\n          this.setListSummary.block.height_VisibleAttrib +\n          this.setListSummary.block.scrollTop_cache +\n          totalHeight;\n        return `translate(${x} ${y}) rotate(-90)`;\n      });\n  }\n\n  /** -- */\n  refreshRow() {\n    this.refreshWindowSize();\n    this.DOM.setRows.attr(\n      \"transform\",\n      (row) => `translate(0,${(row.orderIndex + 0.5) * this.rowHeight})`\n    );\n    this.refreshRow_LineWidths();\n  }\n\n  /** -- */\n  refreshSetPair_Position() {\n    var w = this.getWidth();\n    this.DOM.aggrGlyphs.style(\"transform\", (setPair) => {\n      var i1 = setPair.set_1.orderIndex;\n      var i2 = setPair.set_2.orderIndex;\n      var left = (Math.min(i1, i2) + 0.5) * this.rowHeight;\n      if (this.popupSide === \"left\") left = w - left;\n      var top = (Math.max(i1, i2) + 0.5) * this.rowHeight;\n      return `translate(${left}px,${top}px)`;\n    });\n  }\n\n  /** -- */\n  private refreshRow_LineWidths() {\n    var setPairDiameter = this.setListSummary.barHeight.get();\n    var totalWidth = this.getWidth();\n\n    // vertical lines\n    this.DOM.line_vert.each((d, i, nodes) => {\n      var _DOM = nodes[i];\n      var i = d.orderIndex;\n      var height =\n        (this.setListSummary.block.catCount_Active - i - 1) * setPairDiameter;\n      var right = (i + 0.5) * setPairDiameter;\n      var m = this.popupSide === \"left\" ? totalWidth - right : right;\n      _DOM.setAttribute(\"x1\", m);\n      _DOM.setAttribute(\"x2\", m);\n      _DOM.setAttribute(\"y2\", height);\n    });\n\n    // horizontal lines\n    this.DOM.line_horz\n      .attr(\"x2\", this.popupSide === \"left\" ? totalWidth : 0)\n      .attr(\"x1\", (d) => {\n        var m = (d.orderIndex + 0.5) * setPairDiameter;\n        return this.popupSide === \"left\" ? totalWidth - m : m;\n      });\n    this.DOM.line_horz_label.attr(\"transform\", (d) => {\n      var m = (d.orderIndex + 0.5) * setPairDiameter + 2;\n      if (this.popupSide === \"left\") m = totalWidth - m;\n      return `translate(${m} 0)`;\n    });\n  }\n}\n","import { Aggregate_Category } from \"./Aggregate_Category\";\nimport { Aggregate_SetPair } from \"./Aggregate_SetPair\";\n\nimport { i18n } from \"./i18n.js\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Attrib } from \"./Attrib\";\nimport { Block_Set } from \"./Block_Set\";\n\n/** -- */\nexport class Attrib_Set extends Attrib {\n  // may have a single parent attribute\n  protected readonly _parent: Attrib_Categorical;\n  get parent(): Attrib_Categorical {\n    return this._parent;\n  }\n  get setListAttrib() {\n    return this._parent;\n  }\n\n  // The associated block (view) - null by default\n  protected _block: Block_Set;\n  public get block(): Block_Set {\n    return this._block;\n  }\n\n  // ********************************************************************\n  // Aggregates (setpairs)\n  // ********************************************************************\n\n  public _aggrs: Aggregate_SetPair[] = [];\n  // just renaming for convenience\n  public get setPairs() {\n    return this._aggrs;\n  }\n\n  private _setPairs_ID: {\n    [index: string]: { [index: string]: Aggregate_SetPair };\n  } = {};\n\n  // sets are parent summaries aggregates\n  get sets() {\n    return this.setListAttrib._aggrs;\n  }\n\n  // ********************************************************************\n  // Constructor\n  // ********************************************************************\n\n  constructor(browser, parent: Attrib_Categorical) {\n    super(\n      browser,\n      i18n.SetPairTitle(parent.attribName),\n      null, // no template, no accessor\n      \"setpair\",\n      \"setPairSummary\",\n      \"\" // not in attribute list\n    );\n\n    this._parent = parent;\n\n    this._block = new Block_Set(this);\n  }\n\n  /** -- */\n  initializeAggregates(): void {\n    if (this.aggr_initialized) return;\n\n    this.createSetPairs();\n\n    this.block.initDOM();\n\n    this.aggr_initialized = true;\n  }\n\n  getAggregate(set_1, set_2): Aggregate_SetPair {\n    var setPair = this._setPairs_ID[set_1.id][set_2.id];\n    if (!setPair) {\n      setPair = new Aggregate_SetPair(this.setListAttrib, set_1, set_2);\n      set_1.setPairs.push(setPair);\n      set_2.setPairs.push(setPair);\n      this.setPairs.push(setPair);\n      this._setPairs_ID[set_1.id][set_2.id] = setPair;\n      this.browser.allAggregates.push(setPair);\n    }\n    return setPair;\n  }\n\n  /** For each element in the given list, checks the set membership and adds setPairs */\n  private createSetPairs() {\n    this.sets.forEach((aggr) => {\n      aggr.setPairs = [];\n    });\n\n    var insertToClique = (set_1, set_2, record) => {\n      // avoid self reference and adding the same record twice\n      // (insert only A-B, not B-A / A-A / B-B)\n      if (set_2.id <= set_1.id) return;\n\n      if (this._setPairs_ID[set_1.id] === undefined)\n        this._setPairs_ID[set_1.id] = {};\n\n      this.getAggregate(set_1, set_2).addRecord(record);\n    };\n\n    var getSetAggr = (v: string): Aggregate_Category => {\n      return this.setListAttrib.getAggrWithLabel(v);\n    };\n    this.setListAttrib.records.forEach((record) => {\n      // read raw values, not with labeling applied\n      var values: string[] = record.getValue(this.setListAttrib);\n      if (values === null) return; // maps to no value\n      if (values.length < 2) return; // maps to one value\n      values.forEach((v_1: string) => {\n        var set_1 = getSetAggr(v_1);\n        if (!set_1.setPairs) return;\n        values.forEach((v_2: string) => {\n          var set_2 = getSetAggr(v_2);\n          if (!set_2.setPairs) return;\n          insertToClique(set_1, set_2, record);\n        });\n      });\n    });\n\n    this.block.updateMaxAggr_Active();\n  }\n\n  /** --*/\n  updatePerceptualOrder() {\n    // Edges are set-pairs with at least one element inside (based on the filtering state)\n    var edges = this.setPairs.filter((aggr) => aggr.measure(\"Active\") > 0);\n    // Nodes are the set-categories\n    var nodes = this.sets;\n\n    // Initialize per-node (per-set) data structures\n    nodes.forEach((node: Aggregate_Category) => {\n      node.MST = {\n        tree: new Object(), // Some unqiue identifier, to check if two nodes are in the same tree.\n        childNodes: [],\n        parentNode: null,\n      };\n    });\n\n    // Compute the perceptual distance metric\n    edges.forEach((edge: Aggregate_SetPair) => {\n      var set_1 = edge.set_1;\n      var set_2 = edge.set_2;\n      edge.mst_distance = 0;\n\n      // For every intersection of set_1\n      set_1.setPairs.forEach((setPair_1: Aggregate_SetPair) => {\n        if (setPair_1 === edge) return;\n        var set_other =\n          setPair_1.set_1 === set_1 ? setPair_1.set_2 : setPair_1.set_1;\n\n        // find the set-pair of set_2 and set_other;\n        var setPair_2: Aggregate_SetPair = null;\n        if (set_2.id > set_other.id) {\n          if (this._setPairs_ID[set_other.id])\n            setPair_2 = this._setPairs_ID[set_other.id][set_2.id];\n        } else {\n          if (this._setPairs_ID[set_2.id])\n            setPair_2 = this._setPairs_ID[set_2.id][set_other.id];\n        }\n\n        if (!setPair_2) {\n          // the other intersection size is zero, there is no link\n          edge.mst_distance += setPair_1.measure(\"Active\");\n          return;\n        }\n        edge.mst_distance += Math.abs(\n          setPair_1.measure(\"Active\") - setPair_2.measure(\"Active\")\n        );\n      });\n\n      // For every intersection of set_2\n      set_2.setPairs.forEach((setPair_1: Aggregate_SetPair) => {\n        if (setPair_1 === edge) return;\n        var set_other =\n          setPair_1.set_1 === set_2 ? setPair_1.set_2 : setPair_1.set_1;\n        // find the set-pair of set_1 and set_other;\n        var setPair_2 = undefined;\n        if (set_1.id > set_other.id) {\n          if (this._setPairs_ID[set_other.id])\n            setPair_2 = this._setPairs_ID[set_other.id][set_1.id];\n        } else {\n          if (this._setPairs_ID[set_1.id])\n            setPair_2 = this._setPairs_ID[set_1.id][set_other.id];\n        }\n        if (setPair_2 === undefined) {\n          // the other intersection size is zero, there is no link\n          edge.mst_distance += setPair_1.measure(\"Active\");\n          return;\n        }\n        // If ther is setPair_2, it was already processed in the main loop above\n      });\n    });\n\n    // Order the edges (setPairs) by their distance (lower score is better)\n    edges.sort(\n      (e1: Aggregate_SetPair, e2: Aggregate_SetPair) =>\n        e1.mst_distance - e2.mst_distance\n    );\n\n    // Run Kruskal's algorithm...\n    edges.forEach((setPair) => {\n      var node_1 = setPair.set_1;\n      var node_2 = setPair.set_2;\n      // set_1 and set_2 are in the same tree\n      if (node_1.MST.tree === node_2.MST.tree) return;\n      // set_1 and set_2 are not in the same tree, connect set_2 under set_1\n      var set_above: Aggregate_Category, set_below: Aggregate_Category;\n      if (node_1.setPairs.length < node_2.setPairs.length) {\n        set_above = node_1;\n        set_below = node_2;\n      } else {\n        set_above = node_2;\n        set_below = node_1;\n      }\n      set_below.MST.tree = set_above.MST.tree;\n      set_below.MST.parentNode = set_above;\n      set_above.MST.childNodes.push(set_below);\n    });\n\n    // Identify the root-nodes of resulting MSTs\n    var treeRootNodes = nodes.filter((node) => {\n      return node.MST.parentNode === null;\n    });\n\n    // We can have multiple trees (there can be sub-groups disconnected from each other)\n\n    // Update tree size recursively by starting at the root nodes\n    var updateTreeSize = (node: Aggregate_Category) => {\n      node.MST.treeSize = 1;\n      node.MST.childNodes.forEach((childNode) => {\n        node.MST.treeSize += updateTreeSize(childNode);\n      });\n      return node.MST.treeSize;\n    };\n    treeRootNodes.forEach((rootNode: Aggregate_Category) => {\n      updateTreeSize(rootNode);\n    });\n\n    // Sort the root nodes by largest tree first\n    treeRootNodes.sort(\n      (node1, node2) => node1.MST.treeSize - node2.MST.treeSize\n    );\n\n    // For each MST, traverse the nodes and add the MST (perceptual) node index incrementally\n    var mst_index = 0;\n    var updateNodeIndex = (node: Aggregate_Category) => {\n      node.MST.childNodes.forEach((chileNode) => {\n        chileNode.MST.order = mst_index++;\n      });\n      node.MST.childNodes.forEach((chileNode) => {\n        updateNodeIndex(chileNode);\n      });\n    };\n    treeRootNodes.forEach((node) => {\n      node.MST.order = mst_index++;\n      updateNodeIndex(node);\n    });\n  }\n\n  isExportable(): boolean{\n    return false;\n  }\n\n  // ********************************************************************\n  // Not applicable\n  // ********************************************************************\n\n  /** It doesn't have its own filter - uses filter of parent category instead */\n  createSummaryFilter(): void {}\n  /** Special templates do not apply */\n  applyTemplateSpecial(): void {}\n\n  /** not used for set/ circle size calculations, just implementing the interface */\n  get measureRangeMax(): number {\n    return this.block.setPairRadius;\n  }\n  updateChartScale_Measure() : void{\n    if (!this.block.isVisible()) return;\n    this.block?.refreshViz_All();\n  }\n  chartAxis_Measure_TickSkip(): number {\n    throw new Error(\"Not applicable.\");\n  }\n\n  isEmpty() {\n    return false;\n  }\n  isFiltered(): boolean {\n    return this.setListAttrib.isFiltered();\n  }\n}\n","import { Aggregate_Category } from \"./Aggregate_Category\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Browser } from \"./Browser\";\nimport { Filter } from \"./Filter\";\n\nimport { Filter_Categorical_Spec } from \"./Types\";\nimport { Record } from \"./Record\";\nimport { i18n } from \"./i18n\";\n\nexport class Filter_Categorical extends Filter {\n  public readonly attrib: Attrib_Categorical;\n\n  public selected_AND: Aggregate_Category[] = [];\n  public selected_OR: Aggregate_Category[] = [];\n  public selected_NOT: Aggregate_Category[] = [];\n\n  constructor(_browser: Browser, attrib: Attrib_Categorical) {\n    super(_browser);\n    this.attrib = attrib;\n  }\n\n  get title(): string {\n    return this.attrib.attribName;\n  }\n\n  selectedCount_Total(): number {\n    return (\n      this.selected_AND.length +\n      this.selected_OR.length +\n      this.selected_NOT.length\n    );\n  }\n  selected_Any(): boolean {\n    return (\n      this.selected_AND.length > 0 ||\n      this.selected_OR.length > 0 ||\n      this.selected_NOT.length > 0\n    );\n  }\n  selected_None(): boolean {\n    return (\n      this.selected_AND.length === 0 &&\n      this.selected_OR.length === 0 &&\n      this.selected_NOT.length === 0\n    );\n  }\n  selected_AndOrNot(): Aggregate_Category[] {\n    return this.selected_AND.concat(this.selected_OR).concat(this.selected_NOT);\n  }\n\n  selected_All_clear(): void {\n    this.selected_AND = [];\n    this.selected_OR = [];\n    this.selected_NOT = [];\n  }\n\n  private setRecordCache(record: Record, v: boolean): void {\n    record.setFilterCache(this.filterID, v);\n  }\n\n  onFilter(): void {\n    var noValueOut = this.noValueAggr.filtered === \"out\";\n    var noValueIn = this.noValueAggr.filtered === \"in\";\n\n    this.attrib.records.forEach((record) => {\n      // Note: Using direct access here.\n      // This prevents applying the look-up table overwrite in this class\n      var recordVal_s = record.getValue(this.attrib);\n\n      if (noValueIn) {\n        return this.setRecordCache(record, recordVal_s == null);\n      }\n\n      if (recordVal_s == null) {\n        if (noValueOut) {\n          return this.setRecordCache(record, false);\n        }\n        // survives if AND and OR is not selected\n        this.setRecordCache(\n          record,\n          this.selected_AND.length === 0 && this.selected_OR.length === 0\n        );\n        return;\n      }\n\n      var getAggr = (v) => this.attrib.catTable_id[v];\n\n      // If any of the record values are selected with NOT, the record will be removed\n      if (this.selected_NOT.length > 0) {\n        if (!recordVal_s.every((v) => !getAggr(v).filtered_NOT())) {\n          return this.setRecordCache(record, false);\n        }\n      }\n\n      // All AND selections must be among the record values\n      if (this.selected_AND.length > 0) {\n        var t = 0; // Compute the number of record values selected with AND.\n        recordVal_s.forEach((v) => {\n          if (getAggr(v).filtered_AND()) t++;\n        });\n        if (t !== this.selected_AND.length) {\n          return this.setRecordCache(record, false);\n        }\n      }\n\n      // One of the OR selections must be among the record values\n      if (this.selected_OR.length > 0) {\n        return this.setRecordCache(\n          record,\n          recordVal_s.some((v) => getAggr(v).filtered_OR())\n        );\n      }\n\n      // only NOT selection\n      record.setFilterCache(this.filterID, true);\n    });\n\n    super.onFilter();\n  }\n\n  filterView_Detail() {\n    if (this.noValueAggr.filtered === \"in\") return i18n.NoData;\n\n    // 'this' is the Filter\n    // go over all records and prepare the list\n    var text = \"\";\n\n    if (this.noValueAggr.filtered === \"out\")\n      text = `(${i18n.ValidData})`;\n\n    var queryStr = (_type) =>\n      ` <span class='AndOrNot AndOrNot_${_type}'>\"${i18n[_type]}</span> `;\n\n    if (this.selectedCount_Total() > 4) {\n      text = `<b>${this.selectedCount_Total()}</b> selected`;\n    } else {\n      var selectedItemsCount = 0;\n\n      // OR selections\n      if (this.selected_OR.length > 0) {\n        var useBracket_or =\n          this.selected_AND.length > 0 || this.selected_NOT.length > 0;\n        if (useBracket_or) text += \"[\";\n        // X or Y or ....\n        this.selected_OR.forEach((_cat, i) => {\n          text +=\n            (i !== 0 || selectedItemsCount > 0 ? queryStr(\"Or\") : \"\") +\n            `<span class='optionName'>${_cat.label}</span>`;\n          selectedItemsCount++;\n        });\n        if (useBracket_or) text += \"]\";\n      }\n      // AND selections\n      this.selected_AND.forEach((_cat) => {\n        text +=\n          (text !== \"\" ? queryStr(\"And\") : \"\") +\n          `<span class='optionName'>${_cat.label}</span>`;\n        selectedItemsCount++;\n      });\n      // NOT selections\n      this.selected_NOT.forEach((_cat) => {\n        text += `${queryStr(\"Not\")}<span class='optionName'>${\n          _cat.label\n        }</span>`;\n        selectedItemsCount++;\n      });\n    }\n    return text;\n  }\n\n  exportFilter(): Filter_Categorical_Spec {\n    var _: Filter_Categorical_Spec = {};\n    if (this.noValueAggr.filtered) {\n      _.missing = this.noValueAggr.filtered;\n    } else {\n      [\"AND\", \"OR\", \"NOT\"].forEach((logic) => {\n        var selected_x = this[\"selected_\" + logic];\n        if (selected_x.length > 0) {\n          _[logic] = [];\n          selected_x.forEach((_cat) => {\n            _[logic].push(_cat.label);\n          });\n        }\n      });\n    }\n    return _;\n  }\n\n  importFilter(_: Filter_Categorical_Spec) {\n    if (_.missing) {\n      this.noValueAggr.filtered = _.missing;\n      this.setFiltered(false);\n    } else {\n      this.selected_All_clear();\n\n      [\"AND\", \"OR\", \"NOT\"].forEach((_type: \"AND\" | \"OR\" | \"NOT\") => {\n        if (!_[_type]) return;\n        // find category, and add filter\n        let ar: string[] = _[_type];\n        ar.forEach((catStr: string) => {\n          var aggr = this.attrib.catTable_id[catStr];\n          if(aggr){ \n            this.attrib.filterCategory(aggr, _type, \"All\", false/** skip update */);\n          }\n        });\n      });\n    }\n    if (this.isFiltered) {\n      this.applyFilter();\n    }\n  }\n}\n","import \"leaflet/dist/leaflet.css\";\nimport \"choices.js/public/assets/styles/choices.min.css\";\n\nimport { max } from \"d3-array\";\n\nimport { Block_Categorical } from \"./Block_Categorical\";\nimport { Aggregate_Category } from \"./Aggregate_Category\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Attrib_Set } from \"./Attrib_Set\";\nimport { Browser } from \"./Browser\";\nimport { i18n } from \"./i18n\";\nimport { Config } from \"./Config\";\nimport { Modal } from \"./UI/Modal\";\nimport { Base } from \"./Base\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { Filter_Categorical } from \"./Filter_Categorical\";\nimport {\n  CatLabelSpec,\n  CatSortSpec,\n  RecordVisCoding,\n  SummaryConfig_Categorical,\n  SummarySpec,\n} from \"./Types\";\nimport { AttribTemplate } from \"./AttribTemplate\";\nimport { MapData } from \"./MapData\";\n\nconst d3 = { max };\n\nexport class Attrib_Categorical extends Attrib {\n  public _aggrs: Aggregate_Category[] = [];\n  catTable_id: { [key: string]: Aggregate_Category } = {};\n  private removedAggrs: Aggregate_Category[] = [];\n\n  protected _block: Block_Categorical;\n  public get block(): Block_Categorical {\n    return this._block;\n  }\n\n  public readonly barHeight: Config<number>;\n  public readonly minAggrSize: Config<number>;\n\n  get measureRangeMax(): number {\n    return this.block.width_CatChart;\n  }\n\n  applyTemplateSpecial(): void {\n    if (this.template.special === \"Year\") {\n      this.setSortingOption(\"id\");\n    } else if (this.template.special === \"Month\") {\n      this.setSortingOption(\"id\");\n      this.setCatLabel(i18n.Lookup_Months);\n    } else if (this.template.special === \"WeekDay\") {\n      this.setSortingOption(\"id\");\n      this.setCatLabel(i18n.Lookup_DaysOfWeek);\n    }\n  }\n\n  supportsRecordEncoding(coding: RecordVisCoding) {\n    if (this.isEmpty()) return false;\n    if (coding === \"text\") return true;\n    if (coding === \"textBrief\") return true;\n    return false;\n  }\n\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\n    super(\n      browser,\n      name,\n      template,\n      \"categorical\",\n      \"kshfSummary_Categorical\",\n      \"far fa-font\"\n    );\n\n    this.createSummaryFilter();\n\n    this._block = new Block_Categorical(this);\n\n    this.barHeight = new Config<number>({\n      parent: this,\n      cfgClass: \"barHeight\",\n      cfgTitle: \"RowHeight\",\n      iconClass: \"fa fa-arrows-v\",\n      UISeperator: {\n        title: \"Size\",\n        className: \"catSummary_ListOnly\",\n      },\n      default: Base.defaultBarHeight,\n      helparticle: \"5e87d6d004286364bc97d079\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" }, // special value\n        { name: \"1x\", value: 18, max: 32 },\n        { name: \"2x\", value: 32, max: 44 },\n        { name: \"3x\", value: 44, max: 56 },\n        { name: \"4x\", value: 56, max: 68 },\n        { name: \"5x\", value: 68, max: 80 },\n        { name: \"6x\", value: 80, max: 120 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -100, _type: \"plus\" }, // special value\n      ],\n      isActive: (d) =>\n        d.value && d.value <= this.barHeight.get() && d.max > this.barHeight.get(),\n      onDOM: (DOM) => {\n        DOM.root.classed(\"catSummary_ListOnly\", true);\n      },\n      preSet: async (v, opt) => {\n        if (v === -99) {\n          v = opt._value - 1;\n        } else if (v === -100) {\n          v = opt._value + 1;\n        }\n        return Math.min(85, Math.max(10, v));\n      },\n      onSet: () => {\n        if (this.block.isView_List) {\n          this.block.refreshHeight_Category();\n        } else {\n          this.block.heightRow_category_dirty = true;\n        }\n      },\n    });\n\n    let _timer;\n\n    this.minAggrSize = new Config<number>({\n      parent: this,\n      cfgClass: \"minAggrSize\",\n      cfgTitle: \"Show\",\n      iconClass: \"fa fa-eye-slash\",\n      default: 1,\n      itemOptions: [\n        { name: \"All\", value: 1 },\n        {\n          name: \"More than one\",\n          value: 10,\n        },\n      ],\n      UI: { disabled: true },\n      isActive: (d) => d.value\n        ? this.minAggrSize.get() > 1 \n        : this.minAggrSize.get() === 1,\n      onDOM: (DOM) => {\n        DOM.root\n          .select(\".minAggrSizeInput\")\n          .attr(\"value\", this.minAggrSize.get())\n          .attr(\n            \"max\",\n            d3.max(this._aggrs, (_cat) => _cat.records.length)\n          )\n          .on(\"input\", (event) => {\n            if (_timer) window.clearTimeout(_timer);\n            _timer = window.setTimeout(async () => {\n              await this.minAggrSize.set( Math.max(2, 1 * event.currentTarget.value) );\n            }, 500);\n          });\n      },\n      preSet: async (v) => Math.max(1, v),\n      onSet: (v) => this.setMinAggrSize(v),\n    });\n\n    this.setSortingOption();\n\n    this.finishTemplateSpecial();\n  }\n\n  // TODO incomplete\n  getAggrWithLabel(v: string): Aggregate_Category {\n    return this.catTable_id[v];\n  }\n\n  getAggregate(v: string): Aggregate_Category {\n    let aggr = this.catTable_id[v];\n    if (!aggr) {\n      aggr = new Aggregate_Category(this, v);\n      if(this.catLabel_attr[v]){\n        aggr.label = this.catLabel_attr[v];\n      }\n      this.catTable_id[v] = aggr;\n      this._aggrs.push(aggr);\n      this.browser.allAggregates.push(aggr);\n    }\n    return aggr;\n  }\n\n  initializeAggregates(): void {\n    if (this.aggr_initialized) return;\n\n    this.catTable_id = {};\n    this._aggrs = [];\n    this.removedAggrs = [];\n\n    var maxDegree = 0;\n\n    this.records.forEach((record) => {\n      var catValues = this.template.func.call(record.data, record);\n\n      // make catValues an array if it is not\n      if (!Array.isArray(catValues)) catValues = [catValues];\n\n      // trim whitespaces, remove invalid / empty string values\n      catValues = catValues\n        .map((e) => (e && e.trim ? e.trim() : e))\n        .filter((e) => e != null && e !== \"\")\n        .map((e) => \"\" + e); // convert to string\n\n      catValues = new Set(catValues); // remove duplicates\n\n      // Record is not mapped to any value (missing value)\n      if (catValues.size === 0) {\n        this.setRecordValueCacheToMissing(record);\n        return;\n      }\n\n      let cats: string[] = [];\n      catValues.forEach((id) => {\n        cats.push(id);\n        this.getAggregate(id).addRecord(record);\n      });\n      record.setValue(this, cats);\n\n      maxDegree = Math.max(maxDegree, catValues.size);\n    });\n\n    this.maxValueDegree = maxDegree;\n\n    this.aggr_initialized = true;\n  }\n\n  // Modified internal dataMap function - Skip rows with 0 active item count\n  setMinAggrSize(minSize) {\n    if (!this.aggr_initialized) return; // too early\n    var newAggrs = 0;\n    this.removedAggrs = this.removedAggrs.filter((cat) => {\n      if (cat.records.length >= minSize) {\n        this._aggrs.push(cat);\n        cat.usedAggr = true;\n        newAggrs++;\n        return false;\n      }\n      return true;\n    });\n    this._aggrs = this._aggrs.filter((cat) => {\n      if (cat.records.length >= minSize) {\n        return true;\n      }\n      this.removedAggrs.push(cat);\n      cat.usedAggr = false;\n      cat.isActiveBefore = false;\n      cat.isActive = false;\n      cat.isVisibleBefore = false;\n      cat.isVisible = false;\n      delete cat.orderIndex;\n      if (cat.DOM.aggrGlyph) {\n        cat.DOM.aggrGlyph.remove();\n        delete cat.DOM.aggrGlyph;\n      }\n      return false;\n    });\n    if (!this.block.DOM.inited) return;\n    if (newAggrs) {\n      this.block.insertCategoryGlyphs();\n      this.block.refreshLabelWidth();\n    }\n    this.block.updateCats_IsActive();\n\n    this.block.refreshHeight_Category();\n    this.block.refreshConfigRowCount();\n    this.block.updateCatSorting_now();\n  }\n\n  // ********************************************************************\n  // Set summary / Maximum degree\n  // ********************************************************************\n\n  public setAttrib?: Attrib_Set | null = null;\n\n  private _maxValueDegree = 1;\n  get maxValueDegree() {\n    return this._maxValueDegree;\n  }\n  get isMultiValued() {\n    return this.maxValueDegree > 1;\n  }\n  set maxValueDegree(v) {\n    var _pre = this.maxValueDegree || 1;\n    this._maxValueDegree = v;\n\n    if (this._maxValueDegree !== _pre) {\n      this.block.DOM.root\n        ?.classed(\"isMultiValued\", this.isMultiValued)\n        .classed(\"supportsSetMatrix\", this.supportsSetMatrix);\n      // not ideal, need to generate the full list for now.\n      this.block.DOM.nugget\n        ?.select(\".fa-tags\")\n        .classed(\"active\", this.isMultiValued);\n    }\n  }\n  get supportsSetMatrix(): boolean {\n    // TODO: make this a configurable option?\n    return this.isMultiValued && this._aggrs.length >= 5;\n  }\n\n  showSetSummary() {\n    if (this.setAttrib) {\n      this.setAttrib.block.refreshPopupSide();\n      return;\n    }\n\n    this.setAttrib = new Attrib_Set(this.browser, this);\n    this.setAttrib.initializeAggregates();\n  }\n\n  onAggrClick(event, ctgry: Aggregate_Category) {\n    if (this.browser.adjustMode) return;\n    if (!this.isCatSelectable(ctgry)) return;\n\n    if (event && event.altKey) {\n      this.filterCategory(ctgry, \"NOT\");\n      //\n    } else if (event && event.shiftKey) {\n      this.browser.setSelect_Compare(ctgry, null, false);\n      this.browser.lockSelect_Compare();\n      //\n    } else if (this.dblClickTimer) {\n      this.unselectAllCategories();\n      this.filterCategory(ctgry, \"AND\", \"All\");\n      //\n    } else if (ctgry.isFiltered()) {\n      this.filterCategory(ctgry, \"NONE\");\n      //\n    } else if (this.isMultiValued || this.summaryFilter.selected_None()) {\n      this.filterCategory(ctgry, \"AND\");\n      //\n    } else {\n      // category not filtered, summary not multi-valued, and has some selection - remove all other selections.\n      this.summaryFilter.selected_AndOrNot().forEach((_) => _.set_NONE());\n\n      this.filterCategory(ctgry, \"AND\", \"All\");\n    }\n\n    if (this.isMultiValued) {\n      this.dblClickTimer = window.setTimeout(() => {\n        this.dblClickTimer = null;\n      }, 500);\n    }\n  }\n\n  onAggrHighlight(aggr: Aggregate_Category) {\n    if (this.browser.adjustMode) return;\n    if (!this.isCatSelectable(aggr)) return;\n    if (this.browser.mouseOverCompare.is(false)) return;\n\n    aggr.DOM.matrixRow?.setAttribute(\"selection\", \"selected\");\n\n    // Comes after setting select type of the category - visual feedback on selection...\n    if (!this.isMultiValued && this.summaryFilter.selected_AND.length !== 0)\n      return;\n\n    // Show the highlight\n    if (aggr.filtered_NOT()) return;\n    if (this.isMultiValued || this.summaryFilter.selected_AND.length === 0) {\n      this.browser.setSelect_Compare(aggr);\n    }\n  }\n\n  onAggrLeave(aggr: Aggregate_Category) {\n    if (this.browser.adjustMode) return;\n    if (aggr.locked) return;\n    aggr.unselectAggregate();\n    if (!this.isCatSelectable(aggr)) return;\n    this.browser.clearSelect_Compare();\n  }\n\n  // ********************************************************************\n  // Filtering\n  // ********************************************************************\n\n  public summaryFilter: Filter_Categorical | null = null;\n\n  createSummaryFilter() {\n    this.summaryFilter = new Filter_Categorical(this.browser, this);\n  }\n\n  // ********************************************************************\n  // Sorting\n  // ********************************************************************\n\n  public catSortBy: CatSortSpec = \"Active\";\n  public catSortInverse = false;\n  public pleaseSort = false;\n\n  private _dirtySort = true;\n  set dirtySort(v) {\n    this._dirtySort = v;\n    this.block.DOM.catSortButton?.classed(\"resort\", v);\n  }\n  get dirtySort() {\n    return this._dirtySort || false;\n  }\n\n  setSortingOption(opt: CatSortSpec = \"Active\") {\n    this.catSortBy = opt;\n  }\n\n  get catOrder_Dynamic(): boolean {\n    if (typeof this.catSortBy === \"string\") {\n      if (this.catSortBy === \"alphanumeric\") return false;\n      if (this.catSortBy === \"id\") return false;\n      return true; // \"Active\", \"Compare_X\"\n    }\n    return false;\n  }\n  get catOrder_Fixed() {\n    return !this.catOrder_Dynamic;\n  }\n  setFixedCatOrder() {\n    // generates array of strings, from categorical aggregates, with the order of orderIndex\n    var m = this._aggrs.reduce((acc, aggr: Aggregate_Category) => {\n      acc[aggr.orderIndex] = aggr.label;\n      return acc;\n    }, []);\n\n    this.setSortingOption(m);\n    this.block.updateCatSorting_now();\n  }\n\n  _sortCategories() {\n    var compare_int = (a, b) => a - b;\n    var compare_str = (a, b) => Util.sortFunc_List_String(a, b);\n    var compare_func = (v) =>\n      typeof v === \"string\" ? compare_str : compare_int;\n\n    var theSortFunc: (a: Aggregate_Category, b: Aggregate_Category) => number =\n      null;\n    var valueFunc: Function = null;\n\n    if (typeof this.catSortBy === \"string\") {\n      if (this.catSortBy === \"alphanumeric\") {\n        valueFunc = (aggr) => aggr.label;\n      } else if (this.catSortBy === \"id\") {\n        valueFunc = (aggr) => aggr.id;\n      } else {\n        // Active, Compare_X\n        let getV = (aggr: Aggregate_Category) =>\n          this.browser.getChartValue(aggr, this.catSortBy);\n\n        // Dynamic sorting\n        theSortFunc = (\n          a: Aggregate_Category,\n          b: Aggregate_Category\n        ): number => {\n          // selected on top of the list\n          if (!a.isFiltered() && b.isFiltered()) return 1;\n          if (a.isFiltered() && !b.isFiltered()) return -1;\n          // usedAggr === false => on the bottom\n          if (!a.usedAggr && b.usedAggr) return 1;\n          if (a.usedAggr && !b.usedAggr) return -1;\n\n          var x = getV(b) - getV(a);\n          if (x === 0) x = b.measure(\"Total\") - a.measure(\"Total\");\n          return x;\n        };\n      }\n    } else {\n      if (Array.isArray(this.catSortBy)) {\n        // convert the array into a lookup table for sort-order of the category.\n        var _lookup: { [index: string]: number } = {};\n        this.catSortBy.forEach((s, i) => {\n          _lookup[s] = i + 1;\n        });\n        valueFunc = (aggr) => _lookup[aggr.id] || 99999;\n      } else {\n        valueFunc = this.catSortBy.valueFunc;\n        if (this.catSortBy.preSort) {\n          this.catSortBy.preSort.call(this);\n        }\n      }\n    }\n\n    if (valueFunc) {\n      let getV = (aggr: Aggregate_Category): number => valueFunc(aggr);\n\n      var valueCompareFunc = compare_func(getV(this._aggrs[0])); // int or string comparison, based on first aggr\n\n      theSortFunc = (a: Aggregate_Category, b: Aggregate_Category): number =>\n        valueCompareFunc(getV(a), getV(b));\n    }\n\n    var idCompareFunc = compare_func(this._aggrs[0].label);\n\n    this._aggrs.sort((a, b) => {\n      var _ = theSortFunc(a, b);\n      if (_ === 0) _ = idCompareFunc(a.label, b.label);\n      return this.catSortInverse ? -_ : _;\n    });\n\n    this.dirtySort = false;\n    this.pleaseSort = false;\n  }\n\n  doSortInverse() {\n    if (this.dirtySort) {\n      this.dirtySort = false; // will refresh sorting on next updateCatSorting call\n    } else {\n      this.catSortInverse = !this.catSortInverse;\n    }\n    this.pleaseSort = true;\n    this.block.updateCatSorting(0); // no delay, animated\n  }\n\n  getSortMenuOpts() {\n    return {\n      name: \"Sorting\",\n      items: [\n        {\n          id: \"DynamicSort\",\n          name: \"Active\",\n          iconClass: \"fal fa-sort-amount-down\",\n          active: this.catSortBy === \"Active\",\n          helparticle: \"5e87dcde04286364bc97d08e\",\n          do: (summary, action) => {\n            this.setSortingOption();\n            this.pleaseSort = true;\n            this.block.updateCatSorting(0, true); // no delay, with animation\n          },\n        },\n        {\n          id: \"DynamicSort\",\n          name:\n            i18n[\"Compared\"] +\n            \": \" +\n            (this.browser.comparedAttrib\n              ? `<span class='comparedSummaryName'>${this.browser.comparedAttrib.attribName}</span>`\n              : \"\"),\n          iconClass: \"fal fa-sort-numeric-down\",\n          active:\n            typeof this.catSortBy === \"string\" &&\n            this.catSortBy.startsWith(\"Compare\"),\n          helparticle: \"5e87e12704286364bc97d09e\",\n          when: (_block) =>\n            _block.browser.activeComparisonsCount > 0 &&\n            (_block.attrib !== _block.browser.comparedSummary ||\n              _block.attrib.isMultiValued),\n          do: (_attrib, action) => {\n            // TODO: Take the selected comparison AND the breakdown type/values into account\n            this.setSortingOption(action);\n            this.pleaseSort = true;\n            this.block.updateCatSorting(0, true); // no delay, with animation\n          },\n          options: (_block) =>\n            this.browser.activeComparisons.map((cT) => ({\n              name: this.browser.selectedAggrs[cT].label,\n              iconClass: \"colorBox bg_\" + cT,\n              active: this.catSortBy === cT,\n              value: cT,\n            })),\n        },\n        {\n          id: \"AlphaNumSort\",\n          name: \"Alphabetical\",\n          iconClass: \"fal fa-sort-alpha-down\",\n          active: this.catSortBy === \"alphanumeric\",\n          helparticle: \"5e87df292c7d3a7e9aea6032\",\n          do: () => {\n            this.setSortingOption(\"alphanumeric\");\n            this.pleaseSort = true;\n            this.block.updateCatSorting(0, true); // no delay, with animation\n          },\n        },\n        {\n          id: \"CustomSort\",\n          name: \"Custom\",\n          active: Array.isArray(this.catSortBy),\n          iconClass: \"fal fa-sort-shapes-down\",\n          helparticle: \"5e87ddbf2c7d3a7e9aea602e\",\n          do: () => {\n            this.setFixedCatOrder();\n          },\n        },\n        {\n          id: \"SetMatrixSort\",\n          name: \"Relatedness\",\n          iconClass: \"fa fa-th\",\n          when: (summary) => summary.setSummary && summary.show_set_matrix,\n          do: () => {\n            // Update sorting options of setListSummary (adding relatednesness metric...)\n            this.setSortingOption({\n              valueFunc: (aggr) => -aggr.MST?.order,\n              preSort: () => this.setAttrib.updatePerceptualOrder(),\n            });\n            this.pleaseSort = true;\n            this.block.updateCatSorting_now(); // no delay, no animation\n          },\n        },\n        // *************************\n        {\n          id: \"reverseSort\",\n          name: \"Inverse\",\n          iconClass: \"fal fa-exchange reverseSortIcon\",\n          active: this.catSortInverse,\n          helparticle: \"5e87e22904286364bc97d0a9\",\n          do: () => this.doSortInverse(),\n        },\n      ],\n    };\n  }\n\n  // ********************************************************************\n  // Filtering!\n  // ********************************************************************\n\n  unselectAllCategories() {\n    this._aggrs.forEach((cat) => cat.set_NONE());\n    this.summaryFilter.selected_All_clear();\n    this.block.DOM.noValueAggr?.classed(\"filtered\", false);\n  }\n\n  filterCategory(\n    ctgry: Aggregate_Category,\n    what: \"AND\" | \"OR\" | \"NOT\" | \"NONE\",\n    how = null,\n    update = true\n  ) {\n    if (!ctgry) {\n      return;\n    }\n\n    if (this.browser.skipSortingSummary) {\n      // you can now sort the last filtered summary, attention is no longer there.\n      this.browser.skipSortingSummary.dirtySort = false;\n    }\n\n    this.browser.skipSortingSummary = this;\n    this.dirtySort = true;\n\n    if (\n      this.summaryFilter.selected_OR.length > 0 &&\n      (this.summaryFilter.selected_AND.length > 0 ||\n        this.summaryFilter.selected_NOT.length > 0)\n    ) {\n      how = \"All\";\n    }\n\n    // if selection is in same mode, \"undo\" to NONE.\n    if (what === \"NOT\" && ctgry.filtered_NOT()) what = \"NONE\";\n    if (what === \"AND\" && ctgry.filtered_AND()) what = \"NONE\";\n    if (what === \"OR\" && ctgry.filtered_OR()) what = \"NONE\";\n\n    if (what === \"NONE\") {\n      if (ctgry.filtered_AND() || ctgry.filtered_NOT()) {\n        how = how ?? \"MoreResults\";\n      }\n      if (ctgry.filtered_OR()) {\n        how = how ?? \n          this.summaryFilter.selected_OR.length === 0\n            ? \"MoreResults\"\n            : \"LessResults\";\n      }\n      ctgry.set_NONE();\n      if (\n        this.summaryFilter.selected_OR.length === 1 &&\n        this.summaryFilter.selected_AND.length === 0\n      ) {\n        this.summaryFilter.selected_OR.forEach((a) => {\n          a.set_NONE();\n          a.set_AND(this.summaryFilter.selected_AND);\n        });\n      }\n      if (!this.summaryFilter.selected_Any()) this.dirtySort = false;\n      //\n    } else if (what === \"NOT\") {\n      if (!ctgry.isFiltered()) {\n        if (\n          ctgry.recCnt(\"Active\") ===\n          this.browser.allRecordsAggr.recCnt(\"Active\")\n        ) {\n          Modal.alert(i18n.DialogEmptyResultSet);\n          return;\n        }\n        how = how ?? \"LessResults\";\n      } else {\n        how = how ?? \"All\";\n      }\n      ctgry.set_NOT(this.summaryFilter.selected_NOT);\n      //\n    } else if (what === \"AND\") {\n      if (ctgry.filtered_NOT() || ctgry.filtered_OR()) {\n        how = how ?? \"All\"; // change from NOT to AND\n      } else {\n        how = how ?? \"LessResults\";\n      }\n      ctgry.set_AND(this.summaryFilter.selected_AND);\n      //\n    } else if (what === \"OR\") {\n      if (!this.isMultiValued && this.summaryFilter.selected_NOT.length > 0) {\n        var temp = [];\n        this.summaryFilter.selected_NOT.forEach((a) => temp.push(a));\n        temp.forEach((a) => a.set_NONE());\n      }\n      if (\n        this.summaryFilter.selected_OR.length === 0 &&\n        this.summaryFilter.selected_AND.length === 1\n      ) {\n        this.summaryFilter.selected_AND.forEach((a) => {\n          a.set_NONE();\n          a.set_OR(this.summaryFilter.selected_OR);\n        });\n      }\n      ctgry.set_OR(this.summaryFilter.selected_OR);\n      how = how ?? \"MoreResults\";\n    }\n\n    if (\n      this.summaryFilter.selected_OR.length > 0 &&\n      (this.summaryFilter.selected_AND.length > 0 ||\n        this.summaryFilter.selected_NOT.length > 0)\n    ) {\n      how = \"All\";\n    }\n    if (this.noValueAggr.filtered === \"in\") {\n      how = \"All\";\n    }\n\n    this.summaryFilter.how = how;\n\n    if (this.summaryFilter.selectedCount_Total() === 0) {\n      this.summaryFilter.clearFilter();\n      return;\n    }\n\n    this.block.clearCatTextSearch();\n\n    // if no-values were filtered in, this causes conflict, so reset to not filtered\n    if (this.noValueAggr.filtered === \"in\") {\n      this.noValueAggr.filtered = false;\n    }\n\n    this.block.DOM.root?.classed(\n      \"hasMultiAnd\",\n      this.summaryFilter.selected_AND.length > 1\n    );\n\n    this.summaryFilter.setFiltered(update);\n  }\n\n  isCatSelectable(category: Aggregate_Category) {\n    if (category.isFiltered()) return true;\n    if (category.recCnt(\"Active\") !== 0) return true;\n    // Show if multiple attributes are selected and the summary does not include multi value records\n    if (this.isFiltered() && !this.isMultiValued) return true;\n    // Hide\n    return false;\n  }\n\n  dblClickTimer: number = 0;\n\n  autoCompare() {\n    var _autoCompare = () => {\n      var _index = 0;\n      Base.Compare_List.forEach((cT) => {\n        if (this.browser.vizActive(cT)) return;\n        var aggr;\n        while (true) {\n          aggr = this._aggrs[_index];\n          if (!aggr) return;\n          if (!aggr.locked && aggr.Active.measure > 0) break;\n          _index++;\n        }\n        this.browser.setSelect_Compare(aggr, cT, false);\n        this.browser.lockSelect_Compare(false);\n      });\n\n      this.browser.refreshConfigs();\n    };\n\n    if (this.browser.comparedAttrib && !this.isComparedAttrib()) {\n      Modal.confirm(\n        i18n.DialogChangeCompare(\n          this.attribNameHTML,\n          this.browser.comparedAttrib.attribNameHTML\n        ),\n        i18n.Confirm\n      ).then(\n        () => {\n          this.browser.clearSelect_Compare(\n            this.browser.activeComparisons,\n            false,\n            true\n          ); // don't finalize yet\n          _autoCompare();\n        },\n        () => {}\n      );\n    } else {\n      _autoCompare();\n    }\n  }\n\n  // ********************************************************************\n  // Mapping\n  // ********************************************************************\n\n  public catGeo: string = null;\n\n  private mapTable: MapData = null;\n\n  public mapInitView: [number, number, number] = null;\n\n  public mapConfig: any; // leaflet\n\n  async loadMap() {\n    if (this.mapTable) return;\n\n    this.mapTable = Base.maps.get(this.catGeo);\n\n    if (!this.mapTable) {\n      throw new Error(i18n.Error_CannotFindMap(this.catGeo));\n    }\n\n    await this.mapTable.loadGeo();\n\n    // Call mapping function to store category geometry\n    this.catMap_storeCatGeo();\n\n    // Abort if none of the categories match to map data.\n    if (this._aggrs.length > 0 && this._aggrs.every((_cat) => !_cat._geo_)) {\n      this.removeCatGeo();\n      throw new Error(i18n.Error_CannotMatchMap(this.catGeo));\n    }\n  }\n\n  hasMap(): boolean {\n    return this.catGeo !== null;\n  }\n\n  catMap_storeCatGeo() {\n    this._aggrs.forEach((aggr) => {\n      aggr._geo_ =\n        this.mapTable.getFeature(aggr.id.toUpperCase()) ||\n        this.mapTable.getFeature(aggr.label.toUpperCase());\n\n      if (\n        // not found\n        !aggr._geo_ ||\n        // only accept geojson definitions. A crude approximation.\n        typeof aggr._geo_ !== \"object\" ||\n        typeof aggr._geo_.type === undefined\n      ) {\n        aggr._geo_ = null;\n      }\n    });\n  }\n\n  setCatGeo(template) {\n    this.catGeo = template;\n    this.block.DOM.root?.attr(\"hasMap\", true);\n  }\n\n  removeCatGeo() {\n    this.catGeo = null;\n    this._aggrs.forEach((_cat) => {\n      _cat._geo_ = null;\n    });\n    this.block.removeCatGeo();\n    this.mapTable = null;\n  }\n\n  async setCatGeo_(template) {\n    if (!this.uniqueCategories()) {\n      this.setCatGeo(template);\n      this.block.catViewAs(\"map\");\n\n    } else {\n      // Per-record map: Define new summary\n      this.browser.recordDisplay.setAttrib(\n        \"geo\",\n        this.browser.createAttrib(\n          \"_REGION\",\n          // replace [*] with [*.]\n          template\n            .replace(\"[*]\", \"[*.\" + this.template + \"]\")\n            .replace(\"[UPPERCASE(*)]\", \"[UPPERCASE(*.\" + this.template + \")]\"),\n          \"recordGeo\"\n        )\n      );\n\n      if (this.browser.recordChartType.is(\"none\")) {\n        await this.browser.recordChartType.set(\"map\");\n      }\n\n      this.browser.refreshAttribList();\n    }\n  }\n\n  // ********************************************************************\n  // Cat labels\n  // ********************************************************************\n\n  public catLabel_attr: CatLabelSpec = {};\n\n  setCatLabel(template: CatLabelSpec = {}) {\n    this.catLabel_attr = template;\n    this._aggrs.forEach((aggr) => {\n      aggr.label = this.catLabel_attr[aggr.id] || \"\";\n    });\n\n    this.block?.DOM.catLabel?.html((aggr: Aggregate_Category) => aggr.label);\n  }\n\n  getRecordValue(record: Record): string[] {\n    var r = record.getValue(this);\n    if (r == null) return r;\n    return r.map((_) => this.catLabel_attr[_] || _);\n  }\n\n  getFormattedValue(v: any, _isSVG: any): string {\n    return this.renderRecordValue(v);\n  }\n\n  renderRecordValue(v, d3_selection = null): string {\n    if (v instanceof Record) v = this.getRecordValue(v);\n\n    var getHTML = (_url) => {\n      var _href = _url.href;\n      if (_url.protocol === \"http:\" || _url.protocol === \"https:\") {\n        if (/\\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(_url.pathname)) {\n          // show as image\n          return `<img src='${_href}' class='autoDetectedImg'>`;\n        }\n        // show as link\n        return `<a class='linkInData' href='${_href}' rel='noopener noreferrer' target='_blank'>\" ${_href}</a>`;\n      }\n      return _href;\n    };\n\n    var _finalize = (_value) => {\n      if (d3_selection) d3_selection.html(_value);\n      else return _value;\n    };\n\n    var _value = v\n      .map((_) => {\n        if (this.catTable_id[_]) return this.catTable_id[_].label;\n        if (_ == null) return \"-\";\n        return _ + \"\";\n      })\n      .map((_) => {\n        try {\n          var _url = new URL(_);\n          if (_url.protocol === \"gs:\" && (window as any).firebase) {\n            return (window as any).firebase\n              .storage()\n              .refFromURL(_url.href)\n              .getDownloadURL()\n              .then((url) => {\n                var __url = new URL(url);\n                // update lookup table label to resolved URL\n                if (this.catTable_id[_]) this.catTable_id[_].label = __url.href;\n\n                return _finalize(getHTML(__url));\n              });\n          }\n          _ = getHTML(_url);\n        } catch (exception) {\n        } finally {\n          return _;\n        }\n      })\n      .join(\"<br>\");\n\n    return _finalize(_value);\n  }\n\n  // ********************************************************************\n  // Export / import\n  // ********************************************************************\n\n  async applyConfig(blockCfg: SummarySpec) {\n    super.applyConfig(blockCfg);\n\n    if (blockCfg.mapInitView) {\n      this.mapInitView = blockCfg.mapInitView;\n    }\n    if (blockCfg.mapConfig) {\n      this.mapConfig = blockCfg.mapConfig;\n    }\n\n    await this.measureScaleType.set(blockCfg.measureScaleType);\n    await this.barHeight.set(blockCfg.barHeight);\n    await this.minAggrSize.set(blockCfg.minAggrSize);\n\n    if (blockCfg.catLabel) {\n      this.setCatLabel(blockCfg.catLabel);\n    }\n    if (blockCfg.catGeo) {\n      this.setCatGeo(blockCfg.catGeo);\n    }\n    if (blockCfg.invertedColorTheme) {\n      this.block.catMap_invertColorTheme(blockCfg.invertedColorTheme);\n    }\n\n    if (blockCfg.splitOnSelfCompare === false) {\n      this.block.splitOnSelfCompare = false;\n    }\n\n    if ([\"SingleSelect\", \"MultiSelect\"].includes(blockCfg.dropdown_type)) {\n      this.block.dropdown_type = blockCfg.dropdown_type;\n    }\n\n    if (blockCfg.filter) {\n      this.summaryFilter.importFilter(blockCfg.filter);\n    } else if (this.isFiltered()) {\n      this.summaryFilter.clearFilter();\n    }\n\n    // SORTING RELATED CONFIGURATION\n    if (blockCfg.catSortInverse) {\n      this.catSortInverse = true;\n    }\n    if (blockCfg.catSortBy) {\n      this.setSortingOption(blockCfg.catSortBy);\n    }\n\n    if (blockCfg.viewAs) {\n      // map vs list\n      this.block.catViewAs(blockCfg.viewAs);\n    }\n    if (blockCfg.showSetMatrix) {\n      this.block.showSetMatrix(blockCfg.showSetMatrix);\n    }\n  }\n\n  exportConfig() {\n    var config = super.exportConfig();\n\n    var t: SummaryConfig_Categorical = {\n      viewAs: this.block.viewType,\n      catGeo: this.catGeo,\n      catLabel: this.catLabel_attr,\n      catSortBy: this.catSortBy,\n      catSortInverse: this.catSortInverse,\n      invertedColorTheme: this.block.invertedColorTheme,\n      barHeight: this.barHeight.exportValue(),\n      splitOnSelfCompare: this.block.splitOnSelfCompare,\n      dropdown_type: this.block.isView_Dropdown\n        ? this.block.dropdown_type\n        : undefined,\n      filter: this.summaryFilter.exportFilter()\n    };\n\n    return Object.assign({}, config, t);\n  }\n}\n","import { easePoly } from \"d3-ease\";\nimport { select } from \"./d3_select\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Base } from \"./Base\";\nimport { Browser } from \"./Browser\";\nimport { CompareType, RecordVisCoding } from \"./Types\";\nimport { i18n } from \"./i18n\";\nimport { RecordDisplay } from \"./RecordDisplay\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\n\nconst d3 = {\n  select,\n  easePoly,\n};\n\nexport abstract class RecordView {\n  /** For direct access to main record display */\n  readonly rd: RecordDisplay;\n\n  get browser(): Browser {\n    return this.rd.browser;\n  }\n\n  get textAttrib() {\n    return this.rd.codeBy.text;\n  }\n  get textBriefAttrib() {\n    return this.rd.codeBy.textBrief || this.rd.codeBy.text;\n  }\n  get sortAttrib() {\n    return this.rd.codeBy.sort;\n  }\n  get scatterXAttrib() {\n    return this.rd.codeBy.scatterX;\n  }\n  get scatterYAttrib() {\n    return this.rd.codeBy.scatterY;\n  }\n  get colorAttrib() {\n    return this.rd.codeBy.color;\n  }\n  get sizeAttrib() {\n    return this.rd.codeBy.size;\n  }\n  get geoAttrib() {\n    return this.rd.codeBy.geo;\n  }\n\n  get DOM() {\n    return this.rd.DOM;\n  }\n\n  initialized: boolean = false;\n\n  constructor(rd: RecordDisplay) {\n    this.rd = rd;\n  }\n\n  abstract updateAfterFilter(how): void;\n  abstract prepareAttribs(): Promise<boolean>;\n\n  abstract initView_DOM(): void;\n  abstract initView(): void;\n\n  // Signals that one of the vis codings have been updated\n  abstract finishSetAttrib(t: RecordVisCoding);\n\n  abstract refreshRecordVis(): void;\n  abstract extendRecordDOM(newRecords): void;\n\n  /** Called when the UI/window size is updated  */\n  abstract refreshViewSize(delayMS: number): void;\n\n  /** Called when the given attribute has unit name updated */\n  abstract refreshAttribUnitName(attrib: Attrib);\n\n  refreshRecordSizes(): void {}\n  refreshRecordColors(): void {}\n  refreshLabelOverlaps(): void {}\n\n  async refreshAttribScaleType(attrib: Attrib) {}\n  onRecordMouseOver(record: Record) {}\n  onRecordMouseLeave(record: Record) {}\n\n  // can be extended in sub-classes\n  refreshQueryBox_Filter(bounds) {}\n\n  zoomIn() {}\n  zoomOut() {}\n  zoomToFit() {}\n\n  // can be extended by subclasses\n  updateRecordVisibility() {}\n\n  getRecordsForDOM() {\n    return this.browser.records;\n  }\n\n  isComparable() {\n    // Scatterplot and Map views can share the same code here!\n    if (this.browser.activeComparisonsCount === 0) return false;\n    if (!this.browser.comparedAttrib) return false;\n    if (!this.DOM.kshfRecords) return false;\n    if (\n      this.rd.viewRecAs === \"map\" &&\n      this.rd.codeBy.geo?.geoType !== \"Point\"\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  animStepDelayMs: number = 1000;\n\n  stepTimeAnimation(stepSize: number): boolean {\n    if (this.rd.currentTimeKey.get() == null) return false;\n\n    // Iterates over potential time-series keys.\n    // When it finds one,starts animation, and returns (executed only for one coding)\n    [\"sort\", \"scatter\", \"color\", \"size\"].some((v) => {\n      var attrib = this.rd.codeBy[v];\n      if (!attrib) return false;\n      if (!(attrib instanceof Attrib_Numeric)) return false;\n      if (!attrib.hasTimeSeriesParent()) return false;\n\n      var tsParent = attrib.timeseriesParent;\n\n      this.rd.timeseriesAnimInterval = window.setInterval(() => {\n        let a = tsParent.getTimepointSummary_Next(attrib, stepSize);\n        if (attrib === null) {\n          this.rd.stopTimeseriesAnimation();\n        } else {\n          this.rd.currentTimeKey.set(attrib.timeKey);\n          attrib = a;\n        }\n      }, this.animStepDelayMs);\n\n      return true;\n    });\n  }\n  // no-op by default\n  stopTimeAnimation() {}\n\n  /** -- */\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\n    if (!this.isComparable()) return;\n\n    if (!this.rd.recordDrawArc) return;\n\n    var targetRecords = (record: Record) => {\n      if (!record.isIncluded) return false;\n      if (!record.DOM.record) return false;\n      if (cT && record.isSelected(cT) !== status) return false;\n      if (this.rd.viewRecAs === \"map\") {\n        if (!this.rd.codeBy.geo.getRecordValue(record)) return false;\n      }\n      return true;\n    };\n\n    let _do = (d, cT, arcGen) => {\n      d.select(\".glyph_\" + cT)\n        .transition()\n        .ease(d3.easePoly.exponent(3))\n        .duration(700)\n        .attr(\"d\", arcGen);\n    };\n\n    if (!this.browser.isComparedSummaryMultiValued()) {\n      // renders as point\n      this.DOM.kshfRecords.each((record: Record) => {\n        if (!targetRecords(record)) return;\n        var d = d3.select(record.DOM.record);\n        record.activeComparisons.forEach((cT) =>\n          _do(d, cT, (record) => this.rd.recordDrawArc(record)())\n        );\n      });\n      //\n    } else {\n      // renders as pies\n      this.DOM.kshfRecords.each((record: Record) => {\n        if (!targetRecords(record)) return;\n        var numPies = record.activeComparisons.length;\n        if (numPies === 0) return;\n\n        var arcGen = this.rd.recordDrawArc(record);\n        var arcLen = (2 * Math.PI) / numPies;\n\n        var d = d3.select(record.DOM.record);\n        record.activeComparisons.forEach((cT, i) => {\n          arcGen.startAngle(arcLen * i).endAngle(arcLen * (i + 1));\n          _do(d, cT, arcGen());\n        });\n      });\n    }\n\n    this.rd.refreshCompareLegend();\n  }\n\n  // Utility/ helper\n  protected extendRecordDOM_Point(newRecords) {\n    newRecords.classed(\"pointGeo\", true);\n\n    [\"Main\"]\n      .concat(Base.Compare_List)\n      .forEach((cT) => newRecords.append(\"path\").attr(\"class\", \"glyph_\" + cT));\n    newRecords.append(\"text\").attr(\"class\", \"sizeValueText\");\n\n    // initializes to tiny circles\n    newRecords.selectAll(\"path\").attr(\"d\", Util.getCirclePath());\n  }\n\n  /** -- */\n  insertQueryBoxes(parent, setSizeCb, dragCb, clearCb) {\n    var queryBoxes = parent\n      .selectAll(\".spatialQueryBox\")\n      .data([\"Filter\"].concat(Base.Compare_List))\n      .enter()\n      .append(\"div\")\n      .attr(\n        \"class\",\n        (d) => `spatialQueryBox spatialQueryBox_${d} leaflet-zoom-hide`\n      );\n\n    queryBoxes\n      .selectAll(\".setSize\")\n      .data([\"l\", \"r\", \"t\", \"b\"])\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", (k) => \"setSize-\" + k)\n      .on(\"mousedown\", setSizeCb);\n\n    queryBoxes\n      .append(\"div\")\n      .attr(\"class\", \"dragSelection fa fa-arrows\")\n      .tooltip(\"Drag\")\n      .on(\"mousedown\", dragCb);\n\n    queryBoxes\n      .append(\"div\")\n      .attr(\"class\", \"clearFilterButton fa\")\n      .tooltip((_) => i18n[_ === \"Filter\" ? \"RemoveFilter\" : \"Unlock\"])\n      .on(\"mouseup\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      })\n      .on(\"mousedown\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      })\n      .on(\"click\", clearCb);\n  }\n}\n","import DOMPurify from \"dompurify/dist/purify.es\";\nimport noUiSlider from \"nouislider/dist/nouislider.mjs\";\nimport tippy from \"tippy.js\";\n\nimport { select, pointer, selection } from \"./d3_select\";\nimport { scaleLinear } from \"d3-scale\";\nimport { min, max, extent } from \"d3-array\";\nimport { line, curveLinear, curveMonotoneX } from \"d3-shape\";\nimport { easePoly } from \"d3-ease\";\nimport { schemeCategory10 } from \"d3-scale-chromatic\";\nimport { format } from \"d3-format\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\nimport { Config } from \"./Config\";\nimport { LinearOrLog, RecordVisCoding } from \"./Types\";\nimport { i18n } from \"./i18n\";\nimport { RecordDisplay } from \"./RecordDisplay\";\nimport { RecordView } from \"./RecordView\";\nimport { Record } from \"./Record\";\nimport { Base } from \"./Base\";\n\nimport { TimeData, TimeKey, TimeSeriesData } from \"./TimeSeriesData\";\n\nconst d3 = {\n  select,\n  selection,\n  pointer,\n  min,\n  max,\n  extent,\n  line,\n  curveMonotoneX,\n  curveLinear,\n  scaleLinear,\n  easePoly,\n  schemeCategory10,\n  format,\n};\n\n/** -- */\nclass LabelSpacer {\n  usedList: { _min: number; _max: number; _entity: Record }[];\n\n  constructor() {\n    this.clear();\n  }\n  clear() {\n    this.usedList = [];\n  }\n  isEmpty(pixel: number): boolean {\n    return !this.isUsed(pixel);\n  }\n  isUsed(pixel: number): boolean {\n    return this.usedList.some((_) => pixel < _._max && pixel > _._min);\n  }\n  /** returns the entity that hee given pixel intersects with */\n  intersectsWith(pixel: number) {\n    return this.usedList.find((_) => pixel < _._max && pixel > _._min);\n  }\n  insertUsed(pos: number, range: number, entity: Record) {\n    this.usedList.push({\n      _min: pos - range,\n      _max: pos + range,\n      _entity: entity,\n    });\n  }\n}\n\nfunction hideAllPoppers() {\n  var poppers = [].slice.call(document.querySelectorAll(\"[data-tippy-root]\"));\n\n  poppers.forEach(function (popper) {\n    var tippy = popper._tippy;\n    if (tippy) {\n      tippy.hide();\n      tippy.reference.classList.remove(\"visible\");\n    }\n  });\n}\n\nexport class RecordView_Timeseries extends RecordView {\n  ts_Type: Config<string>;\n  ts_timeKeysStep: Config<\"all\" | \"limits\">;\n  ts_valueAxisScale: Config<LinearOrLog>;\n  timeSeriesSelectMode: Config<\"record\" | \"time\">;\n  timeSeriesChangeVsTimeKey: Config<TimeKey>;\n  fitValueAxis: Config<boolean>;\n\n  private timeKeys_Active: TimeKey[] = [];\n\n  private timeRange: any;\n\n  private scale_Value: any = null;\n  private scale_Time: any = null;\n  private scale_Time_prev: any = null;\n\n  private timeseriesRange: any;\n  private timeseriesRange_noUpdate: boolean = false;\n\n  y_Generator: any; // TODO: check\n\n  private recordInView: (record: Record) => boolean;\n\n  get timeseriesAttrib() {\n    return this.rd.codeBy.timeSeries;\n  }\n\n  /** -- */\n  async prepareAttribs() {\n    if (!this.timeseriesAttrib) {\n      await this.rd.setAttrib(\"timeSeries\", this.rd.config.timeSeriesBy || 0);\n    }\n    return Promise.resolve(true);\n  }\n\n  constructor(rd: RecordDisplay, config) {\n    super(rd);\n\n    this.ts_Type = new Config<string>({\n      cfgClass: \"ts_Type\",\n      cfgTitle: \"Timeseries Plot\",\n      iconClass: \"far fa-chart-line\",\n      default: \"Value\",\n      parent: this,\n      helparticle: \"5eaf64de042863474d1a0efc\",\n      tooltip: `Timeseries plot chart type`,\n      itemOptions: [\n        { name: \"# Value\", value: \"Value\" },\n        { name: \" Rank\", value: \"Rank\" },\n        { name: \"#-Change\", value: \"ChangeAbs\" },\n        { name: \"%-Change\", value: \"ChangePct\" },\n      ],\n      preSet: async (v) => v === \"Change\" ? \"ChangePct\" /* old value*/ : v,\n      onSet: () => this.refreshTimeSeriesPlotType(),\n    });\n\n    this.timeSeriesChangeVsTimeKey = new Config<TimeKey>({\n      parent: this,\n      cfgClass: \"ts_ChangeVsTimeKey\",\n      cfgTitle: \"Change vs.\",\n      iconClass: \"far fa-calendar\",\n      default: null,\n      helparticle: \"5e87f81e2c7d3a7e9aea60a4\",\n      onDOM: (DOM) => {\n        var _ = DOM.root.select(\".configItem_Options\");\n        DOM.keySelect = _.append(\"select\")\n          .attr(\"class\", \"keySelect\")\n          .on(\"change\", async (event) => {\n            await this.timeSeriesChangeVsTimeKey.set(event.currentTarget.selectedOptions[0].__data__._time_src);\n          });\n      },\n      onRefreshDOM: (cfg: Config<TimeKey>) => {\n        if (!cfg.get()) return; // nothing to do!\n        cfg.DOM.root.classed(\"hidden\", !this.isTimeseriesChange());\n        cfg.DOM.keySelect\n          .selectAll(\"option\")\n          .data(this.timeKeys_Active || [], (d: TimeKey) => d._time_src)\n          .join(\n            (enter) => enter.append(\"option\").text((d) => d._time_src),\n            (update) => update,\n            (exit) => exit.remove()\n          )\n          .attr(\"selected\", (d: TimeKey) =>\n            d._time_src === cfg.get()._time_src ? true : null\n          );\n      },\n      preSet: async (v, obj) => {\n        if (!this.timeseriesAttrib) return; // NOT SET now\n\n        if (typeof v === \"string\") {\n          v = this.timeseriesAttrib.timeKeys.find((k) => k._time_src === v);\n        }\n\n        // if not set, use first timeKey\n        if (!v) return this.timeseriesAttrib.timeKeys[0];\n\n        return v;\n      },\n      onSet: (v, obj) => {\n        this.refreshScaleValue();\n        this.refreshKeyLine();\n      },\n    });\n\n    this.ts_timeKeysStep = new Config<\"all\" | \"limits\">({\n      parent: this,\n      cfgClass: \"ts_timeKeysStep\",\n      cfgTitle: \"Time Keys\",\n      iconClass: \"far fa-calendar\",\n      UISeperator: {\n        title: \"Axis\",\n        className: \"ts_only\",\n      },\n      default: \"all\",\n      helparticle: \"5e891b8504286364bc97d544\",\n      itemOptions: [\n        { name: \"All\", value: \"all\" },\n        { name: \"1st &amp; Last (Slope)\", value: \"limits\" },\n      ],\n      forcedValue: () => {\n        if (!this.timeseriesAttrib) return;\n        if (this.timeseriesAttrib.timeKeys.length < 3) return \"limits\";\n      },\n      onSet: () => this.refreshTimeRange(),\n    });\n\n    this.ts_valueAxisScale = new Config<LinearOrLog>({\n      cfgClass: \"ts_valueAxisScale\",\n      cfgTitle: \"Value Axis Scale\",\n      iconClass: \"fa fa-arrows-v\",\n      default: config.ts_valueAxisScale || \"linear\",\n      parent: this,\n      helparticle: \"5f137b5304286306f8070db3\",\n      itemOptions: [\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\n      ],\n      noExport: true,\n      forcedValue: () => {\n        if (this.ts_Type.get() !== \"Value\") return \"linear\";\n        if (this.timeseriesAttrib && !this.timeseriesAttrib.supportsLogScale())\n          return \"linear\";\n      },\n      onSet: async (v) => {\n        if (this.timeseriesAttrib) {\n          await this.timeseriesAttrib.valueScaleType.set(v);\n        }\n      },\n    });\n\n    // Timeseries-only?\n    this.fitValueAxis = new Config<boolean>({\n      cfgClass: \"fitValueAxis\",\n      cfgTitle: \"Fit Value Axis\",\n      iconClass: \"fa fa-arrows-v\",\n      default: false,\n      parent: this,\n      helparticle: \"5e891b992c7d3a7e9aea64fb\",\n      itemOptions: [\n        { name: \"Static\", value: false },\n        { name: \"Dynamic\", value: true },\n      ],\n      forcedValue: () => {\n        if (!this.browser.isFiltered()) return false; // full\n        if (this.ts_Type.is(\"Rank\")) return false; // full\n        if (this.isTimeseriesChange()) return true; // fit\n      },\n      onSet: () => {\n        this.refreshScaleValue();\n      },\n    });\n\n    this.timeSeriesSelectMode = new Config<\"record\" | \"time\">({\n      cfgClass: \"timeSeriesSelectMode\",\n      cfgTitle: \"Mouse Select\",\n      iconClass: \"fa fa-hand-pointer\",\n      UISeperator: {\n        title: \"Control\",\n        className: \"ts_only\",\n      },\n      default: \"record\", // not set\n      parent: this,\n      helparticle: \"5e88c11004286364bc97d3c0\",\n      itemOptions: [\n        { name: \"Nearest Record\", value: \"record\" },\n        { name: \"Nearest Time-Key\", value: \"time\" },\n        // {name: \"Filter\", value: \"filter\" },\n      ],\n      onSet: (v) => {\n        // TODO\n        // this.visMouseMode.val = (v==='filter')?'filter':'pan';\n      },\n    });\n\n    [\n      \"ts_Type\",\n      \"timeSeriesChangeVsTimeKey\",\n      \"timeSeriesSelectMode\",\n      \"ts_timeKeysStep\",\n      \"fitValueAxis\",\n      \"ts_valueAxisScale\",\n    ].forEach((t) => {\n      this[t].val = config[t];\n      this.rd.configs[t] = this[t];\n      this.rd.recordConfigPanel.insertConfigUI(this[t]);\n    });\n\n    var me = this;\n\n    this.timeRange = {\n      _src: {},\n      get min() {\n        return this.val(\"min\");\n      },\n      get max() {\n        return this.val(\"max\");\n      },\n      set min(v) {\n        this._src.min = v ? v._time_src : null;\n      },\n      set max(v) {\n        this._src.max = v ? v._time_src : null;\n      },\n      val: function (t) {\n        var v = this._src[t];\n        if (!v || !me.timeseriesAttrib || !me.timeseriesAttrib.timeKeys)\n          return null;\n        return me.timeseriesAttrib.timeKeys.find((_) => _._time_src === v);\n      },\n      minActive() {\n        return this.min._index > 0;\n      },\n      maxActive() {\n        return this.max._index < me.timeseriesAttrib.timeKeys.length - 1;\n      },\n      isActive(t) {\n        if (t === \"min\") return this.minActive();\n        if (t === \"max\") return this.maxActive();\n        return this.minActive() || this.maxActive();\n      },\n      exportConfig() {\n        var o = {};\n        if (this._src.min) o[\"min\"] = this._src.min;\n        if (this._src.max) o[\"max\"] = this._src.max;\n        return o;\n      },\n      importConfig(o) {\n        if (!o) return;\n        [\"min\", \"max\"].forEach((t) => {\n          if (o[t]) this._src[t] = o[t];\n        });\n      },\n    };\n\n    this.timeRange.importConfig(config.timeRange);\n  }\n\n  /** -- */\n  initView() {\n    this.recordInView = (record: Record) => {\n      var _ts = this.timeseriesAttrib.getRecordValue(record);\n      if (!_ts || _ts.isEmpty()) return false;\n      if (this.isTimeseriesChange()) {\n        var _compareKey = this.timeSeriesChangeVsTimeKey.get()._time_src;\n        var _index = _ts._keyIndex[_compareKey];\n        return _index != null && _index._value != null;\n      }\n      return true;\n    };\n\n    this.refreshTimeSeriesPlotType();\n\n    this.refreshScaleTime();\n\n    this.rd.refreshRecordDOM();\n\n    this.rd.refreshRecordVis();\n    this.refreshTimeseriesTicks();\n    this.refreshTicks_AxisY();\n\n    this.updateDotVisibility();\n\n    this.refreshFilterRanges();\n  }\n\n  /** -- */\n  async initView_DOM() {\n    if (this.DOM.recordBase_Timeseries) {\n      this.DOM.recordGroup =\n        this.DOM.recordBase_Timeseries.select(\".recordGroup\");\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\n      return;\n    }\n\n    var me = this;\n\n    let prevClosestRecord: Record = null;\n    let prevClosestTime: TimeKey = null;\n\n    var changeFormat = d3.format(\"+.2\");\n\n    function refreshDotTooltip(d) {\n      var record: Record = d.DOM.parentNode.__data__;\n      var recordText = me.textBriefAttrib.getRecordValue(record) || \"\";\n      var recordValue = me.timeseriesAttrib.getFormattedValue(d._value);\n      var _recordRank =\n        me.ts_Type.is(\"Rank\")\n          ? ` <span class='extraInfo'>(#${d._rank})</span>`\n          : \"\";\n      var recordChange = \"\";\n      if (me.isTimeseriesChange()) {\n        var _key = me.timeSeriesChangeVsTimeKey.get()._time_src;\n        var ref =\n          me.timeseriesAttrib.getRecordValue(record)?._keyIndex[_key]?._value;\n        var _v = changeFormat((100 * (d._value - ref)) / (ref || 1)) + \"%\"; // avoid divide by zero\n        if (me.ts_Type.is(\"ChangeAbs\")) {\n          _v = me.timeseriesAttrib.getFormattedValue(d._value - ref);\n        }\n        recordChange = ` <span class='extraInfo'>(${_v} vs. ${_key})</span>`;\n      }\n      var x;\n      var fullValue = recordValue + _recordRank + recordChange;\n      if (me.timeSeriesSelectMode.is(\"time\")) {\n        x = `<span class='asdsdadsada'>${recordText}: <b>${fullValue}</b></span>`;\n      } else {\n        x =\n          `<span class='mapItemName'>${recordText}</span>` +\n          \"<div class='recordColorInfo'>\" +\n          \"<div class='mapTooltipLabel'>\" +\n          `<b>${me.timeseriesAttrib.attribName}</b>` +\n          ` <i class='fal fa-calendar'></i> ${d._time_src}` +\n          \"</div><br>\" +\n          `<span class='mapTooltipValue'>${fullValue}</span>` +\n          \"</div>\";\n      }\n      d.DOM.tippy.popper.children[0].children[0].innerHTML =\n        DOMPurify.sanitize(x);\n    }\n\n    var spacer_left = new LabelSpacer();\n    var spacer_right = new LabelSpacer();\n\n    function pofff(c, record, _placement = \"right\") {\n      if (!c.DOM) return; // no tooltip\n      c.DOM.tippy = tippy(\n        c.DOM,\n        Object.assign({}, d3.selection.tippyDefaultConfig, {\n          theme: \"dark kshf-tooltip kshf-record\",\n          placement: _placement,\n          animation: \"fade\",\n          trigger: \"manual\",\n          delay: 0,\n          duration: [500, 100],\n          appendTo: Base.browser.DOM.root.node(),\n        })\n      );\n      refreshDotTooltip(c);\n      c.DOM.tippy.show();\n    }\n\n    this.DOM.recordBase_Timeseries = this.DOM.recordDisplayWrapper\n      .append(\"div\")\n      .attr(\"class\", \"recordBase_Timeseries\");\n\n    this.refreshTimeSeriesChartWidth();\n\n    // Y & X axis\n    [\"Y\", \"X\"].forEach((a) => {\n      var _ = this.DOM.recordBase_Timeseries\n        .append(\"div\")\n        .attr(\"class\", \"recordAxis recordAxis_\" + a);\n      _.append(\"div\").attr(\"class\", \"tickGroup\");\n      _.append(\"div\")\n        .attr(\"class\", \"keyLine\")\n        .style(\"display\", this.isTimeseriesChange() ? \"block\" : null);\n    });\n\n    // X-axis min/max time key setting\n    [\"min\", \"max\"].forEach((limit) => {\n      var __ = this.DOM.recordBase_Timeseries\n        .append(\"span\")\n        .attr(\"class\", \"timeLimit timeLimit-\" + limit);\n      __.append(\"select\").on(\"change\", (event) => {\n        this.setTimeRange({\n          [limit]: event.currentTarget.selectedOptions[0].__data__._index,\n        });\n      });\n      __.append(\"span\").attr(\n        \"class\",\n        limit === \"min\"\n          ? \"far fa-angle-double-right\"\n          : \"far fa-angle-double-left\"\n      );\n    });\n    this.refreshTimeSeriesRangeOpts();\n\n    // ******************************************************\n\n    this.DOM.recordGroup = this.DOM.recordBase_Timeseries\n      .append(\"svg\")\n      .attr(\"class\", \"recordGroup recordGroup_Timeseries\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n\n      .on(\"click\", () => {\n        if (this.rd.visMouseMode === \"filter\") return;\n        if (prevClosestRecord) {\n          hideAllPoppers();\n          this.browser.recordDetailsPopup.updateRecordDetailPanel(\n            prevClosestRecord\n          );\n          this.browser.recordDetailsPopup.updateFocusedTimeKey(prevClosestTime);\n        }\n        this.rd.setDimmed(false);\n      })\n\n      .on(\"mouseleave\", () => {\n        if (this.rd.visMouseMode === \"filter\") return;\n        if (this.timeSeriesSelectMode.is(\"time\")) {\n          hideAllPoppers();\n          this.browser.records.forEach((record) => {\n            // remove \"visible\" from dots\n            if (record.filteredOut) return;\n            if (!prevClosestTime) return;\n              this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n                prevClosestTime._time_src\n              ]?.DOM?.classList.remove(\"visible\");\n          });\n          prevClosestTime = null;\n        }\n        this.rd.onRecordMouseLeave(prevClosestRecord);\n        prevClosestRecord = null;\n      })\n\n      .on(\"mousemove\", (event) => {\n        if (this.rd.visMouseMode === \"filter\") return;\n\n        var _m = d3.pointer(event);\n\n        if (_m[1] > event.currentTarget.offsetHeight || _m[1] < 0) {\n          // out of chart bounds\n          if (this.timeSeriesSelectMode.is(\"record\")) {\n            this.rd.onRecordMouseLeave(prevClosestRecord);\n            prevClosestRecord = null;\n          }\n          if (this.timeSeriesSelectMode.is(\"time\") && prevClosestTime) {\n            hideAllPoppers();\n            this.browser.records.forEach((record: Record) => {\n              if (record.filteredOut) return;\n              if (!prevClosestTime) return;\n              this.timeseriesAttrib\n                .getRecordValue(record)\n                ?._keyIndex[prevClosestTime._time_src]?.DOM?.classList.remove(\n                  \"visible\"\n                );\n            });\n          }\n\n          return;\n        }\n\n        var _m_Time = this.scale_Time.invert(_m[0]);\n        var _compareKey = this.timeSeriesChangeVsTimeKey.get()?._time_src || null;\n\n        var closestTimeKey = null;\n        if (\n          _m_Time.getTime() <= this.scale_Time.domain()[1].getTime() &&\n          _m_Time.getTime() >= this.scale_Time.domain()[0].getTime()\n        ) {\n          var closestTimeDist = 999999999999999;\n          this.timeKeys_Active.every((timeKey) => {\n            var _dist = Math.abs(timeKey._time.getTime() - _m_Time.getTime());\n            if (_dist < closestTimeDist) {\n              closestTimeKey = timeKey;\n              closestTimeDist = _dist;\n              return true;\n            }\n            return false; // getting farther away. We already found the closest\n          });\n        }\n\n        // Select closest time\n        if (this.timeSeriesSelectMode.is(\"time\")) {\n          if (closestTimeKey === prevClosestTime) return;\n\n          if (prevClosestTime) {\n            hideAllPoppers();\n            this.browser.records.forEach((record) => {\n              if (record.filteredOut) return;\n              this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n                prevClosestTime._time_src\n              ]?.DOM?.classList.remove(\"visible\");\n            });\n          }\n\n          if (closestTimeKey) {\n            spacer_right.clear();\n            spacer_left.clear();\n\n            this.browser.records.forEach((record) => {\n              if (!this.recordInView(record) || record.filteredOut) return;\n              var c =\n                this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n                  closestTimeKey._time_src\n                ];\n              if (!c) return;\n              c.DOM.classList.add(\"visible\"); // timeSeriesDot\n              var placement;\n              var ref = this.isTimeseriesChange()\n                ? this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n                    _compareKey\n                  ]._value\n                : 0;\n              var top = this.y_Generator(c, ref);\n              if (spacer_right.isEmpty(top)) {\n                placement = \"right\";\n                spacer_right.insertUsed(top, 30, record);\n              } else if (spacer_left.isEmpty(top)) {\n                placement = \"left\";\n                spacer_left.insertUsed(top, 30, record);\n              } else {\n                return;\n              }\n              pofff(c, record, placement);\n            });\n          }\n          prevClosestTime = closestTimeKey;\n          return;\n        }\n\n        // Select closest point\n\n        var closestRecord = null;\n        if (!closestTimeKey) {\n          this.rd.onRecordMouseLeave(prevClosestRecord);\n          prevClosestRecord = null;\n          return;\n        }\n\n        var closestValueDist = 999999999999999;\n        this.browser.records.forEach((record) => {\n          if (!this.recordInView(record) || record.filteredOut) return;\n          var _ =\n            this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n              closestTimeKey._time_src\n            ];\n          if (!_) return;\n          var ref = this.isTimeseriesChange()\n            ? this.timeseriesAttrib.getRecordValue(record)?._keyIndex[\n                _compareKey\n              ]._value\n            : 0;\n          var _v = this.y_Generator(_, ref);\n          var _dist = Math.abs(_v - _m[1]);\n          if (_dist < 50 && _dist < closestValueDist) {\n            closestRecord = record;\n            closestValueDist = _dist;\n          }\n        });\n\n        if (prevClosestRecord !== closestRecord) {\n          this.rd.onRecordMouseLeave(prevClosestRecord);\n          prevClosestRecord = null;\n          if (closestRecord) {\n            this.rd.onRecordMouseOver(closestRecord);\n            var c =\n              this.timeseriesAttrib.getRecordValue(closestRecord)?._keyIndex[\n                closestTimeKey._time_src\n              ];\n            if (c) {\n              pofff(c, closestRecord);\n            }\n          }\n          prevClosestRecord = closestRecord;\n        } else if (closestRecord) {\n          // maybe record is the same, but the time changed?\n          if (prevClosestTime !== closestTimeKey) {\n            hideAllPoppers();\n            var c =\n              this.timeseriesAttrib.getRecordValue(closestRecord)?._keyIndex[\n                closestTimeKey._time_src\n              ];\n            if (c) {\n              pofff(c, closestRecord);\n            }\n          }\n        }\n\n        prevClosestTime = closestTimeKey;\n\n        this.rd.setDimmed(!!prevClosestRecord);\n      });\n\n    this.DOM.recordLineClippath = this.DOM.recordGroup\n      .append(\"clipPath\")\n      .attr(\"id\", \"recordLineClippath\")\n      .append(\"rect\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"height\", 4000);\n\n    // annotations\n    this.DOM.ts_annotations = this.DOM.recordBase_Timeseries\n      .append(\"span\")\n      .attr(\"class\", \"ts_annotations\");\n\n    this.DOM.recordBase_Timeseries\n      .append(\"div\")\n      .attr(\"class\", \"TimeseriesColorInfo\")\n      .html(i18n[\"Line colors are random\"]);\n\n    // ******************************************************\n\n    this.DOM.timeSeriesControlGroup = this.DOM.recordBase_Timeseries\n      .append(\"div\")\n      .attr(\"class\", \"timeSeriesControlGroup attribControlGroup\");\n\n    this.rd.initDOM_AttribSelect(\"timeSeries\");\n\n    // ******************************************************\n\n    this.DOM.timeAnimationClearRange.on(\"click\", () =>\n      this.setTimeRange({ min: 0, max: 10000 })\n    ); // max is just a very large number\n\n    noUiSlider.create(this.DOM.timeseriesRange.node(), {\n      start: [50, 50],\n      connect: true,\n      step: 1,\n      behaviour: \"tap-drag\",\n      margin: 1, // at least one step difference between the end/start point\n      range: {\n        min: 0,\n        max: 100,\n      },\n    });\n\n    this.timeseriesRange = this.DOM.timeseriesRange.node().noUiSlider;\n\n    var _update_2 = (_values, _handle, unencoded) => {\n      if (this.timeseriesRange_noUpdate) return;\n      unencoded = unencoded.map((_) => Math.round(_));\n      this.timeseriesRange_noUpdate = true;\n      this.setTimeRange({ min: unencoded[0], max: unencoded[1] });\n      delete this.timeseriesRange_noUpdate;\n    };\n    this.timeseriesRange.on(\"set\", _update_2);\n  }\n\n  /** -- */\n  isTimeseriesChange() {\n    return this.ts_Type.is(\"ChangePct\") || this.ts_Type.is(\"ChangeAbs\");\n  }\n\n  extendRecordDOM(newRecords) {\n    newRecords.append(\"path\");\n    newRecords.append(\"g\").attr(\"class\", \"dotGroup\");\n    newRecords\n      .append(\"foreignObject\")\n      .attr(\"width\", \"120\")\n      .attr(\"height\", \"1\")\n      .call((fO) => {\n        fO.append(\"xhtml:div\")\n          .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\n          .attr(\"class\", \"recordText_side\")\n          .html((record: Record) =>\n            this.textBriefAttrib?.renderRecordValue(record)\n          );\n        fO.append(\"xhtml:div\")\n          .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\n          .attr(\"class\", \"recordText_Dot\");\n      });\n  }\n\n  // ********************************************************************\n  // Time range\n  // ********************************************************************\n\n  /** -- Parameters are integer index of the active timeseries attribute timekeys */\n  setTimeRange({ min = -1, max = -1 } = {}) {\n    if (min >= 0) {\n      this.timeRange.min = this.timeseriesAttrib.timeKeys[min];\n    }\n    if (max >= 0) {\n      max = Math.min(max, this.timeseriesAttrib.timeKeys.length - 1);\n      this.timeRange.max = this.timeseriesAttrib.timeKeys[max];\n    }\n    this.refreshTimeRange();\n  }\n\n  /** -- */\n  refreshTimeRange() {\n    this.refreshScaleTime();\n    this.refreshTimeseriesTicks();\n\n    if (this.timeRange.min._time > this.timeSeriesChangeVsTimeKey.get()?._time) {\n      this.timeSeriesChangeVsTimeKey.set(this.timeRange.min);\n      this.refreshTimeSeriesRangeOpts(); // updates combobox for vs.\n\n    } else if (this.timeRange.max._time < this.timeSeriesChangeVsTimeKey.get()?._time) {\n      this.timeSeriesChangeVsTimeKey.set(this.timeRange.max);\n      this.refreshTimeSeriesRangeOpts(); // updates combobox for vs.\n\n    } else {\n      this.refreshScaleValue();\n    }\n  }\n\n  /** -- */\n  refreshTimeSeriesRangeOpts() {\n    [\"min\", \"max\"].forEach((limit) => {\n      this.DOM.root\n        .select(\".timeLimit-\" + limit)\n        .classed(\"filtered\", this.timeRange.isActive(limit));\n      this.DOM.root\n        .select(\".timeLimit-\" + limit + \" > select\")\n        .selectAll(\"option\")\n        .data(\n          this.timeseriesAttrib.timeKeys.filter(\n            limit === \"min\"\n              ? (key) => key._time < this.timeRange.max._time\n              : (key) => key._time > this.timeRange.min._time\n          ),\n          (d) => d._time_src\n        )\n        .join(\n          (enter) => enter.append(\"option\").text((d) => d._time_src),\n          (update) => update,\n          (exit) => exit.remove()\n        )\n        .attr(\"selected\", (d) =>\n          d._time_src === this.timeRange[limit]._time_src ? true : null\n        );\n    });\n  }\n\n  async refreshAttribScaleType(attrib: Attrib) {\n    if (\n      attrib instanceof Attrib_Timeseries &&\n      this.timeseriesAttrib === attrib\n    ) {\n      await this.ts_valueAxisScale.set(attrib.valueScaleType.get()); // apply it back to the attribute\n      if (this.ts_Type.is(\"Value\")) {\n        this.refreshScaleValue();\n      }\n    }\n  }\n\n  async finishSetAttrib(t: RecordVisCoding) {\n    if (t === \"textBrief\") {\n      this.DOM.kshfRecords\n        .selectAll(\"foreignObject > .recordText_side\")\n        .html((record: Record) =>\n          this.textBriefAttrib.renderRecordValue(record)\n        );\n      //\n    } else if (t === \"timeSeries\") {\n      this.scale_Time = this.timeseriesAttrib.timeSeriesScale_Time.copy();\n\n      if (\n        !this.timeRange.min ||\n        !this.timeseriesAttrib.timeKeys.some(\n          (_) => _._time_src === this.timeRange.min._time_src\n        ) ||\n        !this.timeRange.max ||\n        !this.timeseriesAttrib.timeKeys.some(\n          (_) => _._time_src === this.timeRange.max._time_src\n        )\n      ) {\n        this.setTimeRange({ min: 0, max: 10000 });\n      }\n\n      await this.ts_valueAxisScale.set(this.timeseriesAttrib.valueScaleType.get());\n\n      if (this.ts_Type.is(\"Rank\")) {\n        this.timeseriesAttrib.computeRecordRanks();\n      }\n\n      if (!this.timeSeriesChangeVsTimeKey.get()) {\n        await this.timeSeriesChangeVsTimeKey.set(this.rd.config.timeSeriesChangeVsTimeKey);\n      }\n\n      this.refreshScaleTime();\n      this.refreshScaleValue();\n      this.refreshFilterRanges();\n    }\n  }\n\n  /** -- */\n  refreshViewSize(_delayMS: number = 0) {\n    this.refreshScaleTime();\n    this.refreshRecordVis();\n    this.refreshTimeseriesTicks();\n    this.refreshTicks_AxisY();\n    this.updateDotVisibility();\n  }\n\n  // ********************************************************************\n  // Scale of time and values\n  // ********************************************************************\n\n  /** -- */\n  refreshScaleTime() {\n    if (!this.timeseriesAttrib) return;\n    if (!this.timeseriesRange) return;\n\n    this.scale_Time_prev = this.scale_Time.copy();\n\n    this.scale_Time.domain([\n      this.timeRange.min._time,\n      this.timeRange.max._time,\n    ]);\n\n    var timeKeys = this.timeseriesAttrib.timeKeys;\n\n    this.timeKeys_Active = timeKeys.filter(\n      (key) =>\n        key._time >= this.timeRange.min._time &&\n        key._time <= this.timeRange.max._time\n    );\n\n    if (this.ts_timeKeysStep.is(\"limits\")) {\n      this.timeKeys_Active = [\n        this.timeKeys_Active[0],\n        this.timeKeys_Active[this.timeKeys_Active.length - 1],\n      ];\n      if (this.isTimeseriesChange()) {\n        this.timeKeys_Active.splice(1, 0, this.timeSeriesChangeVsTimeKey.get());\n      }\n    }\n\n    this.timeSeriesChangeVsTimeKey.refresh();\n\n    this.marginLeft = 85;\n    this.chartWidth = this.rd.curWidth - this.marginTotal;\n    this.expandMargin();\n    this.scale_Time.range([0, this.chartWidth]);\n\n    // first time setting scale_Time should also reset prev to current\n    if (!this.scale_Time_prev) {\n      this.scale_Time_prev = this.scale_Time.copy();\n    }\n\n    this.refreshTimeSeriesChartWidth();\n\n    this.refreshTimeSeriesRangeOpts();\n\n    this.timeseriesRange_noUpdate = true;\n    this.timeseriesRange.updateOptions({\n      range: {\n        min: 0,\n        max: timeKeys.length - 1,\n      },\n    });\n    delete this.timeseriesRange_noUpdate;\n\n    // \"false\" avoid firing the \"set\" event\n    this.timeseriesRange.setHandle(0, this.timeRange.min._index, false);\n    this.timeseriesRange.setHandle(1, this.timeRange.max._index, false);\n\n    this.DOM.timeAnimation.select(\".rangeTick-min\").html(timeKeys[0]._time_src);\n    this.DOM.timeAnimation\n      .select(\".rangeTick-max\")\n      .html(timeKeys[timeKeys.length - 1]._time_src);\n    this.DOM.timeAnimation\n      .select(\".clearRange\")\n      .classed(\"active\", this.timeRange.isActive());\n\n    this.addAnnotations();\n  }\n\n  /** -- */\n  refreshScaleValue() {\n    if (!this.ts_Type) return;\n    if (!this.timeseriesAttrib) return;\n\n    // RANK    *****************************************************\n    if (this.ts_Type.is(\"Rank\")) {\n      var timeDomain = this.scale_Time.domain();\n      var inTimeDomain = (d) => true;\n      if (timeDomain) {\n        inTimeDomain = (d) =>\n          d._time >= timeDomain[0] && d._time <= timeDomain[1];\n      }\n\n      // count number of records with data within the time domain\n      var maxNumRecords = this.browser.records.reduce(\n        (accumulator, currentRecord: Record) => {\n          if (currentRecord.filteredOut) return accumulator;\n\n          var _val = this.timeseriesAttrib.getRecordValue(currentRecord);\n          if (!_val) return accumulator;\n\n          // consider only values that are inTimeDomain\n          if (_val._timeseries_.filter(inTimeDomain).length === 0) {\n            return accumulator;\n          }\n\n          return accumulator + 1;\n        },\n        0\n      );\n\n      this.scale_Value = d3.scaleLinear().domain([maxNumRecords, 1]);\n    }\n\n    // VALUE   *****************************************************\n    if (this.ts_Type.is(\"Value\")) {\n      this.scale_Value = this.timeseriesAttrib.timeSeriesScale_Value\n        .copy()\n        .nice();\n\n      var new_domain = this.timeseriesAttrib.getExtent_Value(\n        this.fitValueAxis.get(), // onlyFiltered\n        this.scale_Time.domain() // in current domain\n      );\n\n      var _domain = this.scale_Value.domain();\n      if (_domain[0] > _domain[1]) new_domain = [new_domain[1], new_domain[0]]; // flip domain\n\n      this.scale_Value.domain(new_domain);\n    }\n\n    // CHANGE   *****************************************************\n    if (this.isTimeseriesChange()) {\n      if (!this.timeSeriesChangeVsTimeKey.get()) {\n        this.timeSeriesChangeVsTimeKey.set(this.timeKeys_Active[0]);\n      }\n\n      var _key = this.timeSeriesChangeVsTimeKey.get()._time_src;\n\n      var timeDomain = this.scale_Time.domain();\n      var inTimeDomain = (d) =>\n        d._time >= timeDomain[0] && d._time <= timeDomain[1];\n\n      var vizVal;\n      if (this.ts_Type.is(\"ChangeAbs\")) {\n        vizVal = (v, ref) => v._value - ref;\n      } else if (this.ts_Type.is(\"ChangePct\")) {\n        vizVal = (v, ref) => 100 * ((v._value - ref) / ref);\n      }\n\n      var x = this.browser.records.map((record: Record) => {\n        if (!this.recordInView(record) || record.filteredOut) {\n          return [0, 0];\n        }\n\n        var r_ts = this.timeseriesAttrib.getRecordValue(record);\n        var ref = r_ts._keyIndex[_key]._value;\n        if (!ref) return [0, 0];\n        return d3.extent(r_ts._timeseries_, (v) =>\n          inTimeDomain(v) ? vizVal(v, ref) : null\n        );\n      });\n\n      this.scale_Value = d3\n        .scaleLinear()\n        .domain([d3.min(x, (x) => x[0]), d3.max(x, (x) => x[1])])\n        .nice();\n    }\n\n    // FINALIZE ******************************************************\n    this.refreshRecordVis();\n    this.refreshTicks_AxisY();\n    this.refreshFilterRanges();\n  }\n\n  /** -- */\n  refreshYGenerator() {\n    this.y_Generator = {\n      Value: (d: TimeData) => this.scale_Value(d._value),\n      ChangePct: (d: TimeData, ref) =>\n        this.scale_Value(ref ? (100 * (d._value - ref)) / ref : 0),\n      ChangeAbs: (d: TimeData, ref) => this.scale_Value(d._value - ref),\n      Rank: (d: TimeData) => this.scale_Value(d._rank),\n    }[this.ts_Type.get()];\n  }\n\n  /** VALUE AXIS */\n  refreshTicks_AxisY() {\n    var screenHeight = Math.abs(\n      this.scale_Value.range()[1] - this.scale_Value.range()[0]\n    );\n    var targetNumTicks = Math.floor(screenHeight / 40); // one tickevery 40 pixels\n    var _scale = this.scale_Value.copy();\n    if (_scale.base) _scale.base(10);\n    var ticks = _scale.ticks(targetNumTicks);\n\n    // if the values are integer only, keep only integer values here.\n    if (!this.timeseriesAttrib.hasFloat || this.ts_Type.is(\"Rank\")) {\n      ticks = ticks.filter((d) => d % 1 === 0);\n    }\n\n    if (this.ts_Type.is(\"Rank\")) {\n      ticks.unshift(1);\n      ticks = ticks\n        .sort((a, b) => b - a)\n        // keep unique values onlu=y\n        .reduce((accumulator, currentValue) => {\n          if (accumulator[accumulator.length - 1] !== currentValue)\n            accumulator.push(currentValue);\n          return accumulator;\n        }, []);\n    }\n\n    var tickTextFunc = {\n      Rank: (tick) => \"# \" + d3.format(\"d\")(tick),\n      ChangePct: (tick) => (tick > 0 ? \"+\" : \"\") + d3.format(\".3s\")(tick) + \"%\",\n      ChangeAbs: (tick) =>\n        (tick > 0 ? \"+\" : \"\") + this.timeseriesAttrib.printAbbr(tick, true),\n      Value: (tick) => this.timeseriesAttrib.getFormattedValue(tick, true),\n    }[this.ts_Type.get()];\n\n    var timeAxisDOM = this.DOM.root.select(\n      \".recordBase_Timeseries .recordAxis_Y > .tickGroup\"\n    );\n\n    var visiblePos = 0;\n\n    timeAxisDOM\n      .selectAll(\".hmTicks\")\n      .data(ticks.reverse(), (t) => t) // reverse from decreasing to increasing order\n      .join(\n        (enter) =>\n          enter\n            .append(\"div\")\n            .attr(\"class\", \"hmTicks\")\n            .classed(\"zero\", (tick) => tick === 0)\n            .style(\"opacity\", 0)\n            .call((hmTicks) => {\n              hmTicks.append(\"div\").attr(\"class\", \"tickLine\");\n              hmTicks.append(\"div\").attr(\"class\", \"tickText tickText_1\");\n              hmTicks.transition().delay(500).duration(0).style(\"opacity\", 1);\n            }),\n        (update) => update,\n        (exit) => {\n          exit\n            .style(\n              \"transform\",\n              (tick) =>\n                \"translateY(\" + this.scale_Value(tick) + \"px) translateZ(0)\"\n            )\n            .style(\"opacity\", 0)\n            .transition()\n            .duration(0)\n            .delay(500)\n            .remove();\n        }\n      )\n      .style(\n        \"transform\",\n        (tick) => \"translateY(\" + this.scale_Value(tick) + \"px) translateZ(0)\"\n      )\n      .classed(\"hideLabel\", (tick) => {\n        var pos = this.scale_Value(tick);\n        if (pos >= visiblePos) {\n          visiblePos = pos + 20;\n          return false;\n        }\n        return true;\n      })\n      .call((ticks) => {\n        ticks.selectAll(\".tickText\").html(tickTextFunc);\n      });\n  }\n\n  refreshFilterRanges() {\n    this.DOM.root\n      .selectAll(\".recordBase_Timeseries .recordAxis_X > .tickGroup > .hmTicks\")\n      .each((tick: TimeKey) => {\n        tick._histogram = this.timeseriesAttrib.timeKeyAttribs[tick._time_src];\n      })\n      .classed(\n        \"isFiltered\",\n        (tick: TimeKey) => tick._histogram?.isFiltered() && this.ts_Type.is(\"Value\")\n      )\n      .filter(\n        (tick: TimeKey) => tick._histogram?.isFiltered() && this.ts_Type.is(\"Value\")\n      )\n      .selectAll(\".filterArea\")\n      .style(\"height\", (event) => {\n        var d = _DOM.parentNode.__data__ as TimeKey;\n        var _DOM = event.currentTarget;\n        var attrib = d._histogram;\n        var _a = this.scale_Value(attrib.summaryFilter.active.minV);\n        var _b = this.scale_Value(attrib.summaryFilter.active.maxV);\n        var _domain = this.scale_Value.domain();\n        var flipped = _domain[0] > _domain[1];\n        _DOM._minn = flipped ? _b : _a;\n        _DOM._maxx = flipped ? _a : _b;\n        // That's where printing happens\n        d3.select(_DOM.childNodes[flipped ? 1 : 0]).html(\n          attrib.printAbbr(attrib.summaryFilter.active.minV)\n        );\n        d3.select(_DOM.childNodes[flipped ? 0 : 1]).html(\n          attrib.printAbbr(attrib.summaryFilter.active.maxV)\n        );\n        return Math.abs(_DOM._maxx - _DOM._minn) + 14 + \"px\";\n      })\n      .style(\"top\", (event) => {\n        var _domain = this.scale_Value.domain();\n        if (_domain[0] > _domain[1])\n          return event.currentTarget._minn - 5 + \"px\";\n        return event.currentTarget._maxx - 5 + \"px\";\n      });\n  }\n\n  // ********************************************************************\n  // Size / width / height / margins\n  // ********************************************************************\n\n  // is dyanmically updated, needs a setter too, so setting this as regular var.\n  marginLeft: number = 85;\n  chartWidth: number;\n\n  /** -- */\n  get marginRight() {\n    return 150;\n  }\n  /** -- */\n  get marginTotal() {\n    return this.marginLeft + this.marginRight;\n  }\n  /** -- */\n  isMarginExpandable() {\n    var maxWidth = 200 * (this.timeKeys_Active.length - 1);\n    return maxWidth < this.rd.curWidth - this.marginTotal;\n  }\n  /** -- */\n  expandMargin() {\n    if (this.wideTimeScale) return;\n    // shrink the width if there are few time keys active\n    var maxWidth = 200 * (this.timeKeys_Active.length - 1);\n    if (maxWidth < this.chartWidth) {\n      this.marginLeft += (this.chartWidth - maxWidth) / 2;\n      this.chartWidth = maxWidth;\n    }\n  }\n\n  /** -- */\n  refreshTimeSeriesChartWidth() {\n    this.DOM.recordBase_Timeseries\n      ?.style(\"width\", this.chartWidth + \"px\")\n      .style(\"left\", this.marginLeft + \"px\");\n\n    this.DOM.recordLineClippath?.attr(\"width\", this.chartWidth);\n  }\n\n  /** -- */\n  updateRecordVisibility() {\n    this.refreshLabelOverlaps();\n  }\n\n  /** -- */\n  refreshKeyLine() {\n    if (!this.timeseriesAttrib) return;\n\n    if (!this.timeSeriesChangeVsTimeKey.get()) return;\n    this.DOM.root\n      .select(\".recordAxis_X > .keyLine\")\n      .style(\n        \"transform\",\n        `translateX(${this.scale_Time(\n          this.timeSeriesChangeVsTimeKey.get()._time\n        )})`\n      );\n  }\n\n  /** -- */\n  onRecordMouseLeave() {\n    hideAllPoppers();\n  }\n  /** -- */\n  onRecordMouseOver(record) {\n    record.moveDOMtoTop();\n  }\n\n  /** -- */\n  refreshTimeseriesTicks() {\n    if (!this.timeseriesAttrib) return;\n\n    var me = this;\n\n    var timeAxisDOM = this.DOM.root.select(\n      \".recordBase_Timeseries .recordAxis_X > .tickGroup\"\n    );\n\n    var lastTickPos = -300;\n\n    var maxChar = this.timeseriesAttrib.timeKeys.reduce(\n      (accum, key) => Math.max(accum, key._time_src.length),\n      0\n    );\n    var tickGapWidth = maxChar * 9;\n\n    timeAxisDOM\n      .selectAll(\".hmTicks\")\n      .data(this.timeKeys_Active, (t: TimeKey) => t._time_src)\n      .join(\n        (enter) => {\n          var tk = enter\n            .append(\"div\")\n            .attr(\"class\", \"hmTicks\")\n            .style(\"opacity\", 1)\n            .style(\n              \"transform\",\n              (tick) =>\n                `translateX(${this.scale_Time_prev(\n                  tick._time\n                )}px) translateZ(0)`\n            )\n            .call((tk) =>\n              tk\n                .transition()\n                .delay(0)\n                .duration(0)\n                .style(\n                  \"transform\",\n                  (tick) =>\n                    `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\n                )\n            );\n\n          var tickText = tk.append(\"div\").attr(\"class\", \"tickText\");\n\n          tk.append(\"div\").attr(\"class\", \"tickLine\");\n          tk.append(\"div\")\n            .attr(\"class\", \"timeSelectArea\")\n            .on(\"mousedown\", (event, tick) => {\n              if (event.which !== 1) return; // only respond to left-click\n              me.browser.DOM.root.classed(\"noPointerEvents\", true);\n              var DOM = event.currentTarget;\n              var initPos = me.scale_Value.invert(d3.pointer(event)[1]);\n              var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\n              d3.select(\"body\")\n                .on(\"mousemove.test\", () => {\n                  var targetPos = me.scale_Value.invert(\n                    d3.pointer(event, DOM)[1]\n                  );\n                  var _min = initPos > targetPos ? targetPos : initPos;\n                  var _max = initPos > targetPos ? initPos : targetPos;\n                  if (me.ts_Type.is(\"Rank\")) {\n                    var _minRank = Math.floor(_min);\n                    var _maxRank = Math.ceil(_max);\n                    me.browser.records.forEach((r) => {\n                      var mm = r.getValue(this.timeseriesAttrib)._keyIndex;\n                      if (mm) {\n                        var dasds = mm[tick._time_src];\n                        if (dasds) {\n                          if (dasds._rank === _minRank) _min = dasds._value;\n                          if (dasds._rank === _maxRank) _max = dasds._value;\n                        }\n                      }\n                    });\n                    // find records with these limit ranks\n                  }\n                  histSummary.setRangeFilter_Custom(_min, _max);\n                  me.refreshFilterRanges();\n                })\n                .on(\"mouseup.test\", () => {\n                  me.browser.DOM.root.classed(\"noPointerEvents\", false);\n                  d3.select(\"body\")\n                    .on(\"mousemove.test\", null)\n                    .on(\"mouseup.test\", null);\n                });\n              event.preventDefault();\n            });\n\n          var filterArea = tk\n            .append(\"div\")\n            .attr(\"class\", \"filterArea\")\n            .on(\"mousedown\", (event, tick) => {\n              if (event.which !== 1) return; // only respond to left-click\n              me.browser.DOM.root.classed(\"noPointerEvents\", true);\n              var e = event.currentTarget.parentNode.childNodes[2]; // selectArea. TODO: Make this harder to fail!\n              var DOM = event.currentTarget;\n              DOM.classList.add(\"dragging\");\n\n              var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\n\n              var initPos = me.scale_Value.invert(d3.pointer(event, e)[1]);\n              d3.select(\"body\")\n                .on(\"mousemove.test\", () => {\n                  var curPos = me.scale_Value.invert(d3.pointer(event, e)[1]);\n                  histSummary.setRangeFilter_Custom(\n                    Math.min(initPos, curPos),\n                    Math.max(initPos, curPos)\n                  );\n                })\n                .on(\"mouseup.test\", () => {\n                  me.browser.DOM.root.classed(\"noPointerEvents\", false);\n                  DOM.classList.remove(\"dragging\");\n                  d3.select(\"body\")\n                    .on(\"mousemove.test\", null)\n                    .on(\"mouseup.test\", null);\n                });\n              event.preventDefault();\n            });\n\n          tickText\n            .append(\"span\")\n            .attr(\"class\", \"clearFilterButton fa\")\n            .tooltip(i18n.RemoveFilter)\n            .on(\"click\", (tick) => {\n              var _ = this.timeseriesAttrib.getTimepointSummary(tick);\n              if (_) _.summaryFilter.clearFilter();\n            });\n          tickText\n            .append(\"span\")\n            .attr(\"class\", \"theTextText\")\n            .html((tick) => tick._time_src);\n          tickText\n            .append(\"span\")\n            .attr(\"class\", \"openTimepointSummary fa fa-external-link-square\")\n            .tooltip(\"Create Time-Key<br>Histogram\")\n            .on(\"click\", (tick) => {\n              var newSummary = this.timeseriesAttrib.getTimepointSummary(tick);\n              newSummary.block.addToPanel(this.browser.panels.left);\n              this.browser.updateLayout();\n            });\n\n          [\"min\", \"max\"].forEach(function (endType) {\n            filterArea\n              .append(\"div\")\n              .attr(\"class\", \"filterRangeValue filterRangeValue_\" + endType)\n              .on(\"mousedown\", function (event, tick) {\n                if (event.which !== 1) return; // only respond to left-click\n                me.browser.DOM.root.classed(\"noPointerEvents\", true);\n                var e = this.parentNode.parentNode.childNodes[2]; // selectArea. TODO: Make this harder to fail!\n                var _ = this.parentNode;\n                _.classList.add(\"dragging\");\n\n                var histSummary = me.timeseriesAttrib.getTimepointSummary(tick);\n\n                d3.select(\"body\")\n                  .on(\"mousemove.range\", function () {\n                    var curVal = me.scale_Value.invert(d3.pointer(event, e)[1]);\n                    histSummary.summaryFilter.active[endType] = curVal;\n                    histSummary.summaryFilter.setFiltered(true);\n                    me.refreshFilterRanges();\n                  })\n                  .on(\"mouseup.range\", function () {\n                    _.classList.remove(\"dragging\");\n                    me.browser.DOM.root\n                      .attr(\"adjustWidth\", null)\n                      .classed(\"noPointerEvents\", false);\n                    d3.select(\"body\")\n                      .style(\"cursor\", \"auto\")\n                      .on(\"mousemove.range\", null)\n                      .on(\"mouseup.range\", null);\n                  });\n\n                event.preventDefault();\n                event.stopPropagation();\n              });\n          });\n          return tk;\n        },\n\n        (update) => {\n          return update.style(\n            \"transform\",\n            (tick) =>\n              `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\n          );\n        },\n\n        (exit) => {\n          return exit\n            .transition()\n            .duration(0)\n            .delay(500)\n            .style(\n              \"transform\",\n              (tick) =>\n                `translateX(${this.scale_Time(tick._time)}px) translateZ(0)`\n            )\n            .style(\"opacity\", 0)\n            .remove();\n        }\n      )\n      .selectAll(\".tickText\")\n      .style(\"display\", (tick) => {\n        var newTickPos = this.scale_Time(tick._time);\n        if (newTickPos - lastTickPos < tickGapWidth) return \"none\";\n        lastTickPos = newTickPos;\n        return null;\n      });\n\n    this.refreshKeyLine();\n  }\n\n  /** -- */\n  updateDotVisibility() {\n    // based on chart size (width, height) and active (or truly visible) record count\n    var recCount =\n      this.browser.records.length -\n      this.DOM.root.selectAll(\".noTimeSeries, .filteredOut\").nodes().length;\n    this.browser.DOM.root.classed(\n      \"noRecordDots\",\n      this.rd.curHeight / recCount < 100 ||\n        this.rd.curWidth / this.timeKeys_Active.length < 30\n    );\n  }\n\n  private wideTimeScale: boolean = false;\n  private wideTimeScaleTimer: number;\n\n  timeseriesWiden() {\n    if (!this.isMarginExpandable()) return;\n    this.wideTimeScaleTimer = window.setTimeout(() => {\n      this.wideTimeScale = true;\n      this.refreshTimeRange();\n    }, 500);\n  }\n  timeseriesWidenOff() {\n    if (!this.wideTimeScaleTimer) return;\n    window.clearTimeout(this.wideTimeScaleTimer);\n    this.wideTimeScaleTimer = 0;\n    if (this.wideTimeScale && !this.rd.timeseriesAnimInterval) {\n      this.wideTimeScale = false;\n      this.refreshTimeRange();\n    }\n  }\n\n  stepTimeAnimation(stepSize: number): boolean {\n    this.wideTimeScale = true;\n\n    var maxIndex = this.timeseriesAttrib.timeKeys.length - 1;\n\n    // start from beginning\n    if (this.timeRange.max._index >= maxIndex) {\n      this.setTimeRange({ max: this.timeRange.min._index + 1 });\n      window.setTimeout(\n        () => this.rd.startTimeseriesAnimation(stepSize),\n        this.animStepDelayMs\n      ); // adds double-wait, but works fine\n      return true;\n    }\n\n    this.rd.timeseriesAnimInterval = window.setInterval(() => {\n      if (this.timeRange.max._index >= maxIndex) {\n        this.rd.stopTimeseriesAnimation();\n      } else {\n        this.setTimeRange({ max: this.timeRange.max._index + stepSize });\n      }\n    }, this.animStepDelayMs);\n\n    return true;\n  }\n  stopTimeAnimation() {\n    this.refreshTimeRange();\n    this.wideTimeScale = false;\n  }\n\n  updateAfterFilter() {\n    this.updateRecordVisibility();\n\n    this.updateDotVisibility();\n\n    this.fitValueAxis.refresh();\n\n    if (this.ts_Type.is(\"Rank\")) {\n      this.timeseriesAttrib.computeRecordRanks();\n      this.refreshScaleValue();\n      //\n    } else if (this.ts_Type.is(\"Value\")) {\n      if (!this.browser.isFiltered() || this.fitValueAxis.get()) {\n        // resets to default scale\n        this.refreshScaleValue();\n      } else {\n        this.rd.refreshRecordVis();\n      }\n    } else if (this.isTimeseriesChange()) {\n      this.refreshScaleValue();\n    }\n\n    this.refreshLineOpacity();\n  }\n\n  /** -- */\n  addAnnotations() {\n    if (!this.rd.config.timeSeriesAnnotations) return;\n\n    this.DOM.ts_annotations\n      .selectAll(\"div.annotation\")\n      .data(\n        this.rd.config.timeSeriesAnnotations\n          .filter((_) => _._time <= this.timeRange.max._time)\n          .filter((_) => _._time >= this.timeRange.min._time),\n        (_) => _._time\n      )\n      .join(\n        (enter) =>\n          enter\n            .append(\"div\")\n            .attr(\"class\", \"annotation\")\n            .call((annotation) => {\n              annotation.append(\"div\").attr(\"class\", \"line\");\n              annotation.append(\"div\").attr(\"class\", \"annotIcon fa fa-clock\");\n              annotation\n                .append(\"div\")\n                .attr(\"class\", \"textBox\")\n                .call((textBox) => {\n                  textBox\n                    .append(\"div\")\n                    .attr(\"class\", \"timeText\")\n                    .text((_) => _._time_src);\n                  textBox\n                    .append(\"div\")\n                    .attr(\"class\", \"freeText\")\n                    .text((_) => _._text);\n                });\n            }),\n        (update) => update,\n        (exit) => exit.remove()\n      )\n      .style(\"left\", (_) => this.scale_Time(_._time) + \"px\");\n  }\n\n  refreshLineOpacity() {\n    var screenHeight = Math.abs(\n      this.scale_Value.range()[1] - this.scale_Value.range()[0]\n    );\n    var _ratio = screenHeight / this.browser.allRecordsAggr.recCnt(\"Active\");\n\n    var _opacity = Math.max(0.4, Math.min(1.0, _ratio / 25)); // between 0.2 and 1\n\n    var colorScheme = d3.schemeCategory10;\n\n    var strokeWidth = 2;\n    if (_ratio < 50) {\n      strokeWidth = 2;\n    } else if (_ratio < 70) {\n      strokeWidth = 3;\n    } else if (_ratio < 100) {\n      strokeWidth = 4;\n    } else {\n      strokeWidth = 5;\n    }\n\n    this.DOM.kshfRecords\n      .selectAll(\"path\")\n      .style(\n        \"opacity\",\n        (r: Record) => (((r.recordOrder % 3) + 10) / 11) * _opacity\n      ) // slight variation opacity to differentiate\n      .style(\"stroke\", (r: Record) => colorScheme[r.recordOrder % 12])\n      .style(\"stroke-width\", strokeWidth);\n\n    this.DOM.kshfRecords\n      .selectAll(\".recordText_Dot\")\n      .style(\n        \"background-color\",\n        (r: Record) => colorScheme[r.recordOrder % 12]\n      );\n  }\n\n  /** -- */\n  refreshLabelOverlaps() {\n    if (!this.timeseriesAttrib) return;\n\n    var maxTime: number = this.scale_Time.domain()[1].getTime();\n    var lastTime: string = this.timeseriesAttrib.timeKeys.find(\n      (tk: TimeKey) => tk._time.getTime() === maxTime\n    )._time_src;\n\n    var spacer = new LabelSpacer();\n\n    var _compareKey: string = this.timeSeriesChangeVsTimeKey.get()?._time_src || null;\n\n    this.browser.records.forEach((record) => {\n      record._view._labelHidden = true;\n      record._view._labelPos = 0;\n\n      if (!record.filteredOut && this.recordInView(record)) {\n        var _keyIndex = this.timeseriesAttrib.getRecordValue(record)?._keyIndex;\n        var v = _keyIndex[lastTime];\n        if (v) {\n          var m = this.scale_Value(v._value);\n          if (m !== null && isFinite(m) && !isNaN(m)) {\n            record._view._labelHidden = false;\n            var ref = this.isTimeseriesChange()\n              ? _keyIndex[_compareKey]._value\n              : 0;\n            record._view._labelPos = this.y_Generator(v, ref);\n          }\n        }\n      }\n\n      d3.select(record.DOM.record)\n        .select(\"foreignObject\")\n        .classed(\"hidden\", record._view._labelHidden);\n    });\n\n    var gapOffset = 14;\n\n    Array.from(\n      this.browser.records.filter((record) => !record._view._labelHidden)\n    )\n      .sort((r1, r2) => r1._view._labelPos - r2._view._labelPos)\n      .forEach((record) => {\n        var fo = d3.select(record.DOM.record).select(\"foreignObject\");\n\n        var intersectsWith = spacer.intersectsWith(record._view._labelPos);\n\n        var overlaps;\n\n        if (intersectsWith) {\n          let intersectsWithRecord = intersectsWith._entity;\n\n          // intersectsWith is above current record\n          // try to move it above to create extra space\n          spacer.usedList = spacer.usedList.filter(\n            (_) => _._entity !== intersectsWithRecord\n          );\n\n          var _temp = Math.max(\n            record._view._labelPos - gapOffset,\n            intersectsWithRecord._view._labelPos - gapOffset / 2\n          );\n\n          if (spacer.isEmpty(_temp)) {\n            d3.select(intersectsWithRecord.DOM.record)\n              .select(\"foreignObject\")\n              .attr(\"y\", _temp - 8);\n            intersectsWithRecord._view._labelPos = _temp;\n          }\n\n          // insert back\n          spacer.insertUsed(\n            intersectsWithRecord._view._labelPos,\n            gapOffset,\n            intersectsWithRecord\n          );\n\n          var targetPos = Math.min(\n            intersectsWithRecord._view._labelPos + gapOffset\n          );\n          if (\n            spacer.isEmpty(targetPos) &&\n            targetPos <= record._view._labelPos + 10\n          ) {\n            record._view._labelPos = targetPos;\n          } else {\n            overlaps = true;\n          }\n        }\n\n        fo.classed(\"overlapping\", overlaps);\n\n        fo.attr(\"y\", record._view._labelPos - 8);\n        if (!overlaps) {\n          spacer.insertUsed(record._view._labelPos, gapOffset, record);\n        }\n      });\n  }\n\n  /** -- */\n  refreshTimeSeriesPlotType() {\n    if (!this.ts_Type) return;\n    if (!this.timeseriesAttrib) return;\n\n    this.DOM.root.attr(\"data-ts_Type\", this.ts_Type);\n    this.refreshYGenerator();\n\n    if (this.ts_Type.is(\"Rank\")) {\n      this.timeseriesAttrib.computeRecordRanks();\n    }\n\n    if (this.isTimeseriesChange()) {\n      this.DOM.root.select(\".MouseMode-filter\").style(\"display\", \"none\");\n      if (this.rd.visMouseMode === \"filter\") {\n        this.rd.visMouseMode = \"pan\";\n        this.DOM.root.attr(\"visMouseMode\", this.rd.visMouseMode);\n      }\n    } else {\n      this.DOM.root.select(\".MouseMode-filter\").style(\"display\", null);\n    }\n\n    this.DOM.root\n      .select(\".recordAxis_X > .keyLine\")\n      .style(\"display\", this.isTimeseriesChange() ? \"block\" : null);\n\n    this.refreshScaleValue();\n  }\n\n  /** -- */\n  refreshRecordVis() {\n    if (!this.ts_Type) return;\n    if (!this.timeseriesAttrib) return;\n    if (!this.DOM.recordBase_Timeseries) return;\n    if (!this.DOM.kshfRecords) return;\n    if (!this.y_Generator) return;\n    if (!this.timeseriesAttrib.aggr_initialized) return;\n\n    var x_Generator = (d) => this.scale_Time(d._time);\n\n    var timeDomain = this.scale_Time.domain();\n    var inTimeDomain = (d) =>\n      d._time >= timeDomain[0] && d._time <= timeDomain[1];\n\n    // This basically extends the draw area +/- time keys. These are out of the screen, but helps\n    // generate smooth looking animations.\n    var timeKeys = this.timeseriesAttrib.timeKeys;\n    var drawMinTime =\n      timeKeys[Math.max(this.timeRange.min._index - 5, 0)]._time;\n    var drawMaxTime =\n      timeKeys[Math.min(this.timeRange.max._index + 5, timeKeys.length - 1)]\n        ._time;\n    var inWiderTimeDomain = (d) =>\n      d._time >= drawMinTime && d._time <= drawMaxTime;\n\n    var _compareKey = this.timeSeriesChangeVsTimeKey.get()?._time_src || \"\";\n\n    var _refVal;\n\n    var lineGenerator = d3\n      .line()\n      .curve(this.ts_Type.is(\"Rank\") ? d3.curveLinear : d3.curveMonotoneX)\n      .x(x_Generator)\n      .y((d) => this.y_Generator(d, _refVal))\n      .defined((d) => {\n        if (!inWiderTimeDomain(d)) return false;\n        var v = this.y_Generator(d, _refVal);\n        return v != null && isFinite(v) && !isNaN(v);\n      });\n\n    var topGap = 15;\n\n    this.scale_Value.rangeRound([this.rd.curHeight - (topGap + 100), topGap]);\n\n    var slopeOnly = this.ts_timeKeysStep.is(\"limits\");\n\n    var timeKeys_src = {};\n    this.timeKeys_Active.forEach((_) => {\n      timeKeys_src[_._time_src] = true;\n    });\n\n    var lineSelect = this.DOM.kshfRecords\n      .attr(\"transform\", null)\n      .style(\"transform\", null)\n      .classed(\"noTimeSeries\", (record) => !this.recordInView(record))\n      .each((record, i, nodes) => {\n        if (!this.recordInView(record) || record.filteredOut) return;\n\n        var ts = this.timeseriesAttrib.getRecordValue(record);\n        if (!ts) return;\n\n        _refVal = ts._timeseries_.find(\n          (x: TimeData) => x._time_src === _compareKey\n        )?._value;\n\n        var td: TimeData[] = ts._timeseries_.filter(inTimeDomain);\n\n        if (slopeOnly) {\n          td = td.filter((d: TimeData) => timeKeys_src[d._time_src]);\n        }\n\n        d3.select(nodes[i])\n          .select(\".dotGroup\")\n          .selectAll(\".timeSeriesDot\")\n          .data(td, (d: TimeData) => d._time.getTime())\n          .join(\n            (enter) =>\n              enter\n                .append(\"circle\")\n                .attr(\"class\", \"timeSeriesDot\")\n                .attr(\"r\", 3),\n            (update) => update,\n            (exit) => exit.remove()\n          )\n          .each((d: TimeData, i, nodes) => {\n            d.DOM = nodes[i];\n          })\n          .attr(\"cx\", x_Generator)\n          .attr(\"cy\", (d: TimeData) => this.y_Generator(d, _refVal))\n          .style(\"display\", (d: TimeData) => {\n            var v = this.y_Generator(d, _refVal);\n            return v != null && isFinite(v) && !isNaN(v) ? null : \"none\";\n          });\n      })\n      .call((rec) => {\n        rec\n          .selectAll(\"foreignObject\")\n          .attr(\"x\", this.scale_Time.range()[1] + 16)\n          .on(\"mouseenter\", (_event, record) =>\n            this.rd.onRecordMouseOver(record)\n          )\n          .on(\"mouseleave\", (_event, record) =>\n            this.rd.onRecordMouseLeave(record)\n          );\n      })\n      .selectAll(\"path\")\n      .attr(\"fill\", \"none\");\n\n    var dPath = (record) => {\n      if (record.filteredOut) return;\n      var _td: TimeData[] =\n        this.timeseriesAttrib.getRecordValue(record)?._timeseries_;\n      if (!_td) return;\n\n      _refVal = _td.find((x) => x._time_src === _compareKey)?._value;\n\n      if (slopeOnly) {\n        _td = _td.filter((d) => timeKeys_src[d._time_src]);\n      }\n      return lineGenerator(_td);\n    };\n\n    if (this.rd.timeseriesAnimInterval) {\n      var x_Generator_store = x_Generator;\n      x_Generator = (d) => this.scale_Time_prev(d._time);\n      lineGenerator.x(x_Generator);\n      // no transition\n      lineSelect.transition().duration(200).attr(\"d\", dPath);\n      x_Generator = x_Generator_store;\n      lineGenerator.x(x_Generator);\n    }\n\n    // with transition\n    lineSelect\n      .transition()\n      .duration(700)\n      .ease(d3.easePoly.exponent(3))\n      .delay(0)\n      .attr(\"d\", dPath);\n\n    this.refreshLabelOverlaps();\n\n    this.refreshLineOpacity();\n  }\n\n  refreshAttribUnitName(attrib: Attrib) {\n    this.refreshTicks_AxisY();\n  }\n}\n","import { select, pointer } from \"./d3_select\";\nimport { easePoly, easePolyOut } from \"d3-ease\";\nimport { interpolate } from \"d3-interpolate\";\nimport { geoPath, geoTransform } from \"d3-geo\";\nimport { hsl } from \"d3-color\";\nimport { arc } from \"d3-shape\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Aggregate_PointCluster } from \"./Attrib_RecordGeo\";\nimport { Base } from \"./Base\";\nimport { RecordVisCoding, CompareType } from \"./Types\";\nimport { RecordDisplay } from \"./RecordDisplay\";\nimport { RecordView } from \"./RecordView\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\n\nconst d3 = {\n  select,\n  pointer,\n  geoPath,\n  geoTransform,\n  easePolyOut,\n  easePoly,\n  interpolate,\n  hsl,\n  arc,\n};\n\ndeclare let L: any;\n\nexport class RecordView_Map extends RecordView {\n  extendRecordDOM(newRecords) {\n    if (this.geoAttrib.geoType === \"Point\") {\n      if (this.rd.config.mapUsePins) {\n        newRecords\n          .append(\"path\")\n          .attr(\"class\", \"glyph_Main\")\n          .attr(\"d\", Base.map.pinGlyphPath)\n          .attr(\"transform\", \"scale(0.0001)\");\n      } else {\n        this.extendRecordDOM_Point(newRecords);\n      }\n    } else {\n      newRecords.append(\"path\").attr(\"class\", \"glyph_Main\");\n    }\n  }\n\n  mapConfig: any;\n\n  recordGeoPath: any;\n\n  /** -- */\n  updateAfterFilter(how: any) {\n    this.updateRecordVisibility();\n    this.refreshRecordColors();\n    if (this.geoAttrib.geoType === \"Point\") {\n      this.refreshRecordVis();\n    }\n  }\n\n  /** -- */\n  refreshRecordSizes() {\n    if (this.geoAttrib.geoType !== \"Point\") return;\n    if (!this.DOM.recordGroup) return;\n\n    var pathSelection = this.DOM.recordGroup\n      .selectAll(\".kshfRecord > path\")\n      .transition()\n      .duration(700)\n      .ease(d3.easePolyOut.exponent(3));\n\n    if (!this.rd.config.mapUsePins) {\n      pathSelection.attr(\"d\", (record) => this.rd.recordDrawArc(record)());\n      //\n    } else {\n      pathSelection.attr(\n        \"transform\",\n        `scale(${this.rd.getMaxSizeScaleRange() / 15})`\n      );\n    }\n\n    this.DOM.recordGroup\n      .selectAll(\".kshfRecord > .sizeValueText\")\n      .html((record) => record.measure_Self);\n\n    this.refreshPointClusterVis();\n  }\n\n  /** -- */\n  async prepareAttribs() {\n    if (!this.rd.codeBy.geo) {\n      await this.rd.setAttrib(\"geo\", this.rd.config.geoBy || 0);\n    }\n    if (!this.rd.codeBy.color && this.rd.config.colorBy) {\n      await this.rd.setAttrib(\"color\", this.rd.config.colorBy);\n    }\n    if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\n      await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\n    }\n    return Promise.resolve(true);\n  }\n\n  initView() {\n    if (!this.initialized) {\n      this.zoomToFit();\n    }\n\n    if (this.geoAttrib.geoType === \"Point\") {\n      this.refreshPointClusters();\n    }\n    this.refreshPointDOM();\n\n    this.refreshRecordVis();\n    this.refreshRecordColors();\n    this.refreshRecordSizes();\n    // width of color legend area may change, so refresh this\n    this.rd.refreshColorLegend();\n    this.rd.refreshSizeLegend(); // needed to reset usesSizeAttrib class\n  }\n\n  async initView_DOM() {\n    // Do not initialize twice\n    if (this.DOM.recordBase_Map) {\n      this.DOM.recordGroup = this.DOM.recordMap_SVG.select(\".recordGroup\");\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\n        \".kshfRecord > path.glyph_Main\"\n      );\n\n      this.leafletRecordMap.invalidateSize(); // chart area may have changed\n      return;\n    }\n\n    if (!(window as any).L) {\n      await import(\"leaflet\");\n    }\n\n    var me = this;\n\n    this.DOM.recordBase_Map = this.rd.DOM.recordDisplayWrapper\n      .append(\"div\")\n      .attr(\"class\", \"recordBase_Map\");\n\n    this.mapConfig = Util.mergeConfig(Base.map, this.rd.config.mapConfig || {});\n\n    function resetPointSizes() {\n      if (this.geoAttrib.geoType === \"Point\") {\n        if (!this.rd.config.mapUsePins) {\n          this.DOM.recordGroup\n            .selectAll(\".kshfRecord > path\")\n            .attr(\"d\", Util.getCirclePath());\n        } else {\n          this.DOM.recordGroup\n            .selectAll(\".kshfRecord > path\")\n            .attr(\"transform\", \"scale(0.0001)\");\n        }\n      }\n    }\n\n    this.leafletRecordMap = L.map(\n      this.DOM.recordBase_Map.node(),\n      this.mapConfig.leafConfig\n    )\n      .on(\"viewreset\", function () {\n        if (!this._zoomInit_) return;\n        this._zoomInit_ = null;\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", false);\n        me.refreshRecordVis();\n      })\n      .on(\"movestart\", function () {\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", true);\n        me.browser.DOM.root.classed(\"noPointerEvents\", true);\n        resetPointSizes.call(me);\n        this._zoomInit_ = this.getZoom();\n      })\n      .on(\"moveend\", function () {\n        me.rd.DOM.recordDisplayWrapper.classed(\"dragging\", false);\n        me.browser.DOM.root.classed(\"noPointerEvents\", false);\n        me.rd.refreshViz_Compare_All();\n        me.rd.refreshRecordVis();\n        this._zoomInit_ = null;\n      })\n      // When zoom is triggered by fly, the leaflet-zoom-anim is not set.\n      .on(\"zoomstart\", () => {\n        resetPointSizes.call(this);\n        var _ = d3.select(this.leafletRecordMap.getPane(\"mapPane\"));\n        _.classed(\"leaflet-zoom-anim\", true);\n      })\n      .on(\"zoomend\", () => {\n        var _ = d3.select(this.leafletRecordMap.getPane(\"mapPane\"));\n        _.classed(\"leaflet-zoom-anim\", false);\n      });\n\n    if (!this.mapConfig.tileConfig.disabled) {\n      let leafletTileLayer = new L.TileLayer(\n        this.mapConfig.tileTemplate,\n        this.mapConfig.tileConfig\n      );\n      this.leafletRecordMap.addLayer(leafletTileLayer);\n    }\n\n    this.leafletRecordMap.attributionControl.setPosition(\"topright\");\n\n    this.recordGeoPath = d3.geoPath().projection(\n      d3.geoTransform({\n        point: function (x, y) {\n          var point = me.leafletRecordMap.latLngToLayerPoint(\n            new L.latLng(y, x)\n          );\n          this.stream.point(point.x, point.y);\n        },\n      })\n    );\n\n    this.recordGeoPath.pointRadius(this.rd.recordPointSize.get());\n\n    this.DOM.recordBase_Map.select(\".leaflet-tile-pane\");\n\n    this.DOM.recordMap_SVG = d3\n      .select(this.leafletRecordMap.getPanes().overlayPane)\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .attr(\"class\", \"recordMap_SVG\");\n\n    var _defs = this.DOM.recordMap_SVG.append(\"defs\");\n\n    _defs\n      .append(\"filter\")\n      .attr(\"id\", \"pointDropShadow\")\n      .attr(\"height\", \"200%\")\n      .attr(\"width\", \"200%\")\n      .call((filter) => {\n        filter\n          .append(\"feGaussianBlur\")\n          .attr(\"in\", \"SourceAlpha\")\n          .attr(\"stdDeviation\", 3);\n        filter\n          .append(\"feOffset\")\n          .attr(\"dx\", 2)\n          .attr(\"dy\", 2)\n          .attr(\"result\", \"offsetblur\");\n        filter\n          .append(\"feComponentTransfer\")\n          .append(\"feFuncA\")\n          .attr(\"type\", \"linear\")\n          .attr(\"slope\", 0.5);\n        filter.append(\"feMerge\").call((merge) => {\n          merge.append(\"feMergeNode\");\n          merge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\");\n        });\n      });\n\n    // The fill pattern definition in SVG, used to denote geo-objects with no data.\n    // http://stackoverflow.com/questions/17776641/fill-rect-with-pattern\n    _defs\n      .append(\"pattern\")\n      .attr(\"id\", \"diagonalHatch\")\n      .attr(\"patternUnits\", \"userSpaceOnUse\")\n      .attr(\"width\", 4)\n      .attr(\"height\", 4)\n      .append(\"path\")\n      .attr(\"d\", \"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2\")\n      .attr(\"stroke\", \"gray\")\n      .attr(\"stroke-width\", 1);\n\n    this.DOM.clusterGroup = this.DOM.recordMap_SVG\n      .append(\"g\")\n      .attr(\"class\", \"leaflet-zoom-hide clusterGroup\");\n\n    this.DOM.recordGroup = this.DOM.recordMap_SVG\n      .append(\"g\")\n      .attr(\"class\", \"leaflet-zoom-hide recordGroup\");\n  }\n\n  async finishSetAttrib(t: RecordVisCoding) {\n    if (t === \"color\") {\n      this.refreshRecordColors();\n      //\n    } else if (t === \"geo\") {\n      this.rd.config.geo = this.geoAttrib.attribName;\n\n      this.DOM.root.attr(\"data-geotype\", this.geoAttrib.geoType);\n\n      this.DOM.root\n        .select(\".mapView-UnmatchedData\")\n        .classed(\"active\", this.geoAttrib.noValueAggr.records.length > 0);\n\n      if (this.geoAttrib.geoType === \"Point\") {\n        // size\n        if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\n          await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\n        } else {\n          this.rd.refreshAttribOptions(\"size\");\n        }\n        // color\n        this.rd.refreshAttribOptions(\"color\");\n        // prapare color cache\n        await this.geoAttrib.prepPointCluster(this.leafletRecordMap);\n      }\n    }\n  }\n\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\n    if (!this.isComparable()) return;\n\n    // update rendering of point clusters\n    if (this.rd.hasAggregates()) {\n      var sideBySide = this.browser.stackedCompare.is(false);\n\n      // compute \"offset\" for each aggregate\n      this.geoAttrib._aggrs.forEach((aggr: Aggregate_PointCluster) => {\n        var _offset = 0;\n        aggr._glyphOrder = {};\n        // re-order the comparisons so that the larger ones come first\n        this.browser.activeComparisons\n          .slice()\n          .sort((a, b) => aggr.measure(b) - aggr.measure(a))\n          .forEach((cT2, i_cT) => {\n            aggr._glyphOrder[cT2] = i_cT;\n            aggr.setOffset(cT2, _offset);\n            _offset += aggr.measure(cT2);\n          });\n      });\n\n      var numComparisons = this.browser.activeComparisonsCount;\n      this.browser.activeComparisons.forEach((cT2) => {\n        this.DOM[\"clusterGlyphs_\" + cT2]\n          .style(\"stroke-width\", (aggr) => {\n            if (!sideBySide) return 0;\n            return aggr.cluster._radius / numComparisons;\n          })\n          .transition()\n          .ease(d3.easePoly.exponent(3))\n          .duration(700)\n          .attrTween(\"d\", (aggr, i, nodes) => {\n            var DOM = nodes[i];\n            var offset = sideBySide\n              ? 0\n              : aggr.offset(cT2) / (aggr.measure(\"Active\") || 1);\n            var angleInterp = d3.interpolate(\n              DOM._currentPreviewAngle,\n              aggr.ratioToActive(cT2)\n            );\n            var r = aggr.cluster._radius;\n            if (sideBySide) {\n              r -=\n                (aggr._glyphOrder[cT2] + 0.5) *\n                (aggr.cluster._radius / numComparisons);\n            }\n            return (t) => {\n              var newAngle = angleInterp(t);\n              DOM._currentPreviewAngle = newAngle;\n              return Util.getPieSVGPath(offset, newAngle, r - 1, sideBySide);\n            };\n          });\n      });\n    }\n\n    // normal comparison rendering\n    super.refreshSelect_Compare(cT, status);\n  }\n  // map / point\n\n  leafletRecordMap: any;\n\n  constructor(rd: RecordDisplay, config) {\n    super(rd);\n  }\n\n  refreshQueryBox_Filter(bounds = null) {\n    if (this.rd.collapsed) return;\n    var _left, _right, _top, _bottom, temp;\n\n    var isVisible: boolean = false;\n\n    if (typeof L === \"undefined\") {\n      throw Error(\"Leaflet not initialized\");\n    }\n\n    var north_west, south_east;\n    if (bounds === null) {\n      isVisible = this.geoAttrib.isFiltered();\n      if (!isVisible) return;\n      north_west = this.leafletRecordMap.latLngToLayerPoint(\n        this.geoAttrib.summaryFilter.bounds.getNorthWest()\n      );\n      south_east = this.leafletRecordMap.latLngToLayerPoint(\n        this.geoAttrib.summaryFilter.bounds.getSouthEast()\n      );\n    } else if (!(bounds instanceof L.LatLngBounds)) {\n      north_west = this.leafletRecordMap.latLngToLayerPoint(\n        bounds.getNorthWest()\n      );\n      south_east = this.leafletRecordMap.latLngToLayerPoint(\n        bounds.getSouthEast()\n      );\n    } else {\n      throw Error(\"Invalud value\");\n    }\n    _left = north_west.x;\n    _right = south_east.x;\n    _top = north_west.y;\n    _bottom = south_east.y;\n\n    this.rd.DOM.recordDisplayWrapper\n      .select(\".recordBase_Map  .spatialQueryBox_Filter\")\n      .classed(\"active\", bounds || isVisible)\n      .style(\"left\", _left + \"px\")\n      .style(\"top\", _top + \"px\")\n      .style(\"width\", Math.abs(_right - _left) + \"px\")\n      .style(\"height\", Math.abs(_bottom - _top) + \"px\");\n  }\n\n  /** -- */\n  refreshViewSize(delayMs = 500) {\n    this.rd.refreshColorLegendTicks();\n    setTimeout(() => this.leafletRecordMap.invalidateSize(), delayMs);\n  }\n\n  /** -- */\n  refreshAttribUnitName(attrib: Attrib) {\n    this.rd.refreshColorLegendTicks();\n  }\n\n  zoomedBefore = false;\n  /** -- */\n  zoomIn() {\n    this.leafletRecordMap.zoomIn();\n  }\n  /** -- */\n  zoomOut() {\n    this.leafletRecordMap.zoomOut();\n  }\n  /** -- */\n  zoomToFit() {\n    if (!this.zoomedBefore) {\n      if (this.rd.config.mapInitView) {\n        var _c = this.rd.config.mapInitView;\n        if (_c[3] === undefined || _c[3] === false) {\n          this.zoomedBefore = true;\n        }\n        this.leafletRecordMap.setView(L.latLng(_c[0], _c[1]), _c[2]);\n        return;\n      }\n    }\n    this.zoomToBounds(\n      Util.addMarginToBounds(this.geoAttrib.getRecordBounds(true))\n    );\n  }\n  /** -- */\n  zoomToBounds(bounds) {\n    this.rd.DOM.recordDisplayWrapper.classed(\"dragging\", true);\n    this.leafletRecordMap.fitBounds(bounds);\n  }\n  /** -- */\n  setMaxBounds() {\n    if (this.rd.config.map_NoFitBounds) return;\n    this.leafletRecordMap.setMaxBounds(\n      Util.addMarginToBounds(this.geoAttrib.getRecordBounds(false))\n    );\n  }\n\n  translate_glyph(v) {\n    var point = this.leafletRecordMap.latLngToLayerPoint(\n      new L.latLng(v[1], v[0])\n    );\n    return `translate(${point.x},${point.y})`;\n  }\n\n  /** -- */\n  refreshPointClusters() {\n    if (!this.geoAttrib) return;\n    if (this.geoAttrib?.geoType !== \"Point\") return;\n    if (!this.geoAttrib.PointCluster) return;\n\n    this.geoAttrib.updateClusters(\n      this.leafletRecordMap.getBounds(),\n      this.leafletRecordMap.getZoom()\n    );\n\n    this.DOM.clusterGlyphs = this.DOM.clusterGroup\n      .selectAll(\".clusterGlyph\")\n      .data(this.geoAttrib._aggrs)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"clusterGlyph aggrGlyph\")\n      .each((aggr: Aggregate_PointCluster, i, nodes) => {\n        aggr.setAggrGlyph(nodes[i]);\n      })\n      .tooltip((aggr: Aggregate_PointCluster) => aggr.getTooltipHTML(), {\n        theme: \"dark kshf-tooltip kshf-record\",\n        placement: \"right\",\n        animation: \"fade\",\n        followCursor: true,\n        offset: [0, 5],\n      })\n      .attr(\"transform\", (aggr) =>\n        this.translate_glyph(aggr.cluster.geometry.coordinates)\n      )\n      //.on(\"mouseenter\", aggr => this.browser.setSelect_Compare(aggr) )\n      //.on(\"mouseleave\", aggr => this.browser.clearSelect_Compare() )\n      .on(\"click\", (event, aggr) => {\n        if (event.shiftKey) {\n          // filter - TODO needs to have its own filter logic\n          return;\n        }\n        var latlong = aggr.cluster.geometry.coordinates;\n        this.leafletRecordMap.setZoomAround(\n          new L.latLng(latlong[1], latlong[0]),\n          this.leafletRecordMap.getZoom() + 1\n        );\n      })\n      .call((clusterGlyph) => {\n        clusterGlyph\n          .append(\"g\")\n          .attr(\"class\", \"measureGroup\")\n          .call((measureGroup) => {\n            [\"Active\"].concat(Base.Compare_List).forEach((cT) => {\n              this.DOM[\"clusterGlyphs_\" + cT] = measureGroup\n                .append(\"path\")\n                .attr(\"class\", \"measure_\" + cT)\n                .each((aggr, i, nodes) => {\n                  nodes[i]._currentPreviewAngle = 0;\n                });\n            });\n          });\n        clusterGlyph\n          .append(\"text\")\n          .attr(\"class\", \"sizeValueText\")\n          .html((aggr) => \"\" + aggr.Active.measure);\n      });\n\n    // reset circle size\n    this.DOM.clusterGlyphs_Active.attr(\"d\", Util.getCirclePath());\n  }\n\n  /** -- */\n  private refreshPointDOM() {\n    this.rd.refreshRecordDOM();\n    this.rd.updateRecordSizeScale();\n    this.rd.updateRecordColorScale();\n  }\n\n  /** --  */\n  refreshRecordVis() {\n    if (!this.geoAttrib) return;\n\n    if (this.geoAttrib.geoType === \"Point\") {\n      // POINT MAPS\n      this.refreshPointClusters();\n      this.refreshPointDOM();\n\n      this.DOM.kshfRecords?.attr(\"transform\", (record: Record) =>\n        this.translate_glyph(\n          this.geoAttrib.getRecordValue(record).geoFeat.coordinates\n        )\n      );\n      this.DOM.clusterGlyphs?.attr(\n        \"transform\",\n        (aggr: Aggregate_PointCluster) =>\n          this.translate_glyph(aggr.cluster.geometry.coordinates)\n      );\n    } else {\n      // POLYGON MAPS\n      this.DOM.kshfRecords_Path?.attr(\"d\", (record) =>\n        this.recordGeoPath(this.geoAttrib.getRecordValue(record).geoFeat)\n      );\n    }\n  }\n\n  /** -- */\n  refreshPointClusterVis() {\n    if (!this.rd.hasAggregates()) return;\n    if (!this.rd.recordRadiusScale) return;\n\n    var clusterArc = d3\n      .arc()\n      .innerRadius(0)\n      .startAngle(0)\n      .endAngle(2 * Math.PI);\n    var circleDraw = (aggr) => clusterArc.outerRadius(aggr.cluster._radius)();\n\n    this.DOM.clusterGlyphs\n      .each((aggr) => {\n        aggr.cluster._radius = this.rd.recordRadiusScale(aggr.Active.measure);\n      })\n      .classed(\"tinyCluster\", (aggr) => aggr.cluster._radius < 8)\n      .classed(\n        \"clampedCluster\",\n        (aggr) => aggr.cluster._radius >= Base.maxRecordPointSize\n      );\n\n    this.DOM.clusterGlyphs_Active\n      .transition()\n      .duration(700)\n      .ease(d3.easePolyOut.exponent(3))\n      .attr(\"d\", circleDraw);\n\n    // update fill color of clusters\n    if (!this.colorAttrib) {\n      this.DOM.clusterGlyphs_Active.style(\"fill\", null);\n      this.DOM.clusterGlyphs.classed(\"darkBg\", false);\n      //\n    } else {\n      this.DOM.clusterGlyphs_Active.each((cluster, i, nodes) => {\n        var v = cluster.Active.measure;\n        var _fill =\n          v != null ? this.rd.recordColorScale(v) : \"url(#diagonalHatch)\";\n        var darkBg = v != null ? d3.hsl(_fill).l < 0.6 : false;\n\n        nodes[i].style.fill = _fill;\n\n        // to adjust text color by background luminance\n        nodes[i].parentNode.parentNode.classList[darkBg ? \"add\" : \"remove\"](\n          \"darkBg\"\n        );\n      });\n    }\n\n    this.refreshSelect_Compare();\n  }\n\n  /** --\n   * Returns the records that fit/intersect within the bounds (if point) or has geofeat (if polygon)\n   **/\n  getRecordsForDOM() {\n    var bounds = this.leafletRecordMap.getBounds();\n    return this.browser.records.filter((record) => {\n      var _feat = this.geoAttrib.getRecordValue(record)?.geoFeat;\n      if (!_feat) return false;\n      // not in a cluster - not rendered separately\n      if (_feat.type===\"Point\" && _feat.coordinates) {\n        if(record._view.inCluster) return false;\n        return bounds.contains(L.latLng(_feat.coordinates.slice().reverse()));\n      }\n      return true;\n    });\n  }\n\n  /** -- */\n  refreshRecordColors() {\n    if (!this.DOM.kshfRecords_Path) return;\n\n    if (this.colorAttrib) {\n      if (!this.rd.recordColorScale) return;\n\n      var s_f;\n      var s_log = false;\n      var s_ts = (_record) => false;\n\n      if (this.colorAttrib instanceof Attrib_Interval) {\n        s_f = this.colorAttrib.template.func;\n        s_log = this.colorAttrib.isValueScale_Log;\n        if (this.colorAttrib.hasTimeSeriesParent()) {\n          var f_ps = this.colorAttrib.timeseriesParent.template.func;\n          s_ts = function (record) {\n            var _ = f_ps.call(this, record);\n            if (!_ || !_._timeseries_) return false;\n            return _._timeseries_.length === 0;\n          };\n        }\n      } else if (this.colorAttrib === \"_measure_\") {\n        s_f = (record) => record.measure_Self;\n      } else {\n        console.log(\"IMPOSSIBLE\");\n      }\n\n      this.DOM.kshfRecords_Path.each((record, i, nodes) => {\n        if (record.filteredOut) return;\n        var DOM = nodes[i];\n        var _fill = \"url(#diagonalHatch)\";\n        var _stroke = \"#111111\";\n        var darkBg = false;\n\n        var v = s_f.call(record.data, record);\n\n        if (v === \"\" || v == null || typeof v !== \"number\" || (s_log && v <= 0))\n          v = null;\n\n        if (v != null) {\n          _fill = this.rd.recordColorScale(v);\n          darkBg = d3.hsl(_fill).l < 0.6;\n          _stroke = darkBg ? \"#EEEEEE\" : \"#111111\";\n        }\n\n        if (record.isSelected()) {\n          _stroke = null;\n        }\n\n        DOM.style.fill = _fill;\n        DOM.style.stroke = _stroke;\n        DOM.parentNode.classList[darkBg ? \"add\" : \"remove\"](\"darkBg\");\n        DOM.classList[s_ts.call(record.data, record) ? \"add\" : \"remove\"](\n          \"noData\"\n        );\n      });\n    } else {\n      this.DOM.kshfRecords_Path\n        .style(\"fill\", null)\n        .style(\"stroke\", null)\n        .classed(\"noData\", false);\n    }\n\n    this.refreshPointClusterVis();\n  }\n}\n","import { zoom, zoomTransform, zoomIdentity } from \"d3-zoom\";\nimport { easePolyOut } from \"d3-ease\";\nimport { line, curveNatural, curveCatmullRomOpen } from \"d3-shape\";\nimport { select, pointer } from \"./d3_select\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Base } from \"./Base\";\nimport { Config } from \"./Config\";\nimport { i18n } from \"./i18n\";\nimport { RecordDisplay } from \"./RecordDisplay\";\nimport { RecordView } from \"./RecordView\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { CompareType, LinearOrLog, RecordVisCoding } from \"./Types\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\n\nconst d3 = {\n  select,\n  pointer,\n  zoom,\n  zoomTransform,\n  zoomIdentity,\n  line,\n  curveNatural,\n  curveCatmullRomOpen,\n  easePolyOut,\n};\n\nexport class RecordView_Scatter extends RecordView {\n  // ********************************************************************\n  // Configurations\n  // ********************************************************************\n\n  configs: { [index: string]: Config<any> } = {};\n\n  scatter_showTrails: Config<boolean>;\n  scatter_xAxisScale: Config<LinearOrLog | \"auto\">;\n  scatter_yAxisScale: Config<LinearOrLog | \"auto\">;\n\n  private scatterZoom: any; // d3 zoom control obj\n  scatterTransform: { x: number; y: number; z: number } = { x: 0, y: 0, z: 1 };\n\n  scatterAxisScale_X: any; // d3 stuff\n  scatterAxisScale_Y: any; // d3 stuff\n\n  async prepareAttribs() {\n    if (!this.scatterYAttrib) {\n      await this.rd.setAttrib(\n        \"scatterY\",\n        this.rd.config.scatterYBy ||\n          (this.rd.codeBy.sort instanceof Attrib_Numeric\n            ? this.rd.codeBy.sort\n            : 0)\n      );\n    }\n    if (!this.scatterXAttrib) {\n      await this.rd.setAttrib(\"scatterX\", this.rd.config.scatterXBy || 0);\n    }\n    if (!this.rd.codeBy.color && this.rd.config.colorBy) {\n      await this.rd.setAttrib(\"color\", this.rd.config.colorBy);\n    }\n    if (!this.rd.codeBy.size && this.rd.config.sizeBy) {\n      await this.rd.setAttrib(\"size\", this.rd.config.sizeBy);\n    }\n    return Promise.resolve(true);\n  }\n\n  constructor(rd: RecordDisplay, config) {\n    super(rd);\n\n    this.scatter_showTrails = new Config<boolean>({\n      cfgClass: \"scatter_showTrails\",\n      cfgTitle: \"Scatter Trails\",\n      iconXML: Base.custom_icons.trails,\n      default: true,\n      parent: this,\n      helparticle: \"5e89138704286364bc97d51f\",\n      itemOptions: [\n        { name: \"Show\", value: true },\n        { name: \"Hide\", value: false },\n      ],\n      forcedValue: () => {\n        // No trails if both of the axis are not a part of time-series.\n        if (\n          !this.scatterXAttrib?.hasTimeSeriesParent() ||\n          !this.scatterYAttrib?.hasTimeSeriesParent()\n        )\n          return false;\n      },\n    });\n\n    this.scatter_xAxisScale = new Config<LinearOrLog | \"auto\">({\n      parent: this,\n      cfgClass: \"scatter_xAxisScale\",\n      cfgTitle: \"X Axis Scale\",\n      iconClass: \"fa fa-arrows-h\",\n      default: \"linear\",\n      helparticle: \"5f137ac32c7d3a10cbaaf048\",\n      itemOptions: [\n        { name: i18n.Linear + \" \" + i18n.LinearSequence, value: \"linear\" },\n        { name: i18n.Log + \" \" + i18n.Log10Sequence, value: \"log\" },\n      ],\n      noExport: true,\n      forcedValue: () => {\n        if (!this.scatterXAttrib?.supportsLogScale()) return \"linear\";\n      },\n      onSet: async (v) => {\n        if (!this.scatterXAttrib) return;\n        if (!this.scatterXAttrib.hasTimeSeriesParent()) {\n          await this.scatterXAttrib.valueScaleType.set(v);\n        } else if (v !== \"auto\"){\n          await this.scatterXAttrib.timeseriesParent.valueScaleType.set(v);\n        }\n      },\n    });\n\n    this.scatter_yAxisScale = new Config<LinearOrLog | \"auto\">({\n      parent: this,\n      cfgClass: \"scatter_yAxisScale\",\n      cfgTitle: \"Y Axis Scale\",\n      iconClass: \"fa fa-arrows-v\",\n      default: \"linear\",\n      helparticle: \"5f137ac32c7d3a10cbaaf048\",\n      itemOptions: [\n        { name: `${i18n.Linear} ${i18n.LinearSequence}`, value: \"linear\" },\n        { name: `${i18n.Log} ${i18n.Log10Sequence}`, value: \"log\" },\n      ],\n      noExport: true,\n      forcedValue: () => {\n        if (!this.scatterYAttrib?.supportsLogScale()) return \"linear\";\n      },\n      onSet: async (v) => {\n        if (!this.scatterYAttrib) return;\n        if (!this.scatterYAttrib.hasTimeSeriesParent()) {\n          await this.scatterYAttrib.valueScaleType.set(v);\n        } else if (v !== \"auto\"){\n          await this.scatterYAttrib.timeseriesParent.valueScaleType.set(v);\n        }\n      },\n    });\n\n    [\"scatter_showTrails\", \"scatter_xAxisScale\", \"scatter_yAxisScale\"].forEach(\n      (t) => {\n        this[t].val = config[t];\n        this.rd.configs[t] = this[t];\n        this.rd.recordConfigPanel.insertConfigUI(this[t]);\n      }\n    );\n\n    this.scatterZoom = d3\n      .zoom()\n      .filter(() => this.rd.visMouseMode === \"pan\" && this.rd.curHeight)\n      .scaleExtent([1, 8]) // 1 covers the whole dataset. 2 is double-zoom-in.\n      .on(\"start\", () => {\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", true);\n      })\n      .on(\"end\", () => {\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", false);\n        this.refreshLabelOverlaps();\n      })\n      .on(\"zoom\", () => {\n        let t = d3.zoomTransform(this.DOM.recordBase_Scatter.node());\n        this.scatterTransform = { x: t.x, y: t.y, z: t.k };\n        this.DOM.recordGroup_Scatter.style(\n          \"transform\",\n          `translate(${this.scatterTransform.x}px, ${this.scatterTransform.y}px) scale(${this.scatterTransform.z})`\n        );\n        this.refreshRecordVis();\n      });\n\n    this.refreshZoomScaleExtent();\n  }\n\n  /** -- */\n  initView() {\n    this.rd.refreshAttribOptions(\"scatterX\");\n    this.rd.refreshAttribOptions(\"scatterY\");\n\n    this.rd.refreshRecordDOM();\n\n    this.refreshScales();\n\n    this.zoomToFit();\n\n    this.refreshQueryBox_Filter();\n\n    this.rd.updateRecordSizeScale();\n    this.rd.updateRecordColorScale();\n  }\n\n  /** -- */\n  async initView_DOM() {\n    // set CSS variables\n    this.browser.DOM.root\n      .node()\n      .style.setProperty(\n        \"--width_scatter_margin_left\",\n        Base.width_scatter_margin_left + \"px\"\n      );\n\n    this.browser.DOM.root\n      .node()\n      .style.setProperty(\n        \"--height_scatter_margin_bottom\",\n        Base.height_scatter_margin_bottom + \"px\"\n      );\n\n    if (this.DOM.recordBase_Scatter) {\n      this.DOM.recordGroup = this.DOM.recordBase_Scatter.select(\".recordGroup\");\n      this.DOM.kshfRecords =\n        this.DOM.recordGroup_Scatter.selectAll(\".kshfRecord\");\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\n        \".kshfRecord > path.glyph_Main\"\n      );\n      this.DOM.linkGroup = this.DOM.recordGroup_Scatter.select(\".linkGroup\");\n      return; // Do not initialize twice\n    }\n\n    this.DOM.recordBase_Scatter = this.DOM.recordDisplayWrapper\n      .append(\"div\")\n      .attr(\"class\", \"recordBase_Scatter\")\n      .call(this.scatterZoom);\n\n    this.DOM.recordBase_Scatter\n      .append(\"span\")\n      .attr(\"class\", \"ScatterControl-SwapAxis\")\n      .tooltip(i18n.SwapAxis)\n      .on(\"mousedown\", (event) => event.stopPropagation() )\n      .on(\"mouseup\", (event) => event.stopPropagation() )\n      .on(\"dblclick\", (event) => event.stopPropagation() )\n      .on(\"wheel\", (event) => event.stopPropagation() )\n      .on(\"click\", (event) => {\n        this.swapAxis();\n        event.stopPropagation();\n      })\n      .append(\"i\")\n      .attr(\"class\", \"far fa-exchange\");\n\n    // recordAxis_X, recordAxis_Y\n    [\"X\", \"Y\"].forEach((a) => {\n      this.DOM[\"recordAxis_\" + a] = this.DOM.recordBase_Scatter\n        .append(\"div\")\n        .attr(\"class\", \"recordAxis recordAxis_\" + a)\n        .html(\"<div class='tickGroup'></div><div class='onRecordLine'><div class='tickLine'></div><div class='tickText'></div></div>\");\n    });\n\n    this.DOM.recordGroup_Scatter = this.DOM.recordBase_Scatter\n      .append(\"div\")\n      .attr(\"class\", \"recordGroup_Scatter_Wrapper\")\n      .append(\"div\")\n      .attr(\"class\", \"recordGroup_Scatter\");\n\n    [\"X\", \"Y\"].forEach((axis) => {\n      this.DOM[\"scatter\" + axis + \"ControlGroup\"] = this.DOM.recordBase_Scatter\n        .append(\"div\")\n        .attr(\"class\", \"recordGroup_Scatter_\" + axis + \"Axis_Options\")\n        .on(\"mousedown\", (event) => event.stopPropagation() )\n        .on(\"mouseup\", (event) => event.stopPropagation() )\n        .on(\"dbclick\", (event) => event.stopPropagation() )\n        .on(\"wheel\", (event) => event.stopPropagation() )\n        .append(\"span\")\n        .attr(\"class\", \"scatter\" + axis + \"ControlGroup attribControlGroup\");\n\n      this.rd.initDOM_AttribSelect(axis === \"X\" ? \"scatterX\" : \"scatterY\");\n    });\n\n    var _svg = this.DOM.recordGroup_Scatter\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\");\n\n    this.DOM.recordGroup = _svg.append(\"g\").attr(\"class\", \"recordGroup\");\n\n    this.DOM.recordTrail = _svg.append(\"g\").attr(\"class\", \"recordTrail\");\n    this.DOM.recordTrail_Path = this.DOM.recordTrail\n      .append(\"path\")\n      .attr(\"class\", \"recordTrail_Path\");\n\n    this.insertQueryBoxes(\n      this.DOM.recordGroup_Scatter,\n      // setSizeCb\n      (event, t) => {\n        if (event.which !== 1) return; // only respond to left-click\n        this.DOM.recordDisplayWrapper\n          .classed(\"dragging\", true)\n          .classed(\"drawSelecting\", true);\n        d3.select(\"body\")\n          .on(\"mousemove\", (event2) => {\n            var targetPos: number = d3\n              .pointer(event2, this.DOM.recordGroup_Scatter.node().parentNode)\n              .map((_, i) => this[\"scatterAxisScale_\" + (i ? \"Y\" : \"X\")].invert(_) );\n            if (t === \"l\") {\n              this.scatterXAttrib.setRangeFilter_Custom(\n                targetPos[0],\n                this.scatterXAttrib.summaryFilter.active.maxV\n              );\n            }\n            if (t === \"r\") {\n              this.scatterXAttrib.setRangeFilter_Custom(\n                this.scatterXAttrib.summaryFilter.active.minV,\n                targetPos[0]\n              );\n            }\n            if (t === \"t\") {\n              this.scatterYAttrib.setRangeFilter_Custom(\n                this.scatterYAttrib.summaryFilter.active.minV,\n                targetPos[1]\n              );\n            }\n            if (t === \"b\") {\n              this.scatterYAttrib.setRangeFilter_Custom(\n                targetPos[1],\n                this.scatterYAttrib.summaryFilter.active.minV\n              );\n            }\n            this.refreshQueryBox_Filter();\n          })\n          .on(\"mouseup\", () => {\n            this.DOM.recordDisplayWrapper\n              .classed(\"dragging\", false)\n              .classed(\"drawSelecting\", false);\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n        event.preventDefault();\n        event.stopPropagation();\n      },\n      // drag callback\n      (event) => {\n        if (event.which !== 1) return; // only respond to left-click\n        this.DOM.recordDisplayWrapper.classed(\"dragging\", true);\n        var initScreenPos = d3.pointer(\n          event,\n          this.DOM.recordGroup_Scatter.node().parentNode\n        );\n\n        var initMin_X = this.scatterAxisScale_X( this.scatterXAttrib.summaryFilter.active.minV );\n        var initMax_X = this.scatterAxisScale_X( this.scatterXAttrib.summaryFilter.active.maxV );\n        var initMin_Y = this.scatterAxisScale_Y( this.scatterYAttrib.summaryFilter.active.minV );\n        var initMax_Y = this.scatterAxisScale_Y( this.scatterYAttrib.summaryFilter.active.maxV );\n\n        d3.select(\"body\")\n          .on(\"mousemove\", (event3) => {\n            var curScreenPos = d3.pointer(\n              event3,\n              this.DOM.recordGroup_Scatter.node().parentNode\n            );\n            var diffX = initScreenPos[0] - curScreenPos[0];\n            var diffY = initScreenPos[1] - curScreenPos[1];\n            this.scatterYAttrib.setRangeFilter_Custom(\n              this.scatterAxisScale_Y.invert(initMin_Y - diffY),\n              this.scatterAxisScale_Y.invert(initMax_Y - diffY)\n            );\n            this.scatterXAttrib.setRangeFilter_Custom(\n              this.scatterAxisScale_X.invert(initMin_X - diffX),\n              this.scatterAxisScale_X.invert(initMax_X - diffX)\n            );\n            this.refreshQueryBox_Filter();\n          })\n          .on(\"mouseup\", () => {\n            this.DOM.recordDisplayWrapper.classed(\"dragging\", false);\n            d3.select(\"body\").on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n        event.preventDefault();\n        event.stopPropagation();\n      },\n      // click callback\n      (event, d) => {\n        if (d === \"Filter\") {\n          this.scatterXAttrib.summaryFilter.clearFilter();\n          this.scatterYAttrib.summaryFilter.clearFilter();\n        } else {\n          this.browser.clearSelect_Compare(d);\n          this.displayQueryBox(d, false);\n        }\n        event.currentTarget.tippy.hide();\n      }\n    );\n  }\n\n  async refreshAttribScaleType(attrib: Attrib) {\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\n\n    if (\n      this.scatterXAttrib === attrib ||\n      this.scatterXAttrib.timeseriesParent === attrib\n    ) {\n      await this.scatter_xAxisScale.set(this.scatterXAttrib.valueScaleType.get());\n      this.refreshRecordVis();\n    }\n\n    if (\n      this.scatterYAttrib === attrib ||\n      this.scatterYAttrib.timeseriesParent === attrib\n    ) {\n      await this.scatter_yAxisScale.set(this.scatterYAttrib.valueScaleType.get());\n      this.refreshRecordVis();\n    }\n  }\n\n  refreshAttribUnitName(attrib: Attrib) {\n    this.refreshScatterTicks();\n  }\n\n  async finishSetAttrib(t: RecordVisCoding) {\n    if (t === \"text\") {\n      this.DOM.kshfRecords\n        .selectAll(\"foreignObject .recordText\")\n        .html((record: Record) =>\n          this.textBriefAttrib.renderRecordValue(record)\n        );\n      this.refreshRecordBounds();\n      this.refreshLabelOverlaps();\n      //\n    } else if (t === \"scatterX\" || t === \"scatterY\") {\n      if (t === \"scatterX\") {\n        this.scatter_xAxisScale.set(this.scatterXAttrib.valueScaleType.get());\n      }\n      if (t === \"scatterY\") {\n        this.scatter_yAxisScale.set(this.scatterYAttrib.valueScaleType.get());\n      }\n      this.refreshScales();\n      this.refreshLabelOverlaps();\n      this.refreshRecordVis();\n      //\n    } else if (t === \"color\") {\n      this.refreshRecordColors();\n      //\n    } else if (t === \"size\") {\n      //\n    }\n  }\n\n  /** -- */\n  refreshViewSize(_delayMS: number = 0) {\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\n\n    this.refreshZoomScaleExtent();\n    this.refreshRecordVis();\n    this.rd.refreshColorLegendTicks();\n  }\n\n  // ********************************************************************\n  // Scale of X and Y attributes\n  // ********************************************************************\n\n  /** -- */\n  get realWidth() {\n    return this.rd.curWidth - Base.width_scatter_margin_left;\n  }\n  /** -- */\n  get realHeight() {\n    return (\n      this.rd.curHeight -\n      Base.height_scatter_margin_bottom -\n      (this.rd.hasTimeKey ? Base.timeKeyHeight : 0)\n    );\n  }\n\n  scatterScaleX: any; // d3 scale\n  scatterScaleY: any; // d3 scale\n\n  /** -- */\n  getScale(attrib) {\n    return Util.getD3Scale(attrib.isValueScale_Log)\n      .domain(attrib.getVizDomain())\n      .clamp(false);\n  }\n\n  /** -- */\n  refreshScales() {\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\n    if (this.rd.timeseriesAnimInterval) return; // do not refresh scale during animation\n\n    this.scatterScaleX = this.getScale(this.scatterXAttrib).range([\n      this.realWidth * 0.05,\n      this.realWidth * 0.9,\n    ]);\n    this.scatterScaleY = this.getScale(this.scatterYAttrib).range([\n      this.realHeight * 0.9,\n      this.realHeight * 0.05,\n    ]);\n  }\n\n  /** -- */\n  swapAxis() {\n    var _ = this.scatterXAttrib;\n    this.rd.codeBy.scatterX = this.scatterYAttrib;\n    this.rd.codeBy.scatterY = _;\n\n    this.rd.refreshAttribOptions(\"scatterX\");\n    this.rd.refreshAttribOptions(\"scatterY\");\n\n    this.refreshScales();\n\n    this.refreshRecordVis();\n  }\n\n  // ********************************************************************\n  // Zoom control\n  // ********************************************************************\n\n  /** -- */\n  zoomIn() {\n    this.scatterZoom.scaleBy(this.DOM.recordBase_Scatter, 2);\n  }\n  /** -- */\n  zoomOut() {\n    this.scatterZoom.scaleBy(this.DOM.recordBase_Scatter, 1 / 2);\n  }\n  /** -- */\n  zoomToFit() {\n    this.scatterZoom.transform(this.DOM.recordBase_Scatter, d3.zoomIdentity);\n  }\n  /** -- */\n  refreshZoomScaleExtent() {\n    this.scatterZoom.translateExtent([\n      [0, 0],\n      [this.realWidth, this.realHeight],\n    ]);\n  }\n\n  /** -- */\n  refreshLabelOverlaps() {\n    if (!this.initialized) return;\n    if (!this.DOM.kshfRecords) return;\n    if (this.rd.timeseriesAnimInterval) return;\n    var activeComparisons = this.browser.activeComparisons;\n\n    var relevantRecords = this.browser.records.filter((record: Record) => {\n      // hide text labels of all records by default\n      record._view.hideTextLabel = true;\n      return (\n        record.DOM.record &&\n        record._view.textBounds &&\n        record._view.isInScatterPlot &&\n        record._view.isInRange &&\n        record.isIncluded &&\n        (activeComparisons.length === 0 || record.isSelected())\n      );\n    });\n\n    var maxNumOfRecords = (this.realWidth * this.realHeight) / 7000;\n    var numOfLabels = 0;\n\n    relevantRecords.forEach((record: Record, i) => {\n      if (numOfLabels > maxNumOfRecords) return;\n      delete record._view.hideTextLabel; // ok, now inverse logic: show by default\n      // simple transformation on bounds to detect intersecting text labels\n      var _ = record._view.textBounds;\n      var _w = _.width / this.scatterTransform.z;\n      var _h = _.height / this.scatterTransform.z;\n      record._view.viewBounds = {\n        width: _w,\n        height: _h,\n        left: record._view.x,\n        right: record._view.x + _w,\n        top: record._view.y,\n        bottom: record._view.y + _h,\n      };\n\n      for (var j = 0; j < i; j++) {\n        var record_2 = relevantRecords[j];\n        if (\n          !record_2._view.hideTextLabel &&\n          Util.intersectsDOMRect(\n            record._view.viewBounds,\n            record_2._view.viewBounds\n          )\n        ) {\n          record._view.hideTextLabel = true;\n          return;\n        }\n      }\n      numOfLabels++;\n    });\n\n    this.DOM.kshfRecords.classed(\n      \"hideTextLabel\",\n      (record: Record) => record._view.hideTextLabel\n    );\n  }\n\n  /** -- */\n  refreshRecordSizes(): void {\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\n    if (!this.DOM.recordGroup) return;\n\n    this.DOM.recordGroup\n      .selectAll(\".kshfRecord > path\")\n      .transition()\n      .duration(700)\n      .ease(d3.easePolyOut.exponent(3))\n      .attr(\"d\", (record) => this.rd.recordDrawArc(record)());\n    this.refreshSelect_Compare(); // skip label overlap\n  }\n\n  /** -- */\n  refreshRecordColors(): void {\n    if (!this.scatterXAttrib || !this.scatterYAttrib) return;\n\n    if (!this.DOM.kshfRecords) return;\n    if (!this.DOM.kshfRecords_Path) return;\n\n    var _fill = null;\n\n    if (this.colorAttrib instanceof Attrib_Interval) {\n      var c = this.colorAttrib;\n      var s_log = this.colorAttrib.isValueScale_Log;\n      _fill = (record) => {\n        if (record.filteredOut) return;\n        var v = c.getRecordValue(record);\n        return isNaN(v) || v == null || (s_log && v <= 0)\n          ? \"url(#diagonalHatch)\"\n          : this.rd.recordColorScale(v);\n      };\n    }\n\n    this.DOM.kshfRecords_Path.style(\"fill\", _fill);\n  }\n\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\n    this.refreshLabelOverlaps();\n    super.refreshSelect_Compare(cT, status);\n  }\n\n  /** -- */\n  refreshRecordVis() {\n    if (!this.initialized) return;\n\n    if (!this.DOM.recordBase_Scatter) return;\n    if (!this.DOM.kshfRecords) return;\n    if (!this.rd.curHeight) return;\n\n    // running this first, as it also computes scatterAxisScale_X & scatterAxisScale_Y\n    this.refreshScatterTicks();\n\n    var visibleX = this.scatterAxisScale_X.domain();\n    var visibleY = this.scatterAxisScale_Y.domain();\n    visibleY.reverse();\n    var inRange = (x, range) => x > range[0] && x < range[1];\n\n    this.DOM.kshfRecords.each((record: Record) => {\n      record._view.wasInScatterPlot = record._view.isInScatterPlot || false;\n      var _x = this.scatterXAttrib.getRecordValue(record);\n      var _y = this.scatterYAttrib.getRecordValue(record);\n      record._view.isInScatterPlot = _x != null && _y != null;\n      record._view.isInRange = inRange(_x, visibleX) && inRange(_y, visibleY);\n    });\n\n    // was in scatterplot, is in scatterplot\n    this.DOM.kshfRecords\n      .filter((record: Record) => record._view.isInScatterPlot)\n      .classed(\n        \"noTransition\",\n        (record: Record) => !record._view.wasInScatterPlot\n      )\n      .style(\"transform\", (record: Record) => {\n        record._view.x = this.scatterScaleX(\n          record.getValue(this.scatterXAttrib)\n        );\n        record._view.y = this.scatterScaleY(\n          record.getValue(this.scatterYAttrib)\n        );\n        // scale is just based on zoom level - it reverses the affect of the zoom on parent node\n        return `translate(${record._view.x}px, ${record._view.y}px) scale(${\n          1 / this.scatterTransform.z\n        })`;\n      });\n\n    this.DOM.kshfRecords.classed(\n      \"hidden\",\n      (record: Record) => !record._view.isInScatterPlot\n    );\n  }\n\n  /** -- */\n  refreshScatterTicks() {\n    // Compute bounds in SVG coordinates after transform is applied.\n    var minX_real = -this.scatterTransform.x / this.scatterTransform.z;\n    var maxX_real = minX_real + this.realWidth / this.scatterTransform.z;\n    var minY_real = -this.scatterTransform.y / this.scatterTransform.z;\n    var maxY_real = minY_real + this.realHeight / this.scatterTransform.z;\n\n    this.scatterAxisScale_X = this.scatterScaleX\n      .copy()\n      .range([0, this.realWidth])\n      .domain([\n        this.scatterScaleX.invert(minX_real),\n        this.scatterScaleX.invert(maxX_real),\n      ]);\n    this.scatterAxisScale_Y = this.scatterScaleY\n      .copy()\n      .range([0, this.realHeight])\n      .domain([\n        this.scatterScaleY.invert(minY_real),\n        this.scatterScaleY.invert(maxY_real),\n      ]);\n\n    if (this.scatterAxisScale_X.base) this.scatterAxisScale_X.base(10);\n    if (this.scatterAxisScale_Y.base) this.scatterAxisScale_Y.base(10);\n\n    var tickSpacing = {\n      X: 60,\n      Y: 40,\n    };\n    if (this.scatterXAttrib.unitName) {\n      tickSpacing.X += 2 + this.scatterXAttrib.unitName.length * 8;\n    }\n\n    // TODO: add translateZ to reduce redraw (but causes flickering on chrome)\n    var addTicks = (axis, axisScale, chartSize, attrib) => {\n      var numTicks = Math.min(15, Math.floor(chartSize / tickSpacing[axis])); // no more than 15 ticks.\n\n      var ticks = axisScale\n        .ticks(numTicks)\n        .filter((t) => attrib.hasFloat || t % 1 === 0);\n\n      var visiblePos = 0;\n\n      this.DOM[\"recordAxis_\" + axis]\n        .select(\".tickGroup\")\n        .selectAll(\".hmTicks\")\n        .data(ticks, (t) => t)\n        .join(\n          (enter) =>\n            enter\n              .append(\"div\")\n              .attr(\"class\", \"hmTicks\")\n              .call((newDOM) => {\n                newDOM\n                  .transition()\n                  .delay(100)\n                  .on(\"start\", function () {\n                    this.style.opacity = 1;\n                  });\n                newDOM.append(\"div\").attr(\"class\", \"tickText\");\n                newDOM.append(\"div\").attr(\"class\", \"tickLine\");\n              }),\n          (update) => update,\n          (exit) => exit.remove()\n        )\n        .classed(\"lineAtZero\", (tick) => (tick === 0 ? true : false))\n        .style(\n          \"transform\",\n          (tick) => `translate${axis}(${axisScale(tick)}px) translateZ(0)`\n        )\n        .classed(\"hideLabel\", (tick) => {\n          var pos = axisScale(tick);\n          if (pos >= visiblePos) {\n            visiblePos = pos + tickSpacing[axis] / 2;\n            return false;\n          }\n          return true;\n        })\n        // unit name may change, don't just rely on inserting tick text on new ticks.\n        .selectAll(\".tickText\")\n        .html((tick) => attrib.printAbbr(tick));\n\n      // sort ticks from large to small\n    };\n\n    addTicks(\"X\", this.scatterAxisScale_X, this.realWidth, this.scatterXAttrib);\n    addTicks(\n      \"Y\",\n      this.scatterAxisScale_Y,\n      this.realHeight,\n      this.scatterYAttrib\n    );\n\n    this.refreshQueryBox_Filter();\n  }\n  /** -- */\n  updateAfterFilter(how) {\n    this.updateRecordVisibility();\n    this.refreshLabelOverlaps();\n    if (how) {\n      this.refreshRecordVis();\n    }\n    this.refreshRecordColors();\n  }\n\n  /** -- */\n  extendRecordDOM(newRecords) {\n    newRecords.classed(\"noTransition\", true);\n    this.extendRecordDOM_Point(newRecords);\n    newRecords\n      .append(\"foreignObject\")\n      .attr(\"width\", \"120\")\n      .attr(\"height\", \"1\")\n      .append(\"xhtml:div\")\n      .attr(\"xmlns\", \"http://www.w3.org/1999/xhtml\")\n      .attr(\"class\", \"recordText\");\n  }\n\n  /** -- */\n  displayQueryBox(cT, show) {\n    if (!this.initialized) return;\n\n    this.DOM.recordDisplayWrapper\n      .select(\".spatialQueryBox_\" + cT)\n      .style(\"display\", show ? \"block\" : null);\n  }\n\n  /** -- */\n  refreshRecordBounds() {\n    if (!this.initialized) return;\n\n    // needed to make labels visible so that bounds can be computed correctly\n    this.DOM.kshfRecords.classed(\"hideTextLabel\", false);\n\n    this.DOM.kshfRecords.selectAll(\".recordText\").each((record, i, nodes) => {\n      if (!record.DOM.record) {\n        delete record.textBounds;\n        return;\n      }\n      var DOM = nodes[i];\n      var recordTextBounds = DOM.getBoundingClientRect();\n      DOM.parentNode.setAttribute(\"width\", recordTextBounds.width * 1.07);\n      DOM.parentNode.setAttribute(\"height\", recordTextBounds.height);\n      var _ = recordTextBounds; // record.DOM.record.getBoundingClientRect();\n      record.textBounds = {\n        width: _.width,\n        height: _.height,\n        left: _.left,\n        right: _.right,\n        top: _.top,\n        bottom: _.bottom,\n      };\n    });\n  }\n\n  refreshQueryBox_Filter(bounds: { left; right; top; bottom } = null) {\n    if (this.rd.collapsed) return;\n    var _left, _right, _top, _bottom, temp;\n\n    var isVisible: boolean = false;\n\n    if (bounds === null) {\n      isVisible =\n        this.scatterXAttrib.isFiltered() || this.scatterYAttrib.isFiltered();\n\n      if (!this.scatterXAttrib.isFiltered()) {\n        _left = this.scatterXAttrib.rangeOrg[0];\n        if (_left === 0) _left = -1000;\n        _left = _left > 0 ? -_left * 100 : _left * 100;\n        _right = this.scatterXAttrib.rangeOrg[1];\n        if (_right === 0) _right = 1000;\n        _right = _right > 0 ? _right * 100 : -_right * 100;\n      } else {\n        _left = this.scatterXAttrib.summaryFilter.active[0];\n        _right = this.scatterXAttrib.summaryFilter.active[1];\n        if (this.scatterXAttrib.stepTicks) {\n          _left -= 0.5;\n          _right -= 0.5;\n        }\n      }\n\n      if (!this.scatterYAttrib.isFiltered()) {\n        _top = this.scatterYAttrib.rangeOrg[1];\n        if (_top === 0) _top = 1000;\n        _top = _top > 0 ? _top * 100 : -_top * 100;\n        _bottom = this.scatterYAttrib.rangeOrg[0];\n        if (_bottom === 0) _bottom = -1000;\n        _bottom = _bottom > 0 ? -_bottom * 100 : _bottom * 100;\n      } else {\n        _top = this.scatterYAttrib.summaryFilter.active[1];\n        _bottom = this.scatterYAttrib.summaryFilter.active[0];\n        if (this.scatterYAttrib.stepTicks) {\n          _top -= 0.5;\n          _bottom -= 0.5;\n        }\n      }\n    } else {\n      // use provided bounds\n      if (bounds.left > bounds.right) {\n        temp = bounds.left;\n        bounds.left = bounds.right;\n        bounds.right = temp;\n      }\n      if (bounds.top < bounds.bottom) {\n        temp = bounds.top;\n        bounds.top = bounds.bottom;\n        bounds.bottom = temp;\n      }\n      _left = bounds.left;\n      _right = bounds.right;\n      _top = bounds.top;\n      _bottom = bounds.bottom;\n    }\n\n    // convert from domain to screen coordinates\n    _left = this.scatterScaleX(_left);\n    if (isNaN(_left)) _left = -1000; // log scale fix\n    _right = this.scatterScaleX(_right);\n    _top = this.scatterScaleY(_top);\n    _bottom = this.scatterScaleY(_bottom);\n    if (isNaN(_bottom)) _bottom = 1000; // log scale fix\n\n    // give more room\n    _left -= 3;\n    _right += 3;\n    _top -= 3;\n    _bottom += 3;\n\n    this.DOM.recordDisplayWrapper\n      .select(\".recordGroup_Scatter .spatialQueryBox_Filter\")\n      .classed(\"active\", bounds ? true : isVisible)\n      .style(\"left\", _left + \"px\")\n      .style(\"top\", _top + \"px\")\n      .style(\"width\", Math.abs(_right - _left) + \"px\")\n      .style(\"height\", Math.abs(_bottom - _top) + \"px\");\n  }\n\n  /** -- */\n  onRecordMouseOver(record) {\n    record.moveDOMtoTop();\n\n    [\"X\", \"Y\"].forEach((axis, i) => {\n      var attrib: Attrib = this[\"scatter\" + axis + \"Attrib\"];\n      var acc = attrib.attribID;\n      var pos: number = this[\"scatterAxisScale_\" + axis](\n        record._valueCache[acc]\n      );\n      var dom = this.DOM[\"recordAxis_\" + axis];\n      dom\n        .select(\".onRecordLine\")\n        .style(\n          \"transform\",\n          \"translate(\" + pos * (i ? 0 : 1) + \"px,\" + pos * (i ? 1 : 0) + \"px)\"\n        )\n        .style(\"opacity\", 1);\n      dom\n        .select(\".onRecordLine > .tickText\")\n        .html(attrib.getFormattedValue(record._valueCache[acc], false));\n    });\n\n    if (this.scatter_showTrails.is(false)) return;\n\n    if (\n      this.scatterYAttrib.hasTimeSeriesParent() &&\n      this.scatterXAttrib.hasTimeSeriesParent()\n    ) {\n      var _ts_X =\n        this.scatterXAttrib.timeseriesParent.getRecordValue(record)._keyIndex;\n      var _ts_Y =\n        this.scatterYAttrib.timeseriesParent.getRecordValue(record)._keyIndex;\n\n      // merge the two\n      var _ts = [];\n      for (let _time_src in _ts_X) {\n        if (_ts_Y[_time_src]) {\n          _ts.push({\n            x: _ts_X[_time_src]._value,\n            y: _ts_Y[_time_src]._value,\n          });\n        }\n      }\n\n      var lineGenerator = d3\n        .line()\n        .curve(d3.curveNatural || d3.curveCatmullRomOpen)\n        .x((d) => this.scatterScaleX(d.x))\n        .y((d) => this.scatterScaleY(d.y));\n\n      this.DOM.recordTrail.style(\"opacity\", 1);\n\n      this.DOM.recordTrail_Path\n        .style(\"stroke-width\", 2 / this.scatterTransform.z + \"px\")\n        .attr(\"d\", lineGenerator(_ts));\n\n      this.DOM.recordTrail\n        .selectAll(\"circle\")\n        .data(_ts)\n        .join(\"circle\")\n        .attr(\"r\", 3)\n        .style(\"transform\", (d) => {\n          var x = this.scatterScaleX(d.x);\n          var y = this.scatterScaleY(d.y);\n          return `translate(${x}px,${y}px) scale(${\n            1 / this.scatterTransform.z\n          })`;\n        });\n    }\n  }\n\n  /** -- */\n  onRecordMouseLeave() {\n    this.DOM.root.selectAll(\".onRecordLine\").style(\"opacity\", null);\n    // hide the trail\n    this.DOM.recordTrail?.style(\"opacity\", 0);\n  }\n}\n","import { DateTime } from \"luxon/build/es6/luxon\";\n\nimport \"pikaday/css/pikaday.css\";\nimport * as Pikaday from \"pikaday\";\n\nimport { area, curveMonotoneX } from \"d3-shape\";\nimport { easePoly } from \"d3-ease\";\n\nimport { Block_Interval, ZoomableStatus } from \"./Block_Interval\";\nimport { CompareType, MeasureType } from \"./Types\";\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\nimport { Base } from \"./Base\";\n\nconst d3 = {\n  area,\n  curveMonotoneX,\n  easePoly,\n};\n\n// All dates are based on UTC.\n// Since dates are created with zone offset by default, need to offset them back sometimes\nvar offsetUTC = DateTime.now().offset;\n\nexport class Block_Timestamp extends Block_Interval<Date> {\n  // specific attribute type\n  public readonly attrib: Attrib_Timestamp;\n  constructor(attrib: Attrib_Timestamp) {\n    super(attrib);\n  }\n\n  /** -- */\n  dragRange(initPos, curPos, initMin, initMax) {\n    // no-op - not supported\n  }\n\n  /** - */\n  refreshViz_Active() {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\n    super.refreshViz_Active();\n\n    this.updateViz_Areas(\n      \"Active\",\n      !this.browser.stackedCompare && this.browser.activeComparisonsCount > 0\n    );\n  }\n  /** - */\n  refreshViz_Compare(cT: CompareType, curGroup, totalGroups, prevCts = []) {\n    if (!this.isVisible() || !this.DOM.aggrGlyphs) return;\n    super.refreshViz_Compare(cT, curGroup, totalGroups, prevCts);\n\n    if (\n      this.browser.stackedCompare &&\n      this.browser.addedCompare &&\n      curGroup === totalGroups - 1\n    ) {\n      // smoother animation, sets it as a chart-line at offset first - instead of area chart\n      this.DOM[\"measure_Area_\" + cT].attr(\"d\", this.getVizArea(cT, true));\n    }\n    this.updateViz_Areas(cT, !this.browser.stackedCompare);\n  }\n\n  /** -- */\n  insertVizDOM() {\n    // insert these elements only once\n    if (!this.DOM.timeSVG) {\n      this.DOM.timeSVG = this.DOM.histogram\n        .append(\"svg\")\n        .attr(\"class\", \"timeSVG\")\n        .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n        .style(\"margin-left\", Base.width_HistBarGap / 2 + \"px\");\n\n      this.DOM.timeSVG\n        .append(\"defs\")\n        .selectAll(\"marker\")\n        .data(Base.Active_Compare_List.map((x) => \"kshfLineChartTip_\" + x))\n        .enter()\n        .append(\"marker\")\n        .attr(\"id\", (d) => d)\n        .attr(\"patternUnits\", \"userSpaceOnUse\")\n        .attr(\"viewBox\", \"0 0 20 20\")\n        .attr(\"refX\", 10)\n        .attr(\"refY\", 10)\n        .attr(\"markerUnits\", \"strokeWidth\")\n        .attr(\"markerWidth\", 9)\n        .attr(\"markerHeight\", 9)\n        .attr(\"orient\", \"auto\")\n        .append(\"circle\")\n        .attr(\"r\", 4)\n        .attr(\"cx\", 10)\n        .attr(\"cy\", 10);\n\n      [\"Total\", \"Active\"]\n        .concat(Array.from(Base.Compare_List).reverse())\n        .forEach((cT) => {\n          this.DOM[\"measure_Area_\" + cT] = this.DOM.timeSVG\n            .append(\"path\")\n            .attr(\"class\", \"measure_Area_\" + cT + \" measure_\" + cT)\n            .attr(\"marker-mid\", \"url(#kshfLineChartTip_\" + cT + \")\")\n            .attr(\"marker-end\", \"url(#kshfLineChartTip_\" + cT + \")\")\n            .attr(\"marker-start\", \"url(#kshfLineChartTip_\" + cT + \")\");\n        });\n    }\n\n    Base.Total_Active_Compare_List.forEach((cT) => {\n      this.DOM[\"measure_Area_\" + cT].datum(this._aggrs).attr(\n        \"d\",\n        d3\n          .area()\n          .curve(d3.curveMonotoneX)\n          .x(this.attrib.timeAxis_XFunc)\n          .y0(this.height_hist - this.measureLineZero + 2)\n          .y1(this.height_hist - this.measureLineZero + 2)\n      );\n    });\n\n    super.insertVizDOM();\n  }\n\n  /** -- */\n  getVizArea(sT: MeasureType, asLine) {\n    if(sT===\"Other\") return;\n\n    var _area = d3\n      .area()\n      .curve(d3.curveMonotoneX)\n      .x(this.attrib.timeAxis_XFunc)\n      .y(\n        // sets y0 and y1\n        (aggr: Aggregate_Interval<Date>) =>\n          this.height_hist - aggr.sumOffsetScale(sT)\n      );\n\n    if (!asLine) {\n      _area.y1((aggr) => this.height_hist - aggr.offset(sT));\n    }\n\n    /*\n    // Removed, bc having all points defined help with smoother transitions between breakdown modes\n    if (this.isFiltered()) {\n      _area.defined(aggr => {\n        if(this.summaryFilter.active.min && this.summaryFilter.active.min > aggr.maxV) return false;\n        if(this.summaryFilter.active.max && this.summaryFilter.active.max < aggr.minV) return false;\n        return true;\n      });\n    }\n    */\n\n    return _area;\n  }\n  /** - */\n  updateViz_Areas(sT: MeasureType, asLine) {\n    if(sT===\"Other\") return;\n\n    return this.DOM[\"measure_Area_\" + sT]\n      .classed(\"asLine\", asLine)\n      .transition()\n      .duration(this.browser.noAnim ? 0 : 800)\n      .ease(d3.easePoly.exponent(3))\n      .attr(\"d\", this.getVizArea(sT, asLine));\n  }\n\n  /** -- */\n  showValuePicker(DOM, d: \"min\" | \"max\") {\n    if (typeof Pikaday === \"undefined\") return;\n    var skipSelect = false;\n\n    var pikaday = DOM.pikaday;\n\n    var refreshPikadayDate = () => {\n      var aggr = this.attrib.summaryFilter.active;\n      var _date = DateTime.fromJSDate(d===\"min\" ? aggr.minV : aggr.maxV)\n        .plus({ minutes: -offsetUTC })\n        .toJSDate();\n      skipSelect = true;\n      pikaday.setDate(_date);\n    };\n    if (!pikaday) {\n      var me = this;\n      DOM.pikaday = pikaday = new (window as any).Pikaday({\n        field: DOM,\n        firstDay: 1,\n        minDate: this.attrib.rangeOrg[0],\n        maxDate: this.attrib.rangeOrg[1],\n        onSelect: function () {\n          if (skipSelect) {\n            skipSelect = false;\n            return;\n          }\n          var selectedDate: Date = this.getDate();\n          selectedDate = DateTime.fromJSDate(selectedDate)\n            // need to convert value to UTC\n            .plus({ minutes: offsetUTC })\n            .toJSDate();\n          if (\n            (d === \"min\" && selectedDate < me.attrib.summaryFilter.active.minV) ||\n            (d === \"max\" && selectedDate > me.attrib.summaryFilter.active.maxV)\n          ) {\n            me.zoomed.set(false);\n          }\n\n          var minV = me.attrib.summaryFilter.active.minV;\n          var maxV = me.attrib.summaryFilter.active.minV;\n          if(d===\"min\") minV = selectedDate;\n          if(d===\"max\") maxV = selectedDate;\n          me.attrib.setRangeFilter_Custom( minV, maxV);\n          refreshPikadayDate();\n        },\n      });\n    }\n\n    refreshPikadayDate();\n    pikaday.show();\n  }\n\n  getScaleNicing(): number {\n    return this.width_histogram / (this.inDashboard ? this.optimumBinWidth.get() : 10) * 1;\n  }\n\n  hasStaticHeight() {\n    return this.showHistogram.is(false);\n  }\n\n  zoomableStatus(): ZoomableStatus {\n    if (this.attrib.stepTicks) {\n      if (\n        this.attrib.timeTyped.finestRes() ===\n        this.attrib.timeTyped.activeRes.type\n      ) {\n        return this.zoomed.get() ? \"minus\" : \"\";\n      }\n    }\n    return \"plus\";\n  }\n}\n","import { DateTime, Interval } from \"luxon/build/es6/luxon\";\nimport { utcFormat } from \"d3-time-format\";\n\nimport { Aggregate_Interval } from \"./Aggregate_Interval\";\n\nconst d3 = { utcFormat };\n\nexport class Aggregate_Interval_Date extends Aggregate_Interval<Date> {\n  get label(): string {\n    if (this.minV == null || this.maxV == null) return \"-\";\n\n    // if time selection covers a full year/ month, print as a single year/month\n    var m_max = DateTime.fromJSDate(this.maxV, { zone: \"UTC\" });\n    var m_min = DateTime.fromJSDate(this.minV, { zone: \"UTC\" });\n\n    var interval = Interval.fromDateTimes(m_min, m_max);\n\n    var daysInBetween = interval.toDuration(\"days\").toObject().days;\n\n    if (\n      Math.abs(daysInBetween - 365) < 2 &&\n      m_max.month === 1 &&\n      m_max.day === 1\n    ) {\n      return d3.utcFormat(\"%Y\")(this.minV);\n    }\n\n    if (\n      Math.abs(daysInBetween - 30) < 3 &&\n      m_min.day === 1 &&\n      m_max.day === 1\n    ) {\n      return d3.utcFormat(\"%b %Y\")(this.minV);\n    }\n\n    var minStr = this.attrib.getFormattedValue(this.minV, false);\n    var maxStr = this.attrib.getFormattedValue(this.maxV, false);\n\n    return `${this.isMinLarger() ? minStr : \"\"} ... ${\n      this.isMaxSmaller() ? maxStr : \"\"\n    }`;\n  }\n}\n","import { scaleUtc } from \"d3-scale\";\nimport { utcFormat } from \"d3-time-format\";\nimport {\n  utcSecond,\n  utcMinute,\n  utcHour,\n  utcDay,\n  utcWeek,\n  utcMonth,\n  utcYear,\n} from \"d3-time\";\nimport { DateTime } from \"luxon/build/es6/luxon\";\n\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { RecordVisCoding } from \"./Types\";\nimport { Browser } from \"./Browser\";\nimport { Block_Timestamp } from \"./Block_Timestamp\";\nimport { AttribTemplate } from \"./AttribTemplate\";\nimport { Aggregate_Interval_Date } from \"./Aggregate_Interval_Date\";\n\nconst d3 = {\n  scaleUtc,\n  utcFormat,\n  utcSecond,\n  utcMinute,\n  utcHour,\n  utcDay,\n  utcWeek,\n  utcMonth,\n  utcYear,\n};\n\ntype DateRes = \"Second\" | \"Minute\" | \"Hour\" | \"Day\" | \"Month\" | \"Year\";\n\ntype TTTT = {\n  type: DateRes;\n  step: number;\n  format: (any) => string;\n  twoLine?: boolean;\n};\n\n// All dates are based on UTC.\n// Since dates are created with zone offset by default, need to offset them back sometimes\nvar offsetUTC = DateTime.now().offset;\n\nexport class Attrib_Timestamp extends Attrib_Interval<Date> {\n  timeTyped?: {\n    activeRes?: TTTT;\n    second?: boolean;\n    minute?: boolean;\n    hour?: boolean;\n    day?: boolean;\n    month?: boolean;\n    year?: boolean;\n    print?: (any) => string;\n    finestRes?: () => DateRes;\n  };\n\n  /** -- */\n  initTimeTyped() {\n    // Check time resolutions\n    this.timeTyped.year = false;\n    this.timeTyped.month = false;\n    this.timeTyped.day = false;\n    this.timeTyped.hour = false;\n    this.timeTyped.minute = false;\n    this.timeTyped.second = false;\n\n    var tempYear = null;\n\n    this.records.forEach((record) => {\n      var v = this.getRecordValue(record);\n      if (!v) return;\n      if (v.getUTCMonth() !== 0) this.timeTyped.month = true;\n      if (v.getUTCHours() !== 0) this.timeTyped.hour = true;\n      if (v.getUTCMinutes() !== 0) this.timeTyped.minute = true;\n      if (v.getUTCDate() !== 1) this.timeTyped.day = true;\n      if (!this.timeTyped.year) {\n        if (tempYear === null) {\n          tempYear = v.getUTCFullYear();\n        } else {\n          if (tempYear !== v.getUTCFullYear()) this.timeTyped.year = true;\n        }\n      }\n    });\n  }\n\n  timeAxis_XFunc: any;\n\n  constructor(browser: Browser, name: string, template: AttribTemplate) {\n    super(\n      browser,\n      name,\n      template,\n      \"timestamp\",\n      \"kshfSummary_Timestamp\",\n      \"far fa-calendar-day\"\n    );\n\n    this._block = new Block_Timestamp(this);\n\n    this.timeAxis_XFunc = (aggr) =>\n      (this.valueScale(aggr.minV) + this.valueScale(aggr.maxV)) / 2;\n\n    this.configs.showHistogram.cfgTitle = \"Line Chart\"; // customize from \"Histogram\"\n\n    this.timeTyped = {\n      // Finest level of resolution\n      finestRes: function () {\n        if (this.second) return \"Second\";\n        if (this.minute) return \"Minute\";\n        if (this.hour) return \"Hour\";\n        if (this.day) return \"Day\";\n        if (this.month) return \"Month\";\n        if (this.year) return \"Year\";\n      },\n    };\n  }\n\n  createAggregate(minV: Date, maxV: Date) {\n    return new Aggregate_Interval_Date(this, minV, maxV);\n  }\n\n  /** -- */\n  supportsRecordEncoding(coding: RecordVisCoding) {\n    if (this.isEmpty()) return false;\n    if (coding === \"sort\") return true;\n    if (coding === \"text\") return true;\n    if (coding === \"textBrief\") return true;\n    return false;\n  }\n\n  /** -- */\n  getFormattedValue(v) {\n    return v instanceof Date ? this.intervalTickPrint(v) : v;\n  }\n\n  getValuePosX(v: Date): number {\n    var offset = 0;\n    if (this.stepTicks) {\n      offset += this.block.aggrWidth / 2;\n    }\n    return this.valueScale(v) + offset;\n  }\n\n  /** -- */\n  getValueScaleObj() {\n    return d3.scaleUtc();\n  }\n  refreshScaleType() {\n    return;\n  }\n\n  /** -- */\n  fillValueCache() {\n    this.records.forEach((record) => {\n      var v = this.template.func.call(record.data, record);\n      if (v === undefined) v = null;\n      if (!(v instanceof Date)) v = null;\n      record.setValue(this, v);\n      if (v == null) {\n        this.noValueAggr.addRecord(record);\n      }\n    });\n\n    this.initTimeTyped();\n  }\n\n  /** -- */\n  pofffff() {\n    this.updateScaleAndBins();\n  }\n\n  refreshValueScale() {\n    super.refreshValueScale();\n\n    var maxScale: (Date) => Date = d3[\"utc\" + this.timeTyped.finestRes()];\n\n    if (this.intervalTicks.some((tick: Date) => maxScale(tick) < tick)) {\n      var nicing = maxScale;\n\n      this.valueScale = this.getValueScaleObj()\n        .domain(this.rangeActive)\n        .range([0, this.block.width_histogram])\n        .nice(nicing);\n\n      this.intervalTicks = this.valueScale.ticks(nicing);\n    }\n  }\n\n  updateTickPrintFunc() {\n    const formatSecond = d3.utcFormat(\":%S\"),\n      formatMinute = d3.utcFormat(\"%I:%M\"),\n      formatHour = d3.utcFormat(\"%I %p\"),\n      formatDay = d3.utcFormat(\"%a %d\"),\n      formatWeek = d3.utcFormat(\"%b %d\"),\n      formatMonth = d3.utcFormat(\"%b\"),\n      formatYear = d3.utcFormat(\"%Y\");\n\n    this.intervalTickPrint = (date) => {\n      return (\n        d3.utcMinute(date) < date\n          ? formatSecond\n          : d3.utcHour(date) < date\n          ? formatMinute\n          : d3.utcDay(date) < date\n          ? formatHour\n          : d3.utcMonth(date) < date\n          ? d3.utcWeek(date) < date\n            ? formatDay\n            : formatWeek\n          : d3.utcYear(date) < date\n          ? formatMonth\n          : formatYear\n      )(date);\n    };\n  }\n}\n","import { select, pointer } from \"./d3_select\";\nimport { scaleTime, scaleLinear } from \"d3-scale\";\nimport { extent } from \"d3-array\";\nimport { arc } from \"d3-shape\";\n\nimport { Base } from \"./Base\";\nimport { Config } from \"./Config\";\nimport { RecordDisplay } from \"./RecordDisplay\";\nimport { RecordView } from \"./RecordView\";\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\nimport { Util } from \"./Util\";\nimport { Record } from \"./Record\";\nimport { i18n } from \"./i18n\";\nimport { CompareType, RecordVisCoding } from \"./Types\";\nimport { Attrib } from \"./Attrib\";\n\nconst d3 = { select, pointer, scaleTime, scaleLinear, extent, arc };\n\nexport class RecordView_List extends RecordView {\n  // ********************************************************************\n  // Configurations\n  // ********************************************************************\n\n  list_showRank: Config<boolean>;\n  list_sortVizRange: Config<\"dynamic\" | \"static\">;\n  list_ViewType: Config<\"List\" | \"Grid\">;\n  list_sortInverse: Config<boolean>;\n  list_sortColWidth: Config<number>;\n  list_sortVizWidth: Config<number>;\n  list_sparklineVizWidth: Config<number>;\n  list_gridRecordWidth: Config<number>;\n\n  listSortVizScale: any; // d3 scale\n\n  /** -- */\n  async prepareAttribs() {\n    if (!this.sortAttrib) {\n      await this.rd.setAttrib(\"sort\", this.rd.config.sortBy || 0);\n    }\n    return Promise.resolve(this.sortAttrib !== null);\n  }\n\n  constructor(rd: RecordDisplay, config) {\n    super(rd);\n\n    this.list_showRank = new Config<boolean>({\n      cfgClass: \"list_showRank\",\n      cfgTitle: \"Ranking\",\n      iconXML: \"\",\n      default: false,\n      parent: this,\n      helparticle: \"5e88d84d04286364bc97d40f\",\n      tooltip: `The ranking column`,\n      itemOptions: [\n        { name: \"Hide\", value: false },\n        { name: \"Show\", value: true },\n      ],\n      onSet: () => {\n        if (!this.initialized) return;\n        this.refreshShowRank();\n      },\n    });\n\n    this.list_sortVizRange = new Config<\"dynamic\" | \"static\">({\n      cfgClass: \"list_sortVizRange\",\n      cfgTitle: \"Sorting Vis Axis\",\n      iconClass: \"fa fa-long-arrow-right\",\n      default: \"dynamic\",\n      parent: this,\n      //helparticle: \"5e88d84d04286364bc97d40f\",\n      tooltip: `The viz scale used for sorting column`,\n      itemOptions: [\n        { name: \"Static\", value: \"static\" },\n        { name: \"Dynamic\", value: \"dynamic\" },\n      ],\n      onSet: () => {\n        if (!this.initialized) return;\n        this.refreshSortVizScale();\n      },\n    });\n\n    this.list_ViewType = new Config<\"List\" | \"Grid\">({\n      cfgClass: \"list_ViewType\",\n      cfgTitle: \"List Type\",\n      iconClass: \"fa fa-list\",\n      default: \"List\",\n      parent: this,\n      helparticle: \"5f107e492c7d3a10cbaacc43\",\n      itemOptions: [\n        { name: \"List <i class='fa fa-bars'></i>\", value: \"List\" },\n        { name: \"Grid <i class='fa fa-th'></i>\", value: \"Grid\" },\n      ],\n      onSet: async (v) => {\n        this.DOM.root.attr(\"data-list_ViewType\", v);\n        if (!this.initialized) return;\n        this.refreshWidthControls();\n        if (v === \"List\") {\n          await this.list_sortVizWidth?.reset();\n          await this.list_sparklineVizWidth?.reset();\n        } else {\n          this.refreshSparklineViz();\n        }\n      },\n    });\n\n    this.list_sortInverse = new Config<boolean>({\n      cfgClass: \"list_sortInverse\",\n      cfgTitle: \"Sorting Order\",\n      iconClass: \"fa fa-sort-amount-asc\",\n      default: false,\n      parent: this,\n      helparticle: \"5e87f08e2c7d3a7e9aea6081\",\n      itemOptions: [\n        { name: \"Large to small\", value: false },\n        { name: \"Small to large\", value: true },\n      ],\n      onSet: () => {\n        if (!this.initialized) return;\n        this.reverseOrder();\n        this.DOM.root\n          ?.select(\".recordReverseSortButton\")\n          .classed(\"sortInverse\", this.list_sortInverse.is(true));\n      },\n    });\n\n    this.list_sortColWidth = new Config<number>({\n      cfgClass: \"list_sortColWidth\",\n      cfgTitle: \"Sorting Value Width\",\n      iconClass: \"fa fa-arrows-h\",\n      default: 60,\n      parent: this,\n      helparticle: \"5f107eb904286306f806ec35\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { _type: \"_range_\", minValue: 40, maxValue: 120 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 5;\n        } else if (v === -199) {\n          v = obj._value + 5;\n        }\n        return Math.max(40, Math.min(120, v));\n      },\n      onSet: (v) => {\n        this.browser.DOM.root\n          .node()\n          .style.setProperty(\"--list_sortColWidth\", v + \"px\");\n        this.refreshSortColumnWidth();\n      },\n    });\n\n    this.list_sortVizWidth = new Config<number>({\n      cfgClass: \"list_sortVizWidth\",\n      cfgTitle: \"Sorting Bar Width\",\n      iconClass: \"fa fa-arrows-h\",\n      default: 80,\n      parent: this,\n      helparticle: \"5e87f23c04286364bc97d0e3\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { name: \"Off\", value: 0 },\n        { _type: \"_range_\", minValue: 40, maxValue: 400 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      forcedValue: (obj) => {\n        if (this.sortAttrib instanceof Attrib_Timestamp) return 0;\n        if (this.list_ViewType.is(\"Grid\") && obj._value !== 0)\n          return this.list_gridRecordWidth.get() - 10;\n      },\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 5;\n        } else if (v === -199) {\n          v = obj._value + 5;\n        }\n        if (v < 40) return 0;\n        return Math.min(400, v);\n      },\n      onSet: (v) => {\n        if (!this.initialized) return;\n        this.browser.DOM.root\n          .node()\n          .style.setProperty(\"--list_sortVizWidth\", v + \"px\");\n        this.browser.DOM.root.classed(\"noAnim\", true);\n\n        this.refreshSortVizWidth();\n        setTimeout(() => this.browser.DOM.root.classed(\"noAnim\", false), 1000);\n      },\n    });\n\n    this.list_sparklineVizWidth = new Config<number>({\n      cfgClass: \"list_sparklineVizWidth\",\n      cfgTitle: \"Sparkline Width\",\n      iconClass: \"far fa-chart-line\",\n      default: 120,\n      parent: this,\n      helparticle: \"5e87f16904286364bc97d0e2\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { name: \"Off\", value: 0 },\n        { _type: \"_range_\", minValue: 50, maxValue: 300 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      forcedValue: (obj) => {\n        if (!this.sortAttrib?.hasTimeSeriesParent()) return 0;\n        if (this.list_ViewType.is(\"Grid\") && obj._value !== 0)\n          return this.list_gridRecordWidth.get() - 10;\n      },\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 5;\n        } else if (v === -199) {\n          v = obj._value + 5;\n        }\n        if (v < 50) return 0;\n        return Math.min(300, v);\n      },\n      onSet: (v) => {\n        if (!this.initialized) return;\n        this.browser.DOM.root\n          .node()\n          .style.setProperty(\"--list_sparklineVizWidth\", v + \"px\");\n        this.refreshSparklineVizWidth();\n      },\n    });\n\n    this.list_gridRecordWidth = new Config<number>({\n      cfgClass: \"list_gridRecordWidth\",\n      cfgTitle: \"Grid Record Width\",\n      iconClass: \"fa fa-arrows-h\",\n      default: 200,\n      parent: this,\n      helparticle: \"5f10800c04286306f806ee67\",\n      itemOptions: [\n        { name: \"<i class='fa fa-minus'></i>\", value: -99, _type: \"minus\" },\n        { _type: \"_range_\", minValue: 100, maxValue: 400 },\n        { name: \"<i class='fa fa-plus'></i>\", value: -199, _type: \"plus\" },\n      ],\n      preSet: async (v, obj) => {\n        if (v === -99) {\n          v = obj._value - 5;\n        } else if (v === -199) {\n          v = obj._value + 5;\n        }\n        return Math.max(100, Math.min(500, v));\n      },\n      onSet: (v) => {\n        if (!this.initialized) return;\n        this.browser.DOM.root\n          .node()\n          .style.setProperty(\"--list_gridRecordWidth\", v + \"px\");\n        this.refreshSparklineViz();\n      },\n    });\n\n    [\n      \"list_ViewType\",\n      \"list_sortInverse\",\n      \"list_showRank\",\n      \"list_sortColWidth\",\n      \"list_sortVizWidth\",\n      \"list_sortVizRange\",\n      \"list_sparklineVizWidth\",\n      \"list_gridRecordWidth\",\n    ].forEach((t) => {\n      this[t].val = config[t];\n      this.rd.configs[t] = this[t];\n      this.rd.recordConfigPanel.insertConfigUI(this[t]);\n    });\n\n    // Used in list view\n    this.maxVisibleItems_Default =\n      config.maxVisibleItems_Default || Base.maxVisibleItems_Default;\n    this.maxVisibleRecords = this.maxVisibleItems_Default; // This is the dynamic property\n  }\n\n  /** -- */\n  initView() {\n    this.rd.refreshAttribOptions(\"sort\");\n\n    this.DOM.root.attr(\"data-list_ViewType\", this.list_ViewType.get());\n\n    this.refreshSortColumnWidth();\n    this.refreshSortVizWidth();\n    this.refreshSparklineVizWidth();\n\n    this.DOM.kshfRecords = this.DOM.recordGroup_List.selectAll(\".kshfRecord\");\n\n    this.updateRecordSortScale();\n\n    this.refreshRecordVis();\n  }\n\n  async initView_DOM() {\n    var browserRootStyle = this.browser.DOM.root.node().style;\n\n    browserRootStyle.setProperty(\n      \"--list_sortColWidth\",\n      this.list_sortColWidth.get() + \"px\"\n    );\n    browserRootStyle.setProperty(\n      \"--list_sortVizWidth\",\n      this.list_sortVizWidth.get() + \"px\"\n    );\n    browserRootStyle.setProperty(\n      \"--list_sparklineVizWidth\",\n      this.list_sparklineVizWidth.get() + \"px\"\n    );\n    browserRootStyle.setProperty(\n      \"--list_gridRecordWidth\",\n      this.list_gridRecordWidth.get() + \"px\"\n    );\n\n    if (this.DOM.recordGroup_List) {\n      this.DOM.recordGroup = this.DOM.recordGroup_List.select(\".recordGroup\");\n      this.DOM.kshfRecords = this.DOM.recordGroup.selectAll(\".kshfRecord\");\n\n      this.DOM.tableHeaderGroup\n        .node()\n        .insertBefore(\n          this.DOM.sortControlGroup.node(),\n          this.DOM.tableConfigGap.node()\n        );\n\n      return;\n    }\n\n    this.DOM.recordGroup_List = this.rd.DOM.recordDisplayWrapper\n      .append(\"div\")\n      .attr(\"class\", \"recordGroup_List\");\n\n    this.DOM.tableHeaderGroup = this.DOM.recordGroup_List\n      .append(\"div\")\n      .attr(\"class\", \"tableHeaderGroup\");\n\n    this.DOM.tableHeaderGroup\n      .append(\"div\")\n      .attr(\"class\", \"showRecordRank\")\n      .append(\"span\")\n      .html(\"Rank\");\n\n    this.rd.DOM.sortControlGroup = this.DOM.tableHeaderGroup\n      .append(\"span\")\n      .attr(\"class\", \"sortControlGroup attribControlGroup\");\n\n    this.rd.initDOM_AttribSelect(\"sort\");\n\n    this.rd.DOM.sortControlGroup\n      .append(\"span\")\n      .attr(\"class\", \"recordReverseSortButton sortButton\")\n      .classed(\"sortInverse\", this.list_sortInverse.is(true))\n      .tooltip(i18n.ReverseOrder)\n      .on(\"click\", async () => await this.list_sortInverse.set(!this.list_sortInverse.get()) )\n      .append(\"span\")\n      .attr(\"class\", \"fa\");\n\n    this.DOM.tableConfigGap = this.DOM.tableHeaderGroup\n      .append(\"span\")\n      .attr(\"class\", \"gap\");\n\n    var addMoreVisibleItems = () => {\n      this.maxVisibleRecords += this.maxVisibleItems_Default;\n      this.rd.refreshRecordDOM();\n    };\n\n    this.DOM.recordGroup = this.DOM.recordGroup_List\n      .append(\"div\")\n      .attr(\"class\", \"recordGroup\")\n      .on(\"scroll\", () => {\n        if (\n          this.maxVisibleRecords <= this.browser.allRecordsAggr.recCnt(\"Active\")\n        ) {\n          var DOM = this.DOM.recordGroup.node();\n          if (!this._recordGroupScroll) {\n            var s = window.getComputedStyle(DOM);\n            if (s.overflowY === \"hidden\" && s.overflowX === \"scroll\")\n              this._recordGroupScroll = \"left-right\";\n            else if (s.overflowX === \"hidden\" && s.overflowY === \"scroll\")\n              this._recordGroupScroll = \"top-down\";\n          }\n\n          if (this._recordGroupScroll === \"left-right\") {\n            if (DOM.scrollWidth - DOM.scrollLeft - DOM.offsetWidth < 500)\n              addMoreVisibleItems();\n          }\n          if (this._recordGroupScroll === \"top-down\") {\n            if (DOM.scrollHeight - DOM.scrollTop - DOM.offsetHeight < 10)\n              addMoreVisibleItems();\n          }\n        }\n      });\n\n    var adjustWidth = (event, configObj) => {\n      if (event.which !== 1) return; // only respond to left-click\n      var mouseDown_width = configObj.val - d3.pointer(event, document.body)[0];\n\n      this.browser.activateWidthDrag(event.currentTarget, event, (event2) => {\n        configObj.val = mouseDown_width + d3.pointer(event2, document.body)[0];\n      });\n    };\n\n    this.DOM.adjustSortColumnWidth = this.DOM.recordGroup_List\n      .append(\"div\")\n      .attr(\"class\", \"adjustSortColumnWidth dragWidthHandle\")\n      .on(\"mousedown\", (event) => adjustWidth(event, this.list_sortColWidth));\n\n    this.DOM.adjustSortVizWidth = this.DOM.recordGroup_List\n      .append(\"div\")\n      .attr(\"class\", \"adjustSortVizWidth dragWidthHandle\")\n      .on(\"mousedown\", (event) => adjustWidth(event, this.list_sortVizWidth));\n\n    this.DOM.adjustSparklineVizWidth = this.DOM.recordGroup_List\n      .append(\"div\")\n      .attr(\"class\", \"adjustSparklineVizWidth dragWidthHandle\")\n      .on(\"mousedown\", (event) =>\n        adjustWidth(event, this.list_sparklineVizWidth)\n      );\n\n    this.refreshSortVizWidth();\n    this.refreshWidthControls();\n  }\n\n  /** -- */\n  extendRecordDOM(newRecords) {\n    if (this.animatedList) {\n      newRecords.style(\n        \"transform\",\n        `translateY(${this.maxVisibleRecords * this.animatedRecordHeight}px)`\n      );\n    }\n\n    // RANKINGS\n    var _ = newRecords\n      .append(\"span\")\n      .attr(\"class\", \"recordRank\")\n      .tooltip(\"-\")\n      .on(\"mouseenter\", (event, record) => {\n        event.currentTarget.setAttribute(\n          \"title\",\n          Util.ordinal_suffix_of(record.recordRank + 1)\n        );\n      })\n      .append(\"span\");\n    this.refreshRecordRanks(_);\n    this.DOM.recordRanks = this.DOM.recordGroup.selectAll(\".recordRank > span\");\n\n    // RECORD CLICK CALLBACK - Used by multiple DOM nodes\n    var onRecordClick = (_event, record) => {\n      this.browser.recordDetailsPopup.updateRecordDetailPanel(record);\n      if (\n        this.sortAttrib instanceof Attrib_Numeric &&\n        this.sortAttrib.timeKey\n      ) {\n        this.browser.recordDetailsPopup.updateFocusedTimeKey(\n          this.sortAttrib.timeKey\n        );\n      }\n    };\n\n    // SORTING VALUE LABELS AND BARS\n\n    newRecords.append(\"div\").attr(\"class\", \"recordSparklineVizHost\");\n    newRecords\n      .append(\"div\")\n      .attr(\"class\", \"recordSortValue\")\n      .on(\"click\", onRecordClick);\n    newRecords\n      .append(\"div\")\n      .attr(\"class\", \"recordSortVizHost\")\n      .on(\"click\", onRecordClick)\n      .append(\"div\")\n      .attr(\"class\", \"recordSortViz\");\n\n    this.DOM.recordSortValue =\n      this.DOM.recordGroup.selectAll(\".recordSortValue\");\n    this.DOM.recordSortVizHost =\n      this.DOM.recordGroup.selectAll(\".recordSortVizHost\");\n    this.DOM.recordSortViz = this.DOM.recordGroup.selectAll(\".recordSortViz\");\n    this.DOM.recordSparklineVizHost = this.DOM.recordGroup.selectAll(\n      \".recordSparklineVizHost\"\n    );\n\n    this.refreshSortViz(newRecords);\n    this.refreshSparklineViz();\n\n    this.refreshSortingLabels(newRecords);\n\n    // Insert the content\n    newRecords\n      .append(\"div\")\n      .attr(\"class\", \"content\")\n      .html((record) => this.textAttrib.renderRecordValue(record))\n      .on(\"click\", onRecordClick);\n\n    newRecords\n      .append(\"svg\")\n      .attr(\"class\", \"compareBoxes\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .attr(\"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n      .attr(\"viewBox\", \"-100 -100 200 200\")\n      .call((compareBoxes) => {\n        Base.Compare_List.forEach((cT) => {\n          compareBoxes.append(\"path\").attr(\"class\", \"glyph_\" + cT);\n        });\n      });\n\n    // Fixes ordering problem when new records are made visible on the list\n    // TO-DO: Try to avoid this.\n    this.DOM.recordGroup\n      .selectAll(\".kshfRecord\")\n      .data(this.getRecordsForDOM(), (record: Record) => record.id)\n      .order();\n  }\n\n  // temporary / internal\n  private _recordGroupScroll: string = null;\n\n  async finishSetAttrib(t: RecordVisCoding) {\n    if (t === \"sort\") {\n      this.sortRecords();\n\n      this.refreshSortVizWidth();\n\n      if (this.DOM.recordGroup_List) {\n        this.rd.refreshRecordDOM();\n        this.refreshRecordDOMOrder();\n        this.refreshRecordRanks();\n        this.refreshSortingLabels();\n        this.refreshSparklineViz();\n        if (this.rd.config.recordRefresh) {\n          this.DOM.kshfRecords.each((r) => {\n            this.rd.config.recordRefresh.call(r.data, r, this);\n          });\n        }\n      }\n    }\n    if (t === \"text\") {\n      this.DOM.kshfRecords\n        .selectAll(\".content\")\n        .html((record) => this.textAttrib.renderRecordValue(record));\n    }\n  }\n\n  // ********************************************************************\n  // Record sorting\n  // ********************************************************************\n\n  /** -- */\n  reverseOrder() {\n    this.browser.records.reverse();\n\n    var arr = this.browser.records;\n    var maxLoop = arr.length;\n    for (var i = 0; i < maxLoop; i++) {\n      var v = this.sortAttrib.getRecordValue(arr[0]);\n      if (v === null || v === undefined) {\n        arr.push(arr.shift());\n      } else {\n        break;\n      }\n    }\n\n    this.refreshRecordVis();\n    this.refreshRecordDOMOrder();\n  }\n\n  /** Sort all records given the active sort option\n   *  Records are only sorted on init & when active sorting option changes.\n   *  They are not resorted on filtering.\n   */\n  sortRecords() {\n    var attrib = this.sortAttrib;\n    if (!attrib) return;\n\n    var sortFunc = this.getSortFunc(attrib.template.func);\n\n    var inverse = this.list_sortInverse.is(true);\n\n    this.browser.records.sort((record_A, record_B) => {\n      var v_a = attrib.getRecordValue(record_A);\n      var v_b = attrib.getRecordValue(record_B);\n\n      if (v_a == null && v_b != null) return 1;\n      if (v_b == null && v_a != null) return -1;\n      if (v_b == null && v_a == null) return 0;\n\n      // Don't move filtered-out records to end of the list, keep them in sorted order\n      // This way, you don't need to re-order after filtering, which is a nice property to have.\n\n      var dif = sortFunc(v_a, v_b);\n      return inverse ? -dif : dif;\n    });\n\n    this.updateRecordRanks();\n  }\n\n  /** Returns the sort value type for given sort Value function */\n  getSortFunc(sortValueFunc) {\n    // 0: string, 1: date, 2: others\n    var sortValueFunction = Util.sortFunc_List_Number;\n\n    // find appropriate sortvalue type\n    for (var k = 0, same = 0; true; k++) {\n      if (same === 3 || k === this.browser.records.length) break;\n      var item = this.browser.records[k];\n      var f = sortValueFunc.call(item.data, item);\n      if (f == null || f === \"\") continue;\n      var sortValueType_temp2;\n      switch (typeof f) {\n        case \"string\":\n          sortValueType_temp2 = Util.sortFunc_List_String;\n          break;\n        case \"number\":\n          sortValueType_temp2 = Util.sortFunc_List_Number;\n          break;\n        case \"object\":\n          if (f instanceof Date) sortValueType_temp2 = Util.sortFunc_List_Date;\n          else sortValueType_temp2 = Util.sortFunc_List_Number;\n          break;\n        default:\n          sortValueType_temp2 = Util.sortFunc_List_Number;\n          break;\n      }\n\n      if (sortValueType_temp2 === sortValueFunction) {\n        same++;\n      } else {\n        sortValueFunction = sortValueType_temp2;\n        same = 0;\n      }\n    }\n    return sortValueFunction;\n  }\n\n  // ********************************************************************\n  // Record ranking\n  // ********************************************************************\n\n  private maxVisibleItems_Default: number;\n  maxVisibleRecords: number;\n\n  /** -- */\n  updateRecordRanks() {\n    var wantedRank = 0;\n    var unwantedRank = -1;\n    var lastValue = null;\n    var lastRank = null;\n\n    // records are sorted, and iterated from top to bottom\n    this.browser.records.forEach((record: Record) => {\n      var v = this.sortAttrib.getRecordValue(record);\n\n      if (v instanceof Date) v = v.getTime();\n\n      // Records with the same value have the same \"rank\".\n      // Once there value changes, ranking resumes from \"total\" ranks, counting each same-rank record separately.\n      record.recordRank = record.isIncluded\n        ? v === lastValue\n          ? lastRank\n          : wantedRank\n        : unwantedRank;\n\n      record.recordRank_Unique = record.isIncluded ? wantedRank : unwantedRank;\n\n      if (record.isIncluded && v !== lastValue) {\n        lastValue = v;\n        lastRank = record.recordRank;\n      }\n\n      if (record.isIncluded) {\n        wantedRank++;\n      } else {\n        unwantedRank--;\n      }\n    });\n\n    this.maxVisibleRecords = this.maxVisibleItems_Default;\n  }\n\n  /** -- */\n  refreshShowRank() {\n    this.DOM.root.classed(\"showRank\", this.list_showRank.is(true));\n    this.refreshRecordRanks();\n    this.refreshWidthControls();\n  }\n\n  /** -- */\n  refreshRecordRanks(d3_selection = null) {\n    if (this.list_showRank.is(false)) return;\n    if (d3_selection === null) d3_selection = this.DOM.recordRanks;\n    d3_selection.text((record) =>\n      record.recordRank < 0 ? \"\" : record.recordRank + 1\n    );\n  }\n\n  /** -- */\n  updateRecordVisibility() {\n    this.DOM.kshfRecords.classed(\n      \"rankBeyondListRange\",\n      (record) =>\n        record.recordRank < 0 || record.recordRank >= this.maxVisibleRecords\n    );\n  }\n\n  /** -- */\n  getRecordsForDOM() {\n    return this.browser.records.filter(\n      (record: Record) =>\n        !record.filteredOut && record.recordRank < this.maxVisibleRecords\n    );\n  }\n\n  /** -- */\n  refreshWidthControls() {\n    if (!this.rd.codeBy.sort) return;\n\n    var w_Rank = this.list_showRank.is(true) ? Base.recordRankWidth : 0;\n    var w_sortCol = this.list_sortColWidth.get();\n    var w_sortViz = this.list_sortVizWidth.get();\n    var w_sparkLine = this.list_sparklineVizWidth.get()\n      ? this.list_sparklineVizWidth.get() + 8\n      : 0;\n\n    this.DOM.adjustSparklineVizWidth?.style(\n      \"transform\",\n      `translateX(${w_Rank + w_sparkLine}px`\n    );\n    this.DOM.adjustSortColumnWidth?.style(\n      \"transform\",\n      `translateX(${w_Rank + w_sparkLine + w_sortCol}px)`\n    );\n    this.DOM.adjustSortVizWidth?.style(\n      \"transform\",\n      `translateX(${w_Rank + w_sparkLine + w_sortCol + w_sortViz}px)`\n    );\n\n    var w = Math.max(\n      150,\n      Math.min(500, w_sparkLine + w_sortCol + w_sortViz + 2)\n    ); // 2 pixel: margin\n    if (this.list_ViewType.is(\"Grid\")) {\n      w = 200;\n    }\n\n    this.DOM.sortControlGroup?.select(\".choices\").style(\"width\", w + \"px\");\n  }\n\n  /** -- */\n  refreshSortVizScale() {\n    var attrib = this.sortAttrib;\n    if (!(attrib instanceof Attrib_Numeric)) {\n      return; // invalid if not sorting using numeric attribute\n    }\n\n    this.listSortVizScale = d3\n      .scaleLinear()\n      .range([0, this.list_sortVizWidth.get()]);\n\n    if (attrib.isPercentageUnit()) {\n      // always 0-100 if percentage unit\n      this.listSortVizScale.domain([0, 100]);\n      //\n    } else if (this.list_sortVizRange.is(\"dynamic\")) {\n      // dynamic - based on filtered data\n      var [minV, maxV] = d3.extent(this.browser.records, (record) => {\n        return record.filteredOut\n          ? null\n          : this.sortAttrib.getRecordValue(record);\n      });\n      this.listSortVizScale.domain([Math.min(0, minV), Math.max(0, maxV)]);\n      //\n    } else if (this.list_sortVizRange.is(\"static\")) {\n      // static - based on original domain\n      this.listSortVizScale.domain(this.sortAttrib.rangeOrg);\n    }\n\n    this.refreshSortViz();\n  }\n\n  /** -- */\n  refreshSelect_Compare(cT: CompareType = null, status: boolean = false) {\n    if (!this.isComparable()) return;\n\n    // Shows evenly spaces pies next to records, filling in colors of all comparisons\n    var arcGen = d3.arc().innerRadius(10).outerRadius(100).padAngle(0.15);\n\n    var records = this.DOM.kshfRecords.filter((record: Record) => {\n      if (!record.isIncluded) return false;\n      if (!record.DOM.record) return false;\n      if (cT && record.isSelected(cT) !== status) return false;\n      return true;\n    });\n\n    if (cT) {\n      records = records.filter(\n        (record: Record) => record.isSelected(cT) !== status\n      );\n    }\n\n    records.each((record: Record) => {\n      var numPies = record.activeComparisons.length || 1;\n\n      var arcLen = (2 * Math.PI) / numPies;\n\n      var d = d3.select(record.DOM.record);\n      record.activeComparisons.forEach((cT, i) => {\n        d.select(\".glyph_\" + cT).attr(\n          \"d\",\n          arcGen({\n            startAngle: arcLen * i,\n            endAngle: arcLen * (i + 1),\n          })\n        );\n      });\n    });\n  }\n\n  /** -- */\n  refreshSortColumnWidth() {\n    this.refreshWidthControls();\n  }\n\n  /** -- */\n  refreshSortVizWidth() {\n    this.refreshSortVizScale();\n\n    this.DOM.root.classed(\"showSortBars\", this.list_sortVizWidth.get() > 0);\n\n    this.refreshWidthControls();\n  }\n\n  /** -- */\n  refreshSparklineVizWidth() {\n    if (!this.DOM.recordSparklineVizHost) return;\n    this.DOM.recordSparklineVizHost.style(\n      \"display\",\n      this.list_sparklineVizWidth.get() === 0 ? \"none\" : null\n    );\n\n    this.refreshSparklineViz();\n    this.refreshWidthControls();\n  }\n\n  /** -- */\n  refreshRecordVis() {\n    this.updateRecordRanks();\n    this.rd.refreshRecordDOM();\n    this.animateList();\n    this.refreshRecordRanks();\n    this.refreshSortViz();\n    this.refreshSparklineViz();\n  }\n\n  /** -- */\n  refreshSortViz(d3_selection = null) {\n    var dom = d3_selection\n      ? d3_selection.select(\".recordSortViz\")\n      : this.DOM.recordSortViz;\n\n    if (!dom || dom.nodes().length === 0) return;\n\n    if (!(this.sortAttrib instanceof Attrib_Numeric)) {\n      dom.style(\"width\", \"0px\").style(\"left\", null);\n      return;\n    }\n\n    var zeroPos = this.listSortVizScale(0);\n\n    dom.style(\"transform\", (record) => {\n      var v = this.sortAttrib.getRecordValue(record);\n      return `translate(${\n        v >= 0 ? zeroPos : this.listSortVizScale(v)\n      }px, 0px) scale(${\n        v == null ? 0 : Math.abs(this.listSortVizScale(v) - zeroPos)\n      },1)`;\n    });\n  }\n\n  refreshSparklineViz() {\n    var attrib = this.sortAttrib;\n    if (!attrib) return;\n    if (!(attrib instanceof Attrib_Numeric)) return;\n    if (!attrib.hasTimeSeriesParent()) return;\n    if (!this.DOM.recordSparklineVizHost) return;\n\n    this.DOM.recordSparklineVizHost.style(\n      \"display\",\n      this.list_sparklineVizWidth.get() === 0 ? \"none\" : null\n    );\n    if (this.list_sparklineVizWidth.get() === 0) return;\n\n    var ts = attrib.timeseriesParent;\n\n    var timeScale = d3\n      .scaleTime()\n      .domain(ts.timeSeriesScale_Time.domain())\n      .range([0, this.list_sparklineVizWidth.get()]);\n\n    var valueScale = d3\n      .scaleLinear()\n      .domain(ts.timeSeriesScale_Value.domain())\n      .rangeRound([27, 3]);\n\n    var activeTime = attrib.timeKey._time;\n\n    var dotPosition = (record, i, nodes) => {\n      var v = attrib.getRecordValue(record);\n      if (v == null) return \"translate(-1000,0)\"; // not visible\n      var x = timeScale(activeTime);\n      var lineData = ts.getRecordValue(record);\n      valueScale.domain(lineData.extent_Value_raw);\n      var y = valueScale(v);\n      nodes[i].classList[y > 13 ? \"add\" : \"remove\"](\"upper\");\n      return `translate(${x},${y})`;\n    };\n\n    this.DOM.recordSparklineVizHost.selectAll(\"*\").remove();\n    var _ = this.DOM.recordSparklineVizHost\n      .append(\"svg\")\n      .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n      .on(\"mouseleave\", (event) => {\n        d3.select(event.currentTarget.children[1]).attr(\n          \"transform\",\n          dotPosition\n        );\n      })\n      .on(\"mousemove\", (event) => {\n        var _time = timeScale.invert(d3.pointer(event, event.currentTarget)[0]);\n        var currentDif = 9999999999999; // large number\n        var nearestTimeKey = ts.timeKeys[0];\n        ts.timeKeys.some((_key) => {\n          // _keys are sorted from early to late\n          var timeDif = Math.abs(+_key._time - +_time);\n          if (timeDif > currentDif) return true; // difference increases, we had just found the right key\n          currentDif = timeDif;\n          nearestTimeKey = _key;\n          return false;\n        });\n        d3.select(event.currentTarget.children[1]).attr(\n          \"transform\",\n          (record, i, nodes) => {\n            var x = timeScale(nearestTimeKey._time);\n            var _ = ts.getRecordValue(record);\n            valueScale.domain(_.extent_Value_raw);\n            var tk = _._timeseries_.find(\n              (x) => x._time_src === nearestTimeKey._time_src\n            );\n            let v = tk ? tk._value : null;\n            var y = valueScale(v);\n            if (y == null) return \"translate(-100,-100)\"; // No value / no dot / out of screen\n            var DOM = nodes[i];\n            if (y > 13) DOM.classList.add(\"upper\");\n            else DOM.classList.remove(\"upper\");\n            return `translate(${x},${y})`;\n          }\n        );\n        d3.select(event.currentTarget.children[1].children[1]).text(\n          nearestTimeKey._time_src\n        );\n      });\n\n    _.append(\"path\")\n      .attr(\"class\", \"timeline\")\n      .attr(\"d\", (record) => {\n        var lineData = ts.getRecordValue(record);\n        if (!lineData || !lineData.extent_Value_raw) return;\n        valueScale.domain(lineData.extent_Value_raw);\n        return Util.getLineGenerator(\n          timeScale,\n          valueScale\n        )(ts.getRecordValue(record)?._timeseries_);\n      });\n\n    var __ = _.append(\"g\")\n      .attr(\"transform\", dotPosition)\n      .on(\"click\", async (event) => {\n        var _time = timeScale.invert(\n          d3.pointer(event, event.currentTarget.parentNode)[0]\n        );\n        var currentDif = 9999999999999; // large number\n        var nearestTimeKey = ts.timeKeys[0];\n        ts.timeKeys.some((_key) => {\n          // _keys are sorted from early to late\n          var timeDif = Math.abs(+_key._time - _time);\n          if (timeDif > currentDif) return true; // difference increases, we had just found the right key\n          currentDif = timeDif;\n          nearestTimeKey = _key;\n          return false;\n        });\n        await this.rd.currentTimeKey.set(nearestTimeKey);\n      });\n\n    __.append(\"circle\").attr(\"class\", \"activeDot\").attr(\"r\", 3);\n    __.append(\"text\")\n      .attr(\"class\", \"timekeyText\")\n      .attr(\"y\", 15)\n      .text(attrib.timeKey._time_src);\n  }\n\n  animatedList: boolean = false; // TEMP\n  animatedRecordHeight: 40;\n\n  /** -- */\n  animateList() {\n    if (!this.animatedList) return;\n    this.DOM.recordGroup_List.classed(\"animatedList\", true);\n    this.DOM.kshfRecords.style(\n      \"transform\",\n      (record) =>\n        `translateY(${record.recordRank_Unique * this.animatedRecordHeight}px)`\n    );\n  }\n\n  /** -- */\n  refreshRecordDOMOrder() {\n    if (!this.animatedList) {\n      this.DOM.kshfRecords = this.DOM.recordGroup\n        .selectAll(\".kshfRecord\")\n        .data(this.browser.records, (record) => record.id)\n        .order();\n    }\n    Util.scrollToPos_do(this.DOM.recordGroup, 0);\n    this.animateList();\n  }\n\n  /** -- */\n  refreshSortingLabels(d3_selection = null) {\n    if (!this.sortAttrib) return;\n    var sortLabel = this.sortAttrib.sortLabel;\n    var dom = d3_selection\n      ? d3_selection.selectAll(\".recordSortValue\")\n      : this.DOM.recordSortValue;\n    if (!dom) return;\n    dom.html((record) => {\n      var v = sortLabel.call(this, record);\n      return v === \"\" || v === null || v === \"NaN\" ? \"N/A\" : v;\n    });\n  }\n\n  /** -- */\n  updateAfterFilter() {\n    this.DOM.recordGroup.node().scrollTop = 0;\n    if (this.list_sortVizRange.is(\"dynamic\")) {\n      this.refreshSortVizScale();\n    }\n    this.refreshRecordVis();\n  }\n\n  /** -- */\n  updateRecordSortScale() {\n    this.DOM.root.attr(\n      \"sortAttribType\",\n      this.sortAttrib instanceof Attrib_Numeric ? \"numeric\" : \"time\"\n    );\n    this.DOM.root.classed(\n      \"sortAttribOnTimeseries\",\n      (this.sortAttrib instanceof Attrib_Numeric &&\n        this.sortAttrib.timeseriesParent?.timeKeys.length > 1) ||\n        null\n    );\n  }\n\n  refreshAttribUnitName(attrib: Attrib) {\n    if (\n      attrib === this.sortAttrib ||\n      (this.sortAttrib instanceof Attrib_Numeric &&\n        attrib === this.sortAttrib.timeseriesParent)\n    ) {\n      this.refreshSortingLabels();\n    }\n  }\n\n  // ********************************************************************\n  // No-op's\n  // ********************************************************************\n\n  refreshViewSize(_delayMS: number): void {}\n}\n","import noUiSlider from \"nouislider/dist/nouislider.mjs\";\nimport \"nouislider/dist/nouislider.css\";\nimport { DateTime } from \"luxon/build/es6/luxon\";\n\nimport { select } from \"./d3_select\";\nimport { scaleLinear, scaleSqrt, scaleThreshold, scaleTime } from \"d3-scale\";\nimport { max, extent, quantile } from \"d3-array\";\nimport { easePolyInOut } from \"d3-ease\";\nimport { format } from \"d3-format\";\nimport { hsl } from \"d3-color\";\nimport { arc } from \"d3-shape\";\n\nimport { TimeData, TimeKey } from \"./TimeSeriesData\";\n\nimport { Filter_Record, Filter_Text } from \"./Filter\";\nimport { Config } from \"./Config\";\nimport { Util } from \"./Util\";\nimport { i18n } from \"./i18n\";\nimport { Modal } from \"./UI/Modal\";\nimport { AttribDropdown } from \"./UI/AttribDropdown\";\nimport { ConfigPanel } from \"./UI/ConfigPanel\";\nimport { Browser, ColorThemeType } from \"./Browser\";\nimport { Base } from \"./Base\";\nimport { Aggregate_PointCluster, Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\n\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Attrib } from \"./Attrib\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\n\nimport { Record } from \"./Record\";\nimport { RecordView } from \"./RecordView\";\nimport { RecordView_Timeseries } from \"./RecordView_Timeseries\";\nimport { RecordView_Map } from \"./RecordView_Map\";\nimport { RecordView_Scatter } from \"./RecordView_Scatter\";\nimport { RecordView_List } from \"./RecordView_List\";\n\nimport {\n  CompareType,\n  IntervalT,\n  RecordDisplayType,\n  RecordVisCoding,\n} from \"./Types\";\n\nconst d3 = {\n  select,\n  scaleLinear,\n  scaleSqrt,\n  scaleThreshold,\n  scaleTime,\n  max,\n  extent,\n  quantile,\n  easePolyInOut,\n  format,\n  hsl,\n  arc,\n};\n\ndeclare let L: any;\n\n/** -- */\nexport class RecordDisplay {\n  readonly browser: Browser;\n\n  // ********************************************************************\n  // record vis mapping attributes\n  // ********************************************************************\n\n  codeBy: {\n    text: Attrib_Categorical;\n    textBrief: Attrib_Categorical;\n    // numeric\n    sort: Attrib_Interval<IntervalT>;\n    scatterX: Attrib_Numeric;\n    scatterY: Attrib_Numeric;\n    // if coloring aggregates, can be set to \"_measure_\", whioch links to active measure attrib\n    size: Attrib_Numeric | \"_measure_\";\n    color: Attrib_Numeric | \"_measure_\";\n    // timeseries\n    timeSeries: Attrib_Timeseries;\n    // geo\n    geo: Attrib_RecordGeo;\n  } = {\n    text: null,\n    textBrief: null,\n    sort: null,\n    scatterX: null,\n    scatterY: null,\n    size: null,\n    color: null,\n    timeSeries: null,\n    geo: null,\n  };\n\n  // ********************************************************************\n  // Color control (shared)\n  // ********************************************************************\n\n  invertedColorTheme: boolean = false;\n  recordColorStepTicks: boolean = false;\n  recordColorScale: any = null;\n  recordColorScaleTicks: any = null;\n  mapColorScalePos: any = null;\n\n  // ********************************************************************\n  // Time keys / current key (used for synchronizing time keys)\n  // ********************************************************************\n\n  timeKeys: TimeKey[] = [];\n  currentTimeKey: Config<TimeKey>;\n  timeKeySlider: any;\n  timeKeySlider_PauseUpdate: boolean = true;\n\n  // ********************************************************************\n  // Point-based records\n  // ********************************************************************\n\n  recordPointSize: Config<number>;\n  recordRadiusScale: any;\n  recordDrawArc: any;\n  drawArc: any;\n\n  // ********************************************************************\n  // ...\n  // ********************************************************************\n\n  // general text filter (on text attribute)\n  textFilter: Filter_Text = null;\n  // record filter: to filter out individual records\n  recordFilter: Filter_Record = null;\n\n  collapsed: boolean = false;\n\n  DOM: { [index: string]: any } = {};\n\n  View: RecordView; // TODO\n  Views: { [index: string]: RecordView } = {};\n\n  config: any; // TODO\n\n  recordConfigPanel: ConfigPanel; // TODO\n\n  configs: { [index: string]: Config<any> } = {};\n\n  visMouseMode: \"pan\" | \"draw\" | \"filter\" = \"pan\";\n\n  async setView(_type: RecordDisplayType) {\n    if (_type === \"none\") {\n      this.View = null;\n      return;\n    }\n\n    // Create the view object if it does not exist.\n    if (!this.Views[_type]) {\n      var recordDisplayOptions = this.browser.options.recordDisplay || {};\n      if (_type === \"list\") {\n        this.Views[_type] = new RecordView_List(this, recordDisplayOptions);\n      } else if (_type === \"map\") {\n        this.Views[_type] = new RecordView_Map(this, recordDisplayOptions);\n      } else if (_type === \"scatter\") {\n        this.Views[_type] = new RecordView_Scatter(this, recordDisplayOptions);\n      } else if (_type === \"timeseries\") {\n        this.Views[_type] = new RecordView_Timeseries(\n          this,\n          recordDisplayOptions\n        );\n      }\n    }\n\n    this.View = this.Views[_type];\n\n    if (!this.codeBy.text) {\n      var potentials = this.browser.attribs.filter(\n        (attrib) => attrib instanceof Attrib_Categorical\n      ) as Attrib_Categorical[];\n\n      if (potentials.length === 0) {\n        throw new Error(\"Data must have at least one categorical attribute.\");\n      }\n\n      // find the categorical attribute with most number of categories (i.e. most unique)\n      var mostUnique = potentials[0];\n      potentials.forEach((catAttr) => {\n        if (mostUnique._aggrs.length < catAttr._aggrs.length) {\n          mostUnique = catAttr;\n        }\n      });\n\n      this.codeBy.text = mostUnique;\n    }\n\n    this.recordConfigPanel.hide();\n\n    await this.View.initView_DOM();\n\n    await this.View.prepareAttribs();\n\n    this.refreshViewAsOptions();\n\n    this.View.initView();\n\n    this.View.initialized = true;\n\n    this.View.updateRecordVisibility();\n\n    this.refreshWidth();\n    this.View.refreshViewSize(10);\n  }\n\n  /** -- */\n  constructor(browser: Browser, config) {\n    this.browser = browser;\n\n    this.recordFilter = new Filter_Record(this.browser);\n\n    this.config = Object.assign({}, config);\n\n    if (this.config.mapUsePins !== false) {\n      this.config.mapUsePins = true;\n    }\n\n    this.recordPointSize = new Config<number>({\n      cfgClass: \"recordPointSize\",\n      cfgTitle: \"Point Size\",\n      iconClass: \"fa fa-dot\",\n      UI: { disabled: true },\n      default: Base.defaultRecordPointSize,\n      parent: this,\n      helparticle: \"5e8907cf2c7d3a7e9aea6499\",\n      preSet: async (v) => Math.max(0.5, Math.min(v, Base.maxRecordPointSize)),\n      onSet: async () => {\n        if (!this.recordPointSize) return;\n        this.updateRecordSizeScale();\n      },\n    });\n\n    this.currentTimeKey = new Config<TimeKey>({\n      cfgClass: \"currentTimeKey\",\n      cfgTitle: \"Focused Time Key\",\n      iconClass: \"fa fa-arrows-v\",\n      default: null,\n      parent: this,\n      UI: { disabled: true },\n      helparticle: \"5b37053a2c7d3a0fa9a3a30c\",\n      onRefreshDOM: () => {\n        if (!this.DOM.root) return;\n        this.DOM.root.classed(\"hasTimeKey\", this.hasTimeKey);\n\n        if (!this.currentTimeKey.get()) return;\n        if (!this.DOM.timeAnimation) return;\n        if (!this.hasTimeKey) return;\n\n        this.DOM.timeAnimation\n          .select(\".rangeTick-min\")\n          .text(this.timeKeys[0]._time_src);\n        this.DOM.timeAnimation\n          .select(\".rangeTick-max\")\n          .text(this.timeKeys[this.timeKeys.length - 1]._time_src);\n        this.DOM.timeAnimation\n          .select(\".rangeTick-cur\")\n          .text(this.currentTimeKey.get()._time_src)\n          .style(\n            \"left\",\n            (100 * this.currentTimeKey.get()._index) /\n              (this.timeKeys.length - 1) +\n              \"%\"\n          );\n\n        this.timeKeySlider_PauseUpdate = true;\n        this.timeKeySlider.updateOptions({\n          range: {\n            min: 0,\n            max: Math.max(1, this.timeKeys.length - 1),\n          },\n        });\n        this.timeKeySlider.setHandle(0, this.currentTimeKey.get()._index, false);\n        this.timeKeySlider_PauseUpdate = false;\n\n        this.DOM.timeAnimation\n          .select(\".timeKeySelect\")\n          .selectAll(\"option\")\n          .data(this.timeKeys, (d) => d._time)\n          .join(\n            (enter) => enter.append(\"option\").text((d) => d._time_src),\n            (update) => update,\n            (exit) => exit.remove()\n          )\n          .attr(\"selected\", (timeKey) =>\n            timeKey._time_src === this.currentTimeKey.get()._time_src\n              ? true\n              : null\n          );\n      },\n      preSet: async (v, obj) => {\n        if (v === \"previous\" && obj._value) {\n          v = this.timeKeys[obj._value._index - 1];\n        }\n\n        if (v === \"next\" && obj._value) {\n          v = this.timeKeys[obj._value._index + 1];\n        }\n\n        if (!v || !v._time_src) return;\n\n        // _index may have been updated. Better to refresh\n        v = this.timeKeys.find((_) => _._time_src === v._time_src);\n\n        if (!v) return;\n        return v;\n      },\n      onSet: async (v: TimeKey) => {\n        if (!v) return;\n\n        // sync timekey across all vis attributes\n        this.skipRefreshRecordVis = true;\n\n        (\n          [\"sort\", \"scatterX\", \"scatterY\", \"color\", \"size\"] as RecordVisCoding[]\n        ).forEach((_type) => {\n          var targetAttrib = this.codeBy[_type];\n          if (\n            targetAttrib instanceof Attrib_Numeric &&\n            targetAttrib.timeKey?._time_src !== v._time_src\n          ) {\n            // record visualizations are updated through these setting updates\n            this.setAttrib(\n              _type,\n              targetAttrib.timeseriesParent.getTimepointSummary({\n                _time_src: v._time_src,\n              })\n            );\n          }\n        });\n\n        this.skipRefreshRecordVis = false;\n\n        this.refreshRecordVis(); // refresh visualization ONCE after all attributes are updated.\n\n        // update measure attrib to use the same time key\n        if (this.measureSummary?.hasTimeSeriesParent()) {\n          var newMeasureSummary =\n            this.measureSummary.timeseriesParent.getTimepointSummary(v);\n          if (newMeasureSummary)\n            await this.browser.measureSummary.set(newMeasureSummary);\n        }\n\n        // timeKeyStep timeKeyNext\n        this.DOM.timeAnimation\n          .select(\".timeKeyPrev\")\n          .classed(\"active\", v._time_src !== this.timeKeys[0]._time_src);\n        this.DOM.timeAnimation\n          .select(\".timeKeyNext\")\n          .classed(\n            \"active\",\n            v._time_src !== this.timeKeys[this.timeKeys.length - 1]._time_src\n          );\n      },\n    });\n\n    [\"currentTimeKey\", \"recordPointSize\"].forEach((t) => {\n      this.configs[t] = this[t];\n      this[t].val = config[t];\n    });\n\n    if (config.timeSeriesAnnotations) {\n      var _converted = [];\n      Object.keys(config.timeSeriesAnnotations).forEach((_k) => {\n        var _v = config.timeSeriesAnnotations[_k];\n        var _t = DateTime.fromFormat(_v, DateTime.DATE_SHORT, { zone: \"UTC\" });\n        if (_t.isValid) {\n          _converted.push({ _time: _t.toJSDate(), _time_src: _k, _text: _v });\n        }\n      });\n      this.config.timeSeriesAnnotations = _converted;\n    }\n\n    config.timeseriesWidth = config.timeseriesWidth || 400;\n  }\n\n  /** Shortcut to access browser record chart type */\n  get viewRecAs(): RecordDisplayType {\n    return this.browser.recordChartType.get();\n  }\n\n  kshfRecords_Type: RecordDisplayType = \"none\";\n\n  async initialize() {\n    \"use strict\";\n    var config = this.config;\n\n    // **********************************************************************************\n    // **********************************************************************************\n    // **********************************************************************************\n\n    this.DOM.root = this.browser.DOM.root\n      .select(\".recordDisplay\")\n      .attr(\"visMouseMode\", this.visMouseMode);\n\n    this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"dropZone\")\n      .on(\"mouseenter\", function () {\n        this.classList.add(\"onReadyToDrop\");\n      })\n      .on(\"mouseleave\", function () {\n        this.classList.remove(\"onReadyToDrop\");\n      })\n      .on(\"mouseup\", async () => {\n        if (this.viewRecAs !== \"none\") {\n          return;\n        }\n        var attrib = this.browser.movedAttrib;\n        if (!attrib) return;\n\n        if (attrib instanceof Attrib_Categorical) {\n          await this.setAttrib(\"text\", attrib);\n          if (this.viewRecAs === \"none\") {\n            await this.browser.recordChartType.set(\"list\");\n          }\n        } else if (attrib instanceof Attrib_Timeseries) {\n          await this.setAttrib(\"timeSeries\", attrib);\n          await this.browser.recordChartType.set(\"timeseries\");\n          //\n        } else if (attrib instanceof Attrib_RecordGeo) {\n          await this.setAttrib(\"geo\", attrib);\n          await this.browser.recordChartType.set(\"map\");\n          //\n        } else if (attrib instanceof Attrib_Interval) {\n          await this.setAttrib(\"sort\", attrib);\n          if (this.viewRecAs === \"none\") {\n            await this.browser.recordChartType.set(\"list\");\n          }\n        }\n\n        this.browser.updateLayout();\n      })\n      .call((x) => {\n        x.append(\"div\").attr(\"class\", \"dropIcon fa fa-list-ul\");\n        x.append(\"span\")\n          .attr(\"class\", \"dropZoneText\")\n          .text(i18n[\"Add Record Panel\"]);\n      });\n\n    this.initDOM_RecordDisplayHeader();\n\n    // **************************************************\n    // TIME ANIMATION\n    this.DOM.timeAnimation = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"timeAnimation\");\n\n    this.DOM.recordDisplayWrapper = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"recordDisplayWrapper\");\n\n    this.initDOM_CustomControls();\n\n    this.recordConfigPanel = new ConfigPanel(\n      this.DOM.root,\n      \"Record Chart Configuration\",\n      \"recordDisplayConfig\",\n      Object.values(this.configs),\n      this.browser,\n      this.DOM.recordDisplayConfigButton\n    );\n\n    // always set record text attribute\n    await this.setAttrib(\"text\", config.textBy);\n    if (!this.codeBy.text) {\n      await this.setAttrib(\"text\", this.browser.idSummaryName);\n    }\n    await this.setAttrib(\"textBrief\", config.textBriefBy);\n\n    // *************************************************************************\n    // Initialize config options\n\n    for (var v in [\n      \"sort\",\n      \"scatterX\",\n      \"scatterY\",\n      \"color\",\n      \"size\",\n      \"link\",\n      \"timeSeries\",\n    ]) {\n      var _attrib: string = config[v + \"By\"];\n      if (_attrib) await this.setAttrib(v as RecordVisCoding, _attrib);\n    }\n\n    this.textFilter = new Filter_Text(this.browser);\n\n    if (config.colorTheme) {\n      this.setRecordColorTheme(config.colorTheme);\n    }\n\n    if (config.recordPointSize) {\n      await this.recordPointSize.set(config.recordPointSize);\n    }\n\n    if (config.colorInvert) {\n      this.invertColorTheme(true);\n    }\n\n    if (config.filter) {\n      this.recordFilter.importFilter(config.filter);\n    } else {\n      this.recordFilter.clearFilter();\n    }\n    \n    config.viewAs ??= \"none\";\n\n    if (config.viewAs !== this.viewRecAs) {\n      await this.browser.recordChartType.set(config.viewAs);\n    }\n\n    if (config.collapsed) {\n      this.collapseRecordViewSummary(true);\n    } else {\n      this.collapseRecordViewSummary(false);\n    }\n  }\n\n  /** -- */\n  refreshConfigs() {\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\n  }\n\n  curWidth: number;\n  curHeight: number;\n\n  setHeight(v) {\n    var oldHeight = this.curHeight;\n    this.curHeight = v;\n    if (this.viewRecAs === \"none\") return;\n    if (this.curHeight !== oldHeight) this.View.refreshViewSize(0);\n  }\n\n  setWidth(v) {\n    var oldWidth = this.curWidth;\n    this.curWidth = v;\n    if (this.viewRecAs === \"none\") return;\n    if (this.curWidth !== oldWidth) {\n      this.refreshWidth();\n      this.View.refreshViewSize(0);\n    }\n  }\n\n  refreshWidth() {\n    this.DOM.root\n      ?.classed(\"narrow\", this.curWidth < 500)\n      .classed(\"wide\", this.curWidth > 700)\n      .style(\"width\", this.curWidth + \"px\");\n  }\n\n  /** -- */\n  getNumOfColorScaleBins() {\n    return this.recordColorScale.range().length - 2;\n  }\n\n  /** -- */\n  get textAttrib_Brief(): Attrib_Categorical {\n    return this.codeBy.textBrief || this.codeBy.text;\n  }\n\n  /** -- */\n  get height_Header() {\n    if (!this.DOM.recordDisplayHeader) return 0;\n    return this.DOM.recordDisplayHeader.node().offsetHeight;\n  }\n\n  /** -- */\n  refreshCompareLegend() {\n    if (!this.DOM.colorCompareGroup) return;\n\n    this.DOM.colorCompareGroup.classed(\"active\", !!this.browser.comparedAttrib);\n\n    if (\n      !this.browser.comparedAttrib ||\n      !this.browser.comparedAttrib.attribName\n    ) {\n      return;\n    }\n\n    var str =\n      \"<div class='comparedSummaryName'>\" +\n      this.browser.comparedAttrib.attribNameHTML +\n      \"</div>\";\n    str += \"<div class='compareBlocks'>\";\n    this.browser.activeComparisons.forEach((cT: CompareType) => {\n      str += `<div class='compareBlock'><span class='colorBox bg_${cT}'></span> \n        <span class='theText'>${this.browser.selectedAggrs[cT].label}</span></div>`;\n    });\n\n    // \"Other group\"\n    if (\n      this.browser.records.filter(\n        // TODO: depending on view type certain records may be excluded\n        // Example: Map: records with no geo. Timeseries : records with no timeseries, etc.\n        (x: Record) => !x.isSelected() && x.isIncluded\n      ).length\n    ) {\n      str +=\n        \"<div class='compareBlock'><span class='colorBox bg_Active'></span> \" +\n        `<span class='theText'>(${this.browser.otherNameInCompare})</span></div>`;\n    }\n    str += \"</div>\";\n    this.DOM.colorCompareGroup.html(str).classed(\"active\", true);\n  }\n\n  getColorValue(v) {\n    if (this.codeBy.color instanceof Attrib_Numeric) {\n      return this.codeBy.color.getFormattedValue(v);\n    } else {\n      return v;\n    }\n  }\n\n  /** -- */\n  refreshColorLegend() {\n    if (!this.DOM.mapColorScaleGroup) return;\n\n    this.DOM.root\n      .select(\".editColorTheme.fa-adjust\")\n      .classed(\"rotatedY\", this.invertedColorTheme);\n\n    this.DOM.root.classed(\"usesColorAttrib\", this.codeBy.color != null);\n\n    if (!this.recordColorScale) return;\n    if (!this.codeBy.color) return;\n\n    var colorBins = this.recordColorScale.range();\n    // remove first and last color elements\n    colorBins = colorBins.slice(1, colorBins.length - 1);\n\n    var logScale = false;\n    if (this.codeBy.color === \"_measure_\") {\n      if (this.measureSummary?.isValueScale_Log) {\n        logScale = true;\n      }\n    } else {\n      if (this.codeBy.color.isValueScale_Log) {\n        logScale = true;\n      }\n    }\n\n    this.mapColorScalePos = Util.getD3Scale(logScale);\n\n    var totalDomain = this.recordColorScale.domain();\n    this.mapColorScalePos\n      .domain([totalDomain[0], totalDomain[totalDomain.length - 1]])\n      .range([0, 100]);\n\n    this.DOM.mapColorScaleBins.selectAll(\".mapColorThemeBin\").remove();\n    this.DOM.mapColorScaleBins\n      .selectAll(\".mapColorThemeBin\")\n      .data(colorBins)\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", \"mapColorThemeBin\")\n      .tooltip(\n        (_) => {\n          var d = this.recordColorScale.invertExtent(_);\n          return this.recordColorStepTicks\n            ? d[0]\n            : this.getColorValue(d[0]) + \" &mdash; \" + this.getColorValue(d[1]);\n        },\n        {\n          placement: \"bottom\",\n        }\n      )\n      .style(\"background-color\", (d) => d)\n      .style(\"transform\", (d, i) => {\n        var d = this.recordColorScale.invertExtent(d);\n        var left = this.mapColorScalePos(d[0]);\n        var right = this.mapColorScalePos(d[1]);\n        return `translateX(${left}%) scaleX(${Math.abs(right - left) / 100})`;\n      });\n\n    this.refreshColorLegendTicks();\n  }\n\n  /** -- */\n  refreshColorLegendTicks() {\n    if (!this.codeBy.color) return;\n    if (!this.recordColorScaleTicks) return;\n\n    var legendWidth = this.DOM.mapColorScaleLabels.node().offsetWidth;\n    var lastTickPos = -200;\n\n    var tickWidthGap = 30;\n\n    let c: Attrib_Numeric = null;\n\n    if (this.codeBy.color === \"_measure_\") {\n      var attrib = !this.browser.measureFunc_Count && this.measureSummary;\n      if (attrib) {\n        c = attrib;\n        tickWidthGap += attrib.unitName.length * 6;\n      }\n    } else {\n      c = this.codeBy.color;\n      tickWidthGap += this.codeBy.color.unitName.length * 6;\n    }\n\n    var _print = (v) => (c ? c.printAbbr(v) : v);\n\n    var ticks = this.recordColorScaleTicks.slice();\n    var offset = 0;\n    if (this.recordColorStepTicks) {\n      ticks.pop();\n      offset = 50 / ticks.length;\n    }\n\n    this.DOM.mapColorScaleLabels.selectAll(\".mapColorScaleLabel\").remove();\n    this.DOM.mapColorScaleLabels\n      .selectAll(\".mapColorScaleLabel\")\n      .data(ticks)\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", \"mapColorScaleLabel\")\n      .style(\"left\", (i) => offset + this.mapColorScalePos(i) + \"%\")\n      .classed(\"hidden\", (i) => {\n        var curTickPos = (legendWidth * this.mapColorScalePos(i)) / 100;\n        var visible = curTickPos - lastTickPos > tickWidthGap;\n        if (visible) lastTickPos = curTickPos;\n        return !visible;\n      })\n      .call((tick) => {\n        tick\n          .append(\"div\")\n          .attr(\"class\", \"tickLabel\")\n          .html((i) => \"\" + _print(i));\n      });\n  }\n\n  /** -- */\n  invertColorTheme(v = null) {\n    this.invertedColorTheme = v == null ? !this.invertedColorTheme : v;\n    this.updateRecordColorScale();\n  }\n\n  /** -- */\n  setRecordColorTheme(v: ColorThemeType) {\n    this.browser.activeColorTheme = v;\n    this.updateRecordColorScale();\n  }\n\n  /** -- */\n  initDOM_RecordDisplayHeader() {\n    this.DOM.recordDisplayHeader = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"recordDisplayHeader\");\n\n    // Remove record display button\n    this.DOM.removeRecordPanelButton = this.DOM.recordDisplayHeader\n      .append(\"div\")\n      .attr(\"class\", \"removeRecordPanelButton far fa-times-circle\")\n      .tooltip(i18n.RemoveRecordPanel, { placement: \"bottom\" })\n      .on(\"click\", async () => await this.browser.recordChartType.set(\"none\") );\n\n    // Expand record display button\n    this.DOM.recordDisplayHeader\n      .append(\"div\")\n      .attr(\"class\", \"buttonRecordViewExpand far fa-expand-alt\")\n      .tooltip(i18n.OpenSummary, { placement: \"bottom\" })\n      .on(\"click\", () => this.collapseRecordViewSummary(false));\n\n    // Collapse record display button\n    this.DOM.recordDisplayHeader\n      .append(\"div\")\n      .attr(\"class\", \"buttonRecordViewCollapse far fa-compress-alt\")\n      .tooltip(i18n.CollapseSummary, { placement: \"bottom\" })\n      .on(\"click\", () => this.collapseRecordViewSummary(true));\n\n    this.initDOM_GlobalTextSearch();\n\n    // Record Name\n    this.DOM.recordDisplayHeader\n      .append(\"div\")\n      .attr(\"class\", \"recordName recordDisplayName\")\n      .html(this.browser.recordName);\n\n    this.DOM.recordDisplayConfigButton = this.DOM.recordDisplayHeader\n      .append(\"span\")\n      .attr(\"class\", \"recordDisplayConfigButton fal fa-cog\")\n      .tooltip(i18n.Configure)\n      .on(\"click\", (event) => {\n        this.recordConfigPanel.showAtPos(\n          event.target.offsetLeft + 25,\n          event.target.offsetTop + 25\n        );\n      });\n\n    // Change record display view\n    var x = this.DOM.recordDisplayHeader\n      .append(\"span\")\n      .attr(\"class\", \"recordDisplay_ViewGroup\");\n    x.selectAll(\"span.fa\")\n      .data([\n        {\n          v: \"list\",\n          t: i18n.ListButton,\n          i: \"<span class='far fa-list-ul'></span>\",\n        },\n        {\n          v: \"map\",\n          t: i18n.MapButton,\n          i: \"<span class='fal fa-globe'></span>\",\n        },\n        {\n          v: \"node\",\n          t: i18n.NodeButton,\n          i: \"<span class='far fa-share-alt'></span>\",\n        },\n        {\n          v: \"timeseries\",\n          t: i18n.TimeSeriesButton,\n          i: \"<span class='far fa-chart-line'></span>\",\n        },\n        {\n          v: \"scatter\",\n          t: i18n.ScatterButton,\n          i: \"<span class='far fa-chart-scatter'></span>\",\n        },\n      ])\n      .enter()\n      .append(\"span\")\n      .attr(\"class\", (d) => \"recordDisplay_ViewAs_\" + d.v + \" disabled\")\n      .tooltip((_) => i18n.RecordViewTypeTooltip(_.t), { placement: \"bottom\" })\n      .on(\"click\", async (_event, d) => await this.browser.recordChartType.set(d.v) )\n      .html((d) => d.i + \"<span class='ViewTitle'>\" + d.t + \"</span>\");\n  }\n\n  /** -- */\n  initDOM_GlobalTextSearch() {\n    this.DOM.recordTextSearch = this.DOM.recordDisplayHeader\n      .append(\"span\")\n      .attr(\"class\", \"recordTextSearch textSearchBox\");\n\n    this.DOM.recordTextSearch.append(\"span\").attr(\"class\", \"far fa-search\");\n    this.DOM.recordTextSearch\n      .append(\"span\")\n      .attr(\"class\", \"fa fa-times-circle\")\n      .tooltip(i18n.RemoveFilter)\n      .on(\"click\", () => this.textFilter.clearFilter());\n    this.DOM.recordTextSearch\n      .append(\"input\")\n      .attr(\"type\", \"text\")\n      .attr(\"class\", \"textSearchInput\")\n      .tooltip(i18n.TextSearchForRecords)\n      .on(\"keydown\", (event) => event.stopPropagation())\n      .on(\"keypress\", (event) => event.stopPropagation())\n      .on(\"keyup\", (event) => {\n        var dom = event.currentTarget;\n        if (event.key === \"Enter\") {\n          dom.tippy.hide();\n          if (dom.timer) clearTimeout(dom.timer);\n          dom.timer = null;\n          this.textFilter.queryString = dom.value;\n          if (this.textFilter.queryString === \"\") {\n            this.textFilter.clearFilter();\n            return;\n          }\n          this.browser.clearSelect_Compare();\n          this.textFilter.setFiltered();\n          return;\n        }\n        event.stopPropagation();\n      });\n  }\n\n  getMaxSizeScaleRange() {\n    if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\n      return Math.max(\n        10,\n        Math.min(\n          this.recordPointSize.get(),\n          this.codeBy.geo.pointClusterRadius / 2\n        )\n      );\n    } else if (this.codeBy.size instanceof Attrib_Interval) {\n      return this.recordPointSize.get();\n    }\n    throw Error(\"Unexpected status\");\n  }\n\n  getMaxSizeDomainRange(): number {\n    if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\n      return (\n        d3.max(this.codeBy.geo._aggrs, (_: Aggregate_PointCluster) =>\n          _.measure(\"Active\")\n        ) || 1 // || 1: there may be no clusters\n      );\n    } else if (this.codeBy.size instanceof Attrib_Interval) {\n      return this.codeBy.size.valueScale.domain()[1];\n    }\n    throw Error(\"Unexpected status\");\n  }\n\n  /** -- */\n  updateRecordSizeScale() {\n    var constPointSize = Math.max(this.recordPointSize.get(), 4); // const size must be 4 or larger\n\n    this.drawArc = d3\n      .arc()\n      .outerRadius(constPointSize) // fixed radius arc by default\n      .innerRadius(0)\n      .startAngle(0)\n      .endAngle(2 * Math.PI);\n\n    var getArc = (v) => this.drawArc.outerRadius(this.recordRadiusScale(v));\n\n    if (this.codeBy.size === null) {\n      // Constant size, constant shape - both are functions returning constant values\n      this.recordRadiusScale = () => constPointSize;\n      this.recordDrawArc = () => this.drawArc;\n      //\n    } else {\n      this.recordRadiusScale = d3\n        .scaleSqrt()\n        .clamp(false)\n        .range([0, this.getMaxSizeScaleRange() * 2])\n        .domain([0, this.getMaxSizeDomainRange()]);\n\n      if (this.codeBy.size === \"_measure_\" && this.isPointMap()) {\n        // point map using measure as a size attribute\n        this.recordDrawArc = (record) => getArc(record.measure_Self);\n        //\n      } else if (this.codeBy.size instanceof Attrib_Interval) {\n        // point map usig regular numeric size attribute\n        var m = this.codeBy.size;\n        this.recordDrawArc = (record) => {\n          var v = m.template.func.call(record.data, record);\n          // in cases where point would be invisible/negligable, set very small so that it has a path\n          if (isNaN(v) || v == null || (m.isValueScale_Log && v <= 0))\n            v = 0.0001;\n          return getArc(v);\n        };\n      }\n    }\n\n    this.refreshSizeLegend();\n    this.View?.refreshRecordSizes();\n  }\n\n  /** -- */\n  initDOM_CustomControls() {\n    if (this.DOM.visViewControl) return;\n    var me = this;\n\n    var X, _;\n\n    // Scale legend\n    X = this.DOM.recordDisplayWrapper\n      .append(\"span\")\n      .attr(\"class\", \"mapGlyphColorSetting\");\n    this.DOM.mapGlyphColorSetting = X;\n\n    // Record point size\n    var sizeGroup = this.DOM.mapGlyphColorSetting\n      .append(\"div\")\n      .attr(\"class\", \"attribGroup sizeGroup\")\n      .classed(\"active\", this.codeBy.size != null);\n\n    // Gap\n    this.DOM.mapGlyphColorSetting.append(\"div\").attr(\"class\", \"attribGap\");\n\n    // Record color (attrib)\n    this.DOM.colorCompareGroup = this.DOM.mapGlyphColorSetting\n      .append(\"div\")\n      .attr(\"class\", \"colorCompareGroup attribGroup\");\n\n    // Record color (compare)\n    var colorGroup = this.DOM.mapGlyphColorSetting\n      .append(\"div\")\n      .attr(\"class\", \"attribGroup colorGroup\")\n      .classed(\"active\", this.codeBy.color != null);\n\n    // ****************************************************************\n    // ** SIZE ********************************************************\n\n    this.DOM.sizeControlGroup = sizeGroup\n      .append(\"div\")\n      .attr(\"class\", \"sizeControlGroup attribControlGroup\");\n    sizeGroup\n      .append(\"div\")\n      .attr(\"class\", \"dotSizes\")\n      .call((dom) => {\n        dom\n          .append(\"i\")\n          .attr(\"class\", \"dotSize dotSize-expand-alt far fa-plus\")\n          .tooltip(i18n.Larger, { placement: \"top\" })\n          .on(\"click\", async () => {\n            await this.recordPointSize.set(this.recordPointSize.get() * Math.sqrt(2));\n          });\n        dom\n          .append(\"i\")\n          .attr(\"class\", \"dotSize dotSize-compress-alt far fa-minus\")\n          .tooltip(i18n.Smaller, { placement: \"top\" })\n          .on(\"click\", async () => {\n            await this.recordPointSize.set(this.recordPointSize.get() / Math.sqrt(2));\n          });\n      });\n    this.DOM.sizeLegendGroup = sizeGroup\n      .append(\"div\")\n      .attr(\"class\", \"attribLegendGroup sizeLegendGroup\");\n\n    this.DOM.sizeControlGroup\n      .append(\"span\")\n      .attr(\"class\", \"header\")\n      .text(i18n.Size + \" \");\n    this.initDOM_AttribSelect(\"size\");\n\n    // ****************************************************************\n    // ** COLOR *******************************************************\n\n    // Control\n    this.DOM.colorControlGroup = colorGroup\n      .append(\"div\")\n      .attr(\"class\", \"colorControlGroup attribControlGroup\");\n    this.DOM.colorControlGroup\n      .append(\"span\")\n      .attr(\"class\", \"header\")\n      .text(i18n.Color + \" \");\n    this.initDOM_AttribSelect(\"color\");\n\n    this.DOM.mapColorScaleGroup = colorGroup\n      .append(\"div\")\n      .attr(\"class\", \"attribLegendGroup mapColorScaleGroup\");\n\n    // Invert color theme\n    colorGroup\n      .append(\"div\")\n      .attr(\"class\", \"editColorTheme fa fa-paint-brush\")\n      .tooltip(i18n.ChangeColorTheme, { placement: \"left\" })\n      .on(\"click\", (event) => {\n        var addLegend = function (dom) {\n          var _theme = me.browser.activeColorTheme;\n          var _temp = me.browser.colorTheme[_theme];\n          me.browser.colorTheme[_theme] = this.value;\n          var colors = me.browser.colorTheme.getDiscrete(9);\n          me.browser.colorTheme[_theme] = _temp;\n          if (me.invertedColorTheme) colors = colors.reverse();\n\n          d3.select(dom)\n            .append(\"div\")\n            .attr(\"class\", \"colorLegend\")\n            .selectAll(\".colorLegendBox\")\n            .data(colors)\n            .enter()\n            .append(\"span\")\n            .attr(\"class\", \"colorLegendBox\")\n            .style(\"background-color\", (_) => _);\n        };\n\n        Modal.popupMenu(\n          event,\n          {\n            name: \"Color Theme\",\n            items: [\n              {\n                id: \"colorThemeInverse\",\n                name: \"Invert\",\n                iconClass: \"far fa-adjust\",\n                active: this.invertedColorTheme,\n                do: () => this.invertColorTheme(),\n              },\n              {\n                id: \"colorScaleScale\",\n                name: \"BinScale\",\n                iconClass: \"far fa-arrows-h\",\n                when: () =>\n                  this.codeBy.color &&\n                  this.codeBy.color instanceof Attrib_Numeric &&\n                  this.codeBy.color.supportsLogScale(),\n                do: async (_, opt) => {\n                  var attrib = this.codeBy.color as Attrib_Numeric; // checked by when\n                  if (!attrib) return;\n                  if (attrib.timeseriesParent) {\n                    await attrib.timeseriesParent.valueScaleType.set(opt);\n                  } else {\n                    await attrib.valueScaleType.set(opt);\n                  }\n                },\n                options: [\n                  {\n                    name: \"Linear\",\n                    value: \"linear\",\n                    active:\n                      this.codeBy.color instanceof Attrib_Numeric &&\n                      this.codeBy.color.isValueScale_Linear,\n                  },\n                  {\n                    name: \"Log\",\n                    value: \"log\",\n                    active:\n                      this.codeBy.color instanceof Attrib_Numeric &&\n                      !this.codeBy.color.isValueScale_Linear,\n                  },\n                ],\n              },\n              {\n                id: \"colorThemeSwitch\",\n                name: \"Switch (Seq.  Div.)\",\n                iconClass: \"far fa-exchange\",\n                do: () =>\n                  this.setRecordColorTheme(\n                    this.browser.activeColorTheme === \"sequential\"\n                      ? \"diverging\"\n                      : \"sequential\"\n                  ),\n              },\n              {\n                id: \"colorThemeSequential\",\n                name: \"Sequential\",\n                iconClass: \"far fa-long-arrow-right\",\n                do: (_, opt) => {\n                  this.browser.colorTheme.sequential = opt;\n                  this.setRecordColorTheme(\"sequential\");\n                },\n                // todo: highlight the active one\n                options: [\n                  { name: \"Greys\", value: \"Greys\", onName: addLegend },\n                  { name: \"Blues\", value: \"Blues\", onName: addLegend },\n                  { name: \"Green-Blue\", value: \"GnBu\", onName: addLegend },\n                  {\n                    name: \"Yellow-Green-Blue\",\n                    value: \"YlGnBu\",\n                    onName: addLegend,\n                  },\n                  { name: \"Greens\", value: \"Greens\", onName: addLegend },\n                  { name: \"Yellow-Green\", value: \"YlGn\", onName: addLegend },\n                  { name: \"Blue-Green\", value: \"BuGn\", onName: addLegend },\n                  {\n                    name: \"Purple-Blue-Green\",\n                    value: \"PuBuGn\",\n                    onName: addLegend,\n                  },\n                  { name: \"Purple-Blue\", value: \"PuBu\", onName: addLegend },\n                  { name: \"Purples\", value: \"Purples\", onName: addLegend },\n                  { name: \"Blue-Purple\", value: \"BuPu\", onName: addLegend },\n                  { name: \"Purple-Red\", value: \"PuRd\", onName: addLegend },\n\n                  { name: \"Oranges\", value: \"Oranges\", onName: addLegend },\n                  { name: \"Orange-Red\", value: \"OrRd\", onName: addLegend },\n                  {\n                    name: \"Yellow-Orange-Red\",\n                    value: \"YlOrRd\",\n                    onName: addLegend,\n                  },\n                  {\n                    name: \"Yellow-Orange-Brown\",\n                    value: \"YlOrBr\",\n                    onName: addLegend,\n                  },\n\n                  { name: \"Inferno\", value: \"Inferno\", onName: addLegend }, // no discrete version\n                  { name: \"Magma\", value: \"Magma\", onName: addLegend }, // no discrete version\n                  { name: \"Plasma\", value: \"Plasma\", onName: addLegend }, // no discrete version\n\n                  { name: \"Cividis\", value: \"Cividis\", onName: addLegend }, // no discrete version\n                  { name: \"Viridis\", value: \"Viridis\", onName: addLegend }, // no discrete version\n                  { name: \"Warm\", value: \"Warm\", onName: addLegend }, // no discrete version\n                  { name: \"Cool\", value: \"Cool\", onName: addLegend }, // no discrete version\n                ],\n              },\n              {\n                id: \"colorThemeDiverging\",\n                name: \"Diverging\",\n                iconClass: \"far fa-arrows-h\",\n                do: (_, opt) => {\n                  this.browser.colorTheme.diverging = opt;\n                  this.setRecordColorTheme(\"diverging\");\n                },\n                options: [\n                  { name: \"Spectral\", value: \"Spectral\", onName: addLegend },\n                  { name: \"Brown-Green\", value: \"BrBG\", onName: addLegend },\n                  { name: \"Purple-Green\", value: \"PRGn\", onName: addLegend },\n                  {\n                    name: \"Pink-Yellow-Green\",\n                    value: \"PiYG\",\n                    onName: addLegend,\n                  },\n                  { name: \"Purple-Orange\", value: \"PuOr\", onName: addLegend },\n                  { name: \"Red-Blue\", value: \"RdBu\", onName: addLegend },\n                  { name: \"Red-Gray\", value: \"RdGy\", onName: addLegend },\n                  {\n                    name: \"Red-Yellow-Blue\",\n                    value: \"RdYlBu\",\n                    onName: addLegend,\n                  },\n                  {\n                    name: \"Red-Yellow-Green\",\n                    value: \"RdYlGn\",\n                    onName: addLegend,\n                  },\n                ],\n              },\n            ],\n          },\n          null,\n          { placement: \"top\" }\n        );\n      });\n\n    // Scale\n    this.DOM.mapColorHighlightedValue = this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"mapColorHighlightedValue fa fa-caret-down\");\n    this.DOM.mapColorScaleBins = this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"mapColorScaleBins\");\n    this.DOM.mapColorScaleLabels = this.DOM.mapColorScaleGroup\n      .append(\"div\")\n      .attr(\"class\", \"mapColorScaleLabels\");\n\n    // play/pause buttons\n    var x = this.DOM.timeAnimation\n      .append(\"span\")\n      .attr(\"class\", \"detailPlay attribDetailPlay\");\n    x.append(\"i\")\n      .attr(\"class\", \"fa fa-play-circle\")\n      .tooltip(i18n.AutoPlay)\n      .on(\"click\", (event) =>\n        this.startTimeseriesAnimation(event.shiftKey ? 5 : 1)\n      )\n      .on(\"mouseover\", () => {\n        if (this.View instanceof RecordView_Timeseries) {\n          this.View.timeseriesWiden();\n        }\n      })\n      .on(\"mouseout\", () => {\n        if (this.View instanceof RecordView_Timeseries) {\n          this.View.timeseriesWidenOff();\n        }\n      });\n    x.append(\"i\")\n      .attr(\"class\", \"fa fa-pause-circle\")\n      .tooltip(i18n.StopAutoPlay)\n      .on(\"click\", () => this.stopTimeseriesAnimation());\n\n    this.DOM.timeAnimation\n      .append(\"div\")\n      .attr(\"class\", \"timeKeyStep timeKeyPrev\")\n      .tooltip(i18n.Previous)\n      .on(\"click\", () => this.currentTimeKey.set(this.timeKeys[this.currentTimeKey.get()._index - 1]) )\n      .append(\"span\")\n      .attr(\"class\", \"fa fa-caret-left\");\n\n    this.DOM.timeAnimation\n      .append(\"select\")\n      .attr(\"class\", \"timeKeySelect\")\n      .on(\"change\", async (event) => await this.currentTimeKey.set(event.currentTarget.selectedOptions[0].__data__) );\n\n    this.DOM.timeAnimation\n      .append(\"div\")\n      .attr(\"class\", \"timeKeyStep timeKeyNext\")\n      .tooltip(i18n.Next)\n      .on(\"click\", async () => await this.currentTimeKey.set(this.timeKeys[this.currentTimeKey.get()._index + 1]) )\n      .append(\"span\")\n      .attr(\"class\", \"fa fa-caret-right\");\n\n    this.DOM.timeAnimation\n      .append(\"div\")\n      .attr(\"class\", \"timeKeyRange\")\n      .call((timeKeyRange) => {\n        timeKeyRange.append(\"span\").attr(\"class\", \"rangeTick-min\").text(\"min\");\n\n        // SINGLE-KEY SLIDER (MAP, SCATTERPLOT, LIST)\n        var attribDetailRange = timeKeyRange\n          .append(\"div\")\n          .attr(\"class\", \"attribDetailRange\");\n\n        noUiSlider.create(attribDetailRange.node(), {\n          connect: true,\n          step: 1,\n          behaviour: \"tap-drag\",\n          range: {\n            min: 0,\n            max: this.hasTimeKey ? this.timeKeys.length - 1 : 100,\n          },\n          start: this.currentTimeKey.get()?._index ?? 0,\n        });\n\n        attribDetailRange.append(\"span\").attr(\"class\", \"rangeTick-cur\");\n\n        this.timeKeySlider = attribDetailRange.node().noUiSlider;\n        var _update_1 = async (v) => {\n          if (this.timeKeySlider_PauseUpdate) return;\n          var _node = this.DOM.timeAnimation\n            .selectAll(\".timeKeySelect > option\")\n            .nodes()[Math.round(1 * v)];\n          if (_node) {\n            this.timeKeySlider_PauseUpdate = true;\n            await this.currentTimeKey.set(_node.__data__);\n            this.timeKeySlider_PauseUpdate = false;\n          }\n        };\n        this.timeKeySlider.on(\"set\", _update_1);\n\n        // DOUBLE-KEY SLIDER (TIMESERIES)\n        this.DOM.timeseriesRange = timeKeyRange\n          .append(\"div\")\n          .attr(\"class\", \"timeseriesRange\");\n\n        timeKeyRange.append(\"span\").attr(\"class\", \"rangeTick-max\");\n      });\n\n    this.DOM.timeAnimationClearRange = this.DOM.timeAnimation\n      .append(\"span\")\n      .attr(\"class\", \"clearRange fa fa-times\")\n      .tooltip(i18n.Reset);\n    // handled added in TimeSeries view\n\n    this.currentTimeKey.refresh();\n\n    // View control...\n    this.DOM.visViewControl = this.DOM.recordDisplayWrapper\n      .append(\"span\")\n      .attr(\"class\", \"visViewControl\");\n\n    // **************************************************\n    // ZOOM IN / OUT / RESET\n    this.DOM.visViewControl\n      .append(\"span\")\n      .attr(\"class\", \"ChartControlGroup ViewControlGroup\")\n      .call((_) => {\n        _.append(\"span\")\n          .attr(\"class\", \"ChartControlGroupTitle\")\n          .html(i18n.Zoom);\n        _.append(\"span\")\n          .attr(\"class\", \"visViewControlButton far fa-plus\")\n          .tooltip(i18n.ZoomIn)\n          .on(\"click\", () => this.View.zoomIn());\n        _.append(\"span\")\n          .attr(\"class\", \"visViewControlButton far fa-minus\")\n          .tooltip(i18n.ZoomOut)\n          .on(\"click\", () => this.View.zoomOut());\n        _.append(\"span\")\n          .attr(\"class\", \"visViewControlButton far fa-expand-arrows-alt\")\n          .tooltip(i18n.ZoomToFit)\n          .on(\"click\", () => this.View.zoomToFit());\n      });\n\n    // MOUSE SELECT MODE\n    var _m = (t) =>\n      t === \"filter\"\n        ? \"Filter\"\n        : \"Select nearest \" + (t === \"record\" ? \"point\" : \"time\");\n\n    // Maps only\n    this.DOM.visViewControl\n      .append(\"div\")\n      .attr(\"class\", \"visViewControlButton mapView-UnmatchedData\")\n      .tooltip(i18n.MissingLocations)\n      .text(\"\")\n      .on(\"click\", () => {\n        Modal.alert(\n          \"The following records do not appear on the map.<br><br>\" +\n            this.codeBy.geo.noValueAggr.records.map((_) => _._id).join(\", \") +\n            (this.codeBy.geo.geoType !== \"Point\"\n              ? \"<br><br>\" +\n                \"<span style='font-size: 0.9em; color: gray; font-weight: 300'>\" +\n                \"Please see the list of standard region names \" +\n                \"<a style='color: gray; text-decoration: underline;' href='https://docs.google.com/spreadsheets/d/1DKNXwsJy6_Mdy3ofwbBIZeBGrxSItYOJXNZgLyu0IM4' target='_blank'>here</a>.<br>\" +\n                \"If the place names above are misspelled, please update your data source.<span>\"\n              : \"\")\n        );\n      });\n  }\n\n  /** -- */\n  refreshTimeKeys() {\n    this.timeKeys = [];\n\n    [\"sort\", \"scatterX\", \"scatterY\", \"color\", \"size\"].forEach((_type) => {\n      var targetAttrib = this.codeBy[_type];\n      if (\n        targetAttrib instanceof Attrib_Numeric &&\n        targetAttrib.hasTimeSeriesParent()\n      ) {\n        // make a copy of timeKeys of the timeseries summary\n        var timeKeyOptions = Array.from(targetAttrib.timeseriesParent.timeKeys);\n        // finds the shared subset of keys across all timeseries variables\n        if (this.timeKeys.length === 0) {\n          this.timeKeys = timeKeyOptions;\n        } else {\n          this.timeKeys = this.timeKeys.filter((k) =>\n            timeKeyOptions.find((_) => _._time_src === k._time_src)\n          );\n        }\n      }\n    });\n\n    // From 0 (oldest) to last (newest)\n    this.timeKeys = this.timeKeys.sort(\n      (a, b) => a._time.getTime() - b._time.getTime()\n    );\n\n    // re-assign index numbers\n    this.timeKeys.forEach((key, i) => {\n      key._index = i;\n      delete key._histogram; // not needed - does not apply\n    });\n\n    this.currentTimeKey.refresh();\n  }\n\n  /** -- */\n  get hasTimeKey() {\n    return this.timeKeys.length > 1; // must be at least two - single time-key has no control\n  }\n\n  filterStatusUpdated(attrib: Attrib) {\n    if (attrib instanceof Attrib_Numeric) {\n      if (\n        this.viewRecAs === \"scatter\" &&\n        (this.codeBy.scatterX === attrib || this.codeBy.scatterY === attrib)\n      ) {\n        this.View?.refreshQueryBox_Filter(null);\n      }\n      if (\n        attrib.timeseriesParent === this.codeBy.timeSeries &&\n        this.View instanceof RecordView_Timeseries\n      ) {\n        this.View.refreshFilterRanges();\n      }\n    }\n  }\n\n  /** -- */\n  collapseRecordViewSummary(collapsed) {\n    this.collapsed = collapsed;\n    this.DOM.root.classed(\"collapsed\", this.collapsed);\n    if (this.browser.finalized) this.browser.updateLayout_Height();\n  }\n\n  /** -- */\n  refreshViz_Compare_All() {\n    this.DOM.root\n      .selectAll(\"[class*='spatialQueryBox_Compare']\")\n      .classed(\n        \"active\",\n        (d) => this.browser.vizActive(d) && this.browser.selectedAggrs[d].bounds\n      );\n  }\n\n  /** -- */\n  refreshViewAsOptions() {\n    var activeCount = 0;\n    [\"list\", \"map\", \"timeseries\", \"scatter\"].forEach((viewType) => {\n      var t = this.browser.recordChartType.itemOptions.find(\n        (_) => _.value === viewType\n      );\n      var disabled = !t.activeWhen || !t.activeWhen();\n      activeCount += !disabled ? 1 : 0;\n      this.DOM.recordDisplayHeader\n        .select(\".recordDisplay_ViewAs_\" + viewType)\n        .classed(\"disabled\", disabled)\n        .classed(\"active\", viewType.toLowerCase() == this.viewRecAs);\n    });\n\n    this.DOM.recordDisplayHeader\n      .select(\".recordDisplay_ViewGroup\")\n      .classed(\"disabled\", activeCount <= 1);\n  }\n\n  private attribDropdowns: {\n    [index: string /* RecordVisCoding */]: AttribDropdown;\n  } = {};\n\n  /** -- */\n  refreshAttribOptions(_type) {\n    if (!this.attribDropdowns[_type]) return;\n    this.attribDropdowns[_type].refresh();\n  }\n\n  /** -- */\n  initDOM_AttribSelect(_type: RecordVisCoding) {\n    this.attribDropdowns[_type] = new AttribDropdown(_type, this);\n    this.refreshAttribOptions(_type);\n  }\n\n  /** -- */\n  getAttribOptions_UI(_type: RecordVisCoding): Attrib[] {\n    var opts = this.browser.attribs.filter(\n      (attrib) =>\n        attrib.supportsRecordEncoding(_type) && !attrib.hasTimeSeriesParent()\n    );\n\n    // scatterX / scatterY options cannot include the same active attribute\n    if ([\"scatterX\", \"scatterY\"].includes(_type)) {\n      var other: Attrib =\n        _type === \"scatterX\" ? this.codeBy.scatterY : this.codeBy.scatterX;\n      if (other) {\n        if (other.hasTimeSeriesParent()) other = other.parent;\n        opts = opts.filter((s) => s.attribID != other.attribID);\n      }\n    }\n\n    // generate new attribute if there's no sortable attribute\n    if (_type === \"sort\" && opts.length === 0) {\n      var newAttrib: Attrib_Numeric;\n      if (this.browser.idSummaryName === \"id\") {\n        newAttrib = this.browser.createAttrib(\"Sort by id\", function () {\n          return 1 * this.id;\n        }) as Attrib_Numeric;\n      } else {\n        newAttrib = this.browser.createAttrib(\"Sort (random)\", function () {\n          return Math.random();\n        }) as Attrib_Numeric;\n      }\n      newAttrib._metricFuncs = [];\n      newAttrib.initializeAggregates();\n      // calls the function again, but this time we have a numeric summary\n      return this.getAttribOptions_UI(\"sort\");\n    }\n\n    opts.sort((s1, s2) =>\n      Util.sortFunc_List_String(s1.attribName, s2.attribName)\n    );\n\n    if ([\"color\", \"size\"].includes(_type)) {\n      opts.unshift(null); // The first option is no color/size attribute.\n    }\n\n    return opts;\n  }\n\n  timeseriesAnimInterval: number = 0;\n\n  /** -- */\n  startTimeseriesAnimation(stepSize = 1) {\n    if (this.timeseriesAnimInterval) {\n      this.stopTimeseriesAnimation();\n    }\n\n    if (this.View?.stepTimeAnimation(stepSize)) {\n      this.DOM.root.classed(\"animatingTime\", true);\n    }\n  }\n\n  /** -- */\n  stopTimeseriesAnimation() {\n    this.DOM.root.classed(\"animatingTime\", false);\n\n    this.View?.stopTimeAnimation();\n\n    this.View.refreshLabelOverlaps();\n\n    if (!this.timeseriesAnimInterval) return;\n    window.clearInterval(this.timeseriesAnimInterval);\n    this.timeseriesAnimInterval = 0;\n  }\n\n  isPointMap() {\n    return this.viewRecAs === \"map\" && this.codeBy.geo?.geoType === \"Point\";\n  }\n\n  /** -- */\n  hasAggregates() {\n    return (\n      this.isPointMap() &&\n      this.DOM.clusterGlyphs &&\n      this.codeBy.geo.pointClusterRadius > 0 &&\n      this.codeBy.geo._aggrs.length > 0\n    );\n  }\n\n  /** -- */\n  async setAttrib(\n    _type: RecordVisCoding,\n    _attrib: number | string | Function | Attrib,\n    stopAnimation = false\n  ): Promise<boolean> {\n    let attrib: Attrib = null;\n\n    // if integer, index by integer among potential options\n    if (typeof _attrib === \"number\") {\n      attrib = this.getAttribOptions_UI(_type)[_attrib];\n      //\n    } else if (typeof _attrib === \"function\") {\n      attrib = this.browser.createAttrib(\"_Records\", _attrib, \"categorical\"); // create from function\n      //\n    } else if (typeof _attrib === \"string\") {\n      if (_attrib !== \"_measure_\") {\n        attrib = this.browser.createAttrib(_attrib); // create from string\n      }\n      //\n    } else if (_attrib) {\n      attrib = _attrib;\n    }\n\n    if ([\"sort\", \"scatterX\", \"scatterY\", \"size\", \"color\"].includes(_type)) {\n      var timeSrc;\n      if (attrib instanceof Attrib_Numeric && attrib.timeseriesParent) {\n        timeSrc = attrib.timeKey._time_src;\n        attrib = attrib.timeseriesParent;\n      }\n      if (attrib instanceof Attrib_Timeseries) {\n        timeSrc = this.currentTimeKey.get()?._time_src || timeSrc;\n        attrib = attrib.getTimepointSummary(\n          attrib.timeKeys.find((x) => x._time_src === timeSrc) || // current time-key\n            attrib.timeKeys[attrib.timeKeys.length - 1] // most recent time-key\n        );\n      }\n    }\n\n    // if (attrib instanceof Attrib) {\n    //   if (!attrib.supportsRecordEncoding(_type)) return;\n    // }\n\n    var prevTimeSeriesParent: Attrib_Timeseries = null;\n\n    if (_type === \"text\") {\n      if (!(attrib instanceof Attrib_Categorical)) return;\n      this.codeBy.text = attrib;\n\n    } else if (_type === \"textBrief\") {\n      if (!(attrib instanceof Attrib_Categorical)) return;\n      this.codeBy.textBrief = attrib;\n\n    } else if (_type === \"sort\") {\n      if (!(attrib instanceof Attrib_Interval)) return;\n      if (this.codeBy.sort instanceof Attrib_Numeric)\n        prevTimeSeriesParent = this.codeBy.sort.timeseriesParent;\n      this.codeBy.sort = attrib;\n\n    } else if (_type === \"scatterX\") {\n      if (!(attrib instanceof Attrib_Numeric)) return;\n      if (this.codeBy.scatterX)\n        prevTimeSeriesParent = this.codeBy.scatterX.timeseriesParent;\n      this.codeBy.scatterX = attrib;\n\n    } else if (_type === \"scatterY\") {\n      if (!(attrib instanceof Attrib_Numeric)) return;\n      if (this.codeBy.scatterY) {\n        prevTimeSeriesParent = this.codeBy.scatterY.timeseriesParent;\n      }\n      this.codeBy.scatterY = attrib;\n\n    } else if (_type === \"size\") {\n      prevTimeSeriesParent = this.codeBy.size instanceof Attrib_Numeric\n        ? this.codeBy.size.timeseriesParent\n        : null;\n\n      if (_attrib === \"_measure_\") {\n        this.codeBy.size = _attrib;\n      } else if (attrib instanceof Attrib_Numeric) {\n        this.codeBy.size = attrib;\n      } else if (_attrib === null) {\n        this.codeBy.size = null;\n      } else {\n        return;\n      }\n\n    } else if (_type === \"color\") {\n      prevTimeSeriesParent = this.codeBy.color instanceof Attrib_Numeric\n        ? this.codeBy.color.timeseriesParent\n        : null;\n      if (_attrib === \"_measure_\") {\n        this.codeBy.color = _attrib;\n      } else if (attrib instanceof Attrib_Numeric) {\n        this.codeBy.color = attrib;\n      } else if (_attrib === null) {\n        this.codeBy.color = null;\n      } else {\n        return;\n      }\n\n    } else if (_type === \"timeSeries\") {\n      if (!(attrib instanceof Attrib_Timeseries)) return;\n      this.codeBy.timeSeries = attrib;\n\n    } else if (_type === \"geo\") {\n      if (!(attrib instanceof Attrib_RecordGeo)) return;\n      this.codeBy.geo = attrib;\n      await this.codeBy.geo.loadGeo();\n\n    } else {\n      return;\n    }\n\n    if (stopAnimation) {\n      this.stopTimeseriesAnimation(); // hard-stop any existing animation\n    }\n\n    var timeKeysChange = false;\n\n    if (_type !== \"timeSeries\") {\n      if( attrib instanceof Attrib_Numeric &&\n        attrib.timeseriesParent &&\n        prevTimeSeriesParent !== attrib.timeseriesParent\n      ) {\n        timeKeysChange = true;\n      }\n    }\n\n    if (timeKeysChange) {\n      this.refreshTimeKeys();\n      if (attrib instanceof Attrib_Numeric)\n        await this.currentTimeKey.set(attrib.timeKey);\n    }\n\n    if (!this.DOM.root) return;\n\n    if (attrib instanceof Attrib) {\n      attrib.initializeAggregates();\n    }\n\n    if (_type === \"text\") {\n      this.DOM.recordTextSearch\n        .attr(\"active\", true)\n        .select(\"input\")\n        .attr(\"placeholder\", this.textAttrib_Brief?.attribName);\n\n      // Call the onDOM function for all the records that have been inserted to the page\n      if (this.config.onDOM) {\n        this.DOM.kshfRecords.each((record) => {\n          this.config.onDOM.call(record.data, record);\n        });\n      }\n\n    } else if (_type === \"textBrief\") {\n      this.DOM.recordTextSearch\n        .attr(\"active\", true)\n        .select(\"input\")\n        .attr(\"placeholder\", this.textAttrib_Brief.attribName);\n\n    } else if (_type === \"color\") {\n      this.updateRecordColorScale();\n\n    } else if (_type === \"size\") {\n      if (this.codeBy.size instanceof Attrib_Numeric) {\n        if (\n          this.viewRecAs === \"scatter\" ||\n          (this.viewRecAs === \"map\" && this.codeBy.geo?.geoType === \"Point\")\n        ) {\n          var s_f = this.codeBy.size.template.func;\n          var s_log = this.codeBy.size.isValueScale_Log;\n\n          var sortVal = (r) => {\n            var v = s_f.call(r.data, r);\n            return isNaN(v) || v == null || (s_log && v <= 0) ? -1 : v;\n          };\n\n          // need to apply delay to sorting (z-order) because we want the elements to animate to first\n          if (this.sortRecordDomTimer) clearTimeout(this.sortRecordDomTimer);\n          this.sortRecordDomTimer = window.setTimeout(() => {\n            this.DOM.kshfRecords = this.DOM.recordGroup\n              .selectAll(\".kshfRecord\")\n              .sort((r_a, r_b) => sortVal(r_b) - sortVal(r_a));\n            this.View.refreshLabelOverlaps();\n          }, 1000);\n        }\n      }\n\n      this.updateRecordSizeScale();\n\n      this.refreshSizeLegend();\n    }\n\n    await this.View?.finishSetAttrib(_type);\n\n    this.refreshAttribOptions(_type);\n  }\n\n  sortRecordDomTimer: number;\n\n  // ********************************************************************\n  // MAPPING\n  // ********************************************************************\n\n  /** -- */\n  getMaxPointSize(): number {\n    if (!(this.codeBy.size instanceof Attrib_Numeric)) {\n      return 1; // only 1 point max\n    }\n\n    return this.codeBy.size.timeseriesParent // use timeseries parents domain...\n      ? d3.max(this.codeBy.size.timeseriesParent.timeSeriesScale_Value.domain())\n      : this.codeBy.size.rangeActive[1];\n  }\n\n  /** -- */\n  sanitizeTicks(ticks, attrib: Attrib_Numeric | \"_measure_\", numTicks: number) {\n    if (ticks.domain) {\n      var _scale = ticks.copy().nice(numTicks);\n      ticks = _scale.ticks(numTicks);\n      // d3 error ? make sure the ticks cover the full attrib Range\n      var domain = _scale.domain();\n      if (ticks[0] > domain[0]) ticks.unshift(domain[0]);\n      if (ticks[ticks.length - 1] < domain[1]) ticks.push([domain[1]]);\n    }\n\n    // when ticks must be integer values, round them\n    if (attrib === \"_measure_\" || !attrib.hasFloat) {\n      ticks = ticks.map((v) => Math.round(v));\n    }\n\n    // avoid repeated tick values\n    return ticks.filter((_, i) => i == 0 || _ !== ticks[i - 1]);\n  }\n\n  /** -- */\n  refreshSizeLegend() {\n    if(this.DOM.root == null) return;\n\n    this.DOM.root.classed(\"usesSizeAttrib\", hasSizeLegend);\n\n    var hasSizeLegend =\n      this.codeBy.size != null &&\n      (this.viewRecAs === \"scatter\" ||\n        (this.viewRecAs === \"map\" && this.codeBy.geo.geoType === \"Point\"));\n\n    if (!hasSizeLegend) return;\n\n    if (!this.DOM.sizeLegendGroup) return;\n\n    var maxValue;\n\n    if (this.viewRecAs === \"map\") {\n      maxValue = this.recordRadiusScale.domain()[1];\n      if (isNaN(maxValue)) {\n        this.DOM.root.classed(\"usesSizeAttrib\", false);\n        return;\n      }\n    } else {\n      maxValue = this.getMaxPointSize();\n    }\n\n    var markRatios = [0.2, 0.4, 0.6, 0.8, 1];\n\n    if (this.recordPointSize.get() > 25) {\n      markRatios = [0.1, 0.4, 0.7, 1];\n    }\n\n    var ticks = this.sanitizeTicks(\n      markRatios.map((v) => maxValue * v * v),\n      this.codeBy.size,\n      10\n    );\n    ticks = ticks.filter((_) => _ !== 0);\n\n    var printLabel;\n    if (this.codeBy.size instanceof Attrib_Numeric) {\n      let y = this.codeBy.size;\n      printLabel = (v) => y.getFormattedValue(v);\n    } else {\n      printLabel = d3.format(\"~s\");\n    }\n\n    maxValue = ticks[ticks.length - 1];\n\n    ticks = ticks.map((_) => ({ size: 2 * this.recordRadiusScale(_), val: _ })); // size\n\n    this.DOM.sizeLegendGroup.selectAll(\"div\").remove();\n    this.DOM.sizeLegendGroup\n      .selectAll(\"div\")\n      .data(ticks)\n      .join((enter) =>\n        enter\n          .append(\"div\")\n          .attr(\"class\", \"sizeGlyph\")\n          .call((sizeGlyphs) =>\n            sizeGlyphs\n              .append(\"span\")\n              .attr(\"class\", \"glyphWrapper\")\n              .append(\"span\")\n              .attr(\"class\", \"theGlyph\")\n              .style(\"width\", (d) => d.size + \"px\")\n              .style(\"height\", (d) => d.size + \"px\")\n          )\n          .call((sizeGlyphs) =>\n            sizeGlyphs\n              .append(\"span\")\n              .attr(\"class\", \"glyphLabel\")\n              .html((_) => printLabel(_.val))\n          )\n      );\n  }\n\n  /** -- */\n  linkedTimeKey() {\n    if (this.codeBy.scatterY == null) return false;\n    if (this.codeBy.scatterX == null) return false;\n    var yTs = this.codeBy.scatterY.timeseriesParent;\n    var xTs = this.codeBy.scatterX.timeseriesParent;\n    if (!xTs || !yTs) return false;\n    return (\n      yTs.attribName !== xTs.attribName &&\n      yTs.timeKeys.length === xTs.timeKeys.length &&\n      this.codeBy.scatterY.timeKey !== this.codeBy.scatterX.timeKey\n    );\n  }\n\n  /** -- */\n  flipSelected(f, cT) {\n    if (!cT) cT = this.browser.Compare_Highlight;\n    this.DOM.kshfRecords.each((record) => record.flipSelected(f, cT));\n  }\n\n  skipRefreshRecordVis: boolean = false;\n\n  /** -- */\n  refreshRecordVis() {\n    if (!this.DOM.recordGroup) return;\n    if (this.skipRefreshRecordVis) return;\n    if (this.kshfRecords_Type !== this.viewRecAs) return;\n    if (!this.View) return;\n    this.View.refreshRecordVis();\n  }\n\n  /** -- */\n  isSummaryUsedInRecordChart(summary) {\n    return {\n      list: [\"sort\"],\n      map: [\"color\", \"size\"],\n      scatter: [\"scatterX\", \"scatterY\", \"color\", \"size\"],\n      timeseries: [\"timeSeries\"],\n      none: [],\n    }[this.viewRecAs].some((t) => {\n      var _ = this[t + \"Attrib\"];\n      return _ && (summary === _ || summary === _.parentSummary);\n    });\n  }\n\n  /** -- */\n  async refreshAttribScaleType(attrib) {\n    if (this.codeBy.color instanceof Attrib) {\n      if (\n        this.codeBy.color === attrib ||\n        this.codeBy.color.timeseriesParent === attrib\n      ) {\n        this.updateRecordColorScale();\n      }\n    }\n\n    await this.View?.refreshAttribScaleType(attrib);\n  }\n\n  /** Instead of overall maximum, we can also get a quantile value */\n  private getMaxMeasureValue(quantile = null): number {\n    // maximum of records that are not in a special cluster - using measure_Self values\n    var _list: number[] = this.browser.records.reduce((accum: number[], record: Record) => {\n      if (record.isIncluded && !record._view.inCluster && record.measure_Self)\n        accum.push(record.measure_Self);\n      return accum;\n    }, []);\n\n    // add maximum active of all the clisters\n    if (this.codeBy.geo) {\n      _list = this.codeBy.geo._aggrs.reduce(\n        (accum, aggr: Aggregate_PointCluster) => {\n          accum.push(aggr.measure(\"Active\"));\n          return accum;\n        },\n        _list\n      );\n    }\n\n    _list.sort((a, b) => b - a);\n\n    if (quantile) return d3.quantile(_list, quantile);\n\n    return _list[0];\n  }\n\n  get measureSummary() {\n    return this.browser.measureSummary.get();\n  }\n\n  updateRecordColorScale() {\n    if (!this.codeBy.color) {\n      this.recordColorScale = null;\n      this.recordColorScaleTicks = null;\n      this.recordColorStepTicks = null;\n      this.refreshColorLegend();\n      return;\n    }\n\n    var c: Attrib_Numeric, domain: [number, number];\n\n    if (this.codeBy.color === \"_measure_\") {\n      domain = [1, this.getMaxMeasureValue()];\n      c = this.measureSummary;\n    } else {\n      domain = this.codeBy.color.valueScale.domain();\n      c = this.codeBy.color;\n    }\n\n    const _colorLegendScale = Util.getD3Scale(c?.isValueScale_Log).domain(domain);\n\n    var numTicks = 10;\n    while (true) {\n      this.recordColorScaleTicks = this.sanitizeTicks(\n        _colorLegendScale,\n        c ?? \"_measure_\",\n        numTicks\n      );\n      if (this.recordColorScaleTicks.length <= 10) break;\n      numTicks--;\n    }\n\n    this.recordColorStepTicks = false;\n\n    if (\n      (!c || !c.hasFloat) &&\n      Util.isStepTicks(this.recordColorScaleTicks) &&\n      this.recordColorScaleTicks.length < 10\n    ) {\n      this.recordColorStepTicks = true;\n      this.recordColorScaleTicks.push(\n        this.recordColorScaleTicks[this.recordColorScaleTicks.length - 1] + 1\n      );\n    }\n\n    // How many number of bins are we going to support?\n    // Options are from 3 to 9!\n    var numBins = Math.max(\n      Math.min(this.recordColorScaleTicks.length - 1, 9),\n      1\n    );\n\n    // from quantized scale to discrete colors\n    var colors = this.browser.colorTheme.getDiscrete(numBins);\n    if (this.invertedColorTheme) colors.reverse();\n    // replicates first and last colors to match the ticks\n    // needed because we are using threshold scale, which also considers below/above the scale limits\n    // using slightl different colors so invertExtent would function well\n    colors = [d3.hsl(colors[0]).brighter(0.1).formatHex()]\n      .concat(colors)\n      .concat(\n        d3\n          .hsl([colors[colors.length - 1]])\n          .darker(0.1)\n          .formatHex()\n      );\n\n    this.recordColorScale = d3\n      .scaleThreshold()\n      .domain(this.recordColorScaleTicks)\n      .range(colors);\n\n    this.refreshColorLegend();\n  }\n\n  /** -- */\n  onRecordMouseOver(record: Record) {\n    record.highlightRecord();\n    this.setDimmed(true);\n\n    this.View.onRecordMouseOver(record);\n\n    // manage color mapping here. can apply to map / scatterplot\n    if (\n      this.codeBy.color &&\n      (this.viewRecAs === \"map\" || this.viewRecAs === \"scatter\")\n    ) {\n      var v;\n      if (this.codeBy.color === \"_measure_\") {\n        v = record.measure_Self;\n      } else {\n        v = this.codeBy.color.getRecordValue(record);\n      }\n      // Set opacity, and position\n\n      var offset = 0;\n      if (this.recordColorStepTicks) {\n        offset = 50 / (this.recordColorScaleTicks.length - 1);\n      }\n\n      this.DOM.mapColorHighlightedValue\n        .style(\"opacity\", v === null ? null : 1)\n        .style(\"left\", offset + this.mapColorScalePos(v) + \"%\");\n    }\n  }\n\n  /** -- */\n  onRecordMouseLeave(record) {\n    this.setDimmed(false);\n\n    if (!record) return;\n    record.unhighlightRecord();\n    this.View.onRecordMouseLeave(record);\n    if (\n      this.codeBy.color &&\n      (this.viewRecAs === \"map\" || this.viewRecAs === \"scatter\")\n    ) {\n      this.DOM.mapColorHighlightedValue.style(\"opacity\", null);\n    }\n  }\n\n  /** -- */\n  refreshTextAttrib() {}\n\n  sparklineCounter: number = 0;\n\n  getRecordTitle(record: Record) {\n    var recordName = `<span class='mapItemName'>${this.textAttrib_Brief.renderRecordValue(\n      record\n    )}</span>`;\n\n    var catColorText = \"\";\n    if (this.browser.comparedAttrib) {\n      let a = this.browser.comparedAttrib;\n      let compare_Color = \"Active\";\n      Base.Compare_List.forEach((cX) => {\n        if (record.isSelected(cX)) compare_Color = cX;\n      });\n      catColorText = `<div class='recordColorInfo'>\n        <span class='mapTooltipLabel'>${a.attribName}</span>\n        <div class='mapTooltipValue'><span class='colorBox bg_${compare_Color}'></span>${a.getRecordValue(\n        record\n      )}</div>\n        </div>`;\n    }\n\n    if (!this.codeBy.color) return recordName + catColorText;\n\n    var a = this.codeBy.color;\n\n    if (a === \"_measure_\" || !a.hasTimeSeriesParent()) {\n      var _value, _label;\n      if (a === \"_measure_\") {\n        _label = i18n.measureText(this.browser);\n        _value = record.measure_Self;\n      } else {\n        _label = a.attribName;\n        _value = a.getFormattedValue(a.template.func.call(record.data, record));\n      }\n      // Just a single value / not timeseries\n      return (\n        recordName +\n        catColorText +\n        \"<div class='recordColorInfo'>\" +\n        `<span class='mapTooltipLabel'>${_label}</span>: ` +\n        `<span class='mapTooltipValue'>${_value}</span>` +\n        \"</div>\"\n      );\n    }\n\n    var a2 = a;\n\n    var activeVal = a.template.func.call(record.data, record);\n\n    // Timeseries popup\n    var ts = a.timeseriesParent;\n    var timeseriesData = ts.getRecordValue(record);\n    var chart_width = 150;\n    var chart_height = 40;\n\n    // converts the object into simple array\n    var tsd = timeseriesData._timeseries_;\n\n    if (tsd.length === 0) {\n      // Just a single value / not timeseries\n      return (\n        recordName +\n        catColorText +\n        \"<div class='recordColorInfo'> - \" +\n        `<span class='timeseriesName blockName'>${ts.attribNameHTML}</span>` +\n        \"</div>\"\n      );\n    }\n\n    // filter out the invalid values from beginning and end\n    while (tsd[0]._value === undefined) {\n      tsd = tsd.slice(1);\n    }\n    while (tsd[tsd.length - 1]._value === undefined) {\n      tsd = tsd.slice(0, tsd.length - 1);\n    }\n\n    // **********************************\n    // Time scale ***********************\n    var timeScale = d3\n      .scaleTime()\n      .domain(d3.extent(tsd, (x: TimeData) => x._time))\n      .range([0, chart_width]);\n\n    // **********************************\n    // Value scale **********************\n    // compute the min-max of the tooltip using the real record values\n    var [value_min, value_max] = d3.extent(tsd, (_: TimeData) => _._value);\n    var steadyValue = false;\n    if (value_min === value_max) {\n      steadyValue = value_min;\n      value_min -= 0.0001;\n      value_max += 0.0001;\n    }\n    if (ts.hasFlippedDomain()) {\n      [value_max, value_min] = [value_min, value_max];\n    }\n    var valueScale = d3\n      .scaleLinear()\n      .domain([value_min, value_max])\n      .rangeRound([chart_height, 0]);\n\n    // get activeTime\n    var tsDots = \"\";\n    var activeTime = null;\n    if (activeVal != null) {\n      activeTime = ts.timeKeys.filter(\n        (tk) => tk._time_src === a2.timeKey._time_src\n      )[0];\n      tsDots =\n        `<g transform='translate(${timeScale(activeTime._time)} ${valueScale(\n          activeVal\n        )})'><circle class='activeValueDot' r='4' fill='${this.recordColorScale(\n          activeVal\n        )}'/><text class='activeValueText' y='-5'>${a.printAbbr(\n          activeVal,\n          true\n        )}</text>` + \"</g>\";\n    }\n\n    var colorOut = this.browser.colorTheme.getContinuous();\n    var mapp = this.mapColorScalePos\n      .copy()\n      .range(this.invertedColorTheme ? [1, 0] : [0, 1]);\n\n    this.sparklineCounter++;\n\n    // add the time extent\n    [tsd[0], tsd[tsd.length - 1]].forEach((t) => {\n      tsDots += `<g transform='translate(${timeScale(\n        t._time\n      )} ${chart_height})'><text class='limitText activeValueTime' y='16'>${\n        t._time_src\n      }</text></g>`;\n    });\n\n    // add the value extent\n    if (!steadyValue) {\n      var onLeft = activeTime && activeTime._index > ts.timeKeys.length / 2;\n      [value_max, value_min].forEach((v) => {\n        tsDots +=\n          \"<g transform='translate(\" +\n          (onLeft ? 0 : chart_width) +\n          \" \" +\n          valueScale(v) +\n          \")'>\" +\n          \"<text class='limitText activeRangeText' x='\" +\n          (onLeft ? \"-\" : \"\") +\n          \"3' y='5' \" +\n          \"style='text-anchor: \" +\n          (onLeft ? \"end\" : \"start\") +\n          \";'>\" +\n          ts.printAbbr(v, true) +\n          \"</text>\" +\n          \"</g>\";\n      });\n    }\n\n    var _stroke = steadyValue ? colorOut(mapp(value_max)) : \"\";\n\n    return (\n      recordName +\n      catColorText +\n      `<div class='sparklineWrapper'>\n        <svg class='tooltipSparkline' xmlns='http://www.w3.org/2000/svg'>\n          <defs>\n            <clipPath id='SparklineClipPath${this.sparklineCounter}'>\n              <rect x='-20' y='-25' height='100' class='sparkLineClipPath'></rect>\n            </clipPath>\n          </defs>\n          <g>\n            <path class='timeline' d='${Util.getLineGenerator(\n              timeScale,\n              valueScale\n            )(tsd)}' stroke='${_stroke}' />\n            ${tsDots}\n          </g>\n        </svg>\n      </div>\n      <span class='timeseriesName blockName'>${ts.attribNameHTML}</span>`\n    );\n  }\n\n  /** -- */\n  refreshRecordDOM() {\n    var isCanvasView = [\"map\", \"node\", \"scatter\", \"timeseries\"].includes(\n      this.viewRecAs\n    );\n\n    this.DOM.recordGroup\n      .selectAll(\".kshfRecord\")\n      .data(this.View.getRecordsForDOM(), (record: Record) => record.id)\n      .join(\n        (enter) => {\n          // argh. removing this causes some weird animation problem..\n          if (enter.nodes().length === 0) return enter;\n\n          return (\n            enter\n              .append(\n                {\n                  map: \"g\",\n                  node: \"g\",\n                  scatter: \"g\",\n                  timeseries: \"g\",\n                  list: \"div\",\n                }[this.viewRecAs]\n              )\n              // kshfRecord_XYZ can be used to apply custom CSS\n              .attr(\n                \"class\",\n                (record: Record) =>\n                  \"kshfRecord kshfRecord_#\" +\n                  // record.id may not be string with dynamic data loading\n                  (\"\" + record.id).replace(/\\s/g, \"_\")\n              )\n              .tooltip((record: Record) => this.getRecordTitle(record), {\n                theme: \"dark kshf-tooltip kshf-record\",\n                placement: \"right\",\n                animation: \"fade\",\n                followCursor: this.viewRecAs === \"map\",\n                offset: [0, this.viewRecAs === \"map\" ? 10 : 0],\n                onShown: (instance) => {\n                  d3.select(instance.popper)\n                    .select(\".sparkLineClipPath\")\n                    .attr(\"width\", 2)\n                    .transition()\n                    .duration(1000)\n                    .delay(0)\n                    .ease(d3.easePolyInOut)\n                    .attr(\"width\", 200);\n                },\n              })\n              .on(\"mouseenter\", (event, record) => {\n                if (this.viewRecAs === \"timeseries\") return;\n                var DOM = event.currentTarget;\n                if (DOM.highlightTimeout) clearTimeout(DOM.highlightTimeout);\n                DOM.highlightTimeout = window.setTimeout(() => {\n                  clearTimeout(DOM.highlightTimeout);\n                  this.onRecordMouseOver(record);\n                }, this.browser.movingMouseDelay);\n              })\n              .on(\"mouseleave\", (event, record) => {\n                if (this.viewRecAs === \"timeseries\") return;\n                var DOM = event.currentTarget;\n                if (DOM.highlightTimeout)\n                  window.clearTimeout(DOM.highlightTimeout);\n                this.onRecordMouseLeave(record);\n              })\n              .on(\"mousedown\", (event) => {\n                if (!isCanvasView) return;\n                event.currentTarget._mousemove = false;\n                event.stopPropagation();\n                event.preventDefault();\n              })\n              .on(\"mousemove\", (event) => {\n                if (!isCanvasView) return;\n                event.currentTarget._mousemove = true;\n              })\n              .on(\"click\", (event, record) => {\n                if (!isCanvasView) return;\n                var DOM = event.currentTarget;\n                if (DOM._mousemove) return; // Do not show the detail view if the mouse was used to drag the canvas\n                this.browser.recordDetailsPopup.updateRecordDetailPanel(record);\n\n                if (\n                  this.viewRecAs === \"map\" &&\n                  this.codeBy.color instanceof Attrib_Numeric\n                ) {\n                  this.browser.recordDetailsPopup.updateFocusedTimeKey(\n                    this.codeBy.color.timeKey\n                  );\n                }\n\n                if (DOM.highlightTimeout)\n                  window.clearTimeout(DOM.highlightTimeout);\n                if (DOM.tippy.state.visible) DOM.tippy.hide();\n                this.onRecordMouseLeave(record);\n              })\n              .call((newRecords) => {\n                this.View.extendRecordDOM(newRecords);\n              })\n          );\n        },\n        (_update) => null,\n        (exit) => exit.each((record) => record.assignDOM(null)).remove()\n      );\n\n    this.DOM.kshfRecords = this.DOM.recordGroup\n      .selectAll(\".kshfRecord\")\n      .each((record, i, nodes) => {\n        var DOM = nodes[i];\n        record.assignDOM(DOM);\n\n        if (this.viewRecAs === \"list\" || this.viewRecAs === \"timeseries\") {\n          DOM.tippy.disable();\n        } else {\n          DOM.tippy.enable();\n        }\n      });\n\n    if (isCanvasView) {\n      this.DOM.kshfRecords_Path = this.DOM.recordGroup.selectAll(\n        \".kshfRecord > path.glyph_Main\"\n      );\n    }\n\n    if (this.View instanceof RecordView_Map) {\n      this.View.setMaxBounds();\n      // continue executing below... no break\n    } else if (this.View instanceof RecordView_Scatter) {\n      this.View.finishSetAttrib(\"size\"); // TODO: Check / can be removed.\n      this.View?.refreshRecordColors();\n      //\n    }\n\n    this.View?.refreshSelect_Compare();\n    this.View?.updateRecordVisibility();\n    this.refreshTextAttrib();\n\n    this.kshfRecords_Type = this.viewRecAs;\n  }\n\n  /** -- */\n  refreshAfterHighlight(v) {\n    this.setDimmed(v);\n    this.View.refreshLabelOverlaps();\n  }\n\n  /** -- */\n  setDimmed(v) {\n    this.DOM.root?.classed(\"dimmed\", v);\n  }\n\n  /** -- */\n  updateAfterFilter(how) {\n    if (this.viewRecAs === \"none\") return;\n    this.refreshCompareLegend();\n    this.View.updateAfterFilter(how);\n  }\n\n  /** -- */\n  getRecordGeoAttributes() {\n    return this.browser.attribs.filter(\n      (attrib) => attrib instanceof Attrib_RecordGeo\n    );\n  }\n\n  /** -- */\n  exportConfig() {\n    var config = {\n      viewAs: this.viewRecAs,\n      collapsed: this.collapsed,\n      colorInvert: this.invertColorTheme,\n      filter: this.recordFilter.isFiltered\n        ? this.recordFilter.exportFilter()\n        : undefined,\n    };\n\n    var attribName: string;\n\n    [\n      \"sort\",\n      \"scatterX\",\n      \"scatterY\",\n      \"color\",\n      \"size\",\n      \"link\",\n      \"timeSeries\",\n      \"geo\",\n      \"text\",\n      \"textBrief\",\n    ].forEach((v) => {\n      var attrib = this[v + \"Attrib\"];\n      if (!attrib) return;\n\n      if (attrib === \"_measure_\") {\n        attribName = \"_measure_\";\n      } else if (attrib instanceof Attrib) {\n        attribName = attrib.template.str || attrib.attribName;\n        if (attrib.hasTimeSeriesParent()) attribName = attrib.template.str;\n      } else {\n        return;\n      }\n\n      config[v + \"By\"] = attribName;\n    });\n\n    Object.values(this.configs).forEach((_cfg) => _cfg.exportConfigTo(config));\n\n    return config;\n  }\n\n  /** -- */\n  // TO-DO: Improve, A LOT.\n  async importConfig(config) {\n    if (config == null) return;\n\n    await this.browser.recordChartType.set(config.viewAs);\n\n    if (config.colorTheme) {\n      this.setRecordColorTheme(config.colorTheme);\n    }\n    if (config.colorInvert) {\n      this.invertColorTheme(true);\n    }\n    if (config.recordPointSize) {\n      await this.recordPointSize.set(config.recordPointSize);\n    }\n\n    if (config.collapsed) {\n      this.collapseRecordViewSummary(true);\n    } else {\n      this.collapseRecordViewSummary(false);\n    }\n  }\n}\n","export class MapData {\n  // name of the mapdata object\n  public readonly name: string;\n\n  // cache for filename\n  private readonly fileName: string;\n\n  // cache for loaded state\n  private _geoLoaded = false;\n\n  private featureCb?: Function;\n  private alternatives: { [index: string]: any[] };\n  private defaultIndexedProps: string[];\n\n  private features: { [index: string]: any } = {};\n  // main external access to geometric feature (polygon, etc.) given an indexed key\n  getFeature(key: string) {\n    return this.features[key];\n  }\n\n  /** -- */\n  constructor(name: string, fileName: string, processCfg) {\n    this.name = name;\n\n    this.fileName = fileName + \"?ma\";\n\n    processCfg = processCfg || {};\n    this.featureCb = processCfg.featureCb;\n    this.alternatives = processCfg.alternatives || {};\n\n    this.defaultIndexedProps = [\"id\", \"ISO3166-2\", \"ISO3166-1\"];\n    if (processCfg.indexedProps) {\n      if (!Array.isArray(processCfg.indexedProps)) {\n        processCfg.indexedProps = [processCfg.indexedProps];\n      }\n      this.defaultIndexedProps = this.defaultIndexedProps.concat(\n        processCfg.indexedProps\n      );\n    }\n\n    this._processAlternatives(); // calling this to register the names for boost-detection\n  }\n\n  /** -- */\n  get geoLoaded() {\n    return this._geoLoaded;\n  }\n\n  /** -- */\n  _processAlternatives() {\n    for (var _from in this.alternatives) {\n      var _target = this.alternatives[_from];\n\n      if (_from === \"expand\") {\n        for (var name in this.features) {\n          _target.forEach((expander: {from: string, to:string, replace:boolean}) => {\n            var _newKey = name.replace(expander.from, expander.to || \"\");\n            if (_newKey === name || this.features[_newKey]) {\n              return; // same, or key exists\n            }\n            this.features[_newKey] = this.features[name];\n            if (expander.replace) {\n              delete this.features[name];\n            }\n          });\n        }\n      } else if (Array.isArray(_target)) {\n        _target\n          .filter((_to) => typeof _to === \"string\")\n          .forEach((_to) => {\n            this.features[_to] =\n              this.features[_to] || this.features[_from] || null;\n          });\n      }\n    }\n  }\n\n  /** -- */\n  async loadGeo() {\n    if (this._geoLoaded) return true;\n\n    return (\n      fetch(this.fileName, { credentials: \"same-origin\" })\n        .then((response) => response.json())\n\n        // if topojson format, load library and parse to geojson\n        .then(async (data) => {\n          if (!data.objects) return data;\n          await import(\"topojson-client\");\n          return (window as any).topojson.feature(data, data.objects.regions);\n        })\n\n        .then((geojsonData) => {\n          geojsonData.features.forEach((feature) => {\n            // move features from .properties.alltags to the .properties so they can be indexed\n            if (feature.properties.alltags) {\n              for (var k in feature.properties.alltags)\n                feature.properties[k] = feature.properties.alltags[k];\n              delete feature.properties.alltags;\n            }\n\n            if (this.featureCb) feature = this.featureCb(feature);\n\n            feature.properties.id = feature.properties.id || feature.id;\n\n            // detect all properties that include \"name\", but not \"fix\" + indexed properties\n            this.defaultIndexedProps\n              .concat(\n                Object.keys(feature.properties).filter(\n                  (x) =>\n                    x.toUpperCase().includes(\"NAME\") &&\n                    !x.toUpperCase().includes(\"FIX\")\n                )\n              )\n              .forEach((indexProp) => {\n                var _index = feature.properties[indexProp];\n                if (!_index) return;\n                _index = \"\" + _index;\n                this.features[_index.toUpperCase()] = feature;\n                // index version with \"-\" replaced with \" \"\n                if (_index.includes(\"-\")){\n                  this.features[_index.replace(/-/g, \" \").toUpperCase()] = feature;\n                }\n              });\n          });\n\n          this._geoLoaded = true;\n          this._processAlternatives();\n        })\n    );\n  }\n}\n","import { Attrib } from \"./Attrib\";\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Base } from \"./Base\";\nimport { MapData } from \"./MapData\";\n\nvar mapStandardsMenuOpts = {\n  id: \"cat_addMap\",\n  name: \"Add map\",\n  iconClass: \"far fa-globe\",\n  when: (attrib: Attrib) => attrib instanceof Attrib_Categorical && !attrib.catGeo,\n  do: async (attrib: Attrib_Categorical, action, path) => {\n    path = path.slice(path[1] === \"World\" ? 1 : 2);\n    var mapIndex =\n      \"Map_\" +\n      path.map((_) => _.replace(/ /g, \"\").replace(/-/g, \"\")).join(\"_\") +\n      \"_\" +\n      action.level;\n    await attrib.setCatGeo_(mapIndex + \"[UPPERCASE(*)]\");\n  },\n  options: [\n    {\n      name: \"World\",\n      options: [\n        {\n          name: \"Country\",\n          value: {\n            level: \"Adm2\",\n            indexedProps: [\n              \"ISO3166-1:alpha2\",\n              \"ISO3166-1:alpha3\",\n              \"ISO3166-1:numeric\",\n            ],\n            alternatives: {\n              \"BOSNIA AND HERZEGOVINA\": [\"BOSNIA-HERZEGOVINA\"],\n              BRUNEI: [\"BRUNEI DARUSSALAM\"],\n              BOLIVIA: [\n                \"BOLIVARIAN REPUBLIC OF VENEZUELA\",\n                \"BOLIVIA, PLURINATIONAL STATE OF\",\n              ],\n              BAHAMAS: [\"BAHAMAS, THE\", \"THE BAHAMAS\"],\n              \"DEMOCRATIC REPUBLIC OF THE CONGO\": [\n                \"CONGO, DEM. REP.\",\n                \"CONGO, THE DEMOCRATIC REPUBLIC OF THE\",\n                \"CONGO, DEMOCRATIC REPUBLIC\",\n              ],\n              CONGO: [\"CONGO, REP.\", \"CONGO, REPUBLIC OF\"],\n              \"CTE D'IVOIRE\": [\"COTE D'IVOIRE\", \"IVORY COAST\"],\n              CHINA: [\"CHINA, PEOPLE'S REPUBLIC OF\"],\n              \"CABO VERDE\": [\"CAPE VERGE\"],\n              EGYPT: [\"EGYPT, ARAB REP.\"],\n              \"SAHRAWI ARAB DEMOCRATIC REPUBLIC\": [\n                \"WESTERN SAHARA\",\n                \"Saharawi\",\n                \"Sahrawi Republic\",\n              ],\n              MICRONESIA: [\n                \"MICRONESIA, FEDERATED STATES OF\",\n                \"MICRONESIA, FED. STS.\",\n              ],\n              \"UNITED KINGDOM OF GREAT BRITAIN AND NORTHERN IRELAND\": [\n                \"UNITED KINGDOM\",\n                \"BRITAIN\",\n              ],\n              GAMBIA: [\"GAMBIA, THE\", \"THE GAMBIA\"],\n              IRAN: [\"IRAN, ISLAMIC REPUBLIC OF\", \"IRAN, ISLAMIC REP.\"],\n              KOSOVO: [\"XKX\", \"XXK\"],\n              KYRGYZSTAN: [\"KYRGYZ REPUBLIC\"],\n              \"SAINT KITTS AND NEVIS\": [\"ST. KITTS AND NEVIS\"],\n              \"NORTH KOREA\": [\n                \"KOREA, DEMOCRATIC PEOPLE'S REPUBLIC OF\",\n                \"KOREA, NORTH\",\n              ],\n              \"SOUTH KOREA\": [\n                \"KOREA, REPUBLIC OF\",\n                \"KOREA, REP.\",\n                \"KOREA, SOUTH\",\n              ],\n              \"LAO PEOPLE'S DEMOCRATIC REPUBLIC\": [\"LAOS\", \"LAO PDR\"],\n              \"SAINT LUCIA\": [\"ST. LUCIA\"],\n              MOLDOVA: [\"MOLDOVA, REPUBLIC OF\"],\n              MACEDONIA: [\n                \"MACEDONIA, THE FORMER YUGOSLAV REPUBLIC OF\",\n                \"NORTH MACEDONIA\",\n                \"REPUBLIC OF MACEDONIA\",\n                \"MACEDONIA, FYR\",\n              ],\n              MYANMAR: [\"BURMA\"],\n              \"PALESTINIAN TERRITORIES\": [\n                \"PALESTINE\",\n                \"PALESTINE, STATE OF\",\n                \"WEST BANK AND GAZA\",\n              ],\n              REUNION: [\"RUNION\"],\n              \"RUSSIAN FEDERATION\": [\"RUSSIA\"],\n              SLOVAKIA: [\"SLOVAK REPUBLIC\"],\n              \"SOUTH SUDAN\": [\"REPUBLIC OF SOUTH SUDAN\"],\n              \"SO TOM AND PRNCIPE\": [\"SAO TOME AND PRINCIPE\"],\n              \"SYRIAN ARAB REPUBLIC\": [\"SYRIA\"],\n              ESWATINI: [\"SWAZILAND\"],\n              TAIWAN: [\"TAIWAN, PROVINCE OF CHINA\", \"TAIWAN (POC)\"],\n              TANZANIA: [\"TANZANIA, UNITED REPUBLIC OF\"],\n              \"UNITED STATES OF AMERICA\": [\"USA\", \"UNITED STATES\"],\n              VATIKAN: [\"HOLY SEE (VATIKAN)\", \"HOLY SEE\"],\n              \"SAINT VINCENT AND THE GRENADINES\": [\n                \"ST. VINCENT AND GRENADINES\",\n                \"ST. VINCENT AND THE GRENADINES\",\n              ],\n              VIETNAM: [\"VIET NAM\"],\n              YEMEN: [\"YEMEN, REP.\", \"REPUBLIC OF YEMEN\", \"YEMEN, REPUBLIC OF\"],\n              VENEZUELA: [\"BOLIVARIAN REPUBLIC OF VENEZUELA\", \"VENEZUELA, RB\"],\n            },\n            featureCb: (feature) => {\n              var wrap, adj = 9;\n              switch (feature.properties[\"ISO3166-1\"]) {\n                case \"RU\":\n                case \"NZ\":\n                case \"FJ\":\n                  wrap = (x) => x < 0;\n                  adj = 360;\n                  break;\n                case \"US\":\n                  wrap = (x) => x > 0;\n                  adj = -360;\n                  break;\n              }\n              if (wrap) {\n                feature.geometry.coordinates.forEach((a, i1) => {\n                  a.forEach((b, i2) => {\n                    b.forEach((c, i3) => {\n                      if (wrap(c[0]))\n                        feature.geometry.coordinates[i1][i2][i3][0] = c[0] +=\n                          adj;\n                    });\n                  });\n                });\n              }\n              return feature;\n            },\n          },\n        },\n      ],\n    },\n    {\n      name: \"Central America and the Caribbean\",\n      options: [\n        {\n          name: \"Belize\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Costa Rica\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Canton\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Cuba\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Dominican Republic\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"El Salvador\",\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Guatemala\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Haiti\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Arrondissement\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Honduras\",\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Jamaica\",\n          options: [{ name: \"Parish\", value: { level: \"Adm6\" } }],\n        },\n        {\n          name: \"Nicaragua\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Panama\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Puerto Rico\",\n          options: [{ name: \"Municipality\", value: { level: \"Adm6\" } }],\n        },\n      ],\n    },\n    {\n      name: \"Central Asia\",\n      options: [\n        {\n          name: \"Armenia\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Azerbaijan\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Cyprus\",\n          options: [{ name: \"District\", value: { level: \"Adm6\" } }],\n        },\n        {\n          name: \"Georgia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Municipality / District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Kazakhstan\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Kyrgyzstan\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Russia\",\n          options: [{ name: \"Oblast\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Tajikistan\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Turkmenistan\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Uzbekistan\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n      ],\n    },\n    {\n      name: \"East Asia and Pacific\",\n      options: [\n        {\n          name: \"Australia\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            { name: \"LGA\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Brunei\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Cambodia\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"China\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Cities\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Indonesia\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Japan\",\n          options: [\n            { name: \"Prefecture\", value: { level: \"Adm4\" } },\n            { name: \"Subprefecture\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Laos\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Malaysia\",\n          options: [{ name: \"State_Territory\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Mongolia\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Myanmar\",\n          options: [\n            { name: \"Region / State\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"New Zealand\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"North Korea\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"City\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Papua New Guinea\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm3\" } },\n            { name: \"Province\", value: { level: \"Adm4\" } },\n          ],\n        },\n        {\n          name: \"Philippines\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm3\" } },\n            { name: \"Province\", value: { level: \"Adm4\" } },\n          ],\n        },\n        {\n          name: \"Singapore\",\n          options: [{ name: \"CDC\", value: { level: \"Adm6\" } }],\n        },\n        {\n          name: \"South Korea\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"City\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Thailand\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Vietnam\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"City\", value: { level: \"Adm6\" } },\n          ],\n        },\n      ],\n    },\n    {\n      name: \"Europe\",\n      options: [\n        {\n          name: \"Albania\",\n          options: [\n            { name: \"Counties\", value: { level: \"Adm6\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Austria\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            { name: \"District &amp; S. Cities\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Belarus\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Belgium\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Bosnia-Herzegovina\",\n          options: [\n            { name: \"District\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Bulgaria\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm6\" } },\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Croatia\",\n          options: [\n            { name: \"County\", value: { level: \"Adm6\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Czech Republic\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm6\" } },\n            { name: \"District\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Denmark\",\n          options: [{ name: \"Regions\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Estonia\",\n          options: [\n            { name: \"County\", value: { level: \"Adm6\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Finland\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm6\" } },\n            { name: \"Subregion\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"France\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Department\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Germany\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            {\n              name: \"District\",\n              value: {\n                level: \"Adm6\",\n                indexedProps: \"de:regionalschluessel\",\n                alternatives: { expand: [{ from: /LANDKREIS /g }] },\n              },\n            },\n          ],\n        },\n        {\n          name: \"Greece\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm5\" } },\n            { name: \"Regional Unit\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Hungary\",\n          options: [\n            { name: \"County\", value: { level: \"Adm6\" } },\n            { name: \"District\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Iceland\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm5\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Ireland\",\n          options: [\n            { name: \"County\", value: { level: \"Adm6\" } },\n            { name: \"District\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Italy\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Kosovo\",\n          options: [\n            {\n              name: \"District\",\n              value: {\n                level: \"Adm4\",\n                alternatives: {\n                  PRISHTINA: [\"PRISHTIN\", \"PRISTINA\"],\n                  PEJA: [\"PE\", \"PEJE\", \"PEJ\"],\n                  GJAKOVA: [\"GJAKOV\"],\n                  expand: [\n                    { from: / \\(\\d+\\)/g, replace: true },\n                    { from: \"District of \", replace: true },\n                    { from: \"Region of \", replace: true },\n                  ],\n                },\n              },\n            },\n            {\n              name: \"Municipality\",\n              value: {\n                level: \"Adm6\",\n                alternatives: {\n                  DEAN: [\"DEANI\"],\n                  DRAGASH: [\"DRAGA\"],\n                  FERIZAJ: [\"UROEVAC\"],\n                  \"FUSH KOSOV\": [\"KOSOVO POLJE\"],\n                  GJAKOV: [\"GJAKOVA\", \"AKOVICA\"],\n                  GJILAN: [\"GNJILANE\"],\n                  GLLOGOVC: [\"DRENAS\", \"GLOGOVAC\", \"GLLOGOC\"],\n                  GRACANIC: [\"GRAANICA\", \"GRAANIC\", \"GRACANICA\"],\n                  \"HANI I ELEZIT\": [\"ELEZ HAN\"],\n                  ISTOG: [\"BURIM\", \"ISTOK\"],\n                  KAANIK: [\"KAANIK\"],\n                  KAMENICA: [\"DARDAN\", \"KOSOVSKA KAMENICA\", \"KAMENIC\"],\n                  KLINA: [\"KLIN\"],\n                  KLOKOT: [\"KLLOKOT\", \"KLLOKOTI\"],\n                  LEPOSAVIQ: [\"LEPOSAVI\"],\n                  LIPJAN: [\"LIPLJAN\"],\n                  MALISHEV: [\"MALIEVO\"],\n                  MAMUSH: [\"MAMUA\", \"MAMUSH\"],\n                  MITROVICA: [\"MITROVIC\", \"KOSOVSKA MITROVICA\"],\n                  \"MITROVICA E VERIUT\": [\n                    \"MITROVICA VERIORE\",\n                    \"NORTH MITROVICA\",\n                    \"SEVERNA KOSOVSKA MITROVICA\",\n                    \"SEVERNA MITROVICA\",\n                  ],\n                  \"NOVO BRDO\": [\"NOVOBRD\", \"NOVOBERDE\"],\n                  OBILIQ: [\"KASTRIOT\", \"OBILI\", \"OBILIC\"],\n                  PARTESH: [\"PARTE\", \"PARTES\"],\n                  PEJ: [\"PE\"],\n                  PODUJEV: [\"BESIAN\", \"PODUJEVO\"],\n                  PRISHTIN: [\"PRISHTINA\", \"PRISHTINE\", \"PRISTINA\", \"PRITINA\"],\n                  RAHOVEC: [\"ORAHOVAC\"],\n                  RANILLUG: [\"RANILUG\", \"RANILLUK\"],\n                  SHTRPCE: [\"SHTRPC\", \"TRPCE\"],\n                  SHTIME: [\"TIMLJE\"],\n                  SKENDERAJ: [\"SKNDERAJ\", \"SRBICA\"],\n                  \"SUHA REK\": [\"SUHAREK\", \"THERAND\", \"SUVA REKA\"],\n                  VITI: [\"VITINA\", \"VITIA\"],\n                  VUSHTRRI: [\"VUITRN\"],\n                  \"ZUBIN POTOK\": [\"ZUBIN POTOKU\", \"ZUBN POTOK\"],\n                  ZVEAN: [\"ZVEAN\"],\n                  expand: [\n                    { from: / \\(\\d+\\)/g, replace: true },\n                    { from: \"Municipality of \", replace: true },\n                    { from: \"Region of \", replace: true },\n                  ],\n                },\n              },\n            },\n          ],\n        },\n        {\n          name: \"Latvia\",\n          options: [{ name: \"Municipality\", value: { level: \"Adm6\" } }],\n        },\n        {\n          name: \"Lithuania\",\n          options: [\n            { name: \"County\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Macedonia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            {\n              name: \"Municipality\",\n              value: {\n                level: \"Adm7\",\n                alternatives: { expand: [{ from: /MUNICIPALITY OF /g }] },\n              },\n            },\n          ],\n        },\n        {\n          name: \"Moldova\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Montenegro\",\n          options: [{ name: \"Municipality\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Netherlands\",\n          options: [\n            { name: \"State\", value: { level: \"Adm3\" } },\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Norway\",\n          options: [\n            { name: \"County\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Poland\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"County\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Portugal\",\n          options: [\n            { name: \"District\", value: { level: \"Adm6\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Romania\",\n          options: [{ name: \"County\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Serbia\",\n          options: [\n            { name: \"District\", value: { level: \"Adm6\" } },\n            { name: \"Municipality_City\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Slovakia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Slovenia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm5\" } },\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Spain\",\n          options: [\n            { name: \"Autonomous Community\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Sweden\",\n          options: [\n            { name: \"County\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm7\" } },\n          ],\n        },\n        {\n          name: \"Switzerland\",\n          options: [\n            { name: \"Canton\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Turkey\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm3\" } },\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Ukraine\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Raion\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"United Kingdom\",\n          options: [\n            { name: \"Country\", value: { level: \"Adm4\" } },\n            { name: \"County / Unitary authorities\", value: { level: \"Adm6\" } },\n          ],\n        },\n      ],\n    },\n    {\n      name: \"Middle East and North Africa\",\n      options: [\n        {\n          name: \"Algeria\", // NOT READY\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n            // { \"name\": \"Municipality\", \"value\": { \"level\": \"Adm8\"} }, // Not OSM-based\n          ],\n        },\n        {\n          name: \"Bahrain\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Egypt\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Iraq\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Iran\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"County\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Israel\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Jordan\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Kuwait\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Lebanon\",\n          options: [\n            { name: \"Governorate\", value: { level: \"Adm3\" } },\n            { name: \"District\", value: { level: \"Adm4\" } },\n          ],\n        },\n        {\n          name: \"Libya\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Morocco\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Profecture / Province\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Oman\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Palestine\",\n          options: [\n            { name: \"Territory\", value: { level: \"Adm3\" } },\n            { name: \"Governorate\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Qatar\",\n          options: [{ name: \"Municipality\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Saudi Arabia\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Syria\",\n          options: [\n            {\n              name: \"Governorate\",\n              value: { level: \"Adm4\", indexedProps: [\"PCODE\"] },\n            },\n          ],\n        },\n        {\n          name: \"Tunisia\",\n          options: [\n            { name: \"Governorate\", value: { level: \"Adm4\" } },\n            { name: \"Delegation\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"United Arab Emirates\",\n          options: [{ name: \"Emirate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Yemen\",\n          options: [\n            {\n              name: \"Governorate\",\n              value: {\n                level: \"Adm4\",\n                alternatives: { expand: [{ from: / GOVERNORATE/g }] },\n              },\n            },\n          ],\n        },\n      ],\n    },\n    {\n      name: \"North Ameria\",\n      options: [\n        {\n          name: \"Canada\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Mexico\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"United States\",\n          options: [\n            {\n              name: \"States\",\n              value: {\n                level: \"Adm4\",\n                indexedProps: [\"ISO3166_2\"],\n                alternatives: {\n                  expand: [{ from: \"US-\", replace: true }],\n                  // fips codes\n                  ALABAMA: [1, \"01\"],\n                  ALASKA: [2, \"02\"],\n                  ARIZONA: [4, \"04\"],\n                  ARKANSAS: [5, \"05\"],\n                  CALIFORNIA: [6, \"06\"],\n                  COLORADO: [8, \"08\"],\n                  CONNECTICUT: [9, \"09\"],\n                  DELAWARE: [10],\n                  \"DISTRICT OF COLUMBIA\": [11],\n                  FLORIDA: [12],\n                  GEORGIA: [13],\n                  HAWAII: [15],\n                  IDAHO: [16],\n                  ILLINOIS: [17],\n                  INDIANA: [18],\n                  IOWA: [19],\n                  KANSAS: [20],\n                  KENTUCKY: [21],\n                  LOUISIANA: [22],\n                  MAINE: [23],\n                  MARYLAND: [24],\n                  MASSACHUSETTS: [25],\n                  MICHIGAN: [26],\n                  MINNESOTA: [27],\n                  MISSISSIPPI: [28],\n                  MISSOURI: [29],\n                  MONTANA: [30],\n                  NEBRASKA: [31],\n                  NEVADA: [32],\n                  \"NEW HAMPSHIRE\": [33],\n                  \"NEW JERSEY\": [34],\n                  \"NEW MEXICO\": [35],\n                  \"NEW YORK\": [36],\n                  \"NORTH CAROLINA\": [37],\n                  \"NORTH DAKOTA\": [38],\n                  OHIO: [39],\n                  OKLAHOMA: [40],\n                  OREGON: [41],\n                  PENNSYLVANIA: [42],\n                  \"RHODE ISLAND\": [44],\n                  \"SOUTH CAROLINA\": [45],\n                  \"SOUTH DAKOTA\": [46],\n                  TENNESSEE: [47],\n                  TEXAS: [48],\n                  UTAH: [49],\n                  VERMONT: [50],\n                  VIRGINIA: [51],\n                  WASHINGTON: [53],\n                  \"WEST VIRGINIA\": [54],\n                  WISCONSIN: [55],\n                  WYOMING: [56],\n                  \"AMERICAN SAMOA\": [60],\n                  GUAM: [14, 66],\n                  \"NORTHERN MARIANA ISLANDS\": [69],\n                  \"PUERTO RICO\": [72],\n                  \"VIRGIN ISLANDS\": [78],\n                },\n                featureCb: (feature) => {\n                  var wrap = null,\n                    adj = 9;\n                  switch (feature.properties.name) {\n                    case 2:\n                    case \"AK\":\n                    case \"Alaska\":\n                    case \"Northern Mariana Islands\":\n                    case \"Guam\":\n                      wrap = (x) => x > 0;\n                      adj = -360;\n                      break;\n                  }\n                  if (wrap) {\n                    if (feature.geometry.coordinates[0][0][0][0]) {\n                      feature.geometry.coordinates.forEach((a, i1) => {\n                        a.forEach((b, i2) => {\n                          b.forEach((c, i3) => {\n                            if (wrap(c[0])) {\n                              feature.geometry.coordinates[i1][i2][i3][0] =\n                                c[0] += adj;\n                            }\n                          });\n                        });\n                      });\n                    } else {\n                      feature.geometry.coordinates.forEach((a, i1) => {\n                        a.forEach((b, i2) => {\n                          if (wrap(b[0])) {\n                            feature.geometry.coordinates[i1][i2][0] = b[0] +=\n                              adj;\n                          }\n                        });\n                      });\n                    }\n                  }\n                  return feature;\n                },\n              },\n            },\n            {\n              name: \"Counties\",\n              value: {\n                level: \"Adm6\",\n                indexedProps: [\"GEO_ID\"],\n                alternatives: {\n                  expand: [{ from: \"0500000US\", replace: true }],\n                },\n              },\n            },\n            {\n              name: \"Congressional Districts\",\n              options: [\n                {\n                  name: \"115th\",\n                  value: {\n                    level: \"CD115\",\n                    featureCb: (feature) => {\n                      var wrap = null,\n                        adj = 9;\n                      switch (feature.properties.id.substr(0, 2)) {\n                        case \"AK\":\n                          wrap = (x) => x > 0;\n                          adj = -360;\n                          break;\n                      }\n                      if (wrap) {\n                        feature.geometry.coordinates.forEach((a, i1) => {\n                          a.forEach((b, i2) => {\n                            b.forEach((c, i3) => {\n                              if (wrap(c[0]))\n                                feature.geometry.coordinates[i1][i2][i3][0] =\n                                  c[0] += adj;\n                            });\n                          });\n                        });\n                      }\n                      return feature;\n                    },\n                  },\n                },\n                {\n                  name: \"115th-Hexagon\",\n                  value: {\n                    level: \"CD115HEX\",\n                    indexedProps: [\"GEO_ID\"],\n                    featureCb: (feature) => {\n                      feature.properties.GEO_ID =\n                        feature.properties.STATEAB +\n                        \"-\" +\n                        feature.properties.CDLABEL.padStart(2, \"0\");\n                      return feature;\n                    },\n                  },\n                },\n              ],\n            },\n            {\n              name: \"DC\",\n              options: [\n                {\n                  name: \"Wards (2012)\",\n                  value: { level: \"Wards2012\", indexedProps: [\"WARD\"] },\n                },\n                {\n                  name: \"ANCs (2013)\",\n                  value: { level: \"ANC2013\", indexedProps: [\"ANC_ID\"] },\n                },\n                {\n                  name: \"Neighborhoods\",\n                  value: { level: \"Neighborhoods\", indexedProps: [\"subhood\"] },\n                },\n              ],\n            },\n          ],\n        },\n      ],\n    },\n    {\n      name: \"South America\",\n      options: [\n        {\n          name: \"Argentina\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Department\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Bolivia\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Brazil\",\n          options: [{ name: \"State\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Chile\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Colombia\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Ecuador\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Cantons\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Guyana\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Paraguay\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm8\" } },\n          ],\n        },\n        {\n          name: \"Peru\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Suriname\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Uruguay\",\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Venezuela\",\n          options: [{ name: \"State\", value: { level: \"Adm4\" } }],\n        },\n      ],\n    },\n    {\n      name: \"South Asia\",\n      options: [\n        {\n          name: \"Afghanistan\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Bangladesh\",\n          options: [\n            {\n              name: \"Divisions\",\n              value: { level: \"Adm4\", indexedProps: \"Division\" },\n            },\n            {\n              name: \"District\",\n              value: {\n                level: \"Adm5\",\n                indexedProps: \"District\",\n                alternatives: {\n                  NETRAKONA: [\"NETROKONA\"],\n                  BRAHAMANBARIA: [\"BRAHMANBARIA\"],\n                  NAWABGANJ: [\"CHAPAI NAWABGANJ\"],\n                },\n              },\n            },\n            {\n              name: \"Upazilas\",\n              value: {\n                level: \"Adm6\",\n                indexedProps: \"Upazila\",\n                alternatives: {\n                  NETRAKONA: [\"NETROKONA\"],\n                  BRAHAMANBARIA: [\"BRAHMANBARIA\"],\n                  NAWABGANJ: [\"CHAPAI NAWABGANJ\"],\n                },\n              },\n            },\n          ],\n        },\n        {\n          name: \"Bhutan\",\n          options: [\n            { name: \"District\", value: { level: \"Adm4\" } },\n            { name: \"Gewogs\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"India\",\n          options: [\n            { name: \"State_Union_Territory\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Nepal\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Zone\", value: { level: \"Adm5\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Pakistan\",\n          options: [{ name: \"Province\", value: { level: \"Adm3\" } }],\n        },\n        {\n          name: \"Sri Lanka\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm5\" } },\n          ],\n        },\n      ],\n    },\n    {\n      name: \"Sub-Saharan Africa\",\n      options: [\n        {\n          name: \"Angola\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Benin\",\n          options: [\n            { name: \"Department\", value: { level: \"Adm4\" } },\n            { name: \"Communes\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Botswana\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Burkina Faso\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm4\" } },\n            { name: \"Province\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Burundi\",\n          options: [{ name: \"Provices\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Cameroon\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm4\" } },\n            { name: \"Department\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Central African Republic\",\n          options: [{ name: \"Prefectures\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Chad\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Congo\",\n          options: [{ name: \"Department\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Djibouti\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"DR-Congo\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Eritrea\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Ethiopia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Zone\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Gabon\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Ghana\",\n          options: [{ name: \"Governorate\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Gambia\",\n          options: [\n            { name: \"Regions\", value: { level: \"Adm4\" } },\n            { name: \"LGAs\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Guinea\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Ivory Coast\",\n          options: [\n            { name: \"District\", value: { level: \"Adm4\" } },\n            { name: \"Region\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Kenya\",\n          options: [{ name: \"County\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Lesotho\",\n          options: [{ name: \"District\", value: { level: \"Adm5\" } }],\n        },\n        {\n          name: \"Liberia\",\n          options: [\n            { name: \"County\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Madagascar\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Malawi\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm3\" } },\n            { name: \"District\", value: { level: \"Adm4\" } },\n          ],\n        },\n        {\n          name: \"Mali\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Cercle\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Mauritania\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Mozambique\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Namibia\",\n          options: [{ name: \"Region\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Niger\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Department\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Nigeria\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            { name: \"LGA\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Rwanda\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Senegal\",\n          options: [{ name: \"Region\", value: { level: \"Adm3\" } }],\n        },\n        {\n          name: \"Somalia\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Sierra Leone\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"South Africa\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"Municipality\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"South Sudan\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            {\n              name: \"County\",\n              value: { level: \"Adm6\", indexedProps: [\"ADM2_EN\", \"ADM2_PCODE\"] },\n            },\n          ],\n        },\n        {\n          name: \"Sudan\",\n          options: [\n            { name: \"State\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Swaziland\",\n          options: [\n            { name: \"District\", value: { level: \"Adm4\" } },\n            { name: \"Inkhundla\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Tanzania\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm5\" } },\n          ],\n        },\n        {\n          name: \"Togo\",\n          options: [\n            { name: \"Region\", value: { level: \"Adm4\" } },\n            { name: \"Prefecture\", value: { level: \"Adm6\" } },\n          ],\n        },\n        {\n          name: \"Uganda\",\n          options: [{ name: \"District\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Zambia\",\n          options: [{ name: \"Province\", value: { level: \"Adm4\" } }],\n        },\n        {\n          name: \"Zimbabwe\",\n          options: [\n            { name: \"Province\", value: { level: \"Adm4\" } },\n            { name: \"District\", value: { level: \"Adm6\" } },\n          ],\n        },\n      ],\n    },\n  ],\n};\n\nvar _mapShapesLoaded = false;\n\n/** -- */\nfunction loadMapStandards() {\n  if (_mapShapesLoaded) return;\n\n  // recursive call\n  function addMapIndex(obj, path) {\n    if (obj.value) {\n      var level = obj.value.level;\n      if (path[0] !== \"World\" && path[0] !== \"Custom\") path = path.slice(1);\n      var mapIndex = `Map_${path.map((_) => _.replace(/ /g, \"\").replace(/-/g, \"\")).join(\"_\")}_${level}`;\n      Base.maps.set(\n        mapIndex,\n        new MapData(\n          mapIndex,\n          `${Base.geoFileDir}${path.concat(level).join(\"/\")}.${\n            Base.geoFileExt\n          }`,\n          obj.value\n        )\n      );\n    } else if (obj.options) {\n      path = path.concat([obj.name]);\n      obj.options.forEach((_) => addMapIndex(_, path));\n    }\n  }\n\n  mapStandardsMenuOpts.options.forEach((region) => addMapIndex(region, []));\n\n  _mapShapesLoaded = true;\n}\n\nexport { mapStandardsMenuOpts, loadMapStandards };\n","import { Attrib } from \"../Attrib\";\nimport { Browser } from \"../Browser\";\nimport { SelectType } from \"../Types\";\nimport { Filter, Filter_Base } from \"../Filter\";\nimport { i18n } from \"../i18n\";\n\nexport class BreadCrumb {\n  private readonly browser: Browser;\n\n  public DOM: any = null; // d3-selection\n\n  /** -- */\n  constructor(browser: Browser, selectType: SelectType) {\n    this.browser = browser;\n    this.selectType = selectType;\n  }\n\n  // ********************************************************************\n  // Select type (Filter, Compare_X)\n  // ********************************************************************\n\n  public selectType: SelectType; // can be converted at runtime (Compare can become filter)\n\n  private timeoutHide: number;\n\n  /** -- */\n  showCrumb(selectType, filter: Filter_Base) {\n    this.selectType = selectType;\n\n    if (this.timeoutHide) window.clearTimeout(this.timeoutHide);\n\n    let attrib: Attrib = filter instanceof Filter ? filter.attrib : null;\n\n    if (!this.DOM) {\n      var parentDOM =\n        this.selectType === \"Filter\"\n          ? this.browser.DOM.breadCrumbs_Filter\n          : this.browser.DOM.breadCrumbs_Compare;\n\n      this.DOM = parentDOM\n        .append(\"span\")\n        .html(\n          `<span class='breadCrumbIcon'><i class='fa fa-filter'></i><i class='far fa-times'></i></span>` +\n            `<span class='crumbText'><span class='crumbHeader blockName'></span><span class='crumbDetails'></span></span>`\n        )\n        .each((_, i, nodes) => {\n          if (this.selectType === \"Filter\") {\n            let DOM = nodes[i];\n            var l = DOM.parentNode.childNodes.length;\n            if (l > 1) {\n              DOM.parentNode.insertBefore(\n                DOM,\n                DOM.parentNode.childNodes[l - 2]\n              );\n            }\n          }\n        })\n        .on(\"mouseenter\", () => {\n          if (this.selectType !== \"Filter\") {\n            this.browser.refreshAllMeasureLabels(this.selectType);\n          }\n        })\n        .on(\"mouseleave\", () => {\n          if (this.selectType === \"Filter\") {\n            this.browser.refreshAllMeasureLabels(\"Active\");\n          }\n        })\n        .on(\"click\", () => {\n          if (this.selectType === \"Filter\") {\n            filter.clearFilter();\n          } else {\n            this.browser.clearSelect_Compare(this.selectType, true, true);\n            this.browser.refreshAllMeasureLabels(\"Active\");\n          }\n        });\n\n      this.DOM.style(\"opacity\", 0).transition().style(\"opacity\", 1);\n    }\n\n    this.DOM.attr(\"class\", \"breadCrumb crumbMode_\" + this.selectType)\n      .attr(\"data-summaryID\", attrib?.attribID ?? null)\n      .tooltip(\n        () => i18n[this.selectType === \"Filter\" ? \"RemoveFilter\" : \"Unlock\"]\n      );\n\n    if (this.selectType === \"Filter\") {\n      this.browser.DOM.breadCrumbs_Filter.node().appendChild(this.DOM.node());\n\n      var crumbHeader = this.DOM.select(\".crumbHeader\");\n      if (attrib) {\n        attrib.addDOMBlockName(crumbHeader);\n      } else {\n        crumbHeader.html(filter.title);\n      }\n      this.DOM.select(\".crumbDetails\").html(filter.filterView_Detail());\n    } else {\n      this.DOM.select(\".crumbDetails\").html(\n        this.browser.selectedAggrs[this.selectType]?.label || \"\"\n      );\n    }\n\n    this.browser.checkAndAdjustBreadcrumbs();\n  }\n\n  /** -- */\n  removeCrumb() {\n    if (!this.DOM) return;\n\n    if (this.timeoutHide) window.clearTimeout(this.timeoutHide);\n\n    this.timeoutHide = window.setTimeout(\n      () => {\n        this.timeoutHide = 0;\n        this.DOM.style(\"opacity\", 0)\n          .transition()\n          .delay(300)\n          .remove()\n          .on(\"end\", () => {\n            this.DOM.node().tippy?.hide();\n            this.browser.checkAndAdjustBreadcrumbs();\n            this.DOM = null;\n          });\n      },\n      // duration for timeout\n      this.selectType !== \"Filter\" &&\n        !this.browser.lockedCompare[this.selectType]\n        ? 1000\n        : 0\n    );\n  }\n}\n","import { Attrib } from \"../Attrib\";\nimport { Attrib_Categorical } from \"../Attrib_Categorical\";\nimport { Attrib_Numeric } from \"../Attrib_Numeric\";\nimport { Attrib_RecordGeo } from \"../Attrib_RecordGeo\";\nimport { Attrib_Timeseries } from \"../Attrib_Timeseries\";\nimport { Attrib_Timestamp } from \"../Attrib_Timestamp\";\n\nimport { Base } from \"../Base\";\nimport { Browser } from \"../Browser\";\nimport { i18n } from \"../i18n\";\nimport { mapStandardsMenuOpts } from \"../MapStandards\";\nimport { Modal } from \"./Modal\";\n\nexport var MenuOpts = {\n  /** -- */\n  AttribPanel: {\n    name: \"Options\",\n    items: [\n      {\n        id: \"CollapseAll\",\n        name: \"Collapse All\",\n        iconClass: \"fa fa-caret-up\",\n        do: (dashboard: Browser) => dashboard.collapseAttribListGroups(true),\n      },\n      {\n        id: \"ExpandAll\",\n        name: \"Expand All\",\n        iconClass: \"fa fa-caret-down\",\n        do: (dashboard: Browser) => dashboard.collapseAttribListGroups(false),\n      },\n      {\n        id: \"SetAttribPanelWidth\",\n        name: \"Set panel width\",\n        iconClass: \"far fa-arrows-h\",\n        do: (dashboard: Browser) => {\n          var x = Modal.prompt(\n            \"Enter width in pixels (between 200 and 400)\",\n            dashboard.attribPanelWidth\n          );\n          if (x) dashboard.setAttribPanelWidth(x);\n        },\n      },\n    ],\n  },\n\n  /** -- */\n  Attrib_Grouping: {\n    name: \"Settings\",\n    items: [\n      {\n        id: \"createTimeseries\",\n        name: \"Create Timeseries\",\n        iconClass: \"far fa-chart-line\",\n        when: () => true,\n        do: (groupInfo, action) => {\n          if (action === \"prompt()\") {\n            action = Modal.prompt(\"Enter time index format\");\n            if (!action) return;\n          }\n          // todo: update it to retrieve from parameter, not global space.\n          var dashboard = Base.browser;\n\n          var chain = groupInfo.parents.slice();\n          chain.push(groupInfo.name);\n\n          var pathStr = chain.join(\"->\");\n\n          dashboard.onLoad[pathStr] = `${pathStr}->\\${DATETIME(${action})}`;\n\n          var newConfig = dashboard.exportConfig();\n          // delete all the summaries which are indexed under this timeseries variable\n          newConfig.summaries = newConfig.summaries.filter((cfg) => {\n            var attrib = dashboard.attribWithName(cfg.name);\n            if (!attrib) return false;\n            if (attrib.block?.inDashboard) return true;\n            return pathStr !== attrib.template.pathStr;\n          });\n\n          dashboard = Base.reloadWithNewConfig(dashboard, newConfig);\n        },\n        options: [\n          { name: \"YYYY\", sampleValue: \"2019\", value: \"%Y\" },\n          { name: \"YYYY-MM\", sampleValue: \"2019-12\", value: \"%Y-%m\" },\n          {\n            name: \"YYYY-MM-DD\",\n            sampleValue: \"2019-12-30\",\n            value: \"%Y-%m-%d\",\n          },\n          {\n            name: \"MM/DD/YYYY\",\n            sampleValue: \"12/30/2019\",\n            value: \"%m/%d/%Y\",\n          },\n          { name: \"MM/DD/YY\", sampleValue: \"12/30/16\", value: \"%m/%d/%y\" },\n          {\n            name: \"YYYY-MM-DD\",\n            sampleValue: \"2019-12-30\",\n            value: \"%Y-%m-%d\",\n          },\n          { name: \"<i>Custom</i>\", value: \"prompt()\" },\n        ],\n      },\n    ],\n  },\n\n  /** -- */\n  Attribute: {\n    name: \"Settings\",\n\n    items: [\n      // *************************\n      {\n        id: \"renameAttrib\",\n        name: \"Rename\",\n        iconClass: \"far fa-pencil\",\n        helparticle: \"5ea92f902c7d3a5ea54a1c35\",\n        when: (attrib: Attrib) => !attrib.hasTimeSeriesParent(),\n        do: (attrib: Attrib) => {\n          var x = Modal.prompt(\n            \"Please enter the new attribute name.\",\n            attrib.attribName\n          );\n          if (x) attrib.attribName = x;\n        },\n      },\n\n      // *************************\n      {\n        id: \"setDescription\",\n        name: \"Set description\",\n        iconClass: \"fa fa-info\",\n        helparticle: \"5ea8b8dc2c7d3a5ea54a18ad\",\n        when: (attrib: Attrib) => !attrib.hasTimeSeriesParent(),\n        do: (attrib: Attrib) => {\n          var x = Modal.prompt(\n            \"Please enter a short description for this attribute.\",\n            attrib.description ? attrib.description : \"\"\n          );\n          if (x != null) attrib.description = x;\n        },\n      },\n\n      // ****************************\n      {\n        id: \"setUnitName\",\n        name: \"Set unit-name\",\n        iconClass: \"far fa-ellipsis-h\",\n        helparticle: \"5e88f31404286364bc97d467\",\n        when: (attrib: Attrib) =>\n          (attrib.type === \"timeseries\" || attrib.type === \"numeric\") &&\n          !attrib.hasTimeSeriesParent(),\n        do: (attrib: Attrib) => {\n          var x = Modal.prompt(\n            \"Please enter the unit name\",\n            attrib.unitName || \"\"\n          );\n          if (x != null) attrib.unitName = x;\n        },\n      },\n\n      {\n        id: \"convertDataType\",\n        name: \"Convert data type\",\n        iconClass: \"fa fa-wrench\",\n        options: [\n          // SPLIT CATEGORIES\n          {\n            id: \"cat_splitCat\",\n            name: \"Multi-Cat. (Split by)\",\n            iconClass: \"far fa-tags\",\n            helparticle: \"5e88d4172c7d3a7e9aea63ac\",\n            when: (attrib: Attrib) =>\n              attrib instanceof Attrib_Categorical && !attrib.isMultiValued,\n            do: (attrib: Attrib_Categorical, action) => {\n              if (action === \"prompt()\") {\n                action = Modal.prompt(\"Enter split format\");\n                if (!action) return;\n              }\n\n              attrib.browser.onLoad.main[\n                attrib.template.str\n              ] = `SPLIT(${action})`;\n\n              (window as any).dashboard = Base.reloadWithNewConfig(\n                attrib.browser,\n                attrib.browser.exportConfig()\n              );\n            },\n            options: [\n              {\n                name: \"Space\",\n                iconXML: \"_\",\n                value: \"\\\\s+\",\n                hint: \"Any whitespace\",\n              },\n              { name: \"Comma\", iconXML: \",\", value: \"\\\\s*,\\\\s*\" },\n              { name: \"Semicolumn\", iconXML: \";\", value: \"\\\\s*;\\\\s*\" },\n              { name: \"Vertical-bar\", iconXML: \"|\", value: \"\\\\s*\\\\|\\\\s*\" },\n              { name: \"Plus\", iconXML: \"+\", value: \"\\\\s*\\\\+\\\\s*\" },\n              { name: \"Star\", iconXML: \"*\", value: \"\\\\s*\\\\*\\\\s*\" },\n              { name: \"Custom\", iconXML: \"?\", value: \"prompt()\" },\n            ],\n          },\n\n          {\n            id: \"convertToCategorical\",\n            name: \"Categorical\",\n            iconClass: \"fa fa-tag\",\n            helparticle: \"5e890d9104286364bc97d4ff\",\n            when: (attrib: Attrib) => attrib instanceof Attrib_Numeric && !attrib.timeseriesParent,\n            do: (attrib: Attrib_Numeric) => {\n              Modal.confirm(\n                `Do you want to convert <i>${attrib.attribName}</i> to categorical data?`,\n                \"Convert\"\n              ).then(\n                () => {\n                  attrib.browser.onLoad.main[attrib.template.str] = \"STR()\";\n\n                  var newConfig = attrib.browser.exportConfig();\n                  newConfig.summaries\n                    .filter((s) => s.name === attrib.attribName)\n                    .forEach((s) => {\n                      s.type = \"categorical\";\n                    });\n                  if (\n                    newConfig.metric &&\n                    newConfig.metric.summary === attrib.attribName\n                  ) {\n                    delete newConfig.metric;\n                  }\n                  (window as any).dashboard = Base.reloadWithNewConfig(\n                    attrib.browser,\n                    newConfig\n                  );\n                },\n                () => {}\n              );\n            },\n          },\n          {\n            id: \"num_convertToTimestamp\",\n            name: \"Timestamp\",\n            iconClass: \"far fa-calendar-alt\",\n            helparticle: \"5e88ec2c04286364bc97d44b\",\n            when: (attrib: Attrib) => attrib instanceof Attrib_Numeric && !attrib.timeseriesParent,\n            do: (attrib: Attrib_Numeric, action) => {\n              if (action === \"prompt()\") {\n                action = Modal.prompt(\n                  \"Enter datetime format, using https://github.com/d3/d3-time-format#locale_format\"\n                );\n                if (!action) return;\n              }\n              attrib.browser.onLoad.main[\n                attrib.template.str\n              ] = `DATETIME(${action})`;\n\n              var newConfig = attrib.browser.exportConfig();\n              newConfig.summaries\n                .filter((s) => s.name === attrib.attribName)\n                .forEach((s) => {\n                  delete s.type;\n                  delete s.showPercentiles;\n                  delete s.skipZero;\n                });\n\n              (window as any).dashboard = Base.reloadWithNewConfig(\n                attrib.browser,\n                newConfig\n              );\n            },\n            options: [\n              { \n                name: \"YYYY\",\n                sampleValue: \"2019\",\n                value: \"%Y\"\n              },\n              {\n                name: \"Serial/Sheet date\",\n                sampleValue: \"42010.2\",\n                value: \"%sn\",\n              },\n              // seconds since UNIX epoch\n              {\n                name: \"UNIX epoch-sec\",\n                sampleValue: \"1499310012\",\n                value: \"%s\",\n              },\n              // milliseconds since UNIX epoch\n              {\n                name: \"UNIX epoch-ms\",\n                sampleValue: \"1499310012000\",\n                value: \"%Q\",\n              },\n              { name: \"<i>Custom</i>\", sampleValue: \"?\", value: \"prompt()\" },\n            ],\n          },\n          {\n            id: \"cat_convertToTimestamp\",\n            name: \"Timestamp\",\n            iconClass: \"far fa-calendar\",\n            helparticle: \"5e88ec2304286364bc97d44a\",\n            when: (attrib: Attrib) =>\n              attrib instanceof Attrib_Categorical &&\n              !attrib.isMultiValued &&\n              !attrib.catGeo,\n            do: (attrib: Attrib_Categorical, action) => {\n              if (action === \"prompt()\") {\n                action = Modal.prompt(\n                  \"Enter datetime format, using https://github.com/d3/d3-time-format#locale_format\"\n                );\n                if (!action) return;\n              }\n              attrib.browser.onLoad.main[\n                attrib.template.str\n              ] = `DATETIME(${action})`;\n\n              var newConfig = attrib.browser.exportConfig();\n              // Existing summary will have a \"categorical\" type. delete the type...\n              newConfig.summaries\n                .filter((s) => s.name === attrib.attribName)\n                .forEach((c) => {\n                  delete c.type;\n                  delete c.catLabel;\n                  delete c.catSortBy;\n                  delete c.catGeo;\n                  delete c.barHeight;\n                  delete c.showSetMatrix;\n                });\n\n              (window as any).dashboard = Base.reloadWithNewConfig(\n                attrib.browser,\n                newConfig\n              );\n            },\n            options: [\n              {\n                name: \"YYYY\",\n                sampleValue: \"2019\",\n                value: \"%Y\"\n              },\n              {\n                name: \"MM/DD/YYYY\",\n                sampleValue: \"12/30/2019\",\n                value: \"%m/%d/%Y\",\n              },\n              {\n                name: \"DD/MM/YYYY\",\n                sampleValue: \"30/12/2019\",\n                value: \"%d/%m/%Y\",\n              },\n              {\n                name: \"MM/DD/YY\",\n                sampleValue: \"12/30/16\",\n                value: \"%m/%d/%y\",\n              },\n              {\n                name: \"YYYY-MM-DD\",\n                sampleValue: \"2019-12-30\",\n                value: \"%Y-%m-%d\",\n              },\n              {\n                name: \"MM/DD/YYYY hh:mm\",\n                sampleValue: \"12/30/2019 13:10\",\n                value: \"%m/%d/%Y %H:%M\",\n              },\n              {\n                name: \"DD/MM/YYYY hh:mm\",\n                sampleValue: \"30/12/2019 13:10\",\n                value: \"%d/%m/%Y %H:%M\",\n              },\n              {\n                name: \"Date-Time-Z\",\n                sampleValue: \"2018-07-02T16:24:36Z\",\n                value: \"%Y-%m-%dT%H:%M:%S%Z\",\n              },\n              { name: \"<i>Custom</i>\", value: \"prompt()\" },\n            ],\n          },\n        ],\n      },\n\n      // ****************************\n      // ADD MAP TO CATEGORY\n      mapStandardsMenuOpts,\n\n      // Extract single time key\n      {\n        id: \"extractTimeKey\",\n        name: \"Extract time key\",\n        iconClass: \"far fa-calendar-day\",\n        when: (attrib: Attrib) => attrib instanceof Attrib_Timeseries,\n        options: (attrib: Attrib_Timeseries) =>\n          attrib.timeKeys\n            .filter((timeKey) => !attrib.timeKeyAttribs[timeKey._time_src])\n            .map((timeKey) => ({ name: timeKey._time_src, value: timeKey })),\n        do: (attrib: Attrib_Timeseries, action) => {\n          var _ = attrib.getTimepointSummary(action);\n          _.block.addToPanel(attrib.browser.panels.left);\n          attrib.browser.updateLayout();\n        },\n      },\n\n      // *************************************\n      // DERIVE\n      {\n        id: \"deriveMenuOpt\",\n        name: \"Generate\",\n        iconClass: \"fa fa-share\",\n        when: (attrib: Attrib) => attrib.template.str, // not a custom function\n        options: [\n          {\n            id: \"deriveChangeOverTime\",\n            name: \"Change over time\",\n            when: (attrib: Attrib) => {\n              return (\n                attrib instanceof Attrib_Timeseries &&\n                !attrib.parent &&\n                (!attrib.derivatives[\"TimeseriesChange-%\"] ||\n                  !attrib.derivatives[\"TimeseriesChange-#\"])\n              );\n            },\n            do: (attrib: Attrib_Timeseries, action) => {\n              attrib.createDerivedAttrib(\n                `Change(${action})`,\n                `${attrib.attribName} - ${\n                  action === \"%\" ? \"Percent\" : \"Absolute\"\n                } Change`\n              );\n            },\n            options: (attrib: Attrib_Timeseries) => {\n              var r = [];\n              if (!attrib.derivatives[\"TimeseriesChange-%\"]) {\n                r.push({ name: \"% Percent change\", value: \"%\" });\n              }\n              if (!attrib.derivatives[\"TimeseriesChange-#\"]) {\n                r.push({ name: \"# Absolute change\", value: \"#\" });\n              }\n              return r;\n            },\n          },\n\n          {\n            id: \"time_deriveComponent\",\n            name: \"Time unit\",\n            iconClass: \"far fa-calendar\",\n            when: (attrib: Attrib) => attrib instanceof Attrib_Timestamp,\n            do: (attrib: Attrib_Timestamp, action) =>\n              attrib.createDerivedAttrib(action),\n            // and time-typed in selected resolution,\n            // and not have the specific derived summary\n            options: [\n              {\n                id: \"time_deriveYear\",\n                name: \"Year\",\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.year && !attrib.derivatives.Year,\n                value: \"Year()\",\n              },\n              {\n                id: \"time_deriveMonth\",\n                name: \"Month\",\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.month && !attrib.derivatives.Month,\n                value: \"Month()\",\n              },\n              {\n                id: \"time_deriveDayOfMonth\",\n                name: \"Day of Month\",\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.day && !attrib.derivatives.DayOfMonth,\n                value: \"DayOfMonth()\",\n              },\n              {\n                id: \"time_deriveWeekday\",\n                name: \"Weekday\",\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.day && !attrib.derivatives.WeekDay,\n                value: \"WeekDay()\",\n              },\n              {\n                id: \"time_deriveHour\",\n                name: \"Hour\",\n                when: (attrib: Attrib_Timestamp) => attrib.timeTyped.hour && !attrib.derivatives.Hour,\n                value: \"Hour()\",\n              },\n            ],\n          },\n\n          {\n            id: \"cat_deriveDegree\",\n            name: \"Degree (# of)\",\n            iconClass: \"far fa-hashtag\",\n            when: (attrib: Attrib) =>\n              attrib instanceof Attrib_Categorical && attrib.isMultiValued && !attrib.derivatives.Degree,\n            do: (attrib: Attrib_Categorical) => attrib.createDerivedAttrib(\"Degree()\"),\n          },\n        ],\n      },\n\n      // Positive\n      {\n        id: \"num_keepPositive\",\n        name: \"Keep positive (>0) values\",\n        iconClass: \"fa fa-plus\",\n        when: (attrib: Attrib) =>\n          attrib instanceof Attrib_Numeric &&\n          attrib.rangeOrg[0] <= 0,\n        do: (attrib: Attrib_Numeric) => {\n          Modal.confirm(\n            `Do you want to remove zero-values from <i>${attrib.attribName}</i>?`,\n            \"Remove\"\n          ).then(\n            () => {\n              attrib.browser.onLoad.main[attrib.template.str] = \"POSITIVE()\";\n              (window as any).dashboard = Base.reloadWithNewConfig(\n                attrib.browser,\n                attrib.browser.exportConfig()\n              );\n            },\n            () => {}\n          );\n        },\n      },\n\n      // ****************************\n      {\n        id: \"CompareSelectionControl\",\n        name: \"Comparable\",\n        iconClass: \"fa fa-clone\",\n        do: (attrib: Attrib, action: boolean) => attrib.isComparable.set(action),\n        options: [\n          {\n            name: \"Enable\",\n            value: true,\n            iconClass: \"far fa-check\",\n            active: (attrib: Attrib) => attrib.isComparable.is(true),\n          },\n          {\n            name: \"Disable\",\n            value: false,\n            iconClass: \"far fa-times\",\n            active: (attrib: Attrib) => !attrib.isComparable.is(true),\n          },\n        ],\n      },\n      // ****************************\n      {\n        id: \"aggregateFunctions\",\n        name: \"Aggregation\",\n        iconClass: \"fa fa-cubes\",\n        helparticle: \"5e8944dd04286364bc97d5f0\",\n        when: (attrib: Attrib) => attrib.canHaveMetricFuncs && !attrib.hasTimeSeriesParent(),\n        options: [\n          {\n            name: \"Average\",\n            do: (attrib: Attrib, action: boolean) => {\n              if (action) {\n                attrib.addSupportedMetricFunc(\"Avg\");\n              } else {\n                attrib.removeSupportedMetricFunc(\"Avg\");\n              }\n            },\n            options: [\n              {\n                name: \"Enabled\",\n                value: true,\n                iconClass: \"far fa-check\",\n                active: (attrib: Attrib) => attrib.supportedMetricFuncs.includes(\"Avg\"),\n              },\n              {\n                name: \"Disabled\",\n                value: false,\n                iconClass: \"far fa-times\",\n                active: (attrib: Attrib) => !attrib.supportedMetricFuncs.includes(\"Avg\"),\n              },\n            ],\n          },\n          {\n            name: \"Sum\",\n            do: (attrib: Attrib, action: boolean) => {\n              if (action) {\n                attrib.addSupportedMetricFunc(\"Sum\");\n              } else {\n                attrib.removeSupportedMetricFunc(\"Sum\");\n              }\n            },\n            options: [\n              {\n                name: \"Enabled\",\n                value: true,\n                iconClass: \"far fa-check\",\n                active: (attrib: Attrib) => attrib.supportedMetricFuncs.includes(\"Sum\"),\n              },\n              {\n                name: \"Disabled\",\n                value: false,\n                iconClass: \"far fa-times\",\n                active: (attrib: Attrib) => !attrib.supportedMetricFuncs.includes(\"Sum\"),\n              },\n            ],\n          },\n        ],\n      },\n\n      // Delete map modification\n      {\n        id: \"removeMap\",\n        name: \"Remove map\",\n        iconClass: \"far fa-undo\",\n        when: (attrib: Attrib) =>\n          attrib instanceof Attrib_Categorical && attrib.catGeo !== null,\n        do: (attrib: Attrib_Categorical) => attrib.removeCatGeo(),\n      },\n\n      // Delete derivative\n      {\n        id: \"removeDerive\",\n        name: \"Remove derivation\",\n        iconClass: \"far fa-undo\",\n        when: (attrib: Attrib) => attrib.template.special,\n        do: (attrib: Attrib) => attrib.destroy(),\n      },\n\n      // Delete derived information\n      {\n        id: \"removeRecordGeo\",\n        name: \"Remove record geography\",\n        iconClass: \"far fa-undo\",\n        when: (attrib: Attrib) => attrib instanceof Attrib_RecordGeo,\n        do: (attrib: Attrib_RecordGeo) => {\n          attrib.destroy();\n          (window as any).dashboard = Base.reloadWithNewConfig(\n            attrib.browser,\n            attrib.browser.exportConfig()\n          );\n        },\n      },\n\n      // Delete onLoad modification\n      {\n        id: \"removeModification\",\n        name: \"Remove modification\",\n        iconClass: \"far fa-undo\",\n        when: (attrib: Attrib) => !!attrib.browser.onLoad.main[attrib.template.str],\n        do: (attrib: Attrib) => {\n          var name = attrib.template.str;\n          Modal.confirm(\n            `Do you want to delete the modification ${attrib.browser.onLoad.main[name]} ?`,\n            i18n.Delete\n          ).then(() => {\n            delete attrib.browser.onLoad.main[name];\n            (window as any).dashboard = Base.reloadWithNewConfig(\n              attrib.browser,\n              attrib.browser.exportConfig()\n            );\n          });\n        },\n      },\n\n      {\n        id: \"setAsRecordID\",\n        name: \"Set as record ID\",\n        iconClass: \"far fa-fingerprint\",\n        when: (attrib: Attrib) => {\n          if (attrib.attribName === attrib.browser.idSummaryName)\n            return false;\n          return (\n            attrib._aggrs &&\n            attrib._aggrs.length === attrib.browser.records.length &&\n            !attrib.template.special\n          );\n        },\n        do: (attrib: Attrib) => {\n          if (!attrib.template.str) {\n            Modal.alert(\"Not supported. [756]\");\n            return;\n          }\n          var newConfig = attrib.browser.exportConfig();\n          newConfig.source[0].id = attrib.template.str;\n          newConfig.summaries = newConfig.summaries.filter(\n            (s) => s.name !== attrib.browser.idSummaryName\n          );\n\n          (window as any).dashboard = Base.reloadWithNewConfig(attrib.browser, newConfig);\n        },\n      },\n    ],\n  },\n};\n","import { select, pointer } from \"../d3_select\";\nimport { min, max } from \"d3-array\";\n\nimport { Browser } from \"../Browser\";\nimport { Base } from \"../Base\";\nimport { PanelName, PanelSpec } from \"../Types\";\nimport { Block } from \"../Block\";\nimport { Attrib } from \"../Attrib\";\nimport { Attrib_Categorical } from \"../Attrib_Categorical\";\nimport { Block_Categorical } from \"../Block_Categorical\";\nimport { i18n } from \"../i18n\";\nimport { Attrib_Interval } from \"../Attrib_Interval\";\n\nconst d3 = {\n  select,\n  pointer,\n  min,\n  max,\n};\n\nexport class Panel {\n  private readonly browser: Browser;\n  private readonly _name: PanelName;\n\n  // ********************************************************************\n  // Attributes (/ blocks) in the panel\n  // ********************************************************************\n\n  public attribs: Attrib[] = [];\n\n  hasBlocks() {\n    return this.attribs.length > 0;\n  }\n  isEmpty() {\n    return this.attribs.length === 0;\n  }\n  get blocks(): Block[] {\n    return this.attribs.map((attrib) => attrib.block);\n  }\n\n  private get attribs_Categorical(): Attrib_Categorical[] {\n    return this.attribs.filter(\n      (_): _ is Attrib_Categorical => _ instanceof Attrib_Categorical\n    );\n  }\n\n  // ********************************************************************\n  // Constructor\n  // ********************************************************************\n\n  public DOM: { root: any };\n\n  /** -- */\n  constructor(browser: Browser, name: PanelName, parentDOM) {\n    this.browser = browser;\n    this._name = name;\n\n    this.DOM = {\n      root: parentDOM\n        .append(\"div\")\n        .attr(\"class\", \"panel panel_\" + this.name)\n        .classed(\"panel_side\", this.name === \"left\" || this.name === \"right\")\n        .classed(\"hasBlocks\", false),\n    };\n    this.initDOM_AdjustWidth();\n    this.addDOM_DropZone();\n    this.refreshBlocksDropZonesOrder();\n\n    this.setWidth(this.browser.width_Canvas / 3);\n  }\n\n  public get name(): PanelName {\n    return this._name;\n  }\n\n  /** -- If there's enough space, the panel welcomes new blocks */\n  welcomesNewBlock() {\n    if (this.isEmpty()) return true;\n    if (this.blocks.length < Math.floor(this.height / 150)) return true;\n    return this.heightRemaining >= 0;\n  }\n\n  // ********************************************************************\n  // Height, width...\n  // ********************************************************************\n\n  public height: number; // height of panel in pixels\n\n  private _width_CatBars: number = 0; // placeholder value\n  private _width_CatMeasureLabel: number = 10; // placeholder values\n  private _width_CatText: number = 175; // placeholder value\n\n  /** -- */\n  get width_CatText() {\n    return this._width_CatText;\n  }\n  /** -- */\n  get width_CatLabel() {\n    return (\n      this.width_CatText -\n      (this.browser.stackedCompare.is(true) && !this.hiddenCatBars()\n        ? 0\n        : this.width_CatMeasureLabel)\n    );\n  }\n  /** -- */\n  get width_CatMeasureLabel() {\n    return this._width_CatMeasureLabel;\n  }\n  get width_Real_withGap() {\n    if (this.width_Real === 0) return 0;\n    if (this.name === \"left\" || this.name === \"right\") {\n      return this.hasBlocks() ? this.width_Real + Base.width_PanelGap : 0;\n    }\n    return this.width_Real;\n  }\n  /** -- */\n  get width_Real() {\n    if (this.name === \"middle\") {\n      return (\n        this.browser.width_Canvas -\n        this.browser.panels.left.width_Real_withGap -\n        this.browser.panels.right.width_Real_withGap\n      );\n    }\n    if (this.name === \"bottom\") {\n      return this.browser.width_Canvas;\n    }\n    if (this.isEmpty()) return 0;\n    if (this.isCollapsed()) {\n      return this.DOM.root.node().offsetWidth;\n    }\n    return this.width_CatText + this.width_CatBars + Base.width_ScrollBar; // 8 pixels of gap\n  }\n\n  /** Adjusts width_CatBar based on previous size as well */\n  set width_CatText(_w_) {\n    _w_ = Math.max(Base.width_CatLabelMin, _w_); // use at least 110 pixels for the category label.\n    if (_w_ === this.width_CatText) return;\n    var widthDif = this.width_CatText - _w_;\n    this._width_CatText = _w_;\n    this.attribs_Categorical.forEach((attrib) =>\n      attrib.block.refreshLabelWidth()\n    );\n    // updates category bar widths\n    this.width_CatBars = this.width_CatBars + widthDif;\n  }\n  /** -- */\n  get width_CatBars() {\n    return this._width_CatBars;\n  }\n  /** -- */\n  set width_CatBars(_w_) {\n    _w_ = Math.max(_w_, 0); // cannot be negative\n    this._width_CatBars = _w_;\n    this.DOM.root.classed(\"hideCatBars\", this.hiddenCatBars() ? true : false);\n    this.refreshWidth();\n  }\n\n  /** -- */\n  setWidth(_w_) {\n    this.width_CatBars = _w_ - this.width_CatText - Base.width_ScrollBar;\n  }\n\n  /** --- */\n  refreshWidth() {\n    this.DOM.root.style(\"width\", this.width_Real + \"px\");\n    this.attribs.forEach((_) => _.block.refreshWidth());\n  }\n\n  /** --- */\n  updateWidth_CatMeasureLabels() {\n    // even if width is the same, stacked/not-stacked may have changed\n    this._width_CatMeasureLabel = this.calcWidth_MeasureLabel();\n    this.attribs_Categorical.forEach((attrib) =>\n      attrib.block.refreshLabelWidth()\n    );\n  }\n\n  /** -- */\n  hiddenCatBars() {\n    return this.width_CatBars <= 20;\n  }\n\n  /** -- */\n  initDOM_AdjustWidth() {\n    if (this.name === \"middle\" || this.name === \"bottom\") {\n      return; // not supported\n    }\n    this.DOM.root\n      .append(\"span\")\n      .attr(\"class\", \"panelAdjustWidth\")\n      .tooltip(i18n[\"Adjust Panel Width\"])\n      .on(\"mousedown\", (event) => {\n        if (event.which !== 1) return; // only respond to left-click\n        var mouseDown_x = d3.pointer(event, document.body)[0];\n        var mouseDown_width = this.width_CatBars;\n\n        this.browser.activateWidthDrag(event.currentTarget, event, (event2) => {\n          var mouseMove_x = d3.pointer(event2, document.body)[0];\n          var mouseDif = mouseMove_x - mouseDown_x;\n          if (this.name === \"right\") mouseDif *= -1;\n          this.width_CatBars = mouseDown_width + mouseDif;\n          this.browser.updateMiddlePanelWidth();\n          this.browser.updateLayout_Height();\n        });\n      })\n      .on(\"click\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      });\n  }\n\n  /** --- */\n  private calcWidth_MeasureLabel(): number {\n    if (this.isEmpty()) return 0;\n\n    var activeAggrMax, activeAggrMin;\n\n    if (this.browser.percentBreakdown) {\n      // 100 / %\n      activeAggrMax = 99; // 2 digits\n      activeAggrMin = 0; // 1 digit\n    } else {\n      activeAggrMax = d3.max(this.attribs, (_: Attrib) =>\n        _.getPeakAggr(d3.max, \"Active\")\n      );\n      activeAggrMin = d3.max(this.attribs, (_: Attrib) =>\n        _.getPeakAggr(d3.min, \"Active\")\n      );\n      if (activeAggrMax === 0 && activeAggrMin === 0) return 0;\n    }\n\n    var _w_ = 2;\n\n    // compute number of digits\n    var digits = 1;\n    while (activeAggrMax > 9) {\n      digits++;\n      activeAggrMax = Math.floor(activeAggrMax / 10);\n    }\n    if (!this.browser.hasIntOnlyMeasure()) {\n      digits += 2;\n      _w_ += 8; // Space for \",\"\n    }\n    if (digits > 4) {\n      digits = 3;\n      _w_ += 3; // Space for the splitting \".\" character (e.q. 3.2k)\n      _w_ += 10; // M, k, B, etc.\n    }\n    _w_ += digits * 6.5;\n\n    if (this.browser.percentBreakdown) {\n      if (Base.percentDecimal) {\n        _w_ += 24; // \"%\" character + \".\" character + 1 significant digit\n      } else {\n        _w_ += 13; // \"%\" character + \".\" character + 1 significant digit\n      }\n    } else {\n      // Account for the unitName displayed\n      var unitName = this.browser.measureSummary.get()?.unitName;\n      if (unitName) {\n        // TO-DO: Use the rendered width, instead of fixed multiplier, \"11\"\n        _w_ += 2 + unitName.length * 7;\n      }\n    }\n\n    // negative values have \"-\" character\n    if (activeAggrMin < 0) _w_ += 5;\n\n    return _w_;\n  }\n\n  // ********************************************************************\n  // Add / remove blocks\n  // ********************************************************************\n\n  /** -- */\n  addBlock(block: Block, index) {\n    block.panel = this;\n    var beforeDOM = this.DOM.root.selectAll(\".dropZone\").nodes()[index];\n    if (block.DOM.root && beforeDOM) {\n      block.DOM.root.style(\"display\", \"\");\n      this.DOM.root.node().insertBefore(block.DOM.root.node(), beforeDOM);\n    } else {\n      if (!block.initDOM(beforeDOM)) return;\n    }\n\n    this.DOM.root.classed(\"hasBlocks\", true);\n\n    var curIndex = -1;\n    this.attribs.forEach((attrib, i) => {\n      if (attrib.block === block) curIndex = i;\n    });\n    if (curIndex === -1) {\n      // block is new to this panel\n      if (index >= this.attribs.length) this.attribs.push(block.attrib);\n      else this.attribs.splice(index, 0, block.attrib);\n\n      this.updateWidth_CatMeasureLabels();\n      if (block instanceof Block_Categorical) {\n        block.refreshLabelWidth();\n        if (block.viewType === \"map\") {\n          block.catViewAs(\"map\"); // donno why this is needed for now.\n        }\n      }\n      //\n    } else {\n      // block was in the panel. Change position\n      this.attribs.splice(curIndex, 1);\n      this.attribs.splice(index, 0, block.attrib);\n    }\n\n    if (this.attribs.length === 1) this.refreshWidth();\n    this.refreshCollapsed();\n\n    this.addDOM_DropZone(block.DOM.root.node());\n\n    this.addRemove_Finalize();\n  }\n\n  /** -- */\n  removeBlock(block: Block) {\n    block.panel = undefined;\n    // remove the drop zone that this block created\n    var dropZoneDOM = this.DOM.root.selectAll(\".dropZone\").nodes()[\n      block.orderInPanel\n    ];\n    dropZoneDOM.parentNode.removeChild(dropZoneDOM);\n\n    this.attribs.splice(block.orderInPanel, 1);\n\n    this.updateWidth_CatMeasureLabels();\n    this.DOM.root.classed(\"hasBlocks\", this.hasBlocks());\n    if (!this.hasBlocks()) this.refreshCollapsed();\n\n    this.addRemove_Finalize();\n  }\n\n  private addRemove_Finalize() {\n    this.refreshBlocksDropZonesOrder();\n\n    if (this.name === \"bottom\") {\n      this.browser.DOM.panel_Wrapper.classed(\n        \"panel_bottom_empty\",\n        !this.hasBlocks()\n      );\n    }\n\n    this.refreshSharedMeasureExtent();\n    this.attribs.forEach((attrib) => attrib.updateChartScale_Measure());\n  }\n\n  /** -- */\n  refreshBlocksDropZonesOrder() {\n    this.attribs.forEach((attrib, i) => {\n      attrib.block.orderInPanel = i;\n    });\n    this.DOM.root.selectAll(\".dropZone\").each(function (d, i) {\n      this.__data__ = i;\n    });\n  }\n\n  /** Adds the dropZone DOM BEFORE the provided dom-- */\n  addDOM_DropZone(beforeDOM = null) {\n    var zone;\n    if (beforeDOM) {\n      zone = this.DOM.root.insert(\"div\", () => beforeDOM); // must be a function returning a dom object...\n    } else {\n      zone = this.DOM.root.append(\"div\");\n    }\n    zone\n      .attr(\"class\", \"dropZone\")\n      .on(\"mouseenter\", function () {\n        this.classList.add(\"onHover\");\n        this.children[0].classList.add(\"onReadyToDrop\");\n      })\n      .on(\"mouseleave\", function () {\n        this.classList.remove(\"onHover\");\n        this.children[0].classList.remove(\"onReadyToDrop\");\n      })\n      .on(\"mouseup\", (event) => {\n        var attrib = this.browser.movedAttrib;\n        if (!attrib) return;\n        if (attrib.block.panel) {\n          // if the block was in the panels already\n          attrib.block.DOM.root.node().nextSibling.style.display = \"\";\n          attrib.block.DOM.root.node().previousSibling.style.display = \"\";\n        }\n        attrib.block.addToPanel(this, event.currentTarget.__data__);\n        this.browser.updateLayout();\n      })\n      .call((dropZone) => {\n        dropZone.append(\"div\").attr(\"class\", \"dropIcon fa fa-chart-bar\");\n        dropZone\n          .append(\"div\")\n          .attr(\"class\", \"dropZoneText\")\n          .text(i18n[\"Drop Chart\"]);\n      });\n  }\n\n  // ********************************************************************\n  // Updating layout\n  // ********************************************************************\n\n  private heightRemaining: number = 0;\n\n  /** -- */\n  setHeightAndLayout(targetHeight: number) {\n    this.height = targetHeight;\n\n    this.heightRemaining = targetHeight;\n\n    var finalPass = false,\n      lastRound = false;\n\n    // initialize all blocks as not yet processed.\n    this.blocks.forEach((block) => {\n      block.dueForLayout = true;\n    });\n\n    var dueBlockCount = this.attribs.length;\n\n    var markDone = (block: Block) => {\n      if (!block.dueForLayout) return;\n      this.heightRemaining -= block.height_withMargin;\n      // see if the panel is on the bottom\n      setTimeout(() => {\n        var node = block.DOM.root.node();\n        var top = node.getBoundingClientRect().top;\n        var pos = \"onBottom\";\n        if (top > 300) {\n          pos = \"onTop\";\n        }\n        if (top < 300 || this.width_Real < 400) {\n          if (this.name === \"left\") {\n            pos = \"onRight\";\n          } else if (this.name === \"right\") {\n            pos = \"onLeft\";\n          }\n        }\n        block.DOM.root\n          .select(\".summaryConfig\")\n          .classed(\"onBottom\", pos === \"onBottom\")\n          .classed(\"onTop\", pos === \"onTop\")\n          .classed(\"onRight\", pos === \"onRight\")\n          .classed(\"onLeft\", pos === \"onLeft\");\n      }, 1000);\n      delete block.dueForLayout;\n      dueBlockCount--;\n    };\n\n    this.blocks\n      .filter(\n        (block) =>\n          !block.isVisible() || // Empty or collapsed\n          block.hasStaticHeight()\n      )\n      .forEach((block) => markDone(block));\n\n    while (true) {\n      if (dueBlockCount === 0) break;\n      var dueBlockCount_Pre = dueBlockCount;\n\n      // Distribute remaining space\n      this.blocks\n        .filter((block) => block.dueForLayout)\n        .forEach((block) => {\n          // in last round, if _block can expand, expand it further\n          if (finalPass && block.attrib.type == \"content\") {\n            if (block.height_RangeMin < this.heightRemaining) {\n              block.setHeight(this.heightRemaining);\n            } else {\n              block.setCollapsed(true);\n            }\n            markDone(block);\n            return;\n          }\n          if (lastRound === true) {\n            if (block.height_RangeMax > block.getHeight()) {\n              this.heightRemaining += block.getHeight();\n              block.setHeight(this.heightRemaining);\n              this.heightRemaining -= block.getHeight();\n              return;\n            }\n          }\n          if (dueBlockCount === 0) return;\n\n          // Fairly distribute remaining size across all remaining\n          var _heightRemaining = Math.floor(\n            this.heightRemaining / dueBlockCount\n          );\n\n          if (_heightRemaining >= block.height_RangeMax) {\n            // Panel has more space than what the block needs\n            block.setHeight(block.height_RangeMax);\n            markDone(block);\n          } else if (finalPass) {\n            if (_heightRemaining >= block.height_RangeMin) {\n              // Use whatever space\n              block.setHeight(_heightRemaining);\n              markDone(block);\n            } else {\n              // auto-collapse block if you do not have enough space\n              if (block.attrib.type !== \"content\") {\n                block.setCollapsed(true);\n                markDone(block);\n              }\n            }\n          }\n        });\n\n      finalPass = dueBlockCount_Pre === dueBlockCount;\n      if (lastRound === true) break;\n      if (dueBlockCount === 0) lastRound = true;\n    }\n\n    if (this.name === \"left\" || this.name === \"right\") {\n      this.refreshCollapsed();\n    }\n\n    if (this.name === \"bottom\" || this.name === \"middle\") {\n      this.height = this.height - this.heightRemaining;\n      this.heightRemaining = 0;\n    }\n\n    this.attribs.forEach((attrib, i) => {\n      attrib.block.DOM.root.style(\n        \"margin-bottom\",\n        i === this.attribs.length - 1 ? \"0\" : null\n      );\n    });\n  }\n\n  // ********************************************************************\n  // Collapsing panel\n  // ********************************************************************\n\n  /** -- */\n  collapseAllSummaries(exceptThisOne) {\n    this.attribs.forEach((_) => _.block.setCollapsed(_ !== exceptThisOne));\n    this.browser.updateLayout_Height();\n  }\n\n  /** -- */\n  isCollapsed() {\n    if (this.name === \"bottom\") return false;\n    return this.hasBlocks() && this.attribs.every((_) => _.block.collapsed);\n  }\n\n  /** -- */\n  refreshCollapsed() {\n    var _old = this.DOM.root.classed(\"collapsed\");\n    var _new = this.isCollapsed();\n    this.DOM.root.classed(\"collapsed\", _new);\n    this.refreshWidth();\n    if (_old !== _new) {\n      this.browser.updateLayout();\n    }\n  }\n\n  // ********************************************************************\n  // Synced scales\n  // ********************************************************************\n\n  private _syncedMeasureExtent = [0, 1]; // temp init value\n\n  /** -- */\n  refreshSharedMeasureExtent() {\n    var scales = this.attribs\n      .filter(\n        (s) =>\n          (s instanceof Attrib_Categorical && s.block.isView_List) ||\n          (s instanceof Attrib_Interval && s.block.showHistogram.is(true))\n      )\n      .map((s) => s.measureExtent_Self);\n\n    this._syncedMeasureExtent = [\n      d3.min(scales, (_) => _[0]),\n      d3.max(scales, (_) => _[1]),\n    ];\n  }\n  /** -- */\n  get syncedMeasureExtent() {\n    return this._syncedMeasureExtent;\n  }\n\n  // ********************************************************************\n  // Export / import\n  // ********************************************************************\n\n  /** -- */\n  exportConfig(): PanelSpec {\n    return {\n      catBarWidth: this.name !== \"bottom\" && this.width_CatBars,\n      catLabelWidth: this.width_CatText,\n    };\n  }\n\n  importConfig(config: PanelSpec) {\n    if (!config) return;\n    if (config.catLabelWidth) {\n      this.width_CatText = config.catLabelWidth;\n    }\n    if (config.catBarWidth && this.name !== \"bottom\") {\n      this.width_CatBars = config.catBarWidth;\n    }\n  }\n}\n","import { DataTable } from \"../DataTable\";\n\nexport class DataLoader_FetchURL {\n  accepts(dt: DataTable) {\n    return dt.fileExt;\n  }\n\n  // can be extended by sub-classes to customize http request headers\n  defaultFetchConfig() {\n    return {\n      credentials: \"same-origin\",\n      method: \"GET\",\n    };\n  }\n\n  async load(dt: DataTable) {\n    // Lets Papaparse handle the streaming data loading\n    if (dt.isCSV && dt.stream) {\n      return dt.parseData_CSV(dt.sourceURL);\n    }\n\n    return fetch(\n      dt.sourceURL,\n      Object.assign({}, this.defaultFetchConfig(), dt.fetchConfig)\n    )\n      .then((response) => response.text())\n      .then((data: any) => {\n        if (data.error) {\n          return Promise.reject(data.error);\n        }\n        return dt.parseData(data);\n      });\n  }\n}\n","import { Base } from \"../Base\";\nimport { DataTable } from \"../DataTable\";\n\nexport class DataLoader_GoogleSheets {\n  constructor() {}\n\n  accepts(dt: DataTable) {\n    return dt.type === \"GoogleSheets\";\n  }\n\n  async load(dt: DataTable) {\n\n    await import(\"https://apis.google.com/js/platform.js\");\n    \n    var gapi = (window as any).gapi;\n\n    await new Promise((resolve, reject) => {\n      gapi.load(\"client\", () => {\n        gapi.client\n          .init({\n            discoveryDocs: [\n              \"https://sheets.googleapis.com/$discovery/rest?version=v4\",\n              \"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\",\n            ],\n            apiKey: Base.gapi.gKey,\n            clientId: Base.gapi.clientId,\n            scope: 'profile email',\n          })\n          .then(\n            () => {\n              console.log(\" gapi.client.init\");\n              resolve(true);\n            },\n            (error) => {\n              console.log(error);\n              reject();\n            }\n          );\n      });\n    });\n\n    // Supporting custom data loading proxy\n    gapi.client.setToken(null);\n\n    return new Promise((resolve, reject) => {\n      gapi.client.sheets.spreadsheets.values.get({\n        spreadsheetId: dt.gdocId,\n        range: dt.name + \"!\" + (dt.range ? dt.range : \"1:300000\"),\n        valueRenderOption: \"UNFORMATTED_VALUE\",\n        dateTimeRenderOption: \"SERIAL_NUMBER\", // vs. \"FORMATTED_STRING\"\n      }).then(\n        (response) => {\n          if (!response.result && response.data) {\n            // node API returns a different structure\n            response.result = { values: response.data.data.values };\n          }\n\n          var header = response.result.values[0];\n          var hasIDcolumn =\n            header.filter((columnName) => columnName === dt.id).length > 0;\n\n          for (var row = 1; row < response.result.values.length; row++) {\n            var c = {};\n            for (var col = 0; col < header.length; col++) {\n              c[header[col]] = response.result.values[row][col];\n            }\n            if (!hasIDcolumn) c[dt.id] = \"\" + (row - 1);\n            dt.createRecord(c);\n          }\n\n          dt.processHeaderHierarchy(header);\n          resolve(true);\n        },\n        (err) => {\n          reject(err);\n        }\n      );\n    });\n  }\n}\n","import { TableSpec } from \"./Types\";\nimport { Record } from \"./Record\";\nimport { Base } from \"./Base\";\n\n// Static data loader\nvar DataLoaderRegistry = [];\n\n/** -- */\nexport class DataTable {\n  readonly name: string;\n\n  // ********************************************************************\n  // Records\n  // ********************************************************************\n\n  records: Record[] = [];\n\n  private _byKey: { [index: string]: Record } = {};\n\n  getRecord(key: string): Record {\n    return this._byKey[key];\n  }\n\n  // ********************************************************************\n  // Loading data\n  // ********************************************************************\n\n  onLoad: ((this: DataTable) => boolean) = null;\n\n  postLoad: ((this: DataTable) => boolean) = null;\n\n  private _isLoaded: boolean = false;\n\n  get isLoaded() {\n    return this._isLoaded;\n  }\n\n  async load() {\n    if (this._isLoaded)\n      return;\n\n    if (this.onLoad){\n      this._isLoaded = this.onLoad();\n      if(!this._isLoaded){\n        return Promise.reject(\"Cannot load data via custom loader\");\n      }\n      return;\n    }\n\n    // check loaders, and if loader accepts descriptor, try to load with the loader\n    for (const loader of DataLoaderRegistry) {\n      if (loader.accepts(this)) {\n        var result = await loader.load(this);\n        if (result) {\n          if (this.postLoad){\n            this.postLoad();\n          }\n          this._isLoaded = true;\n          return;\n        }\n      }\n    }\n\n    return Promise.reject(\"Cannot find data loader\");\n  }\n\n  createRecord(_data: any) {\n    var record = new Record(_data, this.id);\n    this.records.push(record);\n    this._byKey[record.id] = record;\n  }\n\n  /** -- */\n  static registerLoader(loader) {\n    DataLoaderRegistry.push(loader);\n  }\n\n  type: \"file\" | \"GoogleSheets\" | any;\n\n  // name of the ID column in dataset\n  id?: string;\n\n  file?: File;\n\n  gdocId?: string;\n  range?: null; // used by google sheet\n\n  dirPath?: string;\n  fullURL?: string;\n\n  // CSV parsin settings with defaults\n  header: boolean = true;\n  fastMode: boolean = false;\n  dynamicTyping: boolean = true;\n  download: boolean = false;\n  stream: boolean = false;\n\n  // fetch configuration\n  fetchConfig?: any;\n\n  /** -- */\n  constructor(dataDescr: TableSpec) {\n    if (dataDescr instanceof File) {\n      this.type = \"file\";\n      this.name = dataDescr.name;\n      this.file = dataDescr;\n      return;\n    }\n    if (typeof dataDescr === \"string\") {\n      dataDescr = { name: dataDescr };\n    }\n\n    dataDescr = Object.assign({}, dataDescr);\n\n    for (var x in dataDescr) {\n      this[x] = dataDescr[x];\n    }\n\n    if (this.gdocId) {\n      this.type = \"GoogleSheets\";\n    }\n\n    this.id = this.id ?? \"id\";\n\n    Base.tables.set(this.name, this);\n  }\n\n  fileType?: \"csv\" | \"tsv\" | \"json\";\n\n  get fileExt() {\n    return this.fileType ? \".\" + this.fileType.toLowerCase() : \"\";\n  }\n  get isCSV() {\n    return this.fileExt === \".csv\" || this.fileExt === \".tsv\";\n  }\n\n  get isGoogleFile() {\n    return (\n      this.dirPath === \"GoogleDrive\" ||\n      this.dirPath === \"https://drive.google.com/file/d/\"\n    );\n  }\n\n  get sourceURL() {\n    if (this.fullURL) return this.fullURL;\n    if (this.isGoogleFile)\n      return `https://www.googleapis.com/drive/v3/files/${this.name}?alt=media&key=${Base.gapi.gKey}`;\n    return (this.dirPath || \"\") + this.name + this.fileExt;\n  }\n\n  get linkToData() {\n    if (this.gdocId) {\n      return \"https://docs.google.com/spreadsheets/d/\" + this.gdocId;\n    }\n    return this.sourceURL;\n  }\n\n  /** -- */\n  async parseData(rawData) {\n    if (this.isCSV) {\n      return await this.parseData_CSV(rawData);\n    } else {\n      return await this.parseData_JSON(rawData);\n    }\n  }\n\n  /** -- */\n  async parseData_JSON(data) {\n    if (typeof data === \"string\") {\n      data = JSON.parse(data);\n    }\n\n    var idColumn = this.id;\n\n    data.forEach((_d, i) => {\n      if (_d[idColumn] === undefined) _d[idColumn] = \"\" + i;\n      this.createRecord(_d);\n    });\n\n    return true;\n  }\n\n  /** -- */\n  async parseData_CSV(data) {\n    let Papa = (window as any).Papa;\n    if (!Papa) {\n      // Sets window.Papa / Not a proper ES6 module\n      await import(\"papaparse\");\n      Papa = (window as any).Papa;\n    }\n\n    return new Promise((resolve, reject) => {\n      let _i = 0;\n\n      Papa.parse(data, {\n        header: this.header === false ? false : true,\n\n        fastMode: this.fastMode !== undefined ? this.fastMode : false,\n\n        dynamicTyping:\n          this.dynamicTyping !== undefined ? this.dynamicTyping : true, // true unless disabled\n\n        download: this.stream === true,\n\n        chunk: (_rows) => {\n          _rows.data.forEach((row) => {\n            if (row[this.id] === undefined) {\n              row[this.id] = \"\" + _i++;\n            }\n            this.createRecord(row);\n          });\n        },\n\n        complete: () => {\n          this.processHeaderHierarchy();\n          resolve?.(true);\n        },\n\n        error: (error) => {\n          console.log(error);\n          reject?.(\"CSV parsing error.\");\n        },\n      });\n    });\n  }\n\n  /** Helper function to process column name header hierarchies (..->..->..) */\n  processHeaderHierarchy(columns: any = null) {\n    if (!columns) {\n      columns = Object.keys(this.records[0].data);\n    }\n\n    columns.forEach((flatColName) => {\n      if (typeof flatColName !== \"string\") return;\n      var keys = flatColName.split(\"->\");\n      if (keys.length === 1) {\n        return; // no hierarchy\n      }\n      keys = keys.map((_) => _.trim()); // trim keys\n      var lastKey = keys.pop();\n      this.records.forEach((rec) => {\n        var _data = rec.data;\n        var _value = _data[flatColName];\n        if (_value != null) {\n          keys.forEach((key) => {\n            _data = _data[key] = _data[key] || {};\n          });\n          _data[lastKey] = _value;\n        }\n        delete rec.data[flatColName];\n      });\n    });\n  }\n}\n","import { Attrib_Content } from \"./Attrib_Content\";\nimport { Block } from \"./Block\";\nimport { i18n } from \"./i18n\";\n\nexport class Block_Content extends Block {\n  public readonly attrib: Attrib_Content;\n  constructor(attrib: Attrib_Content) {\n    super(attrib);\n  }\n\n  // ********************************************************************\n  // ********************************************************************\n\n  private height_content: number = 0;\n  public height_max: number = 10000;\n  public height_min: number = 100;\n\n  hasStaticHeight(): boolean {\n    return false;\n  }\n\n  get height_Content(): number {\n    return this.isVisible() ? this.height_content : 0;\n  }\n  get height_RangeMin(): number {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    return this.height_min;\n  }\n  get height_RangeMax(): number {\n    if (this.attrib.isEmpty()) return this.height_Header;\n    return this.height_max;\n  }\n  setHeight(targetHeight: number): void {\n    this.height_content =\n      Math.min(targetHeight, this.height_max) - this.height_Header;\n  }\n  refreshWidth(): void {}\n\n  // ********************************************************************\n  // ********************************************************************\n\n  private curStep: number = -1;\n  public onStep: Function = null;\n\n  /** -- */\n  onCollapse(): void {\n    if (this.collapsed) return;\n    this.displayStep(0);\n  }\n\n  /** -- */\n  initDOM(beforeDOM): boolean {\n    if (this.attrib.isEmpty()) return false;\n    if (this.DOM.inited) return true;\n\n    this.insertRoot(beforeDOM);\n\n    this.setCollapsed(this.collapsed);\n\n    this.DOM.contentWrapper = this.DOM.wrapper\n      .append(\"div\")\n      .attr(\"class\", \"contentWrapper\");\n\n    this.DOM.contentBlock = this.DOM.contentWrapper\n      .append(\"div\")\n      .attr(\"class\", \"contentBlock\");\n\n    if (this.attrib.isMultiStep()) {\n      var stepControls = this.DOM.contentWrapper\n        .append(\"div\")\n        .attr(\"class\", \"stepControls\");\n      stepControls\n        .append(\"div\")\n        .attr(\"class\", \"stepDots\")\n        .selectAll(\"div\")\n        .data([...Array(this.attrib.content.length).keys()])\n        .enter()\n        .append(\"div\")\n        .attr(\"class\", \"stepDot\")\n        .html(\"\")\n        .tooltip(i18n[\"Jump to step\"])\n        .on(\"click\", (_event, i) => this.displayStep(i));\n\n      stepControls\n        .append(\"div\")\n        .attr(\"class\", \"dismissButton\")\n        .html(i18n.Close)\n        .on(\"click\", () => this.setCollapsedAndLayout(true));\n\n      stepControls.append(\"div\").attr(\"class\", \"stepControlGap\");\n\n      this.DOM.stepPrev = stepControls\n        .append(\"div\")\n        .attr(\"class\", \"stepButton stepPrev\")\n        .html(\"<i class='fa fa-angle-double-left'></i>\" + i18n.Previous)\n        .on(\"click\", () => this.displayStep(this.curStep - 1));\n\n      this.DOM.stepNext = stepControls\n        .append(\"div\")\n        .attr(\"class\", \"stepButton stepNext\")\n        .html(i18n.Next + \"<i class='fa fa-angle-double-right'></i>\")\n        .on(\"click\", () => this.displayStep(this.curStep + 1));\n\n      this.DOM.stepClose = stepControls\n        .append(\"div\")\n        .attr(\"class\", \"stepButton stepClose\")\n        .html(i18n.Close + \"<i class='fa fa-compress-alt'></i>\")\n        .on(\"click\", () => this.setCollapsedAndLayout(true));\n    }\n\n    this.DOM.inited = true;\n\n    this.displayStep(0);\n\n    return true;\n  }\n\n  /** -- */\n  displayStep(stepIndex) {\n    if (!this.DOM.inited) return;\n    if (this.attrib.content.length == 0) return;\n    stepIndex = Math.min(\n      Math.max(0, stepIndex),\n      this.attrib.content.length - 1\n    );\n    if (this.curStep === stepIndex) return;\n\n    this.curStep = stepIndex;\n    var content = this.attrib.content[stepIndex];\n    if (typeof content === \"string\") {\n      this.DOM.contentBlock.html(content);\n      this.DOM.contentWrapper.classed(\"fullIframe\", false);\n    } else if (content.youtube) {\n      this.DOM.contentBlock.html(\n        `<iframe ` +\n          `src='https://www.youtube-nocookie.com/embed/${content.youtube}?controls=0` +\n          `frameborder=0 allow=\"autoplay; encrypted-media; picture-in-picture\"`\n      );\n      this.DOM.contentWrapper.classed(\"fullIframe\", true);\n    }\n\n    if (this.onStep) {\n      this.onStep.call(this);\n    }\n\n    this.DOM.contentBlock.node().scrollTop = 0;\n\n    this.DOM.contentWrapper\n      .classed(\"firstStep\", this.curStep === 0)\n      .classed(\"lastStep\", this.curStep === this.attrib.content.length - 1);\n\n    this.DOM.contentWrapper\n      .selectAll(\".stepDot\")\n      .classed(\"active\", (i) => this.curStep === i);\n  }\n\n  refreshViz_Axis() {\n  }\n\n  refreshViz_Active(): void {\n    return; // no action\n  }\n  refreshViz_Compare(\n    cT: any,\n    curGroup: any,\n    totalGroups: any,\n    prevCts: any\n  ): void {\n    return; // no action\n  }\n  chartAxis_Measure_TickSkip(): number {\n    return; // no action\n  }\n  updateAfterFilter(refreshViz: boolean): void {\n    return; // no action\n  }\n}\n","import { Attrib } from \"./Attrib\";\nimport { BlockContentSpec } from \"./Types\";\nimport { Browser } from \"./Browser\";\nimport { Block_Content } from \"./Block_Content\";\n\n/** -- */\nexport class Attrib_Content extends Attrib {\n  protected _block: Block_Content;\n  public get block(): Block_Content {\n    return this._block;\n  }\n\n  /** -- */\n  private _content: BlockContentSpec[] = [];\n  get content() {\n    return this._content;\n  }\n\n  /** -- */\n  constructor(browser: Browser, name: string) {\n    super(\n      browser,\n      name,\n      null,\n      \"content\",\n      \"kshfBlock_Content\",\n      \"fa fa-file-alt\"\n    );\n\n    this._block = new Block_Content(this);\n  }\n\n  /** -- */\n  isEmpty(): boolean {\n    return this._content.length > 0;\n  }\n  isMultiStep(): boolean {\n    return this._content.length > 1;\n  }\n\n  /** -- */\n  async applyConfig(blockCfg) {\n    super.applyConfig(blockCfg);\n\n    this.setContent(blockCfg._content);\n\n    this.block.height_max = blockCfg.maxHeight;\n    this.block.height_min = blockCfg.minHeight;\n\n    this.block.onStep = blockCfg.onStep;\n  }\n\n  /** -- */\n  setContent(v: BlockContentSpec[] = []): void {\n    this._content = v;\n    this.block?.displayStep(0);\n  }\n\n  initializeAggregates(): void {}\n  updateChartScale_Measure(): void {}\n\n  get measureRangeMax(): number {\n    throw new Error(\"Not supported\");\n  }\n\n}\n","import { Browser } from \"../Browser\";\nimport { TimeKey } from \"../TimeSeriesData\";\nimport { Record } from \"../Record\";\nimport { i18n } from \"../i18n\";\nimport { Util } from \"../Util\";\nimport { Attrib } from \"../Attrib\";\n\nimport { max } from \"d3-array\";\nimport { select } from \"../d3_select\";\nimport { scaleLinear } from \"d3-scale\";\nimport { Attrib_Timeseries } from \"../Attrib_Timeseries\";\nimport { Modal } from \"./Modal\";\nimport { RecordDetailSpec } from \"../Types\";\n\nconst d3 = {\n  select,\n  max,\n  scaleLinear,\n};\n\nexport class RecordDetailPopup {\n  browser: Browser;\n  recordInDetail?: Record;\n\n  timeKeyInDetail?: TimeKey;\n  recordDetailTimeKeys?: TimeKey[];\n\n  recordDetailAttribs?: string[] = [];\n  recordDetailAttribs_Hidden?: string[];\n\n  constructor(browser: Browser) {\n    this.browser = browser;\n\n    if (this.browser.options.recordDetailAttribs) {\n      this.recordDetailAttribs = Array.from(\n        this.browser.options.recordDetailAttribs\n      );\n    }\n  }\n\n  get DOM() {\n    return this.browser.DOM;\n  }\n\n  initDOM() {\n    var overlay_recordDetails = this.DOM.overlay_wrapper\n      .append(\"div\")\n      .attr(\"class\", \"overlay_content overlay_recordDetails\");\n    overlay_recordDetails.append(\"div\").attr(\"class\", \"overlay_Header\");\n    overlay_recordDetails\n      .append(\"div\")\n      .attr(\"class\", \"overlay_Close fa fa-window-close\")\n      .tooltip(i18n.Close, { placement: \"bottom\" })\n      .on(\"click\", () => this.closeRecordDetailPanel());\n    overlay_recordDetails\n      .append(\"div\")\n      .attr(\"class\", \"filterOutRecord fa fa-filter\")\n      .tooltip(i18n[\"Filter out\"], { placement: \"bottom\" })\n      .on(\"click\", () => {\n        this.browser.recordDisplay.recordFilter.removeRecord(\n          this.recordInDetail\n        );\n        this.DOM.overlay_wrapper.attr(\"show\", \"none\");\n      });\n    this.DOM.overlay_recordDetails_content = overlay_recordDetails\n      .append(\"div\")\n      .attr(\"class\", \"content\");\n  }\n\n  /** -- */\n  prepareRecordDetailColumns() {\n    this.browser.attribs.forEach((attrib) => {\n      if (attrib.hasTimeSeriesParent()) return;\n      if (attrib.attribName === \"_Records\") return;\n      attrib.initializeAggregates();\n      this.recordDetailAttribs.push(attrib.attribName);\n    });\n\n    this.recordDetailAttribs.sort((name1, name2) => {\n      var s1 = this.browser.attribWithName(name1);\n      var s2 = this.browser.attribWithName(name2);\n      if (!s1) return -1;\n      if (!s2) return 1;\n      var diff =\n        Util.getAttribTypeOrder(s1.type) - Util.getAttribTypeOrder(s2.type);\n      return diff\n        ? diff\n        : Util.sortFunc_List_String(s1.attribName, s2.attribName);\n    });\n  }\n\n  /** -- */\n  updateRecordDetailPanel_Header(record) {\n    var idSummary = this.browser.attribWithName(this.browser.idSummaryName);\n    idSummary.initializeAggregates();\n\n    var overlay_Header = this.DOM.overlay_wrapper.select(\n      \".overlay_recordDetails > .overlay_Header\"\n    );\n    overlay_Header.html(\"\");\n\n    overlay_Header\n      .append(\"span\")\n      .attr(\"class\", \"idSummaryName\")\n      .html(idSummary.attribName);\n\n    var disableRecordSelectBox = this.browser.records.length >= 2500;\n    var _ = overlay_Header\n      .append(\"span\")\n      .attr(\"class\", \"idContentWrapper\")\n      .classed(\"disabled\", disableRecordSelectBox);\n    _.append(\"span\")\n      .attr(\"class\", \"theText\")\n      .html(idSummary.getRecordValue(record));\n\n    if (!disableRecordSelectBox) {\n      _.append(\"select\").on(\"change\", (event) => {\n        this.updateRecordDetailPanel(\n          event.currentTarget.selectedOptions[0].__data__[0]\n        );\n      });\n      _.select(\"select\").selectAll(\"option\").remove();\n\n      _.select(\"select\")\n        .selectAll(\"option\")\n        .data(\n          this.browser.records\n            .map((r) => [r, idSummary.getRecordValue(r)])\n            .sort((a, b) => Util.sortFunc_List_String(a[1], b[1]))\n        )\n        .enter()\n        .append(\"option\")\n        .attr(\"selected\", (r) => (r[0].id === record.id ? true : null))\n        .html((r) => r[1]);\n    }\n  }\n\n  /** -- */\n  closeRecordDetailPanel() {\n    if (!this.recordInDetail) return;\n    this.recordInDetail = null;\n\n    this.browser.options.onRecordClose?.call(this);\n\n    this.DOM.overlay_wrapper.attr(\"show\", \"none\");\n  }\n  /** -- */\n  updateRecordDetailPanel(record: Record) {\n    this.recordInDetail = record;\n\n    this.DOM.overlay_wrapper\n      .attr(\"show\", \"recordDetails\")\n      .classed(\"easyDismiss\", true);\n\n    this.updateRecordDetailPanel_Header(record);\n\n    if (this.browser.options.onRecordView) {\n      this.DOM.overlay_recordDetails_content.html(\n        this.browser.options.onRecordView.call(record.data, record)\n      );\n      return;\n    }\n\n    if (this.recordDetailAttribs.length === 0) {\n      this.prepareRecordDetailColumns();\n    }\n\n    // extend the \"hidden\" list based on what this record also contains\n    this.recordDetailAttribs_Hidden = [];\n    this.browser.attribs.forEach((attrib) => {\n      attrib.initializeAggregates();\n\n      if (attrib.hasTimeSeriesParent()) return;\n      if (this.recordDetailAttribs.indexOf(attrib.attribName) >= 0) return;\n      if (attrib.getRecordValue(record) == null) return;\n\n      this.recordDetailAttribs_Hidden.push(attrib.attribName);\n    });\n\n    var menuOpt = {\n      name: \"Edit order\",\n      items: [\n        {\n          name: \" Move up\",\n          do: (summary) => {\n            var movedSummaryName = summary.summaryName;\n            var _i = this.recordDetailAttribs.indexOf(movedSummaryName);\n            if (_i == -1 || _i === 0) return;\n            this.recordDetailAttribs.splice(_i, 1);\n            this.recordDetailAttribs.splice(_i - 1, 0, movedSummaryName);\n            this.updateRecordDetailPanel(record);\n          },\n        },\n        {\n          name: \" Move down\",\n          do: (summary) => {\n            var movedSummaryName = summary.summaryName;\n            var _i = this.recordDetailAttribs.indexOf(movedSummaryName);\n            if (_i == -1 || _i === this.recordDetailAttribs.length - 1) return;\n            this.recordDetailAttribs.splice(_i, 1);\n            this.recordDetailAttribs.splice(_i + 1, 0, movedSummaryName);\n            this.updateRecordDetailPanel(record);\n          },\n        },\n        {\n          name: \"Remove\",\n          iconClass: \"fa fa-minus-square\",\n          do: (a) => {\n            this.recordDetailAttribs = this.recordDetailAttribs.filter(\n              (c) => c !== a.attribName\n            );\n            this.updateRecordDetailPanel(record);\n          },\n        },\n        {\n          name: \"Add below\",\n          iconClass: \"fa fa-plus-square\",\n          when: () => this.recordDetailAttribs_Hidden.length > 0,\n          do: (selectedSummary, summaryNameToAdd) => {\n            // add to visible list\n            var pos = this.recordDetailAttribs.indexOf(\n              selectedSummary.attribName\n            );\n            if (pos === -1) return;\n            this.recordDetailAttribs.splice(pos + 1, 0, summaryNameToAdd);\n            // remove from hidden list\n            this.recordDetailAttribs_Hidden =\n              this.recordDetailAttribs_Hidden.filter(\n                (hc) => hc !== summaryNameToAdd\n              );\n            this.updateRecordDetailPanel(record);\n          },\n          options: this.recordDetailAttribs_Hidden.map((c) => ({\n            name: c,\n            value: c,\n          })),\n        },\n      ],\n    };\n\n    // create the hierarchical outline!\n    var outline = {\n      _basic: [],\n      _timeseries: [],\n    };\n\n    this.recordDetailAttribs.forEach((attribName) => {\n      if (attribName === this.browser.idSummaryName) return;\n      var attrib = this.browser.attribWithName(attribName);\n      if (!attrib) return;\n      var v = attrib.getRecordValue(record);\n      if (v == null) return;\n      if (v.length === 0) return;\n\n      var _outline =\n        attrib.type === \"timeseries\" ? outline._timeseries : outline._basic;\n\n      attrib.pathName.forEach((path) => {\n        if (\n          !_outline.some((item) => {\n            if (item instanceof Attrib) return false;\n            if (item.path === path) {\n              _outline = item.items;\n              return true;\n            }\n            return false;\n          })\n        ) {\n          // path not found\n          var _ = {\n            path: path,\n            items: [],\n          };\n          _outline.push(_);\n          _outline = _.items;\n        }\n      });\n\n      _outline.push(attrib);\n    });\n\n    // if a summary has a printName same as its last path name, move it under to last path\n    [\"_basic\", \"_timeseries\"].forEach((p) => {\n      var proc = (_outline) =>\n        _outline.filter((item) => {\n          if (item.path) {\n            item.items = proc(item.items);\n            return true;\n          }\n          return !_outline.some((item2, i) => {\n            if (item2 instanceof Attrib) return false;\n            if (item2.path === item.printName) {\n              item2.items.unshift(item);\n              return true;\n            }\n            return false;\n          });\n        });\n      outline[p] = proc(outline[p]);\n    });\n\n    var getMaxDepth = (_outline) =>\n      _outline.reduce((accum, item) => {\n        return !item.path\n          ? accum\n          : 1 + d3.max(item.items, (_) => (_.items ? getMaxDepth(_.items) : 1));\n      }, 0);\n\n    var maxDepth = getMaxDepth(outline._timeseries);\n\n    // removes any content that was here previously.\n    this.DOM.overlay_recordDetails_content.html(\"\");\n\n    var _table = this.DOM.overlay_recordDetails_content\n      .append(\"table\")\n      .attr(\"class\", \"recordAttribTable\");\n\n    var renderRecordValues = (tbody, items, prevPath) => {\n      var rowsDOM = tbody\n        .selectAll(\"tr.nonexistent\")\n        .data(items)\n        .enter()\n        .append(\"tr\");\n\n      var lastPath = prevPath[prevPath.length - 1] || \"\";\n\n      var addHWrapper = (_td) => {\n        _td\n          .append(\"div\")\n          .attr(\"class\", \"attribHierarchyWrapper\")\n          .call((_div) => {\n            _div\n              .filter((s) => !s.printName || s.printName === lastPath)\n              .append(\"span\")\n              .attr(\"class\", \"hrchyItem collapseArrow\")\n              .on(\"click\", () =>\n                _td.node().parentNode.parentNode.classList.toggle(\"collapsed\")\n              )\n              .append(\"span\")\n              .attr(\"class\", \"fa fa-caret-down\")\n              .tooltip(\"Show/Hide components\");\n            _div\n              .selectAll(\"span.extendLine\")\n              .data((s) => Array.from(prevPath).filter((_) => _ != s.printName))\n              .enter()\n              .append(\"span\")\n              .attr(\"class\", \"hrchyItem extendLine\");\n          });\n      };\n\n      var addRecAttribName = (_tr) => {\n        _tr\n          .append(\"td\")\n          .attr(\"class\", \"recAttribName\")\n          .call((recAttribName) => {\n            recAttribName\n              .filter((attrib) => attrib.description)\n              .append(\"span\")\n              .attr(\"class\", \"summaryDescription far fa-info-circle\")\n              .tooltip((_) => _.description, { placement: \"bottom\" });\n            recAttribName\n              .append(\"span\")\n              .attr(\"class\", \"TheName\")\n              .style(\n                \"font-size\",\n                Math.pow(1.1, maxDepth - prevPath.length) + \"em\"\n              )\n              .html((attrib) => attrib.printName.trim()); //+(\"<i class='fa fa-level-up'></i>\").repeat(prevPath.length));\n            recAttribName\n              .append(\"span\")\n              .attr(\"class\", \"modifyAttribPos fa fa-bars\")\n              .on(\"click\", (event, attrib) =>\n                Modal.popupMenu(event, menuOpt, attrib)\n              );\n            addHWrapper(recAttribName);\n          });\n      };\n\n      rowsDOM\n        .filter((_) => !(_ instanceof Attrib_Timeseries))\n        .attr(\"class\", \"attribRow basicAttrib\")\n        .classed(\"groupTitle\", (s) => s.printName === lastPath)\n        .attr(\"summaryID\", (s) => s.attribID)\n        .each((attrib, i, nodes) => {\n          if (!(attrib instanceof Attrib)) return;\n\n          var _tr = d3.select(nodes[i]);\n\n          attrib.initializeAggregates();\n\n          addRecAttribName(_tr);\n\n          var _recAttribVal = _tr\n            .append(\"td\")\n            .attr(\"class\", \"recAttribVal\")\n            .attr(\"colspan\", 5);\n\n          attrib.renderRecordValue(record, _recAttribVal);\n        });\n\n      rowsDOM\n        .filter((_) => _ instanceof Attrib_Timeseries)\n        .attr(\"class\", \"attribRow timeseriesAttrib\")\n        .classed(\"groupTitle\", (s) => s.printName === lastPath)\n        .attr(\"summaryID\", (s) => s.attribID)\n        .call((_tr) => {\n          addRecAttribName(_tr);\n\n          _tr\n            .append(\"td\")\n            .attr(\"class\", \"recTimeKeyValue\")\n            .call((td) => {\n              td.append(\"div\").attr(\"class\", \"ValueText\");\n              td.filter((s) => s.isComparable.val)\n                .append(\"div\")\n                .attr(\"class\", \"ValueBar\")\n                .append(\"div\")\n                .attr(\"class\", \"TheBar\");\n            });\n          _tr\n            .append(\"td\")\n            .attr(\"class\", \"recTimeKeyChange\")\n            .tooltip(\"\", { placement: \"bottom\" })\n            .html(\"<i class='fa fa-angle-right'></i>\");\n          _tr.append(\"td\").attr(\"class\", \"recTimeKeyRank\");\n\n          _tr\n            .append(\"td\")\n            .attr(\"class\", \"recAttribVal\")\n            .each((attrib: Attrib_Timeseries, i, nodes) => {\n              attrib.renderRecordValue(\n                record,\n                d3.select(nodes[i]),\n                this.recordDetailTimeKeys\n              );\n            });\n        });\n\n      rowsDOM\n        .filter((_) => !(_ instanceof Attrib))\n        .attr(\"class\", \"groupedTableWrapper\")\n        .append(\"td\")\n        .append(\"table\")\n        .append(\"tbody\")\n        .attr(\"class\", \"groupedTable collapsed\")\n        .each((_item, i, nodes) => {\n          var _tbody = d3.select(nodes[i]);\n          if (_item.items[0].printName !== _item.path) {\n            var _tr = _tbody.append(\"tr\").attr(\"class\", \"groupTitle\");\n            _tr\n              .append(\"td\")\n              .attr(\"class\", \"recAttribName\")\n              .call((groupName) => {\n                groupName\n                  .append(\"span\")\n                  .attr(\"class\", \"TheName\")\n                  .style(\n                    \"font-size\",\n                    Math.pow(1.1, maxDepth - prevPath.length) + \"em\"\n                  )\n                  .on(\"click\", () =>\n                    _tbody.node().classList.toggle(\"collapsed\")\n                  )\n                  .html(_item.path.trim());\n                addHWrapper(groupName);\n              });\n            _tr.append(\"td\").attr(\"class\", \"groupNameGap\");\n          }\n\n          renderRecordValues(\n            _tbody,\n            _item.items,\n            prevPath.concat([_item.path])\n          );\n\n          //_tbody.append(\"tr\").attr(\"class\",\"groupCloseRow\").append(\"td\");\n        });\n    };\n\n    renderRecordValues(\n      _table.append(\"tbody\").attr(\"class\", \"basicAttribs\"),\n      outline._basic,\n      []\n    );\n\n    if (outline._timeseries.length > 0) {\n      _table\n        .append(\"tr\")\n        .style(\"height\", \"0.5em\")\n        .style(\"grid-column\", \"1 / span 5\");\n\n      var _tbody = _table.append(\"tbody\").attr(\"class\", \"timeseriesAttribs\");\n\n      this.recordDetailTimeKeys = record.getTimeKeys();\n\n      this.browser.recordDisplay.config.timeseriesWidth = Math.min(\n        (this.recordDetailTimeKeys.length - 1) * 70,\n        400\n      );\n\n      var _tr = _tbody.append(\"tr\");\n      _tr.append(\"td\");\n      var timeKeySelect = _tr\n        .append(\"td\")\n        .attr(\"colspan\", 3)\n        .attr(\"class\", \"timeKeySelect\");\n\n      timeKeySelect\n        .append(\"i\")\n        .attr(\"class\", \"prevTimeKey fa fa-caret-left\")\n        .tooltip(i18n.Previous)\n        .on(\"click\", () =>\n          this.updateFocusedTimeKey(this.timeKey_Step(\"previous\"))\n        );\n      timeKeySelect\n        .append(\"select\")\n        .on(\"change\", (event) =>\n          this.updateFocusedTimeKey(\n            event.currentTarget.selectedOptions[0].__data__\n          )\n        )\n        .selectAll(\"option\")\n        .data(this.recordDetailTimeKeys, (x) => x._time)\n        .enter()\n        .append(\"option\")\n        .text((k) => k._time_src);\n      timeKeySelect\n        .append(\"i\")\n        .attr(\"class\", \"nextTimeKey fa fa-caret-right\")\n        .tooltip(i18n.Next)\n        .on(\"click\", () =>\n          this.updateFocusedTimeKey(this.timeKey_Step(\"next\"))\n        );\n\n      _tr.append(\"td\").attr(\"class\", \"timeseriesEditView\");\n\n      var _tr = _tbody.append(\"tr\").attr(\"class\", \"columnHead\");\n      _tr.append(\"td\");\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Value\").text(\"Value\");\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Change\").text(\"Change\");\n      _tr.append(\"td\").attr(\"class\", \"columnHead_Rank\").text(\"Rank\");\n      _tr\n        .append(\"td\")\n        .attr(\"class\", \"columnHead_TimeTrends\")\n        .text(\"Time Trends\");\n\n      renderRecordValues(_tbody, outline._timeseries, []);\n\n      this.updateFocusedTimeKey(this.recordDetailTimeKeys[0]);\n    }\n\n    // Some random Keshif project uses this to inject some code after main record display view. Hmmm...\n    this[\"updateRecordDetailPanel_custom\"]?.call(this, record);\n  }\n\n  /** -- */\n  updateFocusedTimeKey(timeKey: TimeKey) {\n    if (!this.recordInDetail || !timeKey) return;\n\n    var _time_src: string = timeKey._time_src;\n\n    var timeKeyPos: number = this.getTimeKey_Index(timeKey);\n    if (timeKeyPos < 0) return; // cannot find the timeKey within the record\n\n    this.timeKeyInDetail = timeKey;\n\n    var prevTimeKey: TimeKey =\n      timeKeyPos >= this.recordDetailTimeKeys.length - 1\n        ? null\n        : this.recordDetailTimeKeys[timeKeyPos + 1];\n\n    d3.select(\".timeKeySelect > .nextTimeKey\").classed(\n      \"active\",\n      timeKeyPos !== 0\n    );\n    d3.select(\".timeKeySelect > .prevTimeKey\").classed(\n      \"active\",\n      timeKeyPos !== this.recordDetailTimeKeys.length - 1\n    );\n\n    var _table = this.DOM.overlay_recordDetails_content.select(\n      \"table.recordAttribTable\"\n    );\n\n    _table\n      .selectAll(\".timeseriesAttribs tr:first-child > td > select > option\")\n      .data([timeKey], (x) => x._time)\n      .node().selected = true;\n\n    _table\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue\")\n      .each((attrib: Attrib_Timeseries) => attrib.computeRecordRanks());\n    _table\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue > .ValueText\")\n      .html((attrib: Attrib_Timeseries) => {\n        var ts = attrib.getRecordValue(this.recordInDetail);\n        if (!ts) return \"-\";\n        let v = ts._keyIndex[_time_src];\n        if (!v) return \"-\";\n        return attrib.getFormattedValue(v._value);\n      });\n\n    var clampScale = d3\n      .scaleLinear()\n      .domain([0, 100])\n      .range([0, 100])\n      .clamp(true);\n\n    _table\n      .selectAll(\".timeseriesAttribs .recTimeKeyValue > .ValueBar > .TheBar\")\n      .style(\"width\", (attrib: Attrib_Timeseries) => {\n        var ts = attrib.getRecordValue(this.recordInDetail);\n        if (!ts) return null;\n        var v = ts._keyIndex[_time_src];\n        if (!v) return null;\n        if (attrib.unitName === \"%\") {\n          // value is measured in percentage anyway, and width is percentage of the box!\n          return clampScale(v._value) + \"%\";\n        }\n        return clampScale(attrib.timeSeriesScale_Value(v._value) * 100) + \"%\"; // cannot exceed 100%\n      });\n\n    _table\n      .selectAll(\".timeseriesAttribs .recTimeKeyChange\")\n      .attr(\"data-status\", (attrib: Attrib_Timeseries, i, nodes) => {\n        var DOM = nodes[i];\n        var diff: number = null,\n          disp = \"-\",\n          _title = \"-\",\n          status = \"noValue\";\n        var ts = attrib.getRecordValue(this.recordInDetail);\n        if (!ts || ts.isEmpty()) {\n          nodes[i].tippy.setContent(\"No data\");\n          return \"\";\n        }\n        if (prevTimeKey) {\n          var prev = ts._keyIndex[prevTimeKey._time_src];\n          var cur = ts._keyIndex[_time_src];\n          if (prev && cur) diff = cur._value - prev._value;\n          if (attrib.hasFlippedDomain()) diff *= -1; // flip\n        }\n        if (diff !== null) {\n          var threshold = attrib.timeSeriesScale_Value.domain();\n          threshold = Math.abs(threshold[1] - threshold[0]) / 50; // 1/50th of the range is the signal of change\n          // TODO: make this a parameter\n          if (diff > threshold) {\n            status = \"improve\";\n          } else if (diff < -threshold) {\n            status = \"decline\";\n          } else {\n            status = \"steady\";\n          }\n          _title =\n            `<b>Change from<br>${prevTimeKey._time_src} to ${_time_src}</b>:<br>` +\n            attrib.getFormattedValue(diff);\n        }\n        nodes[i].tippy.setContent(_title);\n        return status;\n      });\n\n    _table\n      .selectAll(\".timeseriesAttribs .recTimeKeyRank\")\n      .html((attrib: Attrib_Timeseries, i, nodes) => {\n        var DOM = nodes[i];\n        DOM.__NumRecords = 0;\n        var ts = attrib.getRecordValue(this.recordInDetail);\n        if (!ts || ts.isEmpty()) return \"-\";\n        let v = ts._keyIndex[_time_src];\n        if (!v || v._rank == 0) return \"-\";\n\n        DOM.__NumRecords = this.browser.records.reduce(\n          (accumulator, rec: Record) => {\n            if (rec.filteredOut) return accumulator;\n\n            var ts = attrib.getRecordValue(rec);\n            if (!ts || ts.isEmpty()) return accumulator;\n\n            let _val = ts._keyIndex[_time_src];\n            if (_val == null) return accumulator;\n\n            return accumulator + 1;\n          },\n          0\n        );\n\n        return `<span class='rankValue'>${v._rank}</span><span class='rankOutOf'>${DOM.__NumRecords}</span>`;\n      })\n      .tooltip(\"\")\n      .on(\"mouseover\", (event) => {\n        var DOM = event.currentTarget;\n        // TODO: consider only records that have valid values\n        // need to process per each row/attribute -\n        // of the ones that are active, do not consider those that do not have a value for the\n        DOM.tippy.setContent(\n          \"Ranking among \" +\n            DOM.__NumRecords +\n            (this.browser.isFiltered() ? \" filtered \" : \" \") +\n            this.browser.recordName\n        );\n      });\n\n    var DOMdots = _table.selectAll(\".recordTimeseriesDot\");\n\n    var refreshedCurrentKeyClass = (altKey) => {\n      DOMdots.classed(\n        \"currentKey\",\n        (d) => d._time.getTime() === altKey._time.getTime()\n      );\n    };\n\n    _table\n      .selectAll(\".recordTimeseriesDot\")\n      .classed(\n        \"currentKey\",\n        (d) => d._time.getTime() === timeKey._time.getTime()\n      )\n      .on(\"mouseover\", (_event, x) => refreshedCurrentKeyClass(x))\n      .on(\"mouseout\", () => refreshedCurrentKeyClass(timeKey));\n\n    refreshedCurrentKeyClass(timeKey);\n\n    // Another project-specific customization that should be in the core in a different way\n    this[\"updateFocusedTimeKey_custom\"]?.();\n  }\n\n  getTimeKey_Index(timeKey) {\n    return this.recordDetailTimeKeys.findIndex(\n      (tK) => tK._time.getTime() == timeKey._time.getTime()\n    );\n  }\n\n  /** next or previous */\n  timeKey_Step(sequence) {\n    if (!(sequence === \"next\" || sequence === \"previous\")) return null;\n    var timeKeyPos = this.getTimeKey_Index(this.timeKeyInDetail);\n    if (timeKeyPos < 0) return null;\n    return (\n      this.recordDetailTimeKeys[timeKeyPos + (sequence === \"next\" ? -1 : 1)] ||\n      null\n    );\n  }\n\n  exportConfig(): RecordDetailSpec {\n    return {\n      recordInDetail: this.recordInDetail?.id,\n      recordDetailAttribs: this.recordDetailAttribs\n        ? Array.from(this.recordDetailAttribs)\n        : undefined,\n    };\n  }\n}\n","import DOMPurify from \"dompurify/dist/purify.es\";\n\nimport { select, pointer } from \"./d3_select\";\nimport { rgb } from \"d3-color\";\nimport { max } from \"d3-array\";\nimport { scaleLinear } from \"d3-scale\";\nimport * as d3Chromatic from \"d3-scale-chromatic\";\n\nimport { RecordDisplay } from \"./RecordDisplay\";\n\nimport {\n  Aggregate_Interval,\n  Aggregate_Interval_Numeric,\n} from \"./Aggregate_Interval\";\nimport { Aggregate } from \"./Aggregate\";\n\nimport { loadMapStandards } from \"./MapStandards\";\n\nimport { ConfigPanel } from \"./UI/ConfigPanel\";\nimport { BreadCrumb } from \"./UI/Breadcrumb\";\nimport { MenuOpts } from \"./UI/MenuOpts\";\nimport { Modal } from \"./UI/Modal\";\nimport { Panel } from \"./UI/Panel\";\n\nimport { Config } from \"./Config\";\nimport { i18n } from \"./i18n\";\nimport { Util } from \"./Util\";\nimport { Base } from \"./Base\";\n\n// Standarad fetch and googlesheet loaders are included by default.\nimport { DataLoader_FetchURL } from \"./DataLoader/FetchURL\";\nimport { DataLoader_GoogleSheets } from \"./DataLoader/GoogleSheets\";\nimport { DataTable } from \"./DataTable\";\n\nimport { Filter_Base } from \"./Filter\";\n\nimport { Attrib } from \"./Attrib\";\nimport { Record } from \"./Record\";\nimport { Block } from \"./Block\";\n\nimport { Attrib_Categorical } from \"./Attrib_Categorical\";\nimport { Attrib_Timestamp } from \"./Attrib_Timestamp\";\nimport { Attrib_RecordGeo } from \"./Attrib_RecordGeo\";\nimport { Attrib_Interval } from \"./Attrib_Interval\";\nimport { Attrib_Numeric } from \"./Attrib_Numeric\";\nimport { Attrib_Content } from \"./Attrib_Content\";\nimport { AttribTemplate } from \"./AttribTemplate\";\n\nimport {\n  BlockType,\n  CompareType,\n  ConfigSpec,\n  DashboardMode,\n  IntervalT,\n  MeasureFunc,\n  MeasureType,\n  PanelName,\n  RecordDisplayType,\n  SummarySpec,\n} from \"./Types\";\n\nimport { Attrib_Timeseries } from \"./Attrib_Timeseries\";\n\nimport { TimeSeriesData } from \"./TimeSeriesData\";\n\nimport { Block_Categorical } from \"./Block_Categorical\";\nimport { RecordDetailPopup } from \"./UI/RecordDetailsPopup\";\n\nconst d3 = {\n  select,\n  pointer,\n  rgb,\n  max,\n  scaleLinear,\n  ...d3Chromatic, // all values in chromatic module\n};\n\nexport type ColorThemeType = \"sequential\" | \"diverging\";\n\nexport type BreakdownType = \"absolute\" | \"dependent\" | \"relative\" | \"total\";\n\ntype DataTypeDescr = {\n  name: string;\n  icon: string;\n  member: (a: Attrib) => boolean;\n  active: boolean;\n};\n\n/** \n    Detected transformations:\n    > STR\n    > JSON\n    > POSITIVE\n    > DATETIME\n    > DELETE\n    > LAT_LONG(lat,long)\n    > MULTIVAL(a;b;c;d;...)\n    > ${DATETIME}\n    > SPLIT\n   */\nfunction applyPreProc(_key: string, _transform: string, recordList: Record[]) {\n  var keySequence = _key.split(\"->\");\n\n  var keyIndex = keySequence[keySequence.length - 1];\n  var keyHostFunc = (v) => {\n    for (var i = 0; i < keySequence.length - 1; i++) {\n      v = v[keySequence[i]];\n      if (v == null) return;\n    }\n    return v;\n  };\n\n  if (_transform === \"DELETE()\") {\n    recordList.forEach((r) => {\n      var host = keyHostFunc(r.data);\n      if (host) delete host[keyIndex];\n    });\n    return;\n  }\n\n  let transformFunc: Function = null;\n\n  /* jshint ignore:start */\n  var isTimeseries = RegExp(/(.+)->\\$\\{(.+)\\}/).exec(_transform);\n  var isDateTime = RegExp(\"DATETIME\\\\((.+)\\\\)\").exec(_transform);\n  var isMultiVal = RegExp(\"MULTIVAL\\\\((.+)\\\\)\").exec(_transform);\n  var isSplit = RegExp(\"SPLIT\\\\((.+)\\\\)\").exec(_transform);\n  var isLatLong = RegExp(\"LAT_LONG\\\\((.+),(.+)\\\\)\").exec(_transform);\n  /* jshint ignore:end */\n\n  if (_transform === \"STR()\") {\n    // convert value to string\n    transformFunc = (v) => (v == null ? null : \"\" + v);\n    //\n  } else if (_transform === \"JSON()\") {\n    // parse value as JSON string\n    transformFunc = (v) => (v == null ? null : JSON.parse(v));\n    //\n  } else if (_transform === \"POSITIVE()\") {\n    // keep only positive values\n    transformFunc = (v) => (v && typeof v === \"number\" && v > 0 ? v : null);\n    //\n  } else if (!isTimeseries && isDateTime && isDateTime.length > 1) {\n    // parse the date given a string\n    var _timeParse = Util.getTimeParseFunc(isDateTime[1]);\n    transformFunc = (v) => (v == null ? null : _timeParse(v));\n    //\n  } else if (isSplit && isSplit.length > 1) {\n    // split values in a string into multiple string\n    var splitExpr = RegExp(isSplit[1]);\n\n    transformFunc = (v): string[] => {\n      if (v == null) return null;\n      if (typeof v === \"number\") {\n        return [\"\" + v];\n      }\n      if (Array.isArray(v)) {\n        if (v.length === 1) {\n          v = v[0]; // try to split the first/only element\n        } else {\n          return v;\n        }\n      }\n\n      // split, trim and cleanup\n      return v\n        .split(splitExpr)\n        .map((x) => x.trim())\n        .filter((x) => x !== \"\");\n    };\n  } else if (isMultiVal && isMultiVal.length > 1) {\n    // merge data from multiple columns\n    var splitExpr = RegExp(\"\\\\s*;\\\\s*\");\n\n    var colNames = isMultiVal[1]\n      .split(splitExpr)\n      .map((x) => x.trim())\n      .filter((x) => x !== \"\");\n\n    if (colNames.length >= 2) {\n      transformFunc = (v, r) => {\n        var _return = [];\n        colNames.forEach((c) => {\n          if (r[c]) {\n            _return.push(r[c]);\n            delete r[c];\n          }\n        });\n        return _return;\n      };\n    }\n  } else if (isTimeseries && isTimeseries.length > 1) {\n    // prepare timeseries structure\n    var _isDateTime = RegExp(\"DATETIME\\\\((.+)\\\\)\").exec(isTimeseries[2]);\n\n    if (_isDateTime && _isDateTime.length > 1) {\n      var __timeParse = Util.getTimeParseFunc(_isDateTime[1]);\n\n      var valueKey = null;\n      var hasValueKey = RegExp(\"::(.+)\").exec(isTimeseries[2]);\n      if (hasValueKey && hasValueKey.length > 1) {\n        valueKey = hasValueKey[1];\n      }\n\n      transformFunc = (v) => {\n        if (v == null) return null;\n\n        let _ts = new TimeSeriesData();\n\n        for (var timeKey in v) {\n          var _value = v[timeKey];\n          if (typeof _value !== \"number\") {\n            continue; // Must be numeric value\n          }\n          var _time = __timeParse(timeKey.trim());\n          if (_time == null) {\n            continue; // cannot parse the string key to date object\n          }\n          _ts.addTimeData({\n            _time: _time,\n            _time_src: timeKey,\n            _value: valueKey ? _value[valueKey] : _value,\n          });\n        }\n\n        // merge timeseries data with object\n        return _ts;\n      };\n    }\n  }\n\n  if (transformFunc) {\n    recordList.forEach((r) => {\n      var host = keyHostFunc(r.data);\n      if (host == null) return;\n      try {\n        host[keyIndex] = transformFunc(host[keyIndex], r.data);\n      } catch (e) {\n        console.log(\"onLoad _transform error: \" + e);\n      }\n    });\n    return;\n  }\n\n  if (isLatLong && isLatLong.length > 1) {\n    var latAttrib = isLatLong[1];\n    var lonAttrib = isLatLong[2];\n    recordList.forEach((r) => {\n      var host = keyHostFunc(r.data);\n      if (!host) return;\n      var _lat = r.data[latAttrib];\n      var _lng = r.data[lonAttrib];\n      if (\n        _lat &&\n        _lng &&\n        typeof _lat === \"number\" &&\n        typeof _lng === \"number\"\n      ) {\n        host[keyIndex] = {\n          type: \"Point\",\n          coordinates: [_lng, _lat],\n        };\n      }\n      delete r.data[latAttrib];\n      delete r.data[lonAttrib];\n    });\n    return;\n  }\n}\n\nexport class Browser {\n  records: Record[] = [];\n\n  recordName: string = \"\";\n\n  idSummaryName: string = null;\n  primaryTableName: string = null;\n\n  recordDisplay: RecordDisplay = null;\n\n  recordDetailsPopup: RecordDetailPopup;\n\n  allRecordsAggr: Aggregate = null;\n  allAggregates: Aggregate[] = [];\n\n  public measureSummary: Config<Attrib_Numeric>;\n  public breakdownMode: Config<BreakdownType>;\n  public dashboardMode: Config<DashboardMode>;\n  public mouseOverCompare: Config<boolean>;\n  public measureFunc: Config<MeasureFunc>;\n  public stackedCompare: Config<boolean>;\n  public recordChartType: Config<RecordDisplayType>;\n  public showWholeAggr: Config<boolean>;\n  public filteringMode: Config<string>;\n\n  private configs: { [key: string]: Config<any> } = {};\n\n  // TODO: review & improve\n  options: ConfigSpec;\n\n  private dashboardConfigPanel: ConfigPanel;\n\n  private domID: string;\n\n  public DOM: { [index: string]: any } = {};\n\n  panels: { [key in PanelName]?: Panel } = {};\n\n  flexAggrs: { [key in CompareType]?: Aggregate_Interval<any> } = {};\n\n  addedCompare: boolean = false;\n\n  // ********************************************************************\n  // Attributes\n  // ********************************************************************\n\n  attribs: Attrib[] = [];\n\n  attribCounter = 0;\n\n  get attribsInDashboard(): Attrib[] {\n    return this.attribs.filter((attrib) => attrib.block?.inDashboard);\n  }\n  // always in dashboard\n  get blocks(): Block[] {\n    return this.attribsInDashboard.map((attrib) => attrib.block);\n  }\n  // query by attribute name\n  attribWithName(name: string): Attrib {\n    return this.attribs.find((attrib) => name === attrib?.attribName || name === attrib?.template?.str) || null;\n  }\n  get _attribs() {\n    var r = {};\n    this.attribs.forEach((attrib) => {\n      r[attrib.attribName] = attrib;\n      if (attrib.template.str) {\n        r[attrib.template.str] = attrib;\n      }\n    });\n    return r;\n  }\n\n  // used to render attribute list hierarchy\n  private attribs_by_group = {};\n\n  // ********************************************************************\n  //\n  // ********************************************************************\n\n  finalized: boolean = false;\n\n  // the shared color scape options in the browser (themes)\n  colorTheme: any; // TODO\n  // active color theme\n  activeColorTheme: ColorThemeType = \"sequential\";\n\n  preventAxisScaleTransition: boolean = true;\n\n  onLoad: {\n    callback?: (this: Browser) => void;\n    main: { [index: string]: string };\n  } = { callback: null, main: {} };\n\n  onModeChange: () => void = null;\n\n  readonly dataTypeDescrs: DataTypeDescr[] = [\n    {\n      name: \"Categorical\",\n      icon: \"far fa-font\",\n      member: (attrib: Attrib) => attrib instanceof Attrib_Categorical,\n      active: false,\n    },\n    {\n      name: \"MultiValued\",\n      icon: \"far fa-tags\",\n      member: (attrib: Attrib) =>\n        attrib instanceof Attrib_Categorical && attrib.isMultiValued,\n      active: false,\n    },\n    {\n      name: \"Numeric\",\n      icon: \"far fa-hashtag\",\n      member: (attrib: Attrib) => attrib instanceof Attrib_Numeric,\n      active: false,\n    },\n    {\n      name: \"Timestamp\",\n      icon: \"far fa-calendar-day\",\n      member: (attrib: Attrib) => attrib instanceof Attrib_Timestamp,\n      active: false,\n    },\n    {\n      name: \"Timeseries\",\n      icon: \"far fa-chart-line\",\n      member: (attrib: Attrib) => attrib instanceof Attrib_Timeseries,\n      active: false,\n    },\n    {\n      name: \"Location\",\n      icon: \"far fa-map-marker\",\n      member: (attrib) =>\n        attrib instanceof Attrib_RecordGeo ||\n        (attrib instanceof Attrib_Categorical && attrib.hasMap()),\n      active: false,\n    },\n    {\n      name: \"Unique\",\n      icon: \"far fa-fingerprint\",\n      member: (attrib: Attrib) => attrib.uniqueCategories(),\n      active: false,\n    },\n    {\n      name: \"Function\",\n      icon: \"fal fa-function\",\n      member: (attrib: Attrib) => !attrib.template.str,\n      active: false,\n    },\n    {\n      name: \"Content\",\n      icon: \"fa fa-file-alt\",\n      member: (attrib: Attrib) => attrib instanceof Attrib_Content,\n      active: false,\n    },\n  ];\n\n  constructor(options: ConfigSpec) {\n    \"use strict\";\n    this.options = options;\n\n    // TODO: Cannot do await here since this is constructor\n    // but it'd be nice to wait until everything is loaded\n    Base.loadResources();\n\n    this.domID = this.options.domID || Base.defaultDOM;\n\n    // BASIC OPTIONS\n\n    Base.Compare_List.forEach((cT) => {\n      this.lockedCompare[cT] = false;\n      this.selectedAggrs[cT] = null;\n      this.crumbs[cT] = new BreadCrumb(this, cT);\n    });\n\n    this.measureFunc = new Config<MeasureFunc>({\n      parent: this,\n      cfgTitle: \"Measure Function\",\n      cfgClass: \"measureFunc\",\n      iconClass: \"fa fa-cubes\",\n      UISeperator: {\n        title: \"Analytics\",\n      },\n      default: \"Count\",\n      tooltip: \"The metric that aggregates values in each category / range.\",\n      helparticle: \"5e9516452c7d3a7e9aeae06e\",\n      itemOptions: [\n        // TODO: implement deactive / empty options\n        // see: addMeasureOptions_Func\n        { name: \"measure_Count\", value: \"Count\" },\n        {\n          name: \"measure_Sum\",\n          value: \"Sum\",\n          activeWhen: () => this.getMeasurableSummaries(\"Sum\").length > 0,\n        },\n        {\n          name: \"measure_Avg\",\n          value: \"Avg\",\n          activeWhen: () => this.getMeasurableSummaries(\"Avg\").length > 0,\n        },\n      ],\n      onRefreshDOM: (cfg: Config<MeasureFunc>) => {\n        // Update text\n        this.DOM.metricFuncText\n          .select(\".measureFuncText\")\n          .html(i18n[\"measure_\" + cfg.get()]);\n        // Update select box\n        this.addMeasureOptions_Func(\n          this.DOM.metricFuncText.select(\".measureFuncOptions\")\n        );\n      },\n      preSet: async (v: MeasureFunc) => {\n        if (v === \"Count\") return v;\n        // v is Sum or Avg - we need to make sure measureSummary is valid.\n        if (!this.measureSummary?.get()) {\n          let attrib = this.getMeasurableSummaries(v)[0];\n          if (!attrib) {\n            throw Error(`No numeric data attribute supports ${v} measure function.`);\n          }\n          await this.measureSummary?.set(attrib as Attrib_Numeric);\n        }\n        return v;\n      },\n      onSet: async () => {\n        await this.refreshMeasureMetric();\n      },\n    });\n\n    this.measureSummary = new Config<Attrib_Numeric>({\n      parent: this,\n      cfgTitle: \"Measure Attribute\",\n      cfgClass: \"measureSummary\",\n      iconClass: \"far fa-cube\",\n      default: null, // not set\n      helparticle: \"5e9516452c7d3a7e9aeae06e\",\n      onDOM: (DOM) => {\n        var _ = DOM.root.select(\".configItem_Options\");\n        DOM.mainSelect = _.append(\"select\").attr(\"class\", \"mainSelect\");\n        DOM.timeKeys = _.append(\"select\")\n          .attr(\"class\", \"timeKeys\")\n          .on(\"input\", (event) => {\n            var selectedKey = event.currentTarget.selectedOptions[0].__data__;\n            this.measureSummary.set(\n              this.measureSummary.get().timeseriesParent.getTimepointSummary(\n                selectedKey\n              ));\n          });\n      },\n      onRefreshDOM: (cfg: Config<Attrib_Numeric>) => {\n        if (!cfg.get()) return; // nothing to do!\n        var attrib = this.measureSummary.get();\n        this.addMeasureOptions_Summaries(cfg.DOM.mainSelect);\n\n        this.addMeasureOptions_Summaries(\n          this.DOM.metricFuncText.select(\"select.measureSummary\")\n        );\n\n        // If measureSummary is timeseries, we need to show the keys\n        var withKeys = attrib.timeseriesParent;\n        cfg.DOM.timeKeys.classed(\"hide\", !withKeys);\n\n        this.DOM.metricFuncText\n          .select(\".timeKeys.metricOptionWrapper\")\n          .classed(\"hide\", !withKeys);\n        this.DOM.metricFuncText\n          .select(\".measureSummaryName\")\n          .html((withKeys ? attrib.timeseriesParent : attrib).attribNameHTML);\n\n        if (withKeys) {\n          this.addMeasureOptions_Keys(cfg.DOM.timeKeys);\n          this.addMeasureOptions_Keys(\n            this.DOM.metricFuncText.select(\"select.timeKeys\")\n          );\n          this.DOM.metricFuncText\n            .select(\".timeKeyText\")\n            .html(attrib.timeKey._time_src);\n        }\n      },\n      preSet: async (v) => {\n        var attrib: Attrib = v;\n        if (typeof attrib === \"string\") {\n          attrib = this.attribWithName(v);\n          if (!attrib) attrib = this.createAttrib(v);\n        }\n\n        if (attrib instanceof Attrib_Timeseries) {\n          // First, try to use the timeKey of current measure attrib\n          attrib.initializeAggregates(); // before this, timeKeys is not computed.\n          var key =\n            this.measureSummary.get()?.timeKey ||\n            this.recordDisplay.currentTimeKey.get() ||\n            attrib.timeKeys[attrib.timeKeys.length - 1];\n          attrib = attrib.getTimepointSummary(key);\n        }\n\n        if (!attrib || !(attrib instanceof Attrib_Numeric)) return; // not a valid value\n\n        // make sure attrib caches are initialized...\n        attrib.initializeAggregates();\n\n        return attrib; // allright\n      },\n      onSet: async (v) => {\n        if (!v || this.measureFunc_Count) return;\n        await this.refreshMeasureMetric();\n      },\n    });\n\n    this.breakdownMode = new Config<BreakdownType>({\n      parent: this,\n      cfgTitle: \"Breakdown\",\n      cfgClass: \"breakdownMode\",\n      iconClass: \"far fa-percent\",\n      default: \"absolute\",\n      helparticle: \"5e89445604286364bc97d5eb\",\n      tooltip: `How to compute and compare data groups`,\n      itemOptions: [\n        { name: \"# Absolute\", value: \"absolute\" },\n        { name: \"% of Compared\", value: \"dependent\" },\n        { name: \"% of Groups\", value: \"relative\" },\n        { name: \"% of All\", value: \"total\" },\n      ],\n      forcedValue: () => {\n        if (!this.measureWithPositiveValues()) return \"absolute\";\n      },\n      preSet: async (v: BreakdownType) => {\n        if (v !== \"absolute\" && this.measureFunc_Avg) {\n          throw Error(`You cannot analyze data by ${i18n.DialogComparisonSelection} when<br>\n            using <i>average</i> as aggregation function for <i>${this.measureSummary.get().attribName}</i>.`);\n        }\n        if (v !== \"absolute\" && this.measureSumWithNegativeValues()) {\n          throw Error(i18n.DialogCompareForRelative);\n        }\n\n        return v;\n      },\n      onSet: async (v) => {\n        this.preventAxisScaleTransition = true;\n        this.addedCompare = false;\n        for(let attrib of this.attribsInDashboard){\n          await attrib.axisScaleType.set(v === \"relative\" ? \"full\" : \"fit\");\n          attrib.refreshScale_Measure();\n        }\n        await this.refreshAnalytics();\n        this.preventAxisScaleTransition = false;\n      },\n    });\n\n    this.stackedCompare = new Config<boolean>({\n      parent: this,\n      cfgTitle: \"GroupView\",\n      cfgClass: \"stackedCompare\",\n      iconClass: \"CompareModeIcon\", // will add sub-elements to this\n      UISeperator: {\n        title: \"Visualization\",\n      },\n      default: true,\n      helparticle: \"5e88ff692c7d3a7e9aea6475\",\n      tooltip: `The comparison view mode<br><br>\n        <b>Side-by-side</b>: Compare on shared baseline<br><br>\n        <b>Stacked</b>: Compare on stacked baseline`,\n      itemOptions: [\n        { name: \"SideBySide\", value: false },\n        { name: \"Stacked\", value: true },\n      ],\n      onDOM: (DOM) => {\n        DOM.root\n          .select(\".CompareModeIcon\")\n          .selectAll(\"div\")\n          .data([0, 1, 2])\n          .enter()\n          .append(\"div\")\n          .attr(\"class\", \"CompareModeIcon-block\");\n      },\n      forcedValue: () => {\n        if (this.dependentBreakdown) {\n          return false;\n        }\n\n        if (this.relativeBreakdown) {\n          if (!this.comparedAttrib) return false;\n          return !this.isComparedSummaryMultiValued(); // stack if it's not multi-valued\n        }\n\n        if (this.totalBreakdown) {\n          if (!this.comparedAttrib) return false;\n          if (this.isComparedSummaryMultiValued()) return false;\n        }\n\n        // absoluteBreakdown from now on\n\n        // detect cases when you cannot stack\n        if (this.comparedAttrib && this.isComparedSummaryMultiValued())\n          return false;\n        if (!this.measureWithPositiveValues()) return false;\n      },\n      preSet: async (v) => {\n        if (v !== true && v !== false) return; // not valid input\n\n        if (v && this.comparedAttrib && this.isComparedSummaryMultiValued()) {\n          throw i18n.DialogStackedMultiValue(this.comparedAttrib.attribName);\n        }\n        if (\n          !v &&\n          this.comparedAttrib &&\n          !this.isComparedSummaryMultiValued() &&\n          this.relativeBreakdown\n        ) {\n          throw i18n.DialogSideBySideSingleValue(\n            this.comparedAttrib.attribName\n          );\n        }\n        if (v && this.measureFunc_Avg) {\n          throw (\n            i18n.DialogStackedCharts +\n            \" cannot be used with <i>average</i> measure function.\"\n          );\n        }\n        if (v && this.dependentBreakdown) {\n          throw (\n            i18n.DialogStackedCharts +\n            \" cannot be used with \" +\n            i18n.DialogDependentBreakdown\n          );\n        }\n        if (v && this.measureSumWithNegativeValues()) {\n          throw (\n            i18n.DialogStackedCharts +\n            \" cannot be used with measuring totals with negative values.\"\n          );\n        }\n\n        return v;\n      },\n      onSet: async () => {\n        this.attribsInDashboard.forEach((attrib) =>\n          attrib.refreshScale_Measure()\n        );\n        await this.refreshAnalytics();\n      },\n    });\n\n    this.showWholeAggr = new Config<boolean>({\n      parent: this,\n      cfgTitle: \"Whole Distribution\",\n      cfgClass: \"showWholeAggr\",\n      iconClass: \"fa fa-square\", // will add sub-elements to this\n      default: true,\n      tooltip: `When you have two or more compare selections, \n                you can choose to show the whole value of the aggreagates.`,\n      helparticle: \"5e893d7a2c7d3a7e9aea656f\",\n      itemOptions: [\n        { name: \"Show\", value: true },\n        { name: \"Hide\", value: false },\n      ],\n      forcedValue: () => {\n        if (this.activeComparisonsCount === 0) return true;\n\n        if (this.dependentBreakdown) {\n          return false;\n        }\n\n        if (this.relativeBreakdown) {\n          if (!this.comparedAttrib) return false;\n          return !this.isComparedSummaryMultiValued();\n        }\n\n        if (this.totalBreakdown) {\n          if (!this.comparedAttrib) return false;\n          return;\n          //if(this.comparedSummary.isMultiValued) return false;\n        }\n\n        // of-total or absolute breakdown, with comparisons\n\n        if (this.stackedCompare.is(true)) {\n          var totalOfCompared = this.activeComparisons.reduce((accum, val) => {\n            if (this.selectedAggrs[val]) {\n              return accum + this.selectedAggrs[val][val].measure;\n            }\n            return accum;\n          }, 0);\n\n          if (totalOfCompared === this.allRecordsAggr.measure(\"Active\"))\n            return false;\n        }\n\n        if (!this.measureWithPositiveValues()) return false;\n      },\n      onSet: async () => await this.refreshAnalytics(),\n    });\n\n    this.filteringMode = new Config<string>({\n      parent: this,\n      cfgTitle: \"Filtering\",\n      cfgClass: \"filteringMode\",\n      iconClass: \"fal fa-filter\", // will add sub-elements to this\n      UISeperator: {\n        title: \"Selections\",\n      },\n      default: \"chained\",\n      tooltip: `<b>Combined</b> allows combining multiple filters together<br><br>\n        <b>Single</b> forces to have at most one active filter.`,\n      helparticle: \"5e88eff404286364bc97d459\",\n      itemOptions: [\n        { name: \"Chained\", value: \"chained\" },\n        { name: \"Single\", value: \"single\" },\n      ],\n      preSet: async (v) => {\n        v = v.toLowerCase();\n        if (v === \"combined\") v = \"chained\";\n        return v;\n      },\n      onSet: (v) => {\n        if (v === \"single\" && this.numOfActiveFilters > 1) {\n          this.clearFilters_All(this.filters.find((_) => _.isFiltered)); // remove our all but one\n        }\n      },\n    });\n\n    this.mouseOverCompare = new Config<boolean>({\n      parent: this,\n      cfgTitle: \"Hover Highlight\",\n      cfgClass: \"mouseOverCompare\",\n      iconClass: \"fal fa-mouse-pointer\", // will add sub-elements to this\n      default: true,\n      helparticle: \"5e8905c52c7d3a7e9aea6489\",\n      itemOptions: [\n        { name: \"Enabled\", value: true },\n        { name: \"Disabled\", value: false },\n      ],\n    });\n\n    this.recordChartType = new Config<RecordDisplayType>({\n      parent: this,\n      cfgTitle: \"Record Chart Type\",\n      cfgClass: \"recordChartType\",\n      iconClass: \"fal fa-bullseye\", // will add sub-elements to this\n      UISeperator: {\n        title: \"Record Chart\",\n      },\n      default: \"none\",\n      helparticle: \"5eadcca72c7d3a5ea54a59e9\",\n      noExport: true,\n      itemOptions: [\n        { name: \"None\", value: \"none\" },\n        {\n          name: \"ListButton\",\n          value: \"list\",\n          activeWhen: () => true, // always visible\n        },\n        {\n          name: \"MapButton\",\n          value: \"map\",\n          activeWhen: () => {\n            return this.recordDisplay?.getRecordGeoAttributes().length > 0;\n          },\n        },\n        {\n          name: \"TimeSeriesButton\",\n          value: \"timeseries\",\n          activeWhen: () => {\n            if (this.records?.length < 2) return false;\n            return this.recordDisplay?.getAttribOptions_UI(\"timeSeries\").length > 0;\n          },\n        },\n        {\n          name: \"ScatterButton\",\n          value: \"scatter\",\n          activeWhen: () => {\n            if (this.records?.length < 5) return false;\n            return this.recordDisplay?.getAttribOptions_UI(\"scatterX\").length > 1;\n          },\n        },\n      ],\n\n      preSet: async (v : RecordDisplayType) => {\n        if (!this.records) return; // data not loaded yet\n        if (!this.recordDisplay) return;\n\n        if (this.records.length > 5000 && ![\"list\", \"none\"].includes(v)) {\n          await Modal.confirm(\n            \"<div style='text-align:center;''>There are more than 2,000 records.<br>\" +\n              `The ${v} chart will be crowded and potentially slow.<br><Br>` +\n              `Are you sure you want to change to ${v} chart?</div>`,\n            \"Change chart type\"\n          );\n        }\n\n        if (v === \"map\") {\n          // Make sure recordDisplay.config.geo is set.\n          if (!this.recordDisplay.config.geo) {\n            var _ = this.recordDisplay.getRecordGeoAttributes()[0];\n            if (!_) throw \"Geo attribute not found\";\n          }\n        }\n\n        return v;\n      },\n\n      onSet: async (_type: RecordDisplayType) => {\n        try {\n          if(!this.recordDisplay) return;\n\n          if (_type === \"map\") {\n            // Make sure recordDisplay.config.geo is set.\n            if (!this.recordDisplay.config.geo) {\n              var _ = this.recordDisplay.getRecordGeoAttributes()[0];\n              if (!_) throw \"Geo attribute not found\";\n              this.recordDisplay.config.geo = _.attribName;\n            }\n          }\n\n          // setting the css style here so that the UI can prepare the layout\n          this.DOM.root?.attr(\"recordChartType\", _type);\n\n          await this.recordDisplay.setView(_type);\n\n          this.refreshIsEmpty();\n          this.updateLayout_Height();\n\n        } catch (e) {\n          console.log(e);\n          this.recordChartType?.undoChange();\n        }\n      },\n    });\n\n    this.dashboardMode = new Config<DashboardMode>({\n      parent: this,\n      cfgTitle: \"Dashboard Mode\",\n      cfgClass: \"dashboardMode\",\n      iconClass: \"fa fa-wrench\", // temporary\n      UI: { disabled: true },\n      default: \"Explore\",\n      helparticle: \"5e8943d504286364bc97d5e6\",\n      itemOptions: [\n        { name: \"Explore\", value: \"Explore\" },\n        { name: \"Author\", value: \"Author\" },\n        { name: \"Adjust\", value: \"Adjust\" },\n        { name: \"Capture\", value: \"Capture\" },\n        { name: \"Save\", value: \"Save\" },\n      ],\n      preSet: async (v) => {\n        if (v === \"Print\") return \"Capture\";\n        return v;\n      },\n      onSet: async (v, cfg) => {\n        if (this.finalized) {\n          this.setNoAnim(true);\n\n          if (v === \"Author\")\n            this.refreshAttribList();\n\n          this.panels.bottom.setWidth(this.width_Canvas);\n          this.panels.bottom.refreshWidth();\n\n          this.updateLayout();\n          //updateLayout may not be \"effective\" if loading is not finalized...\n          this.updateMiddlePanelWidth();\n\n          setTimeout(() => this.setNoAnim(false), 500);\n\n          this.onModeChange?.();\n        }\n        await cfg.refresh();\n      },\n      onRefreshDOM: (cfg: Config<DashboardMode>) => {\n        if (!this.DOM.panel_Footer) return;\n        this.DOM.panel_Footer\n          .selectAll(\".dashSelectMode\")\n          .classed(\"active\", (_) => cfg.is(_.name));\n        this.DOM.root\n          .attr(\"data-dashboardMode\", cfg.get());\n      },\n    });\n\n    [\n      \"measureFunc\",\n      \"measureSummary\",\n      \"breakdownMode\",\n      \"stackedCompare\",\n      \"showWholeAggr\",\n      \"filteringMode\",\n      \"mouseOverCompare\",\n      \"recordChartType\",\n    ].forEach((_) => {\n      this.configs[_] = this[_];\n    });\n\n    var me = this;\n\n    this.colorTheme = {\n      browser: this,\n      // defaults\n      sequential: \"YlGnBu\",\n      diverging: \"Spectral\",\n      getDiscrete(bins = 9) {\n        let _theme = me.activeColorTheme;\n        let scale = d3[\"scheme\" + this[_theme]];\n        if (scale && scale[bins]) {\n          return scale[bins].slice(); // return a copy in case someone wants to edit\n        }\n        scale = d3[\"interpolate\" + this[_theme]];\n        var colors = [];\n        if (bins === 1) {\n          colors.push(d3.rgb(scale(0.8)).hex());\n        } else if (bins === 2) {\n          colors.push(d3.rgb(scale(0.8)).hex());\n          colors.push(d3.rgb(scale(0.2)).hex());\n        } else {\n          for (let i = 0; i < bins; ++i) {\n            colors.push(d3.rgb(scale(i / (bins - 1))).hex());\n          }\n        }\n        return colors.reverse(); // cividis, etc, need to reverse from light to dark\n      },\n      getContinuous() {\n        return d3[\"interpolate\" + this[me.activeColorTheme]];\n      },\n      exportConfig() {\n        var _: any = {};\n        if (this.sequential !== \"YlGnBu\") _.sequential = this.sequential;\n        if (this.diverging !== \"Spectral\") _.diverging = this.diverging;\n        return _;\n      },\n    };\n\n    this.allRecordsAggr = new Aggregate(null); // not placed in an attribute\n    this.allAggregates.push(this.allRecordsAggr);\n\n    Base.browsers[this.getDashboardID()] = this;\n    Base.browser = this;\n\n    if (this.options.onLoad) {\n      // callback\n      if (this.options.onLoad.callback) {\n        if (this.options.onLoad.callback instanceof Function) {\n          this.onLoad.callback = this.options.onLoad.callback;\n        } else {\n          delete this.options.onLoad;\n        }\n      }\n      // main keys\n      for (var key in this.options.onLoad) {\n        this.onLoad.main[key] = this.options.onLoad[key];\n      }\n    }\n\n    let lastMouseMoveEvent: MouseEvent = null;\n\n    this.DOM.root = d3\n      .select(this.domID)\n      .classed(\"kshf\", true)\n      .classed(\"noAnim\", true)\n      .attr(\"data-dashboardMode\", this.dashboardMode.get())\n      .attr(\"recordChartType\", \"none\")\n      .on(\"mousemove\", (event: MouseEvent) => {\n        // Compute mouse moving speed, to adjust repsonsiveness\n        if (!lastMouseMoveEvent) {\n          lastMouseMoveEvent = event;\n          return;\n        }\n        var timeDif = event.timeStamp - lastMouseMoveEvent.timeStamp;\n        if (timeDif === 0) return;\n\n        var xDif = Math.abs(event.x - lastMouseMoveEvent.x);\n        var yDif = Math.abs(event.y - lastMouseMoveEvent.y);\n\n        // controls highlight selection delay\n        this.mouseSpeed = Math.min((xDif + yDif) / timeDif, 2);\n\n        lastMouseMoveEvent = event;\n      });\n\n    if (this.dashZoomLevel != \"1.00\") {\n      this.attemptToFixBrowserZoomLevel(this.dashZoomLevel);\n    }\n\n    this.updateWidth_Total();\n\n    this.recordName = this.options.recordName || \"\";\n\n    // remove any DOM elements under this domID, kshf takes complete control over what's inside\n    var rootDomNode = this.DOM.root.node();\n    while (rootDomNode.hasChildNodes())\n      rootDomNode.removeChild(rootDomNode.lastChild);\n\n    this.DOM.pointerBlock = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"pointerBlock\");\n    this.DOM.attribDragBox = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"attribDragBox\");\n\n    this.insertDOM_WarningBox();\n\n    //this.DOM.mainWrapper = this.DOM.root.append(\"div\").attr(\"class\",\"mainWrapper\");\n\n    this.recordDetailsPopup = new RecordDetailPopup(this);\n\n    this.insertDOM_Panel_Overlay();\n\n    this.insertDOM_AttribPanel();\n\n    this.DOM.panel_Wrapper = this.DOM.root\n      //.append(\"div\").attr(\"class\",\"panel_Data_Wrapper\")\n      .append(\"div\")\n      .attr(\"class\", \"panel_Wrapper\")\n      .classed(\"emptyDashboard\", true) // empty dashboard by default on initialization.\n      .classed(\"panel_bottom_empty\", true);\n\n    this.insertDOM_PanelBasic();\n\n    this.dashboardConfigPanel = new ConfigPanel(\n      this.DOM.panel_Wrapper,\n      \"DashboardAnalyticsConfig\",\n      \"DashboardAnalyticsConfig\",\n      Object.values(this.configs),\n      this,\n      this.DOM.metricFuncSelectButton\n    );\n\n    this.panels.left = new Panel(this, \"left\", this.DOM.panel_Wrapper);\n    this.panels.right = new Panel(this, \"right\", this.DOM.panel_Wrapper);\n\n    this.DOM.middleColumn = this.DOM.panel_Wrapper\n      .append(\"div\")\n      .attr(\"class\", \"middleColumn\");\n\n    this.panels.middle = new Panel(this, \"middle\", this.DOM.middleColumn);\n    this.DOM.middleColumn.append(\"div\").attr(\"class\", \"recordDisplay\");\n\n    this.panels.bottom = new Panel(this, \"bottom\", this.DOM.panel_Wrapper);\n\n    this.DOM.panelEmpty = this.DOM.panel_Wrapper\n      .append(\"div\")\n      .attr(\"class\", \"panelEmpty\")\n      .append(\"div\")\n      .attr(\"class\", \"actionInfo\")\n      .html(i18n.EmptyDashboardNotice);\n\n    this.insertDOM_Panel_Footer();\n\n    this.DOM.root.selectAll(\".panel\").on(\"mouseleave\", () => {\n      setTimeout(() => {\n        if (!this.needToRefreshLayout) return;\n        this.updateLayout_Height();\n        this.needToRefreshLayout = false;\n      }, 1500); // update layout after 1.5 seconds\n    });\n\n    this.loadDataSources();\n  }\n\n  needToRefreshLayout: boolean = false;\n\n  /** -- */\n  refreshConfigs() {\n    Object.values(this.configs).forEach((cfg) => cfg.refresh());\n\n    this.attribsInDashboard.forEach((attrib) => attrib.refreshConfigs());\n\n    this.refreshAnalytics();\n  }\n\n  /** -- */\n  activateWidthDrag(DOM, event, onMove) {\n    DOM.classList.add(\"dragging\");\n    this.setNoAnim(true);\n\n    this.DOM.root\n      .style(\"cursor\", \"ew-resize\")\n      .on(\"mousemove.temp\", onMove)\n      .on(\"mouseup.temp\", () => {\n        DOM.classList.remove(\"dragging\");\n        this.setNoAnim(false);\n      });\n\n    event.preventDefault();\n  }\n\n  blockWithOpenConfig: Block = null;\n\n  /** -- */\n  closeConfigPanels() {\n    this.blockWithOpenConfig?.DOM?.root.classed(\"showConfig\", false);\n    this.blockWithOpenConfig = undefined;\n    this.dashboardConfigPanel.hide();\n    this.recordDisplay.recordConfigPanel.hide();\n  }\n\n  /** -- */\n  noAnim: boolean = false;\n  setNoAnim(v) {\n    if (!this.finalized) return;\n    this.noAnim = v;\n    this.DOM.root.classed(\"noAnim\", this.noAnim);\n    this.DOM.pointerBlock.attr(\"active\", this.noAnim ? \"\" : null);\n    if (!this.noAnim) {\n      this.DOM.root\n        .style(\"cursor\", null)\n        .on(\"mousemove.temp\", null)\n        .on(\"mouseup.temp\", null);\n    }\n  }\n\n  /** -- */\n  refreshIsEmpty() {\n    this.DOM.panel_Wrapper.classed(\n      \"emptyDashboard\",\n      this.attribsInDashboard.length === 0 && this.recordChartType.is(\"none\")\n    );\n  }\n\n  /** Returns data type based on first found valid value, null if type not detected */\n  getAttribTypeFromFunc(func: Function): BlockType {\n    var type = null;\n\n    this.records.some((record) => {\n      var _val = func.call(record.data, record);\n      if (_val == null || _val == \"\") return false; // cannot infer type\n\n      var v_type = typeof _val;\n      if (v_type === \"object\" && _val._timeseries_) {\n        type = \"timeseries\";\n      } else if (v_type === \"object\" && _val.coordinates) {\n        type = \"recordGeo\";\n      } else if (v_type === \"number\") {\n        type = \"numeric\";\n      } else if (_val instanceof Date) {\n        type = \"timestamp\";\n      } else if (v_type === \"string\" || v_type === \"boolean\") {\n        // TO-DO: Think about boolean summaries (?)\n        type = \"categorical\";\n      } else if (Array.isArray(_val)) {\n        type = \"categorical\";\n      }\n\n      return type ? true : false;\n    });\n\n    return type;\n  }\n\n  /** -- */\n  createAttrib(\n    name: string,\n    func = undefined,\n    type: BlockType = undefined\n  ): Attrib {\n    if (!name) return;\n\n    // return existing block with same name\n    if (this.attribWithName(name)) {\n      return this.attribWithName(name);\n    }\n\n    var attrib: Attrib;\n\n    if (type === \"content\") {\n      attrib = new Attrib_Content(this, name);\n    } else {\n      if (func == null) {\n        func = name;\n      }\n      var _v = new AttribTemplate(func, this);\n\n      type = type ?? _v.blockType;\n\n      if (!type) {\n        type = this.getAttribTypeFromFunc(_v.func);\n      }\n\n      if (!type) {\n        console.log(`Summary data type could not be detected for: ${name}`);\n        return;\n      }\n\n      if (type === \"categorical\") {\n        attrib = new Attrib_Categorical(this, name, _v);\n        //\n      } else if (type === \"timeseries\") {\n        attrib = new Attrib_Timeseries(this, name, _v);\n        //\n      } else if (type === \"recordGeo\") {\n        attrib = new Attrib_RecordGeo(this, name, _v);\n        //\n      } else if (type === \"timestamp\") {\n        attrib = new Attrib_Timestamp(this, name, _v);\n        //\n      } else if (type === \"numeric\") {\n        attrib = new Attrib_Numeric(this, name, _v);\n      }\n    }\n\n    this.insertAttribIntoGroupIndex(attrib);\n\n    return attrib;\n  }\n\n  /** -- */\n  destroyAttrib(attrib: Attrib) {\n    attrib?.block?.removeFromPanel();\n\n    var indexFrom = -1;\n    this.attribs.forEach((a, i) => {\n      if (a === attrib) indexFrom = i;\n    });\n    if (indexFrom === -1) return;\n\n    this.attribs.splice(indexFrom, 1);\n\n    // if the attrib is within the record display sorting list, remove!\n    this.recordDisplay?.refreshAttribOptions(\"sort\");\n\n    this.removeAttribFromGroupIndex(attrib);\n    this.refreshAttribList();\n  }\n\n  /** -- */\n  insertAttribIntoGroupIndex(attrib: Attrib) {\n    var target = this.attribs_by_group;\n    // find position in hierarchy\n    attrib.groupPath.forEach((_key, i, list) => {\n      if (!target[_key]) {\n        // \"group\" node (simple string, not a summary group)\n        target[_key] = {\n          name: _key,\n          item: _key,\n          parents: list.slice(0, i),\n          sub: {},\n        };\n      }\n      target = target[_key].sub;\n    });\n    var _key = attrib.printName;\n    if (!target[_key]) {\n      target[_key] = {\n        name: _key,\n        parents: attrib.groupPath,\n        sub: {},\n      };\n    } // if new, establish \"sub\".\n    target[_key].item = attrib;\n  }\n\n  /** -- */\n  removeAttribFromGroupIndex(attrib: Attrib) {\n    var target = this.attribs_by_group;\n    attrib.groupPath.forEach((_key) => {\n      // when changing timeseries, the key numeric summaries get updated after timeseries name is updated\n      // target[_key] may be indexing old stuff that's no longer valid\n      target = target && target[_key] && target[_key].sub;\n    });\n    if (target) delete target[attrib.printName];\n    delete attrib?.block?.DOM.nugget;\n    this.removeEmptySubs();\n  }\n\n  /** -- */\n  removeEmptySubs() {\n    function recurse(obj) {\n      for (let [key, value] of Object.entries(obj)) {\n        let v = value as any;\n        if (typeof v.item === \"string\" && Object.entries(v.sub).length === 0) {\n          // not a block, doesn't have sub-blocks\n          delete obj[key];\n        } else {\n          recurse(v.sub);\n        }\n      }\n    }\n    recurse(this.attribs_by_group);\n  }\n\n  /** -- */\n  setRecordName(v) {\n    this.recordName = v;\n    this.DOM.root.selectAll(\".recordName\").html(this.recordName);\n  }\n  /** -- */\n  setDescription(t) {\n    this.options.description = t;\n    this.DOM.browserDescription\n      .select(\".customDescription\")\n      .style(\"display\", t ? \"inline-block\" : null);\n    this.DOM.browserDescription.select(\".customDescriptionText\").html(t);\n  }\n\n  private divWidth: number;\n  /** -- */\n  updateWidth_Total() {\n    this.divWidth = this.DOM.root.node().clientWidth;\n  }\n  /** -- */\n  getWidth_Total() {\n    return this.divWidth;\n  }\n  /** This also considers if the available attrib panel is shown */\n  get width_Canvas() {\n    return (\n      this.divWidth -\n      (this.authorMode ? this._attribPanelWidth : 0) -\n      2 * Base.width_PanelGap\n    ); // 8 pixels on both sides are gone\n  }\n\n  /** -- */\n  get height_PanelHeader() {\n    var _ = parseInt(this.DOM.panel_DataStatus.style(\"height\"));\n    return isNaN(_) ? 0 : _;\n  }\n  /** -- */\n  get height_PanelFooter() {\n    var _ = parseInt(this.DOM.panel_Footer.style(\"height\"));\n    return isNaN(_) ? 0 : _;\n  }\n\n  /** -- */\n  getDashboardID() {\n    return window.location.pathname + this.domID;\n  }\n\n  // ********************************************************************\n  // Warning panel\n  // ********************************************************************\n\n  panel_warningBox = null;\n\n  /* -- */\n  insertDOM_WarningBox() {\n    this.panel_warningBox = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"warningBox_wrapper\");\n    var x = this.panel_warningBox.append(\"span\").attr(\"class\", \"warningBox\");\n    this.DOM.warningText = x.append(\"span\").attr(\"class\", \"warningText\");\n    x.append(\"span\")\n      .attr(\"class\", \"dismiss fa fa-times\")\n      .tooltip(i18n.Close)\n      .on(\"click\", () => this.hideWarning());\n  }\n  showWarning(v) {\n    this.panel_warningBox.classed(\"active\", true);\n    this.DOM.warningText.html(v);\n    setTimeout(() => this.hideWarning(), 5000); // auto-hide after 5 seconds\n  }\n  hideWarning() {\n    if (this.panel_warningBox) this.panel_warningBox.classed(\"active\", null);\n  }\n\n  private mouseSpeed: number = 0;\n  get movingMouseDelay() {\n    return this.mouseSpeed < 0.2 ? 0 : this.mouseSpeed * 500;\n  }\n\n  /** -- */\n  getMeasurableSummaries(_t): Attrib[] {\n    return this.attribs\n      .filter(\n        (attrib) =>\n          attrib.supportedMetricFuncs.includes(_t) &&\n          !attrib.isEmpty() &&\n          !attrib.hasTimeSeriesParent()\n      )\n      .sort((s1, s2) =>\n        Util.sortFunc_List_String(s1.attribName, s2.attribName)\n      );\n  }\n\n  /** -- */\n  addMeasureOptions_Summaries(dom) {\n    dom\n      .on(\"change\", async (event) => await this.measureSummary.set(event.currentTarget.selectedOptions[0].__data__) )\n      .selectAll(\"option\")\n      .remove();\n\n    if (this.measureFunc.is(\"Count\")) return;\n\n    dom\n      .selectAll(\"option\")\n      .data(this.getMeasurableSummaries(this.measureFunc.get()))\n      .enter()\n      .append(\"option\")\n      .attr(\"selected\", (s) => s.attribID === this.measureSummary.get()?.attribID ? true : null )\n      .html((s) => s.attribName);\n  }\n\n  /** -- */\n  addMeasureOptions_Keys(dom) {\n    dom.selectAll(\"option\").remove();\n\n    dom // slice creates a copy, reverse in-place updates this copy\n      .selectAll(\"option\")\n      .data(this.measureSummary.get().timeseriesParent.timeKeys.slice().reverse())\n      .enter()\n      .append(\"option\")\n      .attr(\"value\", (timeKey) => timeKey._time_src)\n      .attr(\"selected\", (timeKey) =>\n        timeKey._time_src === this.measureSummary.get().timeKey._time_src\n          ? \"true\"\n          : null\n      )\n      .html((timeKey) => timeKey._time_src);\n  }\n\n  /** -- */\n  addMeasureOptions_Func(dom) {\n    dom\n      .on(\"change\", async (event) => await this.measureFunc.set(event.currentTarget.selectedOptions[0].__data__.v) )\n      .selectAll(\"option\")\n      .remove();\n\n    var opts = [{ v: \"Count\", l: i18n.measure_Count, active: true }];\n\n    [\"Sum\", \"Avg\"].forEach((_t) => {\n      opts.push({\n        v: _t,\n        l: i18n[\"measure_\" + _t],\n        active: this.getMeasurableSummaries(_t).length > 0,\n      });\n    });\n\n    dom\n      .selectAll(\"option\")\n      .data(opts)\n      .enter()\n      .append(\"option\")\n      .attr(\"disabled\", (d) => (d.active ? null : true))\n      .attr(\"selected\", (d) => (d.v === this.measureFunc.get() ? true : null))\n      .html((d) => d.l);\n  }\n\n  /** -- */\n  insertDOM_Panel_DatasetInfo() {\n    this.DOM.datasource = this.DOM.browserDescription\n      .append(\"a\")\n      .attr(\"class\", \"fal fa-table datasource\")\n      .attr(\"target\", \"_blank\")\n      .tooltip(i18n.OpenDataSource);\n\n    var _ = this.DOM.browserDescription\n      .append(\"div\")\n      .attr(\"class\", \"DataPrivacy\")\n      .html(\n        '<span class=\"DataPrivacy-Public\">Public data</span>' +\n          '<span class=\"DataPrivacy-Private\">Private data</span>'\n      );\n\n    var x = this.DOM.browserDescription\n      .append(\"span\")\n      .attr(\"class\", \"customDescription\");\n    x.append(\"span\")\n      .attr(\"class\", \"customDescriptionButton\")\n      .tooltip(\"Edit\")\n      .on(\"click\", () => {\n        var _descr = Modal.prompt(\n          \"Provide a short description or credit for the dataset\",\n          this.options.description\n        );\n        if (_descr === \"\") {\n          this.setDescription(null);\n          return;\n        }\n        if (!_descr) return;\n        var _url = Modal.prompt(\"Provide the link for credit\", \"\");\n        if (_url) {\n          // if _url doesn't start with http, add http://\n          if (_url.substr(0, 4) !== \"http\") _url = \"http://\" + _url;\n          _descr =\n            \"<a target='_blank' rel='noopener noreferrer' href='\" +\n            _url +\n            \"'>\" +\n            _descr +\n            \"</a>\";\n        }\n        this.setDescription(_descr);\n      })\n      .html(\"<i class='fa fa-info-circle'></i> \");\n    x.append(\"span\").attr(\"class\", \"customDescriptionText\");\n\n    this.setDescription(this.options.description);\n  }\n\n  /** -- */\n  insertDOM_Panel_Footer() {\n    this.DOM.panel_Footer = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"panel_Footer\");\n\n    var x = this.DOM.panel_Footer\n      .append(\"div\")\n      .attr(\"class\", \"dashboardModeSelect\");\n    x.append(\"div\")\n      .attr(\"class\", \"dashboardModeSelectTitle\")\n      .attr(\"data-helparticle\", \"5e8943d504286364bc97d5e6\")\n      .html(i18n.Mode);\n\n    Modal.createHelpScoutLinks(x, true);\n\n    x.selectAll(\"div.dashSelectMode\")\n      .data([\n        {\n          name: \"Explore\",\n          class: \"far fa-compass\",\n        },\n        {\n          name: \"Author\",\n          class: \"far fa-pen-fancy\",\n        },\n        {\n          name: \"Adjust\",\n          class: \"far fa-sliders-h\",\n        },\n        {\n          name: \"Capture\",\n          class: \"far fa-draw-square\",\n        },\n        {\n          name: \"Save\",\n          class: \"far fa-bookmark\",\n        },\n      ])\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", (_) => `dashSelectMode dashSelectMode-${_.name}`)\n      .classed(\"active\", (_) => this.dashboardMode.is(_.name))\n      .on(\"click\", async (_event, _) => await this.dashboardMode.set(_.name) )\n      .tooltip((_) => i18n[`${_.name} Mode`])\n      .call((dashSelectMode) => {\n        dashSelectMode.append(\"div\").attr(\"class\", (_) => _.class);\n        dashSelectMode\n          .append(\"div\")\n          .attr(\"class\", \"theText\")\n          .html((_) => i18n[_.name]);\n      });\n\n    this.DOM.browserDescription = this.DOM.panel_Footer\n      .append(\"span\")\n      .attr(\"class\", \"browserDescription\");\n\n    // Info & Credits\n    var x = this.DOM.panel_Footer\n      .append(\"span\")\n      .attr(\"class\", \"logoHost\")\n      .tooltip(i18n.ShowInfoCredits)\n      .on(\"click\", () => {\n        this.showCredits();\n        this.DOM.overlay_wrapper\n          .attr(\"show\", \"infobox\")\n          .classed(\"easyDismiss\", true);\n      })\n      .html(\n        `<span class='keshifSVG'>Keshif<img></span>\n        <span class='theDataMadeExplorable'>Data Made Explorable</span>\n        `\n      );\n    x.select(\"svg\")\n      .style(\"width\", \"20px\")\n      .style(\"width\", \"18px\")\n      .style(\"height\", \"19px\");\n  }\n  /** -- */\n  insertDOM_PanelBasic() {\n    var me = this;\n\n    this.DOM.panel_DataStatus = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"panel_DataStatus\");\n\n    this.DOM.metricFuncSelectButton = this.DOM.panel_DataStatus\n      .append(\"span\")\n      .attr(\"class\", \"metricFuncSelectButton basicIcon fal fa-cog\")\n      .tooltip(i18n.DashboardAnalyticsConfig)\n      .on(\"click\", () => this.dashboardConfigPanel.showAtPos(8, 8));\n\n    this.DOM.recordInfo = this.DOM.panel_DataStatus\n      .append(\"span\")\n      .attr(\"class\", \"recordInfo\");\n\n    this.DOM.activeRecordMeasure = this.DOM.recordInfo\n      .append(\"span\")\n      .attr(\"class\", \"activeRecordMeasure\");\n    this.DOM.metricFuncText = this.DOM.recordInfo\n      .append(\"span\")\n      .attr(\"class\", \"metricFuncText\");\n    this.DOM.metricFuncText.html(\n      \"\" +\n        \"<span class='measureFunc metricOptionWrapper'>\" +\n        \"<span class='measureFuncText metricOptionWrapper_Text'></span>\" +\n        \"<select class='measureFuncOptions metricOptionWrapper_Opts'></select>\" +\n        \"</span>\" +\n        \"<span class='timeKeys metricOptionWrapper'>\" +\n        \"<i class='fal fa-calendar'></i>\" +\n        \"<span class='timeKeyText metricOptionWrapper_Text'></span>\" +\n        \"<select class='timeKeys metricOptionWrapper_Opts'></select>\" +\n        \"</span>\" +\n        \"<span class='measureSummary metricOptionWrapper'>\" +\n        \"<span class='measureSummaryName metricOptionWrapper_Text'></span>\" +\n        \"<select class='measureSummary metricOptionWrapper_Opts'></select>\" +\n        \"</span>\" +\n        `<span class='Of_NumberRecord'>${i18n.Of_NumberRecord}</span>`\n    );\n\n    this.DOM.metricFuncText.select(\"select.timeKeys\").on(\"input\", async (event) => {\n      await this.measureSummary.set(\n        this.measureSummary.get().timeseriesParent.getTimepointSummary(\n          event.currentTarget.selectedOptions[0].__data__\n        )\n      );\n    });\n\n    this.DOM.recordName = this.DOM.recordInfo\n      .append(\"span\")\n      .attr(\"class\", \"recordName\")\n      .tooltip(\"\")\n      .on(\"mouseenter\", function (event) {\n        this.tippy.setContent(this.isContentEditable ? \"OK\" : i18n.EditTitle);\n        event.stopPropagation();\n        event.preventDefault();\n      })\n      .on(\"focus\", function () {\n        this.tippy.hide();\n        this._initValue = DOMPurify.sanitize(this.innerHTML);\n      })\n      .on(\"blur\", function () {\n        this.tippy.hide();\n        this.contentEditable = false;\n      })\n      .on(\"keyup\", (event) => event.stopPropagation())\n      .on(\"keypress\", (event) => event.stopPropagation())\n      .on(\"keydown\", function (event) {\n        if (event.keyCode === 27) {\n          // Escape : Do not apply the new label\n          this.blur();\n          this.innerHTML = DOMPurify.sanitize(this._initValue);\n          return;\n        }\n        if (event.keyCode === 13) {\n          // ENTER\n          me.setRecordName(this.textContent);\n          this.blur();\n        }\n        event.stopPropagation();\n      })\n      .on(\"click\", function () {\n        if (!this.isContentEditable) {\n          this.contentEditable = true;\n          this.focus();\n        } else {\n          this.contentEditable = false;\n          me.setRecordName(DOMPurify.sanitize(this.innerHTML));\n        }\n      });\n\n    var dashboardSettings = this.DOM.panel_DataStatus\n      .append(\"span\")\n      .attr(\"class\", \"iconGroup dashboardSettings\");\n\n    this.DOM.panel_Basic_In = this.DOM.panel_DataStatus\n      .append(\"div\")\n      .attr(\"class\", \"panel_Basic_In\");\n\n    this.DOM.panel_DataStatus\n      .append(\"div\")\n      .attr(\"class\", \"iconGroup rightSideIcons\")\n      .call((rightSideIcons) => {\n        rightSideIcons\n          .append(\"div\")\n          .attr(\"class\", \"viewFullscreen basicIcon far fa-expand-arrows-alt\")\n          .tooltip(i18n.ShowFullscreen)\n          .on(\"click\", () => this.showFullscreen());\n\n        if (this.dashZoomLevel !== \"1.00\") {\n          rightSideIcons\n            .append(\"div\")\n            .attr(\"class\", \"basicIcon fa fa-window-restore\")\n            .tooltip(i18n[\"Reset Zoom Level\"])\n            .on(\"click\", () => this.attemptToFixBrowserZoomLevel(\"1.00\", true));\n        }\n\n        rightSideIcons\n          .append(\"div\")\n          .attr(\"class\", \"showHelpIn basicIcon fal fa-question-circle\")\n          .tooltip(i18n.Help)\n          .on(\"click\", () => Modal.helpUI());\n      });\n\n    dashboardSettings\n      .append(\"span\")\n      .attr(\"class\", \"dashboardSetting breakdownModeIcon far fa-percent\")\n      .tooltip(\"\", {\n        onShow: (instance) => {\n          instance.reference.tippy.setContent(\n            `<div>${i18n[\"Breakdown\"]}</div>\n          <b>${this.breakdownMode}</b><br>\n          <i>${i18n[\"Click to change\"]}</i>`\n          );\n        },\n      })\n      .on(\"click\", (event) => {\n        Modal.popupMenu(\n          event,\n          {\n            name: \"Breakdown\",\n            items: [\n              {\n                id: \"absoluteBreakdown\",\n                name: \"Absolute\",\n                iconClass: \"far fa-hashtag\",\n                helparticle: \"5e8944682c7d3a7e9aea659a\",\n                active: this.breakdownMode.is(\"absolute\"),\n                do: async () => await this.breakdownMode.set(\"absolute\"),\n              },\n              {\n                id: \"percentBreakdown\",\n                name: \"Percentage\",\n                iconClass: \"far fa-percent\",\n                expanded: true,\n                options: [\n                  {\n                    id: \"dependentBreakdown\",\n                    name: \"% of Compared\",\n                    helparticle: \"5e8944812c7d3a7e9aea659b\",\n                    active: this.breakdownMode.is(\"dependent\"),\n                    do: async () => await this.breakdownMode.set(\"dependent\"),\n                  },\n                  {\n                    id: \"relativeBreakdown\",\n                    name: \"% of Groups\",\n                    helparticle: \"5e8944932c7d3a7e9aea659c\",\n                    active: this.breakdownMode.is(\"relative\"),\n                    do: async () => await this.breakdownMode.set(\"relative\"),\n                  },\n                  {\n                    id: \"totalBreakdown\",\n                    name: \"% of All\",\n                    helparticle: \"5e94ff6904286364bc984a7a\",\n                    active: this.breakdownMode.is(\"total\"),\n                    do: async () => await this.breakdownMode.set(\"total\"),\n                  },\n                ],\n              },\n            ],\n          },\n          this,\n          { placement: \"bottom-start\" }\n        );\n      });\n\n    dashboardSettings\n      .append(\"span\")\n      .attr(\"class\", \"dashboardSetting lockCrumbMode\")\n      .tooltip(\"\", {\n        onShow: (instance) => {\n          instance.reference.tippy.setContent(\n            `<div>${i18n[\"Group View\"]}</div> <b>${this.stackedCompare}</b><br> <i>${i18n[\"Click to change\"]}</i>`\n          );\n        },\n      })\n      .on(\"click\", async () => await this.stackedCompare.set(!this.stackedCompare.get()) )\n      .append(\"div\")\n      .attr(\"class\", \"CompareModeIcon\")\n      .selectAll(\"div\")\n      .data([0, 1, 2])\n      .enter()\n      .append(\"div\")\n      .attr(\"class\", \"CompareModeIcon-block\");\n\n    this.DOM.breadCrumbs_Filter = this.DOM.panel_Basic_In\n      .append(\"div\")\n      .attr(\"class\", \"breadCrumbs breadCrumbs_Filter\")\n      .call((breadCrumbs_Filter) => {\n        breadCrumbs_Filter\n          .append(\"div\")\n          .attr(\"class\", \"breadCrumbHeader\")\n          .tooltip(i18n.RemoveAllFilters)\n          .text(i18n.Filters)\n          .on(\"click\", () => this.clearFilters_All());\n        breadCrumbs_Filter\n          .append(\"div\")\n          .attr(\"class\", \"breadCrumbCollapseControl far fa-angle-double-right\")\n          .tooltip(\"\", {\n            onTrigger: (instance) => {\n              instance.reference.tippy.setContent(\n                i18n[\n                  (breadCrumbs_Filter.node().classList.contains(\"collapsed\")\n                    ? \"Show\"\n                    : \"Hide\") + \" Filters\"\n                ]\n              );\n            },\n          })\n          .on(\"click\", () => {\n            var cl = breadCrumbs_Filter.node().classList;\n            cl.toggle(\"collapsed\");\n            if (!cl.contains(\"collapsed\")) {\n              this.filters_wrap_letItWrap = true;\n            }\n          });\n      });\n\n    this.DOM.breadCrumbs_Compare = this.DOM.panel_Basic_In\n      .append(\"div\")\n      .attr(\"class\", \"breadCrumbs breadCrumbs_Compare\")\n      .call((breadCrumbs_Compare) => {\n        breadCrumbs_Compare\n          .append(\"span\")\n          .attr(\"class\", \"breadCrumbHeader\")\n          .tooltip(i18n.Unlock)\n          .text(i18n.Compare)\n          .on(\"click\", () => this.clearSelect_Compare(this.activeComparisons, true, true) )\n          .append(\"span\")\n          .attr(\"class\", \"lockCrumbSummary blockName\");\n      });\n  }\n\n  /** -- */\n  async applyConfig(config) {\n    // Import panel config\n    Base.Panel_List.forEach((p) =>\n      this.panels[p].importConfig({\n        ...config.panels[p],\n        ...config.panels.default,\n      })\n    );\n\n    config.summaries = config.summaries || [];\n\n    for(let cfg of config.summaries){\n      await this.applyBlockConfig(cfg);\n    }\n\n    if (config.recordName && this.recordName !== config.recordName) {\n      this.setRecordName(config.recordName);\n    }\n\n    if (config.metric) {\n      var a = this.attribWithName(config.metric.summary);\n      if (a instanceof Attrib_Numeric) {\n        await this.measureSummary.set(a);\n        await this.measureFunc.set(config.metric.type);\n      }\n    } else {\n      await this.measureFunc.set(\"Count\");\n    }\n\n    await this.breakdownMode.set(config.breakdownMode);\n    await this.stackedCompare.set(config.stackedCompare);\n    await this.filteringMode.set(config.filteringMode);\n    await this.showWholeAggr.set(config.showWholeAggr);\n    await this.mouseOverCompare.set(config.mouseOverCompare);\n\n    await this.recordDisplay.importConfig(config.recordDisplay);\n\n    this.records.forEach((rec) => rec.refreshFilterCache());\n    this.updateRecordCount_Active();\n\n    this.updateAfterFilter();\n\n    this.updateLayout();\n  }\n\n  /* -- */\n  insertDOM_Panel_Overlay() {\n    this.DOM.overlay_wrapper = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"overlay_wrapper\");\n\n    // BACKGROUND\n    this.DOM.overlay_wrapper\n      .append(\"div\")\n      .attr(\"class\", \"fullBackground\")\n      .on(\"click\", (event) => {\n        if (!event.currentTarget.parentNode.classList.contains(\"easyDismiss\"))\n          return;\n\n        this.DOM.overlay_wrapper.attr(\"show\", \"none\");\n\n        this.recordDetailsPopup.closeRecordDetailPanel();\n\n        Modal._removeModal(this.DOM.overlay_wrapper);\n      });\n\n    // LOADING BOX\n    this.DOM.loadingBox = this.DOM.overlay_wrapper\n      .append(\"div\")\n      .attr(\"class\", \"overlay_content overlay_loading\");\n    var ssdsd = this.DOM.loadingBox\n      .append(\"span\")\n      .attr(\"class\", \"spinner\")\n      .selectAll(\".spinner_x\")\n      .data([1, 2, 3, 4, 5])\n      .enter()\n      .append(\"span\")\n      .attr(\"class\", (d) => \"spinner_x spinner_\" + d);\n    var hmmm = this.DOM.loadingBox.append(\"div\").attr(\"class\", \"status_text\");\n    hmmm\n      .append(\"span\")\n      .attr(\"class\", \"status_text_sub info\")\n      .html(i18n.LoadingData);\n    this.DOM.status_text_sub_dynamic = hmmm\n      .append(\"span\")\n      .attr(\"class\", \"status_text_sub dynamic\");\n\n    // CREDITS\n    this.DOM.overlay_infobox = this.DOM.overlay_wrapper\n      .append(\"div\")\n      .attr(\"class\", \"overlay_content overlay_infobox\");\n    this.DOM.overlay_infobox\n      .append(\"div\")\n      .attr(\"class\", \"overlay_Close fa fa-times fa-times-circle\")\n      .tooltip(i18n.Close)\n      .on(\"click\", () => this.DOM.overlay_wrapper.attr(\"show\", \"none\"));\n\n    // RECORD DETAILS\n    this.recordDetailsPopup.initDOM();\n\n    // HELP\n    this.DOM.overlay_wrapper\n      .append(\"div\")\n      .attr(\"class\", \"overlay_content overlay_help\");\n  }\n\n  // prevents inserting credits, which sets img src tags and adds image requests, until it is shown\n  creditsInserted = false;\n  showCredits() {\n    if (this.creditsInserted) return;\n    this.DOM.overlay_infobox\n      .append(\"div\")\n      .attr(\"class\", \"creditsBox\")\n      .html(\n        `<div style=\"text-align: center;\">\n  <a target='_blank' href='https://keshif.me'><img class='kshfLogo'></a>\n</div>\n<div>\n  <a class='creditsLink' target='_blank' href='https://keshif.me/Terms'>Terms of Use</a>\n  <a class='creditsLink' target='_blank' href='https://keshif.me/Privacy'>Privacy Policy</a>\n  <a class='creditsLink' target='_blank' href='https://keshif.me/License'>Other Licenses</a>\n</div>\n<div class='copyright'> Keshif, LLC 2022. All rights reserved.</div>\n`\n      );\n    this.creditsInserted = true;\n  }\n\n  /** -- */\n  helper_AddSidePanelGroup(className, _title, _tooltip) {\n    this.DOM[className] = this.DOM.authoringPanel\n      .append(\"div\")\n      .attr(\"class\", \"sidePanelGroup \" + className);\n\n    var xx = this.DOM[className]\n      .append(\"div\")\n      .attr(\"class\", \"sidePanelGroupHeader\");\n    xx.append(\"span\").html(_title);\n    xx.select(\".fa\").tooltip(_tooltip);\n    xx.append(\"span\")\n      .attr(\"class\", \"closeAttribPanel fa fa-window-close\")\n      .tooltip(i18n.Close)\n      .on(\"click\", async () => await this.dashboardMode.set(\"Explore\"));\n\n    return this.DOM[className]\n      .append(\"div\")\n      .attr(\"class\", \"sidePanelGroupContent\");\n  }\n\n  /** -- */\n  refreshAttibFilterState() {\n    this.DOM.dataTypeFilters.classed(\"active\", (_) => _.active);\n    var filterActive = this.dataTypeDescrs.some((_) => _.active);\n\n    var filterLevel;\n\n    var isExcluded = (_) => {\n      var visibleSubItems = filterLevel(Object.values(_.sub));\n      if (visibleSubItems > 0) return false;\n      if (typeof _.item === \"string\") {\n        return visibleSubItems === 0; // no visible items in the sub-tree\n      }\n      _ = _.item;\n      if (this.attribTextQuery) {\n        // also searches the query in descriptions\n        var searchIn = (\n          _.attribName + (_.description ? \" \" + _.description : \"\")\n        ).toLowerCase();\n        if (searchIn.indexOf(this.attribTextQuery) === -1) return true; // not found\n      }\n      if (!filterActive) return false;\n      return !this.dataTypeDescrs.some(\n        (descr) => descr.active && descr.member(_)\n      );\n    };\n\n    filterLevel = (items) => {\n      var visibleCount = 0;\n      items.forEach((_) => {\n        var s = isExcluded(_);\n        d3.select(_.DOM).classed(\"filtered\", s);\n        if (!s) visibleCount++;\n      });\n      return visibleCount;\n    };\n\n    this.removeEmptySubs();\n    filterLevel(Object.values(this.attribs_by_group));\n  }\n\n  /** -- */\n  refreshAttibButtonState() {\n    this.DOM.dataTypeFilters.classed(\"hidden\", (_) =>\n      this.attribs.every(\n        (attrib) => !attrib?.block?.hasNugget || !_.member(attrib)\n      )\n    );\n  }\n\n  private _attribPanelWidth: number = Base.width_AttribPanelDefault;\n  get attribPanelWidth() {\n    return this._attribPanelWidth;\n  }\n\n  /** -- */\n  setAttribPanelWidth(v) {\n    v = Number(v);\n    if (typeof v !== \"number\" || isNaN(v)) return;\n    v = Math.max(Math.min(v, 400), 200);\n    if (v === this._attribPanelWidth) return;\n    this._attribPanelWidth = v;\n    this.DOM.authoringPanel.style(\"width\", this._attribPanelWidth + \"px\");\n    this.updateLayout();\n  }\n\n  attribTextQuery: string = null;\n\n  /** -- */\n  insertDOM_AttribPanel() {\n    this.DOM.authoringPanel = this.DOM.root\n      .append(\"div\")\n      .attr(\"class\", \"authoringPanel\");\n\n    this.DOM.authoringPanel.style(\"width\", this._attribPanelWidth + \"px\");\n\n    // ****************************************************************************\n    // ***************************************************************************\n\n    var attributeInfo = this.helper_AddSidePanelGroup(\n      \"attributePanel\",\n      `<i class='panelIcon fal fa-cube'></i> ${i18n.Attributes}`,\n      \"<b>Author</b> your dashboard<br> using dataset attributes\"\n    );\n\n    attributeInfo\n      .append(\"div\")\n      .attr(\"class\", \"panelAdjustWidth\")\n      .tooltip(i18n[\"Adjust Panel Width\"])\n      .on(\"mousedown\", (event) => {\n        if (event.which !== 1) return; // only respond to left-click\n        var mouseDown_width =\n          this._attribPanelWidth - d3.pointer(event, document.body)[0];\n\n        this.activateWidthDrag(event.currentTarget, event, (event2) => {\n          this.setAttribPanelWidth(\n            mouseDown_width + d3.pointer(event2, document.body)[0]\n          );\n        });\n      })\n      .on(\"click\", (event) => {\n        event.stopPropagation();\n        event.preventDefault();\n      });\n\n    var attributePanelFilters = attributeInfo\n      .append(\"div\")\n      .attr(\"class\", \"attributePanelFilters\");\n\n    this.DOM.dataTypeFilters = attributePanelFilters\n      .append(\"div\")\n      .attr(\"class\", \"dataTypeFilters\")\n      .selectAll(\"div\")\n      .data(this.dataTypeDescrs)\n      .enter()\n      .append(\"div\")\n      .each((_) => {\n        _.active = false;\n      })\n      .attr(\"class\", (_) => \"filterTypeButton \" + _.icon)\n      .html((_) => _.iconDiv)\n      .tooltip((_) => i18n[_.name + \"Attribute\"], { placement: \"bottom\" })\n      .on(\"click\", (event, _) => {\n        _.active = !_.active;\n        this.refreshAttibFilterState();\n      });\n\n    var attributePanelControl;\n\n    attributePanelFilters\n      .append(\"div\")\n      .attr(\"class\", \"filterTypeButton attribTextSearchIcon far fa-search\")\n      .on(\"click\", (event) => {\n        event.currentTarget.classList.toggle(\"active\");\n        attributePanelControl.node().classList.toggle(\"active\");\n        this.DOM.attribTextSearch.select(\"input\").node().focus();\n      });\n\n    attributePanelFilters\n      .append(\"div\")\n      .attr(\"class\", \"filterTypeButton attribListConfiguration fal fa-cog\")\n      .tooltip(i18n.Configure, { placement: \"bottom\" })\n      .on(\"click\", (event) =>\n        Modal.popupMenu(event, MenuOpts.AttribPanel, this)\n      );\n\n    attributePanelControl = attributeInfo\n      .append(\"div\")\n      .attr(\"class\", \"attributePanelControl\");\n\n    // *******************************************************\n    // TEXT SEARCH\n    // *******************************************************\n\n    this.DOM.attribTextSearch = attributePanelControl\n      .append(\"span\")\n      .attr(\"class\", \"textSearchBox attribTextSearch\");\n    this.DOM.attribTextSearch\n      .append(\"input\")\n      .attr(\"class\", \"textSearchInput\")\n      .attr(\"type\", \"text\")\n      .attr(\"placeholder\", i18n.Search)\n      .on(\"keydown\", (event) => event.stopPropagation())\n      .on(\"keypress\", (event) => event.stopPropagation())\n      .on(\"keyup\", (event) => event.stopPropagation())\n      .on(\"input\", (event) => {\n        var DOM = event.currentTarget;\n        if (DOM.timer) clearTimeout(DOM.timer);\n        this.attribTextQuery = DOM.value.toLowerCase();\n        this.DOM.attribTextSearch.classed(\n          \"showClear\",\n          this.attribTextQuery !== \"\"\n        );\n        DOM.timer = setTimeout(() => this.refreshAttibFilterState(), 250);\n      });\n    this.DOM.attribTextSearch\n      .append(\"span\")\n      .attr(\"class\", \"fa fa-times-circle\")\n      .tooltip(i18n.ClearTextSearch)\n      .on(\"click\", () => {\n        this.attribTextQuery = \"\";\n        this.DOM.attribTextSearch\n          .classed(\"showClear\", false)\n          .select(\"input\")\n          .property(\"value\", \"\");\n        this.refreshAttibFilterState();\n      });\n\n    this.DOM.attributeList = attributeInfo\n      .append(\"div\")\n      .attr(\"class\", \"attributeList\");\n\n    this.DOM.boostButton = attributeInfo\n      .append(\"div\")\n      .attr(\"class\", \"boostButton\")\n      .html(\"<i class='fal fa-rocket-launch'></i> Boost\")\n      .tooltip(\"Auto-boost dashboard\")\n      .on(\"click\", () => this.runMagic());\n  }\n\n  /** -- */\n  collapseAttribListGroups(v = true) {\n    this.DOM.root\n      .selectAll(\".AttribListItem.hasSubItems\")\n      .nodes()\n      .forEach((node) => {\n        node.classList[v ? \"add\" : \"remove\"](\"collapsed\");\n      });\n  }\n\n  /** -- */\n  refreshAttribList() {\n    if (!this.finalized) return;\n\n    var recurse = (_selection, level) =>\n      _selection.each((_item, i, nodes) => {\n        refreshLevel(\n          d3.select(nodes[i]).select(\".subItems\"),\n          _item.sub,\n          level + 1\n        );\n      });\n\n    var refreshLevel = (_dom, _data, level) => {\n      _data = Object.values(_data).sort((a: any, b: any) => {\n        var isGroup_A =\n          Object.keys(a.sub).length > 0 && typeof a.item === \"string\";\n        var isGroup_B =\n          Object.keys(b.sub).length > 0 && typeof b.item === \"string\";\n\n        // folders first\n        if (isGroup_A !== isGroup_B) return +isGroup_B - +isGroup_A;\n\n        // first by type, then by name\n        var diff =\n          Util.getAttribTypeOrder(a.item.type) -\n          Util.getAttribTypeOrder(b.item.type);\n        return diff ? diff : Util.sortFunc_List_String(a.name, b.name);\n      });\n\n      _dom.selectAll(\"div.AttribListItem-Level\" + level).remove();\n\n      _dom\n        .selectAll(\"div.AttribListItem-Level\" + level)\n        .data(_data, (_) => _.name + \"_\" + typeof _.item)\n        .join(\n          (enter) => {\n            var listItems = enter\n              .append(\"div\")\n              .attr(\"class\", \"AttribListItem AttribListItem-Level\" + level)\n              .classed(\"hasSubItems\", (_) => Object.entries(_.sub).length > 0)\n              .classed(\"collapsed\", true);\n\n            listItems\n              .append(\"div\")\n              .attr(\"class\", \"nugget\")\n              //.attr(\"tempColumnName\",   _ => _.item.template.str || null)\n              .classed(\"inDashboard\", (_) => _.item?.block?.inDashboard)\n              .classed(\"condensedText\", (_) => _.name?.length > 30)\n              .each((_, i, nodes) => {\n                _.DOM = nodes[i];\n\n                var isGroup = typeof _.item === \"string\";\n                let _dom = d3.select(nodes[i]);\n\n                _dom.on(\"click\", (event) => {\n                  if (event.which !== 1) return; // only respond to left-click\n                  nodes[i].parentNode.classList.toggle(\"collapsed\");\n                });\n\n                _dom\n                  .append(\"div\")\n                  .attr(\"class\", \"groupControl\")\n                  .tooltip(i18n[\"Open/Close\"])\n                  .on(\"click\", (event) => {\n                    event.stopPropagation();\n                    event.preventDefault();\n                    nodes[i].parentNode.classList.toggle(\"collapsed\");\n                  })\n                  .append(\"div\")\n                  .attr(\"class\", \"fa fa-caret-down\");\n\n                _dom\n                  .append(\"span\")\n                  .attr(\"class\", \"nuggetIcon\")\n                  .append(\"div\")\n                  .attr(\n                    \"class\",\n                    isGroup ? \"fa fa-circle\" : _.item?.nuggetClassName\n                  );\n\n                _dom\n                  .append(\"span\")\n                  .attr(\"class\", \"summaryName\")\n                  .html(_.name)\n                  .tooltip(i18n.EditTitle);\n\n                var Y = _dom\n                  .append(\"div\")\n                  .attr(\"class\", \"iconWrapper\")\n                  .on(\"dblclick\", (event) => {\n                    event.stopPropagation();\n                    event.preventDefault();\n                  });\n\n                if (!isGroup) {\n                  let a: Attrib = _.item;\n                  if (a.attribName === this.idSummaryName) {\n                    Y.append(\"div\")\n                      .attr(\"class\", \"summaryRecordIDIcon far fa-fingerprint\")\n                      .tooltip(i18n[\"Record ID\"], { placement: \"bottom\" });\n                  }\n\n                  if (a.type === \"categorical\") {\n                    Y.append(\"div\")\n                      .attr(\"class\", \"summaryMultiCat far fa-tags\")\n                      .tooltip(i18n.MultiValued, { placement: \"bottom\" });\n                  }\n\n                  // no descriptions of simple groups currently\n                  Y.append(\"div\")\n                    .attr(\"class\", \"summaryDescription far fa-info-circle\")\n                    .classed(\"active\", !!a.description)\n                    .tooltip(a.description, { placement: \"bottom\" })\n                    .on(\"click\", function () {\n                      this.tippy.show();\n                    });\n\n                  a.block?.refreshNugget(_dom);\n                }\n\n                Y.append(\"div\")\n                  .attr(\"class\", \"showDeriveMenu fa fa-ellipsis-v\")\n                  .tooltip(i18n.Settings, { placement: \"bottom\" })\n                  .on(\"mousedown\", (event) => event.stopPropagation())\n                  .on(\"click\", (event) => {\n                    event.currentTarget.parentNode.parentNode.classList.add(\n                      \"popupVisible\"\n                    );\n                    if (isGroup) {\n                      Modal.popupMenu(event, MenuOpts.Attrib_Grouping, _);\n                    } else {\n                      _.item.initializeAggregates();\n                      Modal.popupMenu(event, MenuOpts.Attribute, _.item);\n                    }\n                    event.stopPropagation();\n                    event.preventDefault();\n                  });\n              });\n\n            listItems.append(\"div\").attr(\"class\", \"subItems\");\n\n            recurse(listItems, level);\n            return listItems;\n          },\n          (update) => recurse(update, level),\n          (exit) => exit.remove()\n        )\n        .order();\n    };\n\n    this.removeEmptySubs();\n\n    refreshLevel(this.DOM.attributeList, this.attribs_by_group, 0);\n\n    this.refreshAttibButtonState();\n  }\n\n  // ********************************************************************\n  // Full screen control\n  // ********************************************************************\n\n  private isFullscreen = false;\n\n  /** -- */\n  showFullscreen() {\n    this.isFullscreen = this.isFullscreen ? false : true;\n    var elem = this.DOM.root.node();\n    if (this.isFullscreen) {\n      if (elem.requestFullscreen) {\n        elem.requestFullscreen();\n      } else if (elem.msRequestFullscreen) {\n        elem.msRequestFullscreen();\n      } else if (elem.mozRequestFullScreen) {\n        elem.mozRequestFullScreen();\n      } else if (elem.webkitRequestFullscreen) {\n        elem.webkitRequestFullscreen();\n      }\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if ((document as any).msExitFullscreen) {\n        (document as any).msExitFullscreen();\n      } else if ((document as any).mozCancelFullScreen) {\n        (document as any).mozCancelFullScreen();\n      } else if ((document as any).webkitExitFullscreen) {\n        (document as any).webkitExitFullscreen();\n      }\n    }\n  }\n\n  // ********************************************************************\n  // Data loading\n  // ********************************************************************\n\n  _loadedTableCount = 0;\n  _totalTableCount = 0;\n\n  /** Setter & getter accecss so that UI can be updated when data is updated */\n  set loadedTableCount(v) {\n    this._loadedTableCount = v;\n    this.DOM.status_text_sub_dynamic?.text(\n      `(${this._loadedTableCount} / ${this._totalTableCount})`\n    );\n  }\n  get loadedTableCount() {\n    return this._loadedTableCount;\n  }\n\n  /** -- */\n  loadDataSources() {\n    \"use strict\";\n\n    this.DOM.overlay_wrapper.attr(\"show\", \"loading\");\n\n    DataTable.registerLoader(new DataLoader_FetchURL());\n    DataTable.registerLoader(new DataLoader_GoogleSheets());\n\n    this.insertDOM_Panel_DatasetInfo();\n\n    var tableLoadPromises = [];\n\n    if (this.options.source) {\n      let tableSpecs = this.options.source;\n      if (!Array.isArray(tableSpecs)) {\n        tableSpecs = [tableSpecs];\n      }\n\n      this.loadedTableCount = 0;\n      this._totalTableCount = tableSpecs.length;\n\n      tableLoadPromises = tableSpecs.map(async (tableDescr, i) => {\n        var dt = new DataTable(tableDescr);\n\n        await dt.load();\n        this._loadedTableCount++;\n\n        if (i === 0) {\n          this.primaryTableName = dt.name;\n          this.idSummaryName = dt.id || \"id\";\n\n          if (dt.linkToData) {\n            this.DOM.datasource\n              .style(\"display\", \"inline-block\")\n              .attr(\"href\", dt.linkToData);\n          }\n        }\n        return true;\n      });\n    }\n\n    // Execute async data loading on multiple tables\n    Promise.all(tableLoadPromises)\n      // load charts\n      .then(() => {\n        if (!this.primaryTableName) {\n          Modal.alert(\"Cannot load dashboard. Please define primaryTableName.\");\n          return;\n        }\n\n        this.records = Base.tables.get(this.primaryTableName)?.records || [];\n        this.records.forEach((record, i) => {\n          record.recordOrder = i;\n        });\n\n        this.setRecordName(this.recordName || this.primaryTableName);\n\n        // uses setTimeout to be able to render the updated \"Creating browser...\" text.\n        this.DOM.overlay_wrapper\n          .select(\"div.status_text .info\")\n          .text(i18n.CreatingBrowser);\n        this.DOM.overlay_wrapper.select(\"div.status_text .dynamic\").text(\"\");\n        window.setTimeout(async () => this._loadCharts(), 20);\n      })\n      .catch((err) => {\n        console.log(err);\n        Modal.alert(\"Error in loading data.<br><br> Error: \" + err);\n      });\n  }\n\n  /** -- */\n  prepBlockConfig(blockCfg) {\n    // **************************************************\n    // Deprecated/renamed configurations\n\n    if (blockCfg.showPercentile)\n      blockCfg.showPercentiles = blockCfg.showPercentile;\n    if (blockCfg.intervalScale)\n      blockCfg.valueScaleType = blockCfg.intervalScale;\n    if (blockCfg.scaleType) blockCfg.valueScaleType = blockCfg.scaleType;\n    if (blockCfg.minAggrValue) blockCfg.minAggrSize = blockCfg.minAggrValue;\n\n    if (blockCfg.supportsCompareLock === false) {\n      blockCfg.isComparable = false;\n    }\n\n    // Set type of summary automatically if type-specific attributes have been defined\n    if (!blockCfg.type) {\n      if (\n        blockCfg.catLabel ||\n        blockCfg.catTooltip ||\n        blockCfg.catSortBy ||\n        blockCfg.catGeo ||\n        blockCfg.barHeight ||\n        blockCfg.showSetMatrix\n      ) {\n        blockCfg.type = \"categorical\";\n      } else if (blockCfg.showPercentile || blockCfg.skipZero) {\n        blockCfg.type = \"numeric\";\n      } else if (blockCfg.recordGeo) {\n        blockCfg.type = \"recordGeo\";\n      } else if (blockCfg.content) {\n        blockCfg.type = \"content\";\n      }\n    }\n  }\n  /** -- */\n  async applyBlockConfig(attribCfg: SummarySpec) {\n    \"use strict\";\n\n    if (Object.keys(attribCfg).length === 0) return; // NO-OP\n    if (attribCfg.skipConfig) return;\n\n    this.prepBlockConfig(attribCfg);\n\n    var attrib = this.attribWithName(attribCfg.name);\n\n    var _byValue = null;\n    if (typeof attribCfg.value === \"string\" && attribCfg.type !== \"recordGeo\") {\n      _byValue = this.attribWithName(attribCfg.value);\n    }\n\n    if (!attrib && _byValue) {\n      // converting name from \"value\" to \"name\"\n      attrib = _byValue;\n      attrib.attribName = attribCfg.name;\n    } else {\n      if (\n        attrib &&\n        attribCfg.value &&\n        attribCfg.value !== attribCfg.name &&\n        attrib.template.str !== attribCfg.value\n      ) {\n        // redefining the attrib with the requested name using the new value function\n        attrib.destroy();\n      }\n      attrib = this.createAttrib(attribCfg.name, attribCfg.value, attribCfg.type);\n    }\n\n    // handle summary/attribCfg type mismatch...\n    if (attribCfg.type && attribCfg.type !== attrib.type) {\n      attrib.destroy();\n      attribCfg.value = attribCfg.value || attribCfg.name;\n\n      if (typeof attribCfg.value === \"string\") {\n        attrib = this.createAttrib(attribCfg.value, null, attribCfg.type);\n        attrib.attribName = attribCfg.name;\n      } else if (typeof attribCfg.value === \"function\") {\n        attrib = this.createAttrib(\n          attribCfg.name,\n          attribCfg.value,\n          attribCfg.type\n        );\n      }\n    }\n\n    // If attrib object is not found/created, nothing else to do\n    if (!attrib) return;\n\n    await attrib.applyConfig(attribCfg);\n\n    if (\n      attrib.isEmpty() &&\n      (attrib instanceof Attrib_Categorical ||\n        attrib instanceof Attrib_Interval)\n    ) {\n      attrib.destroy();\n      return;\n    }\n\n    if (attribCfg.panel) {\n      attrib.block?.addToPanel(this.panels[attribCfg.panel], undefined, true);\n    }\n  }\n\n  /** -- */\n  runMagic() {\n    var newConfig: any = this.exportConfig();\n\n    var potentialChanges = [];\n\n    // See if we can detect some auto-conversions!\n    var recordKeys = Object.keys(this.records[0].data);\n\n    // LAT_LONG conversion\n    var latKey, longKey;\n    var hasLat = recordKeys.some((k) => {\n      latKey = k;\n      var _ = k.toUpperCase();\n      return [\"LAT\", \"LATITUDE\"].includes(_);\n    });\n    var hasLong = recordKeys.some((k) => {\n      longKey = k;\n      var _ = k.toUpperCase();\n      return [\"LON\", \"LONGITUDE\", \"LNG\", \"LONG\"].includes(_);\n    });\n    if (hasLat && hasLong && !this.options.onLoad[\"_POINT\"]) {\n      potentialChanges.push({\n        i: '<i class=\"far fa-map-marker\"></i>',\n        q: `(<b>${latKey}</b>, <b>${longKey}</b>) is the point location.`,\n        a: () => {\n          this.options.onLoad[\"_POINT\"] = `LAT_LONG(${latKey},${longKey})`;\n          // delete lat/long summaries\n          newConfig.summaries = newConfig.summaries.filter((cfg) => {\n            return cfg.name !== latKey && cfg.name !== longKey;\n          });\n          if (!newConfig.recordDisplay.geo)\n            newConfig.recordDisplay.geo = \"_POINT\";\n          if (newConfig.recordDisplay.viewAs === \"none\")\n            newConfig.recordDisplay.viewAs = \"map\";\n        },\n      });\n    }\n\n    // Derive time feature\n    var timeStampSummaries = this.attribs.filter(\n      (attrib) => attrib instanceof Attrib_Timestamp\n    ) as Attrib_Timestamp[];\n\n    timeStampSummaries.forEach((attrib) => {\n      [\n        { typed: \"month\", derivative: \"Month\" },\n        { typed: \"day\", derivative: \"DayOfMonth\" },\n        { typed: \"day\", derivative: \"WeekDay\" },\n        { typed: \"hour\", derivative: \"Hour\" },\n      ].forEach((_opt) => {\n        if (\n          !attrib.timeTyped[_opt.typed] ||\n          attrib.derivatives[_opt.derivative]\n        ) {\n          return;\n        }\n        potentialChanges.push({\n          i: '<i class=\"far fa-calendar-day\"></i>',\n          q: `Derive ${_opt.derivative} of <b>${attrib.attribName}</b>`,\n          a: () => {\n            newConfig.summaries.push({\n              name: attrib.attribName + \"->\" + _opt.derivative,\n              value: attrib.template.str + \"->\" + _opt.derivative + \"()\",\n              panel: \"none\",\n            });\n          },\n        });\n      });\n    });\n\n    // Detect TIMESERIES\n    // Merge first ten records\n    var _mergedRecData = {};\n    this.records.slice(0, 10).forEach((rec: Record) => {\n      for (var k in rec.data) {\n        _mergedRecData[k] = _mergedRecData[k] || [];\n        _mergedRecData[k].push(rec.data[k]);\n      }\n    });\n\n    recordKeys.forEach((k) => {\n      var _values: any = _mergedRecData[k];\n      _values.some((v) => {\n        if (v == null || typeof v !== \"object\" || Array.isArray(v))\n          return false;\n\n        // TO-DO: Process non-number, string types time series field info (\"2017-05\",\"2017-04\", etc)\n        // both keys and values must be numbers\n        if (\n          Object.entries(v).every(([key, val]) => {\n            return !isNaN(Number(key)) && val !== null && !isNaN(Number(val));\n          })\n        ) {\n          potentialChanges.push({\n            i: '<i class=\"fa fa-chart-line\"></i>',\n            q: `<b>${k}</b> is timeseries by year/order.`,\n            a: () => {\n              this.options.onLoad[k] = k + \"->${DATETIME(%Y)}\";\n              // Remove summaries of individual time keys\n              newConfig.summaries = newConfig.summaries.filter(\n                (s: SummarySpec) => {\n                  if (s.panel !== \"none\") return true;\n                  var _t = new AttribTemplate(s.name, this);\n                  return !(_t && _t.pathStr === k);\n                }\n              );\n            },\n          });\n          return true;\n        }\n        return false;\n      });\n    });\n\n    // ZIPCODE?\n    var isZipCode = (attrib: Attrib) => {\n      var _ = attrib.attribName;\n      return _.toUpperCase() === \"ZIP\" || _.toUpperCase() === \"ZIPCODE\";\n    };\n\n    // Convert from integer to string\n    this.attribs.forEach((attrib) => {\n      if (attrib instanceof Attrib_Numeric && isZipCode(attrib)) {\n        potentialChanges.push({\n          i: '<i class=\"far fa-map-marker\"></i>',\n          q: `<b>${attrib.attribName}</b> is zipcode.`,\n          a: () => {\n            this.options.onLoad[attrib.template.str] = \"STR()\";\n            newConfig.summaries = newConfig.summaries.filter((_) => {\n              return _.name !== attrib.attribName;\n            });\n            attrib.destroy();\n          },\n        });\n      }\n    });\n\n    var numToDateMagic = [\n      {\n        // Serial dates\n        filter: (attrib: Attrib) => {\n          return (\n            attrib instanceof Attrib_Numeric &&\n            attrib.aggr_initialized &&\n            !attrib.unitName &&\n            attrib.rangeOrg[0] >= 18264 && // =DATEVALUE(\"1/1/1950\")\n            attrib.rangeOrg[1] <= 54789 && // =DATEVALUE(\"1/1/2050\")\n            !isZipCode(attrib)\n          );\n        },\n        i: \"hashtag\",\n        convert: \"DATETIME(%sn)\",\n        message: \" is a spreadsheet date field?\",\n      },\n      {\n        // Year only\n        filter: (attrib: Attrib) => {\n          return (\n            attrib instanceof Attrib_Numeric &&\n            attrib.aggr_initialized &&\n            !attrib.unitName &&\n            attrib.rangeOrg[0] >= 1950 && // =DATEVALUE(\"1/1/1950\")\n            attrib.rangeOrg[1] <= 2050 && // =DATEVALUE(\"1/1/2050\")\n            !isZipCode(attrib)\n          );\n        },\n        convert: \"DATETIME(%Y)\",\n        message: \" stores year values?\",\n      },\n      // Timestamp: -631152000 ... 2524608000\n      // Range too wide. Need more complex analysis to detect if fields are potentially dates\n    ];\n\n    this.attribs.forEach((attrib: Attrib) => {\n      numToDateMagic.some((_) => {\n        if (_.filter(attrib)) {\n          potentialChanges.push({\n            i: '<i class=\"fa fa-calendar-day\"></i>',\n            q: attrib.attribName + _.message,\n            a: () => {\n              this.options.onLoad[attrib.template.str] = _.convert;\n              // delete the type of existing attrib\n              newConfig.summaries\n                .filter((s) => s.name === attrib.attribName)\n                .forEach((c) => delete c.type);\n            },\n          });\n        }\n        return false;\n      });\n    });\n\n    // SPLIT CATEGORIES\n    this.attribs.forEach((attrib) => {\n      if (!(attrib instanceof Attrib_Categorical) || attrib.isEmpty()) return;\n\n      var allText = \"\";\n      attrib._aggrs.forEach((aggr) => {\n        allText += aggr.id;\n      });\n\n      [\n        { char: \",\", convert: \"SPLIT(\\\\s*,\\\\s*)\" },\n        { char: \";\", convert: \"SPLIT(\\\\s*;\\\\s*)\" },\n        { char: \"|\", convert: \"SPLIT(\\\\s*\\\\|\\\\s*)\" },\n        { char: \"+\", convert: \"SPLIT(\\\\s*\\\\+\\\\s*)\" },\n      ].forEach((_) => {\n        var n = allText.split(_.char).length - 1;\n        if (n <= allText.length / 20) return;\n        potentialChanges.push({\n          i: '<i class=\"far fa-tags\"></i>',\n          q: `<b>${attrib.attribName}</b> has multiple categories split by <b>${_.char}</b>`,\n          a: () => {\n            this.options.onLoad[attrib.template.str] = _.convert;\n          },\n        });\n      });\n    });\n\n    // Detect ID field\n    var recordTextCandidate = null;\n\n    if (this.idSummaryName === \"id\") {\n      let candidateSummaries: Attrib[] = this.attribs.filter((attrib) => {\n        if (\n          attrib instanceof Attrib_Categorical &&\n          attrib.uniqueCategories() &&\n          attrib.template.str &&\n          attrib.template.str !== \"id\"\n        ) {\n          var allText = \"\";\n          attrib._aggrs.forEach((aggr) => {\n            allText += aggr.id;\n          });\n          attrib[\"___temp\"] = allText.length;\n          return true;\n        }\n        return false;\n      });\n\n      candidateSummaries.sort((a, b) => a[\"___temp\"] - b[\"___temp\"]); // shortest first\n\n      var idCandidate = candidateSummaries[0];\n      if (idCandidate) {\n        potentialChanges.push({\n          i: \"<i class='far fa-fingerprint'></i>\",\n          q: `<b>${idCandidate.attribNameHTML}</b> is the unique fingerprint (ID) of the ${this.recordName}`,\n          a: () => {\n            newConfig.source.tables[0].id = idCandidate.template.str;\n            if (this.attribWithName(\"id\")) this.attribWithName(\"id\").destroy();\n            newConfig.summaries = newConfig.summaries.filter((_) => {\n              return _.name !== \"id\";\n            });\n          },\n        });\n      }\n\n      recordTextCandidate = candidateSummaries[1] || candidateSummaries[0];\n    }\n\n    if (!this.recordDisplay.codeBy.text) {\n      if (!recordTextCandidate) {\n        let candidateSummaries = this.attribs\n          .filter((attrib) => {\n            if (\n              attrib.type === \"categorical\" &&\n              attrib.template.str &&\n              attrib.template.str !== \"id\" &&\n              attrib._aggrs\n            ) {\n              attrib[\"___temp\"] = attrib._aggrs.length;\n              return true;\n            }\n            return false;\n          })\n          .sort((a, b) => b[\"___temp\"] - a[\"___temp\"]); // longest first\n        recordTextCandidate = candidateSummaries[0];\n      }\n      if (recordTextCandidate) {\n        potentialChanges.push({\n          i: '<i class=\"fa fa-font\"></i>',\n          q: `<b>${recordTextCandidate.summaryName}</b> can be used as record text.`,\n          a: () => {\n            newConfig.recordDisplay.textBy = recordTextCandidate.summaryName;\n            if (newConfig.recordDisplay.viewAs === \"none\") {\n              newConfig.recordDisplay.viewAs = \"list\";\n            }\n          },\n        });\n      }\n    }\n\n    if (\n      timeStampSummaries.length > 0 &&\n      timeStampSummaries.length < 3 &&\n      this.panels.bottom.isEmpty()\n    ) {\n      let attrib = timeStampSummaries[0];\n      if (!attrib.block?.inDashboard) {\n        potentialChanges.push({\n          i: '<i class=\"fa fa-th\"></i>',\n          q: `Place <b>${attrib.attribName}</b> on dashboard bottom`,\n          a: () => {\n            newConfig.summaries.forEach((s) => {\n              if (s.name === attrib.attribName) s.panel = \"bottom\";\n            });\n          },\n        });\n      }\n    }\n\n    this.attribs.forEach((attrib) => {\n      delete attrib[\"___temp\"];\n    });\n\n    if (potentialChanges.length === 0) {\n      Modal.alert(i18n.Boost_NoSuggestions);\n    } else {\n      // set change by default\n      potentialChanges.forEach((c) => {\n        if (c.change === undefined) c.change = true;\n      });\n      Modal.autoChanges(potentialChanges).then(\n        (potentialChanges: any[]) => {\n          var reloadDashboard = false;\n          potentialChanges.forEach((_) => {\n            if (_.change) {\n              _.a();\n              reloadDashboard = true;\n            } // apply\n          });\n\n          if (reloadDashboard) {\n            // delete the loaded dataset, so onLoad work correctly\n            Base.tables.delete(this.primaryTableName);\n\n            (window as any).dashboard = new Browser(newConfig);\n          } else {\n            // No changes applied. Remove animation.\n            if (this.DOM.boostButton)\n              this.DOM.boostButton.classed(\"animate\", false);\n          }\n        },\n        () => {\n          // Cancel changes\n          if (this.DOM.boostButton)\n            this.DOM.boostButton.classed(\"animate\", false);\n        }\n      );\n    }\n  }\n\n  public chartsLoaded = false;\n\n  /** -- */\n  async _loadCharts() {\n    if (this.chartsLoaded) return;\n\n    this.DOM.root.classed(\"dataLoaded\", true);\n\n    if (this.records.length === 0) {\n      Modal.alert(`Dataset (${this.recordName}) includes no records.`);\n      return;\n    }\n\n    // process non-function specifications.\n    for (var _key in this.onLoad.main) {\n      applyPreProc(_key, this.onLoad.main[_key], this.records);\n    }\n    this.onLoad.callback?.call(this);\n\n    loadMapStandards();\n\n    // apply panel layout\n    if (!this.options.panels) {\n      this.options.panels = {};\n    }\n    if (!this.options.panels.default) {\n      this.options.panels.default = {};\n    }\n    if (this.options.panels.default.catBarWidth == null) {\n      this.options.panels.default.catBarWidth = (() => {\n        var totalWidth = this.divWidth;\n        [\"left\", \"middle\", \"right\"].forEach((panelName) => {\n          if (this.panels[panelName].isEmpty()) return;\n          totalWidth -=\n            this.panels[panelName].width_Real -\n            this.panels[panelName].width_CatBars;\n        });\n        return Math.floor(totalWidth / 8);\n      })();\n    }\n    [\"left\", \"middle\", \"right\"].forEach((side) => {\n      if (this.options[side + \"PanelLabelWidth\"]) {\n        if (!this.options.panels[side]) this.options.panels[side] = {};\n        this.options.panels[side].catLabelWidth =\n          this.options[side + \"PanelLabelWidth\"];\n      }\n    });\n\n    await this.breakdownMode.set(this.options.breakdownMode);\n    await this.stackedCompare.set(this.options.stackedCompare);\n    await this.filteringMode.set(this.options.filteringMode);\n    await this.showWholeAggr.set(this.options.showWholeAggr);\n    await this.mouseOverCompare.set(this.options.mouseOverCompare);\n\n    this.records.forEach((rec) => this.allRecordsAggr.addRecord(rec));\n\n    if (this.options.attribPanelWidth) {\n      this.setAttribPanelWidth(this.options.attribPanelWidth);\n    }\n\n    if (this.options.colorTheme) {\n      this.colorTheme = Object.assign(this.colorTheme, this.options.colorTheme);\n    }\n\n    Base.Panel_List.forEach((p) =>\n      this.panels[p].importConfig(this.options.panels[p])\n    );\n\n    // look at first \"autoDetect_RowCount\" rows to identify the column names\n    var firstFiveRow_Cols = {};\n    function _recurse(_src, _trgt) {\n      if (!_src) return;\n      for (var _key in _src) {\n        var _v = _src[_key];\n        if (_v == null) continue;\n        if (\n          _v != null &&\n          typeof _v === \"object\" &&\n          !(_v instanceof Date) &&\n          !Array.isArray(_v) &&\n          !_v._timeseries_ &&\n          !_v.geometry &&\n          !_v.coordinates // map\n        ) {\n          // Object index\n          _trgt[_key] = _trgt[_key] || {};\n          _recurse(_v, _trgt[_key]);\n        } else {\n          _trgt[_key] = _v;\n        }\n      }\n    }\n\n    this.records\n      .slice(0, Base.autoDetect_RowCount)\n      .forEach((rec) => _recurse(rec.data, firstFiveRow_Cols));\n\n    // Create a summary for each existing column in the data\n    // Separated to a function to work recursively\n    var addAttribs = (parentPath, _obj, timeSeriesParent = false) => {\n      for (var attribName in _obj) {\n        if (typeof attribName !== \"string\") {\n          continue;\n        }\n\n        var _v = _obj[attribName];\n\n        if (_v != null && _v._timeseries_) {\n          let s = this.createAttrib(parentPath + attribName);\n          if (s) {\n            s.initializeAggregates();\n          }\n          // addAttribs(parentPath + attribName + \"->\", _v, true);\n          //\n        } else if (\n          _v != null &&\n          typeof _v === \"object\" &&\n          !(_v instanceof Date) &&\n          !Array.isArray(_v) &&\n          !_v.geometry &&\n          !_v.coordinates // map\n        ) {\n          addAttribs(parentPath + attribName + \"->\", _v);\n        } else {\n          if (!timeSeriesParent) {\n            let s = this.createAttrib(parentPath + attribName);\n            if (s) {\n              s.initializeAggregates();\n            }\n          }\n        }\n      }\n    };\n\n    addAttribs(\"\", firstFiveRow_Cols);\n\n    this.recordDisplay = new RecordDisplay(\n      this,\n      this.options.recordDisplay || {}\n    );\n\n    if (this.options.metric) {\n      var metric = this.options.metric;\n      if (typeof metric === \"string\") metric = { type: \"Sum\", summary: metric };\n      let a = this.attribWithName(metric.summary);\n      if (a instanceof Attrib_Numeric) {\n        await this.measureSummary.set(a);\n        await this.measureFunc.set(metric.type);\n      }\n    }\n\n    this.options.summaries = this.options.summaries || [];\n\n    for(let cfg of this.options.summaries){\n      await this.applyBlockConfig(cfg);\n    }\n\n    await this.recordDisplay.initialize();\n\n    this.panels.bottom.refreshWidth();\n\n    this.updateMiddlePanelWidth();\n\n    this.records.forEach((rec) => rec.refreshFilterCache());\n    this.updateRecordCount_Active();\n\n    this.updateAfterFilter();\n\n    // Load compare selections\n    if (this.options.selections && !this.options.selections.auto) {\n      var summary = this.attribWithName(this.options.selections.summary);\n      Base.Compare_List.forEach((cT) => {\n        var selection = this.options.selections[cT];\n        if (!selection) return;\n        if (!summary) return;\n\n        summary.initializeAggregates();\n\n        var aggr: Aggregate;\n        if (summary instanceof Attrib_Categorical) {\n          aggr = summary.getAggrWithLabel(selection.id);\n        } else if (summary instanceof Attrib_Numeric) {\n          this.flexAggrs[cT] = new Aggregate_Interval_Numeric(\n            summary,\n            selection.min as number,\n            selection.max as number\n          );\n          aggr = this.flexAggrs[cT];\n        }\n        if (!aggr) return;\n\n        if (this.setSelect_Compare(aggr, cT, false)) {\n          this.lockSelect_Compare(false);\n        }\n      });\n    }\n\n    this.enableAnalytics = true; // before this, do not run analytics computations\n\n    this.refreshConfigs();\n\n    // This needs to be called after analytics mode and configs are set-up.\n    // Auto-compare works on \"top\" categories, which depend on various analytics & chart modes.\n    if (this.options.selections && this.options.selections.auto) {\n      this.attribWithName(this.options.selections.summary)?.autoCompare();\n    }\n\n    this.checkBrowserZoomLevel();\n\n    // hide overlay\n    if (\n      this.DOM.overlay_wrapper.selectAll(\".overlay_modal\").nodes().length === 0\n    ) {\n      this.DOM.overlay_wrapper.attr(\"show\", \"none\");\n    }\n\n    await this.dashboardMode.set(this.options.dashboardMode);\n\n    this.options.onReady?.call(this);\n\n    this.finalized = true;\n\n    if (this.authorMode) this.refreshAttribList();\n\n    // height of histograms depend on dashboard width, which depends on mode.\n    this.updateLayout();\n\n    setTimeout(() => this.setNoAnim(false), 1000);\n\n    this.chartsLoaded = true;\n\n    if (this.options.recordInDetail) {\n      var record = Base.tables\n        .get(this.primaryTableName)\n        .getRecord(this.options.recordInDetail);\n      if (record) this.recordDetailsPopup.updateRecordDetailPanel(record);\n    }\n  }\n\n  /** -- */\n  unregisterBodyCallbacks() {\n    d3.select(\"body\")\n      .on(\"mousemove.layout\", null)\n      .on(\"mouseup.layout\", null)\n      .on(\"keydown.layout\", null);\n  }\n\n  // ********************************************************************\n  // Moving blocks across panels\n  // ********************************************************************\n\n  movedAttrib: Attrib = null;\n\n  private showDropZones = false;\n\n  /** -- */\n  prepareDropZones(attrib: Attrib, dropSource) {\n    this.movedAttrib = attrib;\n    this.showDropZones = true;\n    this.DOM.root.classed(\"showDropZone\", true).attr(\"dropSource\", dropSource);\n    this.DOM.attribDragBox.style(\"display\", \"block\").html(attrib.attribName);\n  }\n\n  /** -- */\n  clearDropZones() {\n    this.movedAttrib = null;\n    this.showDropZones = false;\n    this.unregisterBodyCallbacks();\n    this.DOM.root\n      .classed(\"showDropZone\", false)\n      .attr(\"dropattrtype\", null)\n      .attr(\"dropSource\", null);\n    this.DOM.attribDragBox.style(\"display\", \"none\");\n  }\n\n  /** -- */\n  autoAddAttib(attrib: Attrib): void {\n    if (attrib?.block?.inDashboard) return; //\n\n    if (attrib instanceof Attrib_Timeseries) {\n      this.recordDisplay.setAttrib(\"timeSeries\", attrib)\n        .then(async () => await this.recordChartType.set(\"timeseries\"));\n      return;\n    }\n\n    if (attrib instanceof Attrib_RecordGeo) {\n      this.recordDisplay.setAttrib(\"geo\", attrib)\n        .then(async () => await this.recordChartType.set(\"map\"));\n      return;\n    }\n\n    if (attrib instanceof Attrib_Categorical && attrib.uniqueCategories()) {\n      this.recordDisplay.setAttrib(\"text\", attrib)\n        .then(async () => await this.recordChartType.set(\"list\"));\n      return;\n    }\n\n    var target_panel: PanelName =\n      {\n        timestamp: \"bottom\",\n        categorical: \"left\",\n        numeric: \"right\",\n      }[attrib.type] || \"left\";\n\n    if (!this.panels[target_panel].welcomesNewBlock()) {\n      target_panel = \"middle\";\n    }\n\n    attrib?.block?.addToPanel(this.panels[target_panel]);\n  }\n\n  /** -- */\n  getGlobalActiveMeasure() {\n    if (this.allRecordsAggr.recCnt(\"Active\") === 0) return i18n[\"No [Record]\"];\n    var numStr = this.allRecordsAggr.measure(\"Active\").toLocaleString();\n    return this.getMeasureFormattedValue(numStr);\n  }\n\n  /** -- */\n  updateRecordCount_Active() {\n    this.DOM.activeRecordMeasure.html(this.getGlobalActiveMeasure());\n  }\n\n  /**************************************************************\n   * FILTERS\n   **************************************************************/\n\n  filters: Filter_Base[] = [];\n  filterCounter = 0;\n\n  /** -- */\n  get numOfActiveFilters() {\n    return this.filters.filter((filter) => filter.isFiltered).length;\n  }\n\n  /** -- */\n  isFiltered() {\n    return this.numOfActiveFilters > 0;\n  }\n\n  /** -- */\n  getFilteredSummaryText() {\n    if (this.numOfActiveFilters === 0) return \"\";\n    if (this.numOfActiveFilters > 1) return \"filtered\";\n    var f = this.filters.find((filter) => filter.isFiltered);\n    return f.getRichText_flipped();\n  }\n\n  /** -- */\n  refresh_filterClearAll() {\n    this.DOM.breadCrumbs_Filter.classed(\"isActive\", this.isFiltered());\n  }\n\n  skipSortingSummary: Attrib_Categorical = null;\n\n  /** -- */\n  clearFilters_All(exceptThis: Filter_Base = null) {\n    if (this.numOfActiveFilters === 0) return;\n    // sometimes, it looks like the exceptThis selection is already filtered. Skip in that case\n    if (\n      this.numOfActiveFilters === 1 &&\n      this.filters.filter((filter) => filter.isFiltered)[0] === exceptThis\n    )\n      return;\n    if (this.skipSortingSummary) {\n      // you can now sort the last filtered summary, attention is no longer there.\n      this.skipSortingSummary.dirtySort = false;\n    }\n\n    // clear all registered filters\n    this.filters.forEach(\n      (filter) => filter !== exceptThis && filter.clearFilter(false)\n    );\n\n    // Only update records which were not wanted before.\n    this.records.forEach((rec) => rec.filteredOut && rec.refreshFilterCache());\n    this.updateRecordCount_Active();\n    this.updateAfterFilter(true); // more results\n\n    setTimeout(() => this.updateLayout_Height(), 1000); // update layout after 1 seconds\n  }\n\n  /** -- */\n  updateAfterFilter(how = false) {\n    Base.browser = this;\n\n    Base.Compare_List.forEach((cT) => {\n      var compared_Aggr = this.selectedAggrs[cT];\n      if (compared_Aggr) this.refresh_Compare_Measures(compared_Aggr, cT);\n    });\n\n    this.refreshPanelsSyncedMeasureExtend();\n\n    this.blocks.forEach((block) => block.updateAfterFilter(true)); // refresh viz\n    this.recordDisplay.updateAfterFilter(how);\n\n    this.updateWidth_CatMeasureLabels();\n    this.refreshAllMeasureLabels();\n    this.refresh_filterClearAll();\n\n    this.filteringMode.refresh();\n\n    this.needToRefreshLayout = true;\n  }\n\n  /**************************************************************\n   * ANALYTICS MODES\n   **************************************************************/\n\n  enableAnalytics: boolean = false;\n\n  private refreshAnalytics() {\n    if (!this.enableAnalytics) return;\n\n    this.DOM?.root\n      ?.classed(\"stackedCompare\", this.stackedCompare.is(true))\n      .classed(\"stackedChart\", this.stackedChart)\n      .classed(\"showWholeAggr\", this.showWholeAggr.is(true))\n      .attr(\"breakdownMode\", this.breakdownMode.get())\n      .attr(\"measureFunc\", this.measureFunc.get());\n\n    this.updateWidth_CatMeasureLabels();\n\n    if (this.stackedCompare.is(true)) {\n      this.attribs.forEach((attrib) => {\n        if (attrib.measureScale_Log) attrib.measureScaleType.set(\"linear\");\n      });\n    }\n\n    this.refreshPanelsSyncedMeasureExtend();\n\n    this.attribsInDashboard.forEach((attrib) => {\n      attrib.updateChartScale_Measure(true); // skip refresh viz\n      attrib.block.refreshViz_All();\n      attrib.block.refreshMeasureDescrLabel();\n\n      if (attrib instanceof Attrib_Categorical) {\n        if (attrib.catOrder_Dynamic && attrib.catSortBy !== \"Active\") {\n          attrib.block.updateCatSorting(); // delay, with animation\n        }\n      }\n    });\n\n    this.recordDisplay.View?.refreshSelect_Compare();\n\n    this.refreshAllMeasureLabels();\n  }\n\n  /** -------------------------------------------------- */\n  // Auto-computed from stacked compare setting\n  get stackedChart() {\n    if (this.stackedCompare.is(false)) return false;\n    if (this.activeComparisonsCount >= 1) return true;\n    if (this.activeComparisonsCount === 0) return false;\n    return this.lockedCompare[this.activeComparisons[0]]; // single comparison\n  }\n\n  /** -------------------------------------------------- */\n  get exploreMode() {\n    return this.dashboardMode.is(\"Explore\");\n  }\n  get adjustMode() {\n    return this.dashboardMode.is(\"Adjust\");\n  }\n  get authorMode() {\n    return this.dashboardMode.is(\"Author\");\n  }\n  get captureMode() {\n    return this.dashboardMode.is(\"Capture\");\n  }\n  get saveMode() {\n    return this.dashboardMode.is(\"Save\");\n  }\n\n  /** -------------------------------------------------- */\n  get measureFunc_Count() {\n    return this.measureFunc.is(\"Count\");\n  }\n  get measureFunc_Avg() {\n    return this.measureFunc.is(\"Avg\");\n  }\n  get measureFunc_Sum() {\n    return this.measureFunc.is(\"Sum\");\n  }\n\n  /** -------------------------------------------------- */\n  get singleFiltering() {\n    return this.filteringMode.is(\"single\");\n  }\n  get chainedFiltering() {\n    return this.filteringMode.is(\"chained\");\n  }\n\n  /** -------------------------------------------------- */\n  get absoluteBreakdown() {\n    return this.breakdownMode.is(\"absolute\");\n  }\n  get percentBreakdown() {\n    return this.breakdownMode.get() != \"absolute\";\n  }\n  get relativeBreakdown() {\n    return this.breakdownMode.is(\"relative\");\n  }\n  get dependentBreakdown() {\n    return this.breakdownMode.is(\"dependent\");\n  }\n  get totalBreakdown() {\n    return this.breakdownMode.is(\"total\");\n  }\n\n  /** Updates shared (synced) measure extent within the panel (so bar charts can share the same scale) */\n  private refreshPanelsSyncedMeasureExtend() {\n    Object.values(this.panels).forEach((panel) =>\n      panel.refreshSharedMeasureExtent()\n    );\n  }\n\n  /** -- */\n  refreshAllMeasureLabels(t: MeasureType = null, _fixed = false) {\n    if (!t) {\n      // no mode specified, go through it all\n      this.refreshAllMeasureLabels(\"Active\", true);\n      this.activeComparisons.forEach((cT) =>\n        this.refreshAllMeasureLabels(cT, true)\n      );\n      return;\n    }\n    this.blocks.forEach((block) => {\n      block.refreshMeasureLabelText(t);\n      if (block instanceof Block_Categorical) {\n        // refresh map visualization (TODO: fix/improve this part)\n        if (!_fixed && block.isView_Map) block.refreshViz(t);\n      }\n    });\n  }\n\n  /** -- */\n  updateWidth_CatMeasureLabels() {\n    Base.Panel_List.forEach((p) =>\n      this.panels[p].updateWidth_CatMeasureLabels()\n    );\n  }\n\n  /**************************************************************\n   * COMPARISONS\n   **************************************************************/\n\n  /** True if given compare type is locked */\n  lockedCompare: { [key in CompareType]?: boolean } = {};\n\n  /** Returns selected aggregate, if selection is active on given compare type */\n  selectedAggrs: { [key in CompareType]?: Aggregate } = {};\n\n  /** True if selected comparison is active (checks selected aggregate)  */\n  vizActive(key: CompareType) {\n    return this.selectedAggrs[key] !== null;\n  }\n\n  /** Locked attribute - equal to compared attribute, unless the compared one is not locked */\n  get lockedAttrib(): Attrib {\n    var cT = Base.Compare_List.find((cT) => this.lockedCompare[cT]);\n    return cT ? this.selectedAggrs[cT].attrib : null;\n  }\n\n  /** -- */\n  get comparedAttrib(): Attrib | null {\n    var cT = Base.Compare_List.find((cT) => this.selectedAggrs[cT]);\n    return cT ? this.selectedAggrs[cT].attrib : null;\n  }\n\n  /** Can select aggregate only with current active compared attribute */\n  can_setSelect_Compare(aggr: Aggregate) {\n    return !this.comparedAttrib || this.comparedAttrib === aggr.attrib;\n  }\n\n  /** -- */\n  refresh_Compare_Measures(aggr, cT) {\n    this.resetAllAggrMeasures(cT);\n    aggr.records.forEach((record) => record.addToAggrMeasure(cT));\n  }\n\n  get activeComparisonsCount() {\n    return this.activeComparisons.length;\n  }\n  get activeComparisons(): CompareType[] {\n    return Base.Compare_List.filter((cT) => this.vizActive(cT));\n  }\n  isCompared() {\n    return this.activeComparisonsCount > 0;\n  }\n\n  /** Which Comparison (Compare_X) to use as highlighting */\n  get Compare_Highlight(): CompareType {\n    return Base.Compare_List.find((cT) => {\n      if (!this.lockedCompare[cT]) return cT;\n    });\n  }\n\n  /** Return the name for remaining \"other\" selection. Only valid if using categorical */\n  get otherNameInCompare(): string {\n    if (!this.comparedAttrib) return;\n    if (this.comparedAttrib.type === \"categorical\") {\n      var notCompared = this.comparedAttrib._aggrs.filter((_) => !_.compared);\n      // only one other unselected option, no missing values, all that remains fall into one category\n      if (\n        notCompared.length === 1 &&\n        this.comparedAttrib.noValueAggr.recCnt(\"Total\") === 0\n      ) {\n        return notCompared[0].label;\n      }\n    }\n    return i18n.Other;\n  }\n\n  /** -- */\n  crumbs: { [key in CompareType]?: BreadCrumb } = {};\n\n  // creates a new breadcrumb for active highlight, and returns the previous crumb\n  createNewCrumb(): BreadCrumb {\n    let cT: CompareType = this.Compare_Highlight;\n    var r = this.crumbs[cT] || new BreadCrumb(this, cT);\n    this.crumbs[cT] = new BreadCrumb(this, cT);\n    return r;\n  }\n\n  isComparedSummaryMultiValued(): boolean {\n    var a = this.comparedAttrib;\n    if (a instanceof Attrib_Categorical) {\n      return a.isMultiValued;\n    }\n    return false;\n  }\n\n  /** -- */\n  get flexAggr_Highlight(): Aggregate_Interval<IntervalT> {\n    return this.flexAggrs[Base.Compare_List.find((cT) => !this.vizActive(cT))];\n  }\n\n  /** -- */\n  set flexAggr_Highlight(aggr: Aggregate_Interval<IntervalT>) {\n    this.flexAggrs[Base.Compare_List.find((cT) => !this.vizActive(cT))] = aggr;\n  }\n\n  /** -- */\n  refreshViz_Compare_All() {\n    this.recordDisplay.refreshViz_Compare_All();\n    this.blocks.forEach((block) => block.refreshViz_Compare_All());\n  }\n\n  /** -- */\n  refreshComparedSummary() {\n    if (!this.comparedAttrib) return;\n\n    this.comparedAttrib.addDOMBlockName(\n      this.DOM.breadCrumbs_Compare.select(\".lockCrumbSummary\")\n    );\n\n    this.comparedAttrib.block.DOM.root?.classed(\"comparedSummary\", true);\n  }\n\n  /** -- */\n  lockSelect_Compare(refreshAnalytics = true) {\n    var cT = this.Compare_Highlight;\n    if (!cT) return false; // cannot, sorry\n\n    if (!this.vizActive(cT)) return false;\n    if (this.lockedCompare[cT]) return false;\n    if (!this.selectedAggrs[cT]) return false;\n\n    if (this.selectedAggrs[cT].attrib?.isComparable.is(false)) {\n      return false;\n    }\n\n    this.selectedAggrs[cT].lockSelection();\n    this.lockedCompare[cT] = true;\n\n    this.lockedAttrib?.block?.DOM.root?.classed(\"lockedAttrib\", true);\n\n    if (refreshAnalytics) this.refreshAnalytics();\n\n    return true;\n  }\n\n  selectTimeouts: { [key in CompareType]?: number } = {};\n\n  /** -- */\n  setSelect_Compare(\n    selAggregate: Aggregate,\n    cT: CompareType = null,\n    refreshAnalytics = true\n  ) {\n    if (!selAggregate) return false;\n\n    if (!cT) cT = this.Compare_Highlight;\n    if (!cT) return false; // cT must be set beyond this point\n\n    if (this.selectTimeouts[cT]) {\n      window.clearTimeout(this.selectTimeouts[cT]);\n      this.clearSelect_Compare(cT, false, true);\n      delete this.selectTimeouts[cT];\n    }\n\n    // If there's active compared summary, cannot compare aggregate from another summary\n    if (\n      this.comparedAttrib &&\n      selAggregate.attrib &&\n      this.comparedAttrib !== selAggregate.attrib\n    ) {\n      return false;\n    }\n\n    if (selAggregate !== this.flexAggr_Highlight) {\n      // Already comparing that aggregate, nothing else to do\n      if (this.vizActive(cT)) return cT;\n      if (selAggregate.compared) return cT;\n    }\n\n    this.addedCompare = true;\n\n    this.DOM.root\n      .classed(\"select\" + cT, true)\n      .classed(\"comparedMultiValue\", this.isComparedSummaryMultiValued());\n\n    this.DOM.breadCrumbs_Compare.classed(\"isActive\", true);\n\n    this.selectedAggrs[cT] = selAggregate;\n    this.selectedAggrs[cT].selectCompare(cT);\n\n    this.crumbs[cT].showCrumb(cT, selAggregate.attrib?.summaryFilter);\n\n    this.refreshComparedSummary();\n\n    if (selAggregate.attrib instanceof Attrib_Interval) {\n      selAggregate.attrib.block.refreshIntervalSlider([cT]);\n    }\n\n    this.blocks.forEach((block) => {\n      if (block instanceof Block_Categorical) {\n        if (block.isView_Dropdown) block.dropdown_refreshCategories();\n      }\n    });\n\n    if (refreshAnalytics) {\n      this.refreshConfigs();\n    }\n\n    return cT;\n  }\n\n  /** -- */\n  clearSelect_Compare(\n    cT: CompareType | CompareType[] = this.Compare_Highlight,\n    finalize = true,\n    noWait = false\n  ) {\n    if (!cT) return;\n\n    if (!noWait && !Array.isArray(cT)) {\n      if (this.selectTimeouts[cT]) window.clearTimeout(this.selectTimeouts[cT]);\n      this.selectTimeouts[cT] = window.setTimeout(() => {\n        this.clearSelect_Compare(cT, finalize, true);\n        delete this.selectTimeouts[cT];\n      }, 750);\n      return;\n    }\n\n    var comparedSummary_old = this.comparedAttrib;\n    var lockedSummary_old = this.lockedAttrib;\n\n    var finishClearSelect = () => {\n      this.recordDisplay.refreshCompareLegend();\n\n      this.blocks.forEach((block) => {\n        if (block instanceof Block_Categorical && block.isView_Dropdown) {\n          block.dropdown_refreshCategories();\n        }\n      });\n\n      if (this.comparedAttrib !== comparedSummary_old) {\n        comparedSummary_old.block.DOM.root?.classed(\"comparedSummary\", false);\n      }\n\n      if (this.lockedAttrib !== lockedSummary_old) {\n        lockedSummary_old.block?.DOM.root?.classed(\"lockedAttrib\", false);\n      }\n\n      if (finalize) {\n        this.refreshConfigs();\n      }\n    };\n\n    if (Array.isArray(cT)) {\n      cT.forEach((_) => this.clearSelect_Compare(_, false, noWait));\n      finishClearSelect();\n      return;\n    }\n\n    if (typeof cT !== \"string\") return;\n    if (!this.vizActive(cT)) return;\n\n    this.addedCompare = false;\n\n    this.crumbs[cT].removeCrumb();\n    this.lockedCompare[cT] = false;\n\n    if (this.selectedAggrs[cT]) {\n      let a = this.selectedAggrs[cT].attrib;\n      if (a instanceof Attrib_Interval) {\n        a.block.refreshIntervalSlider([cT]);\n      }\n      this.selectedAggrs[cT].clearCompare(cT);\n      this.selectedAggrs[cT] = null;\n    }\n\n    this.DOM.root.classed(\"select\" + cT, this.vizActive(cT));\n    this.DOM.breadCrumbs_Compare.classed(\n      \"isActive\",\n      this.activeComparisonsCount !== 0\n    );\n\n    this.resetAllAggrMeasures(cT);\n\n    if (finalize) {\n      finishClearSelect();\n    }\n  }\n\n  /** -- */\n  private resetAllAggrMeasures(t) {\n    this.allAggregates.forEach((aggr) => aggr.resetMeasure(t));\n  }\n\n  /**************************************************************\n   * MEASUREMENTS\n   **************************************************************/\n\n  /** -- */\n  hasIntOnlyMeasure(): boolean {\n    return (\n      this.measureFunc_Count ||\n      (this.measureFunc_Sum && !this.measureSummary.get().hasFloat)\n    );\n  }\n  /** --*/\n  measureSumWithNegativeValues(): boolean {\n    return this.measureFunc_Sum && this.measureSummary.get().hasNegativeValues();\n  }\n  /** --*/\n  measureWithPositiveValues(): boolean {\n    if (this.measureFunc_Count) return true;\n    // TODO: This may return true, but other code relies on disabling when using avg measures\n    if (this.measureFunc_Avg) return false;\n    return this.measureSummary.get()?.hasNegativeValues();\n  }\n\n  /** funcType: \"Count\", Sum\" or \"Avg\" */\n  private async refreshMeasureMetric() {\n    if (!this.records) return; // if calling the function too early in initialization\n    let attrib = this.measureSummary?.get();\n    if (!attrib) return;\n\n    this.records.forEach(\n      this.measureFunc_Count\n        ? (rec: Record) => {\n            rec.measure_Self = 1;\n          }\n        : (rec: Record) => {\n            rec.measure_Self = attrib.getRecordValue(rec);\n          }\n    );\n\n    this.allAggregates.forEach((aggr) => aggr.resetAggregateMeasures());\n    this.blocks.forEach((block) => block.updateAfterFilter(false));\n\n    this.recordDisplay.refreshRecordVis();\n\n    this.updateRecordCount_Active();\n\n    this.refreshAnalytics();\n\n    if (attrib.hasTimeSeriesParent()) {\n      await this.recordDisplay.currentTimeKey.set(attrib.timeKey);\n    }\n  }\n\n  /**************************************************************\n   * ZOOM LEVELS (UI)\n   **************************************************************/\n\n  /** -- */\n  get dashZoomLevel() {\n    var r = \"1.00\";\n    try {\n      r = window.localStorage.getItem(\"kshfZoom\") || \"1.00\";\n    } catch (error) {}\n    return r;\n  }\n\n  /** -- */\n  attemptToFixBrowserZoomLevel(\n    multiplier = \"1.00\" /*reset*/,\n    forceReload = false\n  ) {\n    // Doesn't apply in firefox.\n    this.DOM.root.style(\"zoom\", multiplier);\n    try {\n      window.localStorage.setItem(\"kshfZoom\", multiplier);\n    } catch (error) {}\n    if (forceReload) window.location.reload();\n  }\n  /** -- */\n  detectPageZoom() {\n    // Other page size detection approaches:\n    // document.documentElement.clientWidth;\n    // document.documentElement.scrollWidth;\n\n    // CONSTANT - Does not seem to be affected by zoom level. Thus, serves as the \"default\" (100%) zoom\n    var windowOuterWidth = window.outerWidth;\n\n    // On safari,\n    // - Page zoomed in: innerWidth < outerwidth.\n    // - Page zoomed out: innerWidth > outerWidth\n    var windowInnerWidth = window.innerWidth;\n\n    if (window.parent) {\n      try {\n        // if placed inside an iframe, window.outerWidth measures the size of the top window, not the current frame.\n        // so, instead, when there's access to parent, I am using parent's zoom level detection.\n        windowOuterWidth = window.parent.outerWidth;\n        windowInnerWidth = window.parent.innerWidth;\n      } catch (exception) {\n        console.log(\"page detect zoom exception: \" + exception);\n        // use pageZoom URL parameter (TEMP - TODO. Not documented, may be removed in future)\n        let URLparams = new URL((document as any).location).searchParams;\n        if (URLparams && URLparams.get(\"pageZoom\")) {\n          return Number(URLparams.get(\"pageZoom\")) || 1;\n        }\n        return 1;\n      }\n\n      // visualViewport: Generally not useful. It reacts to pinch zoom and such.\n      // Didn't find a useful case where it's needed\n      // window.visualViewport.scale = Chrome only, pinch effect (not useful for detecting zoom level)\n      //windowOuterWidth = window.visualViewport.width;\n      // on safari, visualViewport.width is the window.innerWidth,\n    }\n\n    var pageZoomLevel_num = 1;\n\n    if (windowInnerWidth !== windowOuterWidth) {\n      pageZoomLevel_num = windowInnerWidth / windowOuterWidth;\n    } else {\n      // On chrome, changing zoom level changes devicePixelRatio, BUT it also changes inner/outer width\n      // and that change is captured in the code above before it comes here...\n      // devicePixelRatio\n      // - Not very helpful\n      // - On Safari, devicePixelRatio is CONSTANT (independent of zoom level). Cannot be used for detection.\n      // - On Firefox & Chrome, it is dependent on zoom level\n      //   - It can be \"2\" by default (retina displays, for example).\n      //   - Then what does a value of 1.5 mean? There's no way to know \"native\" zoom level, thus is not reliable.\n      /*\n      var devicePixelRatio = window.devicePixelRatio ? window.devicePixelRatio : 1;\n      if(devicePixelRatio!==undefined && devicePixelRatio!==1 && devicePixelRatio!==2){\n        if(devicePixelRatio>2) devicePixelRatio = devicePixelRatio / 2; \n        var multiplier = 1/devicePixelRatio;\n      }\n      */\n    }\n\n    return pageZoomLevel_num;\n  }\n  /** -- */\n  checkBrowserZoomLevel() {\n    var pageZoomLevel_num = this.detectPageZoom();\n\n    // If diff between detected ideal and current is less than 1%, no need to change\n    if (Math.abs(pageZoomLevel_num - parseFloat(this.dashZoomLevel)) < 0.01) {\n      return;\n    }\n\n    setTimeout(() => {\n      this.showWarning(i18n.ZoomLevelWarning);\n      this.DOM.warningText\n        .select(\".attemptToFix\")\n        .on(\"click\", () =>\n          this.attemptToFixBrowserZoomLevel(pageZoomLevel_num.toFixed(2), true)\n        );\n      this.DOM.warningText\n        .selectAll(\".dismiss\")\n        .on(\"click\", () => this.hideWarning());\n    }, 1000);\n  }\n\n  /**************************************************************\n   * UPDATING LAYOUT\n   **************************************************************/\n\n  /** -- */\n  updateLayout() {\n    if (this.finalized !== true) return;\n    this.updateWidth_Total();\n    this.updateLayout_Height();\n    this.updateMiddlePanelWidth();\n    this.panels.bottom.refreshWidth();\n  }\n  /** -- */\n  filters_wrap_letItWrap = false;\n  checkAndAdjustBreadcrumbs() {\n    if (this.filters_wrap_letItWrap) return;\n    var wrapped = this.isBreadcrumbAreaWrapped();\n    if (wrapped) {\n      this.DOM.breadCrumbs_Filter.classed(\"collapsed\", true);\n      this.filters_wrap_letItWrap = true;\n    }\n  }\n  /** -- */\n  isBreadcrumbAreaWrapped() {\n    var DOM = this.DOM.breadCrumbs_Filter.node();\n    if (DOM.classList.contains(\"collapsed\")) return false; // not wrapped\n    var _top = null,\n      _height = null;\n    var DOM_items = this.DOM.panel_Basic_In.selectAll(\".breadCrumb\").nodes();\n    return DOM_items.some((DOM_item) => {\n      if (_top != null && DOM_item.offsetTop > _top + _height * 0.7) {\n        return true;\n      }\n      _height = DOM_item.offsetHeight;\n      _top = DOM_item.offsetTop;\n      return false;\n    });\n  }\n  /** -- */\n  updateLayout_Height() {\n    if (!this.recordDisplay) {\n      return; // dashboard not initialized yet\n    }\n\n    let divHeight = this.DOM.root.nodes()[0].offsetHeight;\n\n    var divHeight_Total =\n      divHeight -\n      this.height_PanelHeader -\n      this.height_PanelFooter -\n      2 * Base.width_PanelGap;\n\n    // ****************************************************************\n    // BOTTOM PANEL\n    var targetHeight_bottom = divHeight_Total;\n    // In case there is something above the bottom panel, target half the size\n    if (\n      this.panels.left.hasBlocks() ||\n      this.panels.right.hasBlocks() ||\n      this.panels.middle.hasBlocks() ||\n      this.recordChartType.get() !== \"none\"\n    ) {\n      // maximum half height if there is any other content\n      targetHeight_bottom *= 0.5;\n    }\n    this.panels.bottom.setHeightAndLayout(targetHeight_bottom);\n\n    var topPanelsHeight = divHeight_Total - this.panels.bottom.height;\n\n    // ****************************************************************\n    // LEFT PANEL\n    this.panels.left.setHeightAndLayout(topPanelsHeight);\n\n    // ****************************************************************\n    // RIGHT PANEL\n    this.panels.right.setHeightAndLayout(topPanelsHeight);\n\n    // ****************************************************************\n    // MIDDLE PANEL\n    var targetHeight_middle = topPanelsHeight;\n    if (this.recordChartType.get() !== \"none\") {\n      targetHeight_middle -= this.recordDisplay.collapsed\n        ? this.recordDisplay.height_Header + 4\n        : 200;\n      targetHeight_middle -= Base.width_PanelGap;\n    }\n    this.panels.middle.setHeightAndLayout(targetHeight_middle);\n\n    // The part where summary DOM is updated\n    this.blocks.forEach((block) => block.refreshHeight());\n\n    if (!this.recordDisplay.collapsed && this.recordChartType.get() !== \"none\") {\n      var listDisplayHeight =\n        topPanelsHeight -\n        this.recordDisplay.height_Header -\n        this.panels.middle.height;\n      if (this.showDropZones && this.panels.middle.isEmpty())\n        listDisplayHeight *= 0.5;\n      this.recordDisplay.setHeight(listDisplayHeight);\n    }\n  }\n\n  /** -- */\n  updateMiddlePanelWidth() {\n    // for some reason, on page load, this variable may be null. urgh.\n    var widthMiddlePanel =\n      this.width_Canvas -\n      this.panels.left.width_Real_withGap -\n      this.panels.right.width_Real_withGap;\n\n    this.panels.middle.setWidth(widthMiddlePanel);\n    this.panels.middle.refreshWidth();\n    // set summaries are also always placed in middle panel.\n    this.blocks\n      .filter((block) => block.attrib.type === \"setpair\")\n      .forEach((block) => block.refreshWidth());\n\n    if (this.recordDisplay) {\n      this.recordDisplay.setWidth(widthMiddlePanel);\n    }\n  }\n\n  // ********************************************************************\n  // Value access\n  // ********************************************************************\n\n  /**  */\n  getPercentageValue(_val: number, sT, breakMode = null, aggr = null) {\n    breakMode = breakMode || this.breakdownMode.get();\n    if (breakMode === \"absolute\") {\n      return _val;\n    }\n    if (breakMode === \"relative\" && aggr) {\n      if (!this.isCompared()) {\n        return (100 * _val) / this.allRecordsAggr[\"Active\"].measure;\n      }\n      if (aggr.Active.measure === 0) return 0;\n      return (100 * _val) / aggr.Active.measure; // divide by aactive measure of aggregate\n    }\n    if (breakMode === \"dependent\") {\n      return (100 * _val) / this.allRecordsAggr[sT].measure; // divide by total's compared measure\n    }\n    if (breakMode === \"total\") {\n      return (100 * _val) / this.allRecordsAggr[\"Active\"].measure; // divide by total's Active measure\n    }\n  }\n  /** -- */\n  getChartValue(aggr: Aggregate, sT) {\n    return this.getPercentageValue(aggr.measure(sT), sT, null, aggr);\n  }\n  /** -- */\n  getMeasureValue(\n    aggr: Aggregate,\n    sT: MeasureType = \"Active\",\n    breakMode = null,\n    offset: MeasureType[] = []\n  ) {\n    var _val = aggr.measure(sT);\n\n    if (sT === \"Active\" && offset) {\n      offset.forEach((t: MeasureType) => {\n        _val -= aggr.measure(t);\n      });\n    }\n\n    return this.getPercentageValue(_val, sT, breakMode, aggr);\n  }\n  /** -- */\n  getMeasureFormattedValue(_val, isSVG = false) {\n    return this.measureFunc.get() !== \"Count\"\n      ? this.measureSummary.get().getFormattedValue(_val, isSVG)\n      : _val;\n  }\n  /** -- */\n  getValueLabel(_val, isSVG = false, decimals = 1, withPercentage = null) {\n    withPercentage =\n      withPercentage != null ? withPercentage : this.percentBreakdown;\n    if (withPercentage) {\n      if (_val !== 100 && _val !== 0) _val = _val.toFixed(decimals);\n      return _val + (isSVG ? \"%\" : \"<span class='unitName'>%</span>\");\n    }\n\n    if (this.measureFunc_Count) {\n      return Util.formatForItemCount(_val);\n    }\n\n    const measureSummary = this.measureSummary.get();\n\n    if (\n      this.measureFunc_Sum &&\n      !measureSummary.hasNegativeValues() &&\n      !measureSummary.hasFloat\n    ) {\n      return Util.formatForItemCount(_val, measureSummary.unitName);\n    }\n\n    if (_val <= -1000 || _val >= 1000) {\n      return Util.formatForItemCount(_val, measureSummary.unitName);\n    }\n\n    if (this.measureFunc_Avg) {\n      _val = _val.toFixed(decimals);\n    }\n\n    return this.measureSummary.get().getFormattedValue(_val);\n  }\n\n  // ********************************************************************\n  // Export & import\n  // ********************************************************************\n\n  /** -- */\n  exportData() {\n    var out = [];\n    var _clear = (_data) => {\n      for (let attribName in _data) {\n        var attr = _data[attribName];\n        if (typeof attr !== \"object\") continue;\n        if (attr == null) continue;\n        if (attribName === \"_timeseries_\") {\n          delete _data[attribName];\n        }\n        if (attr._timeseries_) {\n          delete attr._timeseries_;\n        }\n        for (let key in attr) {\n          if (attr[key] === \"\") delete attr[key];\n          if (typeof attr[key] == \"object\") _clear(attr[key]);\n        }\n      }\n    };\n    this.records.forEach((record) => {\n      if (record.filteredOut) return;\n      let dataCopy = Object.assign({}, record.data);\n      _clear(dataCopy);\n      out.push(dataCopy);\n    });\n    return out;\n  }\n\n  exportConfig(): ConfigSpec {\n    var config: ConfigSpec = {\n      domID: this.domID !== Base.defaultDOM ? this.domID : undefined,\n      recordName: this.recordName,\n      source: Object.assign({}, this.options.source),\n      description: this.options.description || undefined,\n      attribPanelWidth:\n        this.attribPanelWidth !== Base.width_AttribPanelDefault\n          ? this.attribPanelWidth\n          : undefined,\n      summaries: [],\n      panels: {},\n      recordDisplay: this.recordDisplay.exportConfig() as any,\n\n      colorTheme: this.colorTheme.exportConfig(),\n    };\n\n    Object.values(this.configs).forEach((_cfg) => _cfg.exportConfigTo(config));\n\n    if (!this.measureFunc_Count && this.measureSummary.get()) {\n      config.metric = {\n        type: this.measureFunc.get(),\n        summary: this.measureSummary.get().template.str,\n      };\n    }\n\n    // ***********************************************\n    // Export summary configuration\n    var _exportAttrib = (attrib: Attrib) => {\n      if (attrib.isExportable()) {\n        var cfg = attrib.exportConfig() as SummarySpec;\n        Util.removeEmptyKeys(cfg);\n        config.summaries.push(cfg);\n      }\n    };\n    // export attribs within dashboard, ordered by block, in view order\n    Object.values(this.panels).forEach((panel) =>\n      panel.blocks.forEach((block) => _exportAttrib(block.attrib))\n    );\n    // exports attribs that are not within the panels already / not exported yet\n    this.attribs\n      .filter((attrib) => !attrib?.block?.inDashboard)\n      .forEach(_exportAttrib);\n\n    // Export panel configurations\n    for (let [name, panel] of Object.entries(this.panels)) {\n      if (panel.hasBlocks()) {\n        config.panels[name] = panel.exportConfig();\n      }\n    }\n\n    // Export selections\n    var comparedAttrib = this.comparedAttrib;\n    if (comparedAttrib) {\n      config.selections = {\n        summary: comparedAttrib.attribName,\n      };\n      Base.Compare_List.forEach((cT) => {\n        if (!this.selectedAggrs[cT] || !this.selectedAggrs[cT].locked) return;\n        config.selections[cT] = this.selectedAggrs[cT].exportAggregateInfo();\n      });\n    }\n\n    // remove all settings that are {}\n    let clearSetting = (_) => {\n      if (!Object.keys(config[_]).length) delete config[_];\n    };\n    clearSetting(\"panels\");\n    clearSetting(\"colorTheme\");\n\n    Util.removeEmptyKeys(config);\n\n    return config;\n  }\n}\n"],"names":["DOMPurify","roundArrow","d3","Popper.createPopper","scaleLinear","scaleLog","easeCubicOut","curveMonotoneX","d3.select","Filter_Geo","scaleTime","easePolyInOut","scaleQuantize","easeLinear","easePoly","easePolyOut","zoomTransform","zoomIdentity","scaleUtc","utcSecond","utcWeek","scaleSqrt","scaleThreshold"],"mappings":"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"}